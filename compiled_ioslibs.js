"undefined"===typeof PhoneGap&&("object"!==typeof DeviceInfo&&(DeviceInfo={}),PhoneGap={commandQueue:[],commandQueueFlushing:!1,_constructors:[],documentEventHandler:{},windowEventHandler:{},resources:{base:!0},hasResource:function(a){return PhoneGap.resources[a]},addResource:function(a){PhoneGap.resources[a]=!0}},PhoneGap.available=void 0!=DeviceInfo.uuid,PhoneGap.addConstructor=function(a){var b=document.readyState;("loaded"==b||"complete"==b)&&null!=DeviceInfo.uuid?a():PhoneGap._constructors.push(a)},
function(){var a=setInterval(function(){var b=document.readyState;if(("loaded"==b||"complete"==b)&&null!=DeviceInfo.uuid){for(clearInterval(a);0<PhoneGap._constructors.length;){b=PhoneGap._constructors.shift();try{b()}catch(c){"function"==typeof console.log?console.log("Failed to run constructor: "+console.processMessage(c)):alert("Failed to run constructor: "+c.message)}}b=document.createEvent("Events");b.initEvent("deviceready");document.dispatchEvent(b)}},1)}(),PhoneGap.sessionKey=0,PhoneGap.callbackId=
0,PhoneGap.callbacks={},PhoneGap.callbackStatus={NO_RESULT:0,OK:1,CLASS_NOT_FOUND_EXCEPTION:2,ILLEGAL_ACCESS_EXCEPTION:3,INSTANTIATION_EXCEPTION:4,MALFORMED_URL_EXCEPTION:5,IO_EXCEPTION:6,INVALID_ACTION:7,JSON_EXCEPTION:8,ERROR:9},PhoneGap.createGapBridge=function(){gapBridge=document.createElement("iframe");gapBridge.setAttribute("style","display:none;");gapBridge.setAttribute("height","0px");gapBridge.setAttribute("width","0px");gapBridge.setAttribute("frameborder","0");document.documentElement.appendChild(gapBridge);
return gapBridge},PhoneGap.exec=function(){if(PhoneGap.available){var a,b,c,e,f,g=null;"string"!==typeof arguments[0]?(a=arguments[0],b=arguments[1],c=arguments[2],e=arguments[3],f=arguments[4],g="INVALID"):(splitCommand=arguments[0].split("."),e=splitCommand.pop(),c=splitCommand.join("."),f=Array.prototype.splice.call(arguments,1));e={className:c,methodName:e,arguments:[]};if(a||b)g=c+PhoneGap.callbackId++,PhoneGap.callbacks[g]={success:a,fail:b};null!=g&&e.arguments.push(g);for(a=0;a<f.length;++a)b=
f[a],void 0==b||null==b||("object"==typeof b?e.options=b:e.arguments.push(b));PhoneGap.commandQueue.push(JSON.stringify(e));1==PhoneGap.commandQueue.length&&!PhoneGap.commandQueueFlushing&&(PhoneGap.gapBridge||(PhoneGap.gapBridge=PhoneGap.createGapBridge()),PhoneGap.gapBridge.src="gap://ready")}else alert("ERROR: Attempting to call PhoneGap.exec() before 'deviceready'. Ignoring.")},PhoneGap.getAndClearQueuedCommands=function(){json=JSON.stringify(PhoneGap.commandQueue);PhoneGap.commandQueue=[];return json},
PhoneGap.callbackSuccess=function(a,b){if(PhoneGap.callbacks[a]){if(b.status==PhoneGap.callbackStatus.OK)try{PhoneGap.callbacks[a].success&&PhoneGap.callbacks[a].success(b.message)}catch(c){console.log("Error in success callback: "+a+" = "+c)}b.keepCallback||delete PhoneGap.callbacks[a]}},PhoneGap.callbackError=function(a,b){if(PhoneGap.callbacks[a]){try{PhoneGap.callbacks[a].fail&&PhoneGap.callbacks[a].fail(b.message)}catch(c){console.log("Error in error callback: "+a+" = "+c)}b.keepCallback||delete PhoneGap.callbacks[a]}},
PhoneGap.clone=function(a){if(!a)return a;if(a instanceof Array){for(var b=[],c=0;c<a.length;++c)b.push(PhoneGap.clone(a[c]));return b}if(a instanceof Function||!(a instanceof Object)||a instanceof Date)return a;b={};for(c in a)if(!(c in b)||b[c]!=a[c])b[c]=PhoneGap.clone(a[c]);return b},PhoneGap.m_document_addEventListener=document.addEventListener,PhoneGap.m_window_addEventListener=window.addEventListener,PhoneGap.addWindowEventHandler=function(a,b){PhoneGap.windowEventHandler[a]=b},PhoneGap.addDocumentEventHandler=
function(a,b){PhoneGap.documentEventHandler[a]=b},document.addEventListener=function(a,b,c){var e=a.toLowerCase();"undefined"!==typeof PhoneGap.documentEventHandler[e]&&PhoneGap.documentEventHandler[e](e,b,!0)||PhoneGap.m_document_addEventListener.call(document,a,b,c)},window.addEventListener=function(a,b,c){var e=a.toLowerCase();"undefined"!==typeof PhoneGap.windowEventHandler[e]&&PhoneGap.windowEventHandler[e](e,b,!0)||PhoneGap.m_window_addEventListener.call(window,a,b,c)},PhoneGap.m_document_removeEventListener=
document.removeEventListener,PhoneGap.m_window_removeEventListener=window.removeEventListener,document.removeEventListener=function(a,b,c){var e=a.toLowerCase();"undefined"!==typeof PhoneGap.documentEventHandler[e]&&PhoneGap.documentEventHandler[e](e,b,!1)||PhoneGap.m_document_removeEventListener.call(document,a,b,c)},window.removeEventListener=function(a,b,c){var e=a.toLowerCase();"undefined"!==typeof PhoneGap.windowEventHandler[e]&&PhoneGap.windowEventHandler[e](e,b,!1)||PhoneGap.m_window_removeEventListener.call(window,
a,b,c)},PhoneGap.fireDocumentEvent=function(a,b){var c=document.createEvent("Events");c.initEvent(a);if(b)for(var e in b)c[e]=b[e];document.dispatchEvent(c)},PhoneGap.fireWindowEvent=function(a,b){var c=document.createEvent("Events");c.initEvent(a);if(b)for(var e in b)c[e]=b[e];window.dispatchEvent(c)},PhoneGap.fireEvent=function(a,b,c){var e=document.createEvent("Events");e.initEvent(a);if(c)for(var f in c)e[f]=c[f];b=b||document;void 0===b.dispatchEvent&&(b=document);b.dispatchEvent(e)},PhoneGap.createUUID=
function(){return PhoneGap.UUIDcreatePart(4)+"-"+PhoneGap.UUIDcreatePart(2)+"-"+PhoneGap.UUIDcreatePart(2)+"-"+PhoneGap.UUIDcreatePart(2)+"-"+PhoneGap.UUIDcreatePart(6)},PhoneGap.UUIDcreatePart=function(a){for(var b="",c=0;c<a;c++){var e=parseInt(256*Math.random()).toString(16);1==e.length&&(e="0"+e);b+=e}return b});
if(!PhoneGap.hasResource("debugconsole")){PhoneGap.addResource("debugconsole");var DebugConsole=function(){this.winConsole=window.console;this.logLevel=DebugConsole.INFO_LEVEL};DebugConsole.ALL_LEVEL=1;DebugConsole.INFO_LEVEL=1;DebugConsole.WARN_LEVEL=2;DebugConsole.ERROR_LEVEL=4;DebugConsole.NONE_LEVEL=8;DebugConsole.prototype.setLevel=function(a){this.logLevel=a};DebugConsole.prototype.processMessage=function(a,b){b===void 0&&(b=0);if(typeof a!="object")return this.isDeprecated?"WARNING: debug object is deprecated, please use console object \n"+
a:a;var c=function(a,f){var g="",l;for(l in a)try{if(typeof a[l]=="object"&&f<b){var k=g,n=l+":\n",r;r=c(a[l]).replace(/^/mg,"    ");g=k+(n+r+"\n")}else g=g+(l+" = "+(""+a[l]).replace(/^/mg,"    ").replace(/^    /,"")+"\n")}catch(z){g=g+(l+" = EXCEPTION: "+z.message+"\n")}return g};return"Object:\n"+c(a,b)};DebugConsole.prototype.log=function(a,b){PhoneGap.available&&this.logLevel<=DebugConsole.INFO_LEVEL?PhoneGap.exec(null,null,"com.phonegap.debugconsole","log",[this.processMessage(a,b),{logLevel:"INFO"}]):
this.winConsole.log(a)};DebugConsole.prototype.warn=function(a,b){PhoneGap.available&&this.logLevel<=DebugConsole.WARN_LEVEL?PhoneGap.exec(null,null,"com.phonegap.debugconsole","log",[this.processMessage(a,b),{logLevel:"WARN"}]):this.winConsole.error(a)};DebugConsole.prototype.error=function(a,b){PhoneGap.available&&this.logLevel<=DebugConsole.ERROR_LEVEL?PhoneGap.exec(null,null,"com.phonegap.debugconsole","log",[this.processMessage(a,b),{logLevel:"ERROR"}]):this.winConsole.error(a)};PhoneGap.addConstructor(function(){window.console=
new DebugConsole})}
PhoneGap.hasResource("position")||(PhoneGap.addResource("position"),Position=function(a,b){this.coords=Coordinates.cloneFrom(a);this.timestamp=b||(new Date).getTime()},Position.prototype.equals=function(a){return this.coords&&a&&a.coords&&this.coords.latitude==a.coords.latitude&&this.coords.longitude==a.coords.longitude},Position.prototype.clone=function(){return new Position(this.coords?this.coords.clone():null,this.timestamp?this.timestamp:(new Date).getTime())},Coordinates=function(a,b,c,e,f,g,
l){this.latitude=a;this.longitude=b;this.altitude=c;this.accuracy=e;this.heading=f;this.speed=g;this.altitudeAccuracy=l!="undefined"?l:null},Coordinates.prototype.clone=function(){return new Coordinates(this.latitude,this.longitude,this.altitude,this.accuracy,this.heading,this.speed,this.altitudeAccuracy)},Coordinates.cloneFrom=function(a){return new Coordinates(a.latitude,a.longitude,a.altitude,a.accuracy,a.heading,a.speed,a.altitudeAccuracy)},PositionOptions=function(a,b,c){this.enableHighAccuracy=
a||false;this.timeout=b||1E4;this.maximumAge=c||0;if(this.maximumAge<0)this.maximumAge=0},PositionError=function(a,b){this.code=a||0;this.message=b||""},PositionError.UNKNOWN_ERROR=0,PositionError.PERMISSION_DENIED=1,PositionError.POSITION_UNAVAILABLE=2,PositionError.TIMEOUT=3);PhoneGap.hasResource("acceleration")||(PhoneGap.addResource("acceleration"),Acceleration=function(a,b,c){this.x=a;this.y=b;this.z=c;this.timestamp=(new Date).getTime()},AccelerationOptions=function(){this.timeout=1E4});
PhoneGap.hasResource("accelerometer")||(PhoneGap.addResource("accelerometer"),Accelerometer=function(){this.lastAcceleration=new Acceleration(0,0,0)},Accelerometer.prototype.getCurrentAcceleration=function(a){typeof a=="function"&&a(this.lastAcceleration)},Accelerometer.prototype._onAccelUpdate=function(a,b,c){this.lastAcceleration=new Acceleration(a,b,c)},Accelerometer.prototype.watchAcceleration=function(a,b,c){var e=c!=void 0&&c.frequency!=void 0?c.frequency:1E4;PhoneGap.exec(null,null,"com.phonegap.accelerometer",
"start",[c]);return setInterval(function(){navigator.accelerometer.getCurrentAcceleration(a,b,c)},e)},Accelerometer.prototype.clearWatch=function(a){PhoneGap.exec(null,null,"com.phonegap.accelerometer","stop",[]);clearInterval(a)},Accelerometer.install=function(){if(typeof navigator.accelerometer=="undefined")navigator.accelerometer=new Accelerometer},Accelerometer.installDeviceMotionHandler=function(){if(window.DeviceMotionEvent==void 0){var a=this;a.deviceMotionWatchId=null;a.deviceMotionListenerCount=
0;a.deviceMotionLastEventTimestamp=0;var b=window.addEventListener,c=window.removeEventListener,e=window.dispatchEvent!==void 0,f=function(b){var c=document.createEvent("Events");c.initEvent("devicemotion");c.acceleration=null;c.rotationRate=null;c.accelerationIncludingGravity=b;b=(new Date).getTime();c.interval=a.deviceMotionLastEventTimestamp==0?0:b-a.deviceMotionLastEventTimestamp;a.deviceMotionLastEventTimestamp=b;e?window.dispatchEvent(c):document.dispatchEvent(c)},g=function(){};window.addEventListener=
function(){if(arguments[0]==="devicemotion"){++a.deviceMotionListenerCount;if(a.deviceMotionListenerCount==1)a.deviceMotionWatchId=navigator.accelerometer.watchAcceleration(f,g,{frequency:500})}return e?b.apply(this,arguments):document.addEventListener.apply(this,arguments)};window.removeEventListener=function(){if(arguments[0]==="devicemotion"){--a.deviceMotionListenerCount;a.deviceMotionListenerCount==0&&navigator.accelerometer.clearWatch(a.deviceMotionWatchId)}return e?c.apply(this,arguments):
document.removeEventListener.apply(this,arguments)}}},PhoneGap.addConstructor(Accelerometer.install),PhoneGap.addConstructor(Accelerometer.installDeviceMotionHandler));
if(!PhoneGap.hasResource("battery")){PhoneGap.addResource("battery");var Battery=function(){this._isPlugged=this._level=null;this._batteryListener=[];this._lowListener=[];this._criticalListener=[]};Battery.prototype.eventHandler=function(a,b,c){var e=navigator.battery;if(c){e._batteryListener.length===0&&e._lowListener.length===0&&e._criticalListener.length===0&&PhoneGap.exec(e._status,e._error,"com.phonegap.battery","start",[]);if(a==="batterystatus"){a=e._batteryListener.indexOf(b);a===-1&&e._batteryListener.push(b)}else if(a===
"batterylow"){a=e._lowListener.indexOf(b);a===-1&&e._lowListener.push(b)}else if(a==="batterycritical"){a=e._criticalListener.indexOf(b);a===-1&&e._criticalListener.push(b)}}else{if(a==="batterystatus"){a=e._batteryListener.indexOf(b);a>-1&&e._batteryListener.splice(a,1)}else if(a==="batterylow"){a=e._lowListener.indexOf(b);a>-1&&e._lowListener.splice(a,1)}else if(a==="batterycritical"){a=e._criticalListener.indexOf(b);a>-1&&e._criticalListener.splice(a,1)}e._batteryListener.length===0&&e._lowListener.length===
0&&e._criticalListener.length===0&&PhoneGap.exec(null,null,"com.phonegap.battery","stop",[])}};Battery.prototype._status=function(a){if(a){if(this._level!=a.level||this._isPlugged!=a.isPlugged){PhoneGap.fireEvent("batterystatus",window,a);if(a.level==20||a.level==5)a.level==20?PhoneGap.fireEvent("batterylow",window,a):PhoneGap.fireEvent("batterycritical",window,a)}this._level=a.level;this._isPlugged=a.isPlugged}};Battery.prototype._error=function(a){console.log("Error initializing Battery: "+a)};
PhoneGap.addConstructor(function(){if(typeof navigator.battery==="undefined"){navigator.battery=new Battery;PhoneGap.addWindowEventHandler("batterystatus",navigator.battery.eventHandler);PhoneGap.addWindowEventHandler("batterylow",navigator.battery.eventHandler);PhoneGap.addWindowEventHandler("batterycritical",navigator.battery.eventHandler)}})}
PhoneGap.hasResource("camera")||(PhoneGap.addResource("camera"),Camera=function(){},Camera.DestinationType={DATA_URL:0,FILE_URI:1},Camera.prototype.DestinationType=Camera.DestinationType,Camera.PictureSourceType={PHOTOLIBRARY:0,CAMERA:1,SAVEDPHOTOALBUM:2},Camera.prototype.PictureSourceType=Camera.PictureSourceType,Camera.EncodingType={JPEG:0,PNG:1},Camera.prototype.EncodingType=Camera.EncodingType,Camera.MediaType={PICTURE:0,VIDEO:1,ALLMEDIA:2},Camera.prototype.MediaType=Camera.MediaType,Camera.prototype.getPicture=
function(a,b,c){typeof a!="function"?console.log("Camera Error: successCallback is not a function"):b&&typeof b!="function"?console.log("Camera Error: errorCallback is not a function"):PhoneGap.exec(a,b,"com.phonegap.camera","getPicture",[c])},PhoneGap.addConstructor(function(){if(typeof navigator.camera=="undefined")navigator.camera=new Camera}));
PhoneGap.hasResource("device")||(PhoneGap.addResource("device"),Device=function(){this.uuid=this.phonegap=this.name=this.version=this.platform=null;try{this.platform=DeviceInfo.platform;this.version=DeviceInfo.version;this.name=DeviceInfo.name;this.phonegap=DeviceInfo.gap;this.uuid=DeviceInfo.uuid}catch(a){}this.available=PhoneGap.available=this.uuid!=null},PhoneGap.addConstructor(function(){if(typeof navigator.device==="undefined")navigator.device=window.device=new Device}));
if(!PhoneGap.hasResource("capture")){PhoneGap.addResource("capture");var CaptureError=function(){this.code=null};CaptureError.CAPTURE_INTERNAL_ERR=0;CaptureError.CAPTURE_APPLICATION_BUSY=1;CaptureError.CAPTURE_INVALID_ARGUMENT=2;CaptureError.CAPTURE_NO_MEDIA_FILES=3;CaptureError.CAPTURE_NOT_SUPPORTED=20;var Capture=function(){this.supportedAudioModes=[];this.supportedImageModes=[];this.supportedVideoModes=[]};Capture.prototype.captureAudio=function(a,b,c){PhoneGap.exec(a,b,"com.phonegap.mediacapture",
"captureAudio",[c])};Capture.prototype.captureImage=function(a,b,c){PhoneGap.exec(a,b,"com.phonegap.mediacapture","captureImage",[c])};Capture.prototype._castMediaFile=function(a){var b=[],c;for(c=0;c<a.message.length;c++){var e=new MediaFile;e.name=a.message[c].name;e.fullPath=a.message[c].fullPath;e.type=a.message[c].type;e.lastModifiedDate=a.message[c].lastModifiedDate;e.size=a.message[c].size;b.push(e)}a.message=b;return a};Capture.prototype.captureVideo=function(a,b,c){PhoneGap.exec(a,b,"com.phonegap.mediacapture",
"captureVideo",[c])};var ConfigurationData=function(){this.type;this.width=this.height=0},CaptureImageOptions=function(){this.limit=1;this.mode=null},CaptureVideoOptions=function(){this.limit=1;this.duration=0;this.mode=null},CaptureAudioOptions=function(){this.limit=1;this.duration=0;this.mode=null},MediaFile=function(a,b,c,e,f){this.name=a||null;this.fullPath=b||null;this.type=c||null;this.lastModifiedDate=e||null;this.size=f||0};MediaFile.prototype.getFormatData=function(a,b){typeof this.fullPath===
"undefined"||this.fullPath===null?b({code:CaptureError.CAPTURE_INVALID_ARGUMENT}):PhoneGap.exec(a,b,"com.phonegap.mediacapture","getFormatData",[this.fullPath,this.type])};var MediaFileData=function(a,b,c,e,f){this.codecs=a||null;this.bitrate=b||0;this.height=c||0;this.width=e||0;this.duration=f||0};PhoneGap.addConstructor(function(){if(typeof navigator.device==="undefined")navigator.device=window.device=new Device;if(typeof navigator.device.capture==="undefined")navigator.device.capture=window.device.capture=
new Capture})}
if(!PhoneGap.hasResource("contact")){PhoneGap.addResource("contact");var Contact=function(a,b,c,e,f,g,l,k,n,r,z,s,p,q){this.id=a||null;this.displayName=b||null;this.name=c||null;this.nickname=e||null;this.phoneNumbers=f||null;this.emails=g||null;this.addresses=l||null;this.ims=k||null;this.organizations=n||null;this.birthday=r||null;this.note=z||null;this.photos=s||null;this.categories=p||null;this.urls=q||null};Contact.prototype.convertDatesOut=function(){for(var a=["birthday"],b=0;b<a.length;b++){var c=
this[a[b]];if(c){if(!c instanceof Date)try{c=new Date(c)}catch(e){c=null}c instanceof Date&&(c=c.valueOf());this[a[b]]=c}}};Contact.prototype.convertDatesIn=function(){for(var a=["birthday"],b=0;b<a.length;b++){var c=this[a[b]];if(c)try{this[a[b]]=new Date(parseFloat(c))}catch(e){console.log("exception creating date")}}};Contact.prototype.remove=function(a,b){if(this.id==null){var c=new ContactError;c.code=ContactError.UNKNOWN_ERROR;b(c)}else PhoneGap.exec(a,b,"com.phonegap.contacts","remove",[{contact:this}])};
Contact.prototype.display=function(a,b){if(this.id==null){if(typeof a=="function"){var c=new ContactError;c.code=ContactError.UNKNOWN_ERROR;a(c)}}else PhoneGap.exec(null,a,"com.phonegap.contacts","displayContact",[this.id,b])};Contact.prototype.clone=function(){var a=PhoneGap.clone(this);a.id=null;if(a.phoneNumbers)for(i=0;i<a.phoneNumbers.length;i++)a.phoneNumbers[i].id=null;if(a.emails)for(i=0;i<a.emails.length;i++)a.emails[i].id=null;if(a.addresses)for(i=0;i<a.addresses.length;i++)a.addresses[i].id=
null;if(a.ims)for(i=0;i<a.ims.length;i++)a.ims[i].id=null;if(a.organizations)for(i=0;i<a.organizations.length;i++)a.organizations[i].id=null;if(a.photos)for(i=0;i<a.photos.length;i++)a.photos[i].id=null;if(a.urls)for(i=0;i<a.urls.length;i++)a.urls[i].id=null;return a};Contact.prototype.save=function(a,b){var c=PhoneGap.clone(this);c.convertDatesOut();PhoneGap.exec(a,b,"com.phonegap.contacts","save",[{contact:c}])};var ContactName=function(a,b,c,e,f,g){this.formatted=a!="undefined"?a:null;this.familyName=
b!="undefined"?b:null;this.givenName=c!="undefined"?c:null;this.middleName=e!="undefined"?e:null;this.honorificPrefix=f!="undefined"?f:null;this.honorificSuffix=g!="undefined"?g:null},ContactField=function(a,b,c,e){this.type=a!="undefined"?a:null;this.value=b!="undefined"?b:null;this.pref=c!="undefined"?c:null;this.id=e!="undefined"?e:null},ContactAddress=function(a,b,c,e,f,g,l,k,n){this.pref=a!="undefined"?a:null;this.type=b!="undefined"?b:null;this.formatted=c!="undefined"?c:null;this.streetAddress=
e!="undefined"?e:null;this.locality=f!="undefined"?f:null;this.region=g!="undefined"?g:null;this.postalCode=l!="undefined"?l:null;this.country=k!="undefined"?k:null;this.id=n!="undefined"?n:null},ContactOrganization=function(a,b,c,e,f){this.pref=a!="undefined"?a:null;this.type=b!="undefined"?b:null;this.name=c!="undefined"?c:null;this.department=e!="undefined"?e:null;this.title=f!="undefined"?f:null},Contacts=function(){this.inProgress=false;this.records=[]};Contacts.prototype.find=function(a,b,c,
e){if(b===null)throw new TypeError("You must specify a success callback for the find command.");a===null||a==="undefined"||a.length==="undefined"||a.length<=0?typeof c==="function"&&c({code:ContactError.INVALID_ARGUMENT_ERROR}):PhoneGap.exec(b,c,"com.phonegap.contacts","search",[{fields:a,findOptions:e}])};Contacts.prototype._findCallback=function(a){var b=[];try{for(var c=0;c<a.message.length;c++){var e=navigator.contacts.create(a.message[c]);e.convertDatesIn();b.push(e)}a.message=b}catch(f){console.log("Error parsing contacts: "+
f)}return a};Contacts.prototype._contactCallback=function(a){var b=null;if(a.message)try{b=navigator.contacts.create(a.message);b.convertDatesIn()}catch(c){console.log("Error parsing contact")}a.message=b;return a};Contacts.prototype._errCallback=function(a){var b=new ContactError;b.code=a.message;a.message=b;return a};Contacts.prototype.newContactUI=function(a){PhoneGap.exec(a,null,"com.phonegap.contacts","newContact",[])};Contacts.prototype.chooseContact=function(a,b){PhoneGap.exec(a,null,"com.phonegap.contacts",
"chooseContact",b)};Contacts.prototype.create=function(a){var b,c=new Contact;for(b in a)c[b]!=="undefined"&&(c[b]=a[b]);return c};var ContactFindOptions=function(a,b){this.filter=a||"";this.multiple=b||false},ContactError=function(){this.code=null};ContactError.UNKNOWN_ERROR=0;ContactError.INVALID_ARGUMENT_ERROR=1;ContactError.TIMEOUT_ERROR=2;ContactError.PENDING_OPERATION_ERROR=3;ContactError.IO_ERROR=4;ContactError.NOT_SUPPORTED_ERROR=5;ContactError.PERMISSION_DENIED_ERROR=20;PhoneGap.addConstructor(function(){if(typeof navigator.contacts==
"undefined")navigator.contacts=new Contacts})}
PhoneGap.hasResource("file")||(PhoneGap.addResource("file"),FileProperties=function(a){this.filePath=a;this.size=0;this.lastModifiedDate=null},File=function(a,b,c,e,f){this.name=a||null;this.fullPath=b||null;this.type=c||null;this.lastModifiedDate=e||null;this.size=f||0},File._createEvent=function(a,b){var c={type:a};c.target=b;return c},FileError=function(){this.code=null},FileError.NOT_FOUND_ERR=1,FileError.SECURITY_ERR=2,FileError.ABORT_ERR=3,FileError.NOT_READABLE_ERR=4,FileError.ENCODING_ERR=
5,FileError.NO_MODIFICATION_ALLOWED_ERR=6,FileError.INVALID_STATE_ERR=7,FileError.SYNTAX_ERR=8,FileError.INVALID_MODIFICATION_ERR=9,FileError.QUOTA_EXCEEDED_ERR=10,FileError.TYPE_MISMATCH_ERR=11,FileError.PATH_EXISTS_ERR=12,FileMgr=function(){},FileMgr.prototype.testFileExists=function(a,b,c){PhoneGap.exec(b,c,"com.phonegap.file","testFileExists",[a])},FileMgr.prototype.testDirectoryExists=function(a,b,c){PhoneGap.exec(b,c,"com.phonegap.file","testDirectoryExists",[a])},FileMgr.prototype.getFreeDiskSpace=
function(a,b){PhoneGap.exec(a,b,"com.phonegap.file","getFreeDiskSpace",[])},FileMgr.prototype.write=function(a,b,c,e,f){PhoneGap.exec(e,f,"com.phonegap.file","write",[a,b,c])},FileMgr.prototype.truncate=function(a,b,c,e){PhoneGap.exec(c,e,"com.phonegap.file","truncateFile",[a,b])},FileMgr.prototype.readAsText=function(a,b,c,e){PhoneGap.exec(c,e,"com.phonegap.file","readFile",[a,b])},FileMgr.prototype.readAsDataURL=function(a,b,c){PhoneGap.exec(b,c,"com.phonegap.file","readAsDataURL",[a])},PhoneGap.addConstructor(function(){if(typeof navigator.fileMgr===
"undefined")navigator.fileMgr=new FileMgr}),FileReader=function(){this.fileName="";this.readyState=0;this.onabort=this.onloadend=this.onerror=this.onload=this.onprogress=this.onloadstart=this.error=this.result=null},FileReader.EMPTY=0,FileReader.LOADING=1,FileReader.DONE=2,FileReader.prototype.abort=function(){var a;this.readyState=FileReader.DONE;this.result=null;a=new FileError;a.code=a.ABORT_ERR;this.error=a;if(typeof this.onerror==="function"){a=File._createEvent("error",this);this.onerror(a)}if(typeof this.onabort===
"function"){a=File._createEvent("abort",this);this.onabort(a)}if(typeof this.onloadend==="function"){a=File._createEvent("loadend",this);this.onloadend(a)}},FileReader.prototype.readAsText=function(a,b){this.fileName="";this.fileName=typeof a.fullPath==="undefined"?a:a.fullPath;this.readyState=FileReader.LOADING;if(typeof this.onloadstart==="function")this.onloadstart(File._createEvent("loadstart",this));var c=this;navigator.fileMgr.readAsText(this.fileName,b?b:"UTF-8",function(a){if(c.readyState!==
FileReader.DONE){c.result=decodeURIComponent(a);if(typeof c.onload==="function"){a=File._createEvent("load",c);c.onload(a)}c.readyState=FileReader.DONE;if(typeof c.onloadend==="function"){a=File._createEvent("loadend",c);c.onloadend(a)}}},function(a){if(c.readyState!==FileReader.DONE){c.error=a;if(typeof c.onerror==="function"){a=File._createEvent("error",c);c.onerror(a)}c.readyState=FileReader.DONE;if(typeof c.onloadend==="function"){a=File._createEvent("loadend",c);c.onloadend(a)}}})},FileReader.prototype.readAsDataURL=
function(a){this.fileName="";this.fileName=typeof a.fullPath==="undefined"?a:a.fullPath;this.readyState=FileReader.LOADING;if(typeof this.onloadstart==="function")this.onloadstart(File._createEvent("loadstart",this));var b=this;navigator.fileMgr.readAsDataURL(this.fileName,function(a){if(b.readyState!==FileReader.DONE){b.result=a;if(typeof b.onload==="function"){a=File._createEvent("load",b);b.onload(a)}b.readyState=FileReader.DONE;if(typeof b.onloadend==="function"){a=File._createEvent("loadend",
b);b.onloadend(a)}}},function(a){if(b.readyState!==FileReader.DONE){b.error=a;if(typeof b.onerror==="function"){a=File._createEvent("error",b);b.onerror(a)}b.readyState=FileReader.DONE;if(typeof b.onloadend==="function"){a=File._createEvent("loadend",b);b.onloadend(a)}}})},FileReader.prototype.readAsBinaryString=function(a){this.fileName=a},FileReader.prototype.readAsArrayBuffer=function(a){this.fileName=a},FileWriter=function(a){this.fileName="";this.length=0;if(a){this.fileName=a.fullPath||a;this.length=
a.size||0}this.readyState=this.position=0;this.onerror=this.onabort=this.onwriteend=this.onwrite=this.onprogress=this.onwritestart=this.error=this.result=null},FileWriter.INIT=0,FileWriter.WRITING=1,FileWriter.DONE=2,FileWriter.prototype.abort=function(){if(this.readyState===FileWriter.DONE||this.readyState===FileWriter.INIT)throw FileError.INVALID_STATE_ERR;var a=new FileError;a.code=a.ABORT_ERR;this.error=a;if(typeof this.onerror==="function"){a=File._createEvent("error",this);this.onerror(a)}if(typeof this.onabort===
"function"){a=File._createEvent("abort",this);this.onabort(a)}this.readyState=FileWriter.DONE;if(typeof this.onwriteend=="function"){a=File._createEvent("writeend",this);this.onwriteend(a)}},FileWriter.prototype.writeAsText=function(a,b,c){if(this.readyState===FileWriter.WRITING)throw FileError.INVALID_STATE_ERR;c!==true&&(c=false);this.fileName=a;this.readyState=FileWriter.WRITING;var e=this;if(typeof e.onwritestart==="function"){var f=File._createEvent("writestart",e);e.onwritestart(f)}navigator.fileMgr.writeAsText(a,
b,c,function(a){if(e.readyState!==FileWriter.DONE){e.result=a;if(typeof e.onwrite==="function"){a=File._createEvent("write",e);e.onwrite(a)}e.readyState=FileWriter.DONE;if(typeof e.onwriteend==="function"){a=File._createEvent("writeend",e);e.onwriteend(a)}}},function(a){if(e.readyState!==FileWriter.DONE){e.error=a;if(typeof e.onerror==="function"){a=File._createEvent("error",e);e.onerror(a)}e.readyState=FileWriter.DONE;if(typeof e.onwriteend==="function"){a=File._createEvent("writeend",e);e.onwriteend(a)}}})},
FileWriter.prototype.write=function(a){if(this.readyState===FileWriter.WRITING)throw FileError.INVALID_STATE_ERR;this.readyState=FileWriter.WRITING;var b=this;if(typeof b.onwritestart==="function"){var c=File._createEvent("writestart",b);b.onwritestart(c)}navigator.fileMgr.write(this.fileName,a,this.position,function(a){if(b.readyState!==FileWriter.DONE){b.position=b.position+a;b.length=b.position;if(typeof b.onwrite==="function"){a=File._createEvent("write",b);b.onwrite(a)}b.readyState=FileWriter.DONE;
if(typeof b.onwriteend==="function"){a=File._createEvent("writeend",b);b.onwriteend(a)}}},function(a){if(b.readyState!==FileWriter.DONE){b.error=a;if(typeof b.onerror==="function"){a=File._createEvent("error",b);b.onerror(a)}b.readyState=FileWriter.DONE;if(typeof b.onwriteend==="function"){a=File._createEvent("writeend",b);b.onwriteend(a)}}})},FileWriter.prototype.seek=function(a){if(this.readyState===FileWriter.WRITING)throw FileError.INVALID_STATE_ERR;if(a)this.position=a<0?Math.max(a+this.length,
0):a>this.length?this.length:a},FileWriter.prototype.truncate=function(a){if(this.readyState===FileWriter.WRITING)throw FileError.INVALID_STATE_ERR;this.readyState=FileWriter.WRITING;var b=this;if(typeof b.onwritestart==="function"){var c=File._createEvent("writestart",b);b.onwritestart(c)}navigator.fileMgr.truncate(this.fileName,a,function(a){if(b.readyState!==FileWriter.DONE){b.length=a;b.position=Math.min(b.position,a);if(typeof b.onwrite==="function"){a=File._createEvent("write",b);b.onwrite(a)}b.readyState=
FileWriter.DONE;if(typeof b.onwriteend==="function"){a=File._createEvent("writeend",b);b.onwriteend(a)}}},function(a){if(b.readyState!==FileWriter.DONE){b.error=a;if(typeof b.onerror==="function"){a=File._createEvent("error",b);b.onerror(a)}b.readyState=FileWriter.DONE;if(typeof b.onwriteend==="function"){a=File._createEvent("writeend",b);b.onwriteend(a)}}})},LocalFileSystem=function(){},LocalFileSystem.TEMPORARY=0,LocalFileSystem.PERSISTENT=1,LocalFileSystem.RESOURCE=2,LocalFileSystem.APPLICATION=
3,LocalFileSystem.prototype.requestFileSystem=function(a,b,c,e){a<0||a>3?typeof e=="function"&&e({code:FileError.SYNTAX_ERR}):PhoneGap.exec(c,e,"com.phonegap.file","requestFileSystem",[a,b])},LocalFileSystem.prototype.resolveLocalFileSystemURI=function(a,b,c){PhoneGap.exec(b,c,"com.phonegap.file","resolveLocalFileSystemURI",[a])},LocalFileSystem.prototype._castFS=function(a){var b=null,b=new DirectoryEntry;b.isDirectory=a.message.root.isDirectory;b.isFile=a.message.root.isFile;b.name=a.message.root.name;
b.fullPath=a.message.root.fullPath;a.message.root=b;return a},LocalFileSystem.prototype._castEntry=function(a){var b=null;a.message.isDirectory?b=new DirectoryEntry:a.message.isFile&&(b=new FileEntry);b.isDirectory=a.message.isDirectory;b.isFile=a.message.isFile;b.name=a.message.name;b.fullPath=a.message.fullPath;a.message=b;return a},LocalFileSystem.prototype._castEntries=function(a){var b=a.message,c=[];for(i=0;i<b.length;i++)c.push(window.localFileSystem._createEntry(b[i]));a.message=c;return a},
LocalFileSystem.prototype._createEntry=function(a){var b=null;a.isDirectory?b=new DirectoryEntry:a.isFile&&(b=new FileEntry);b.isDirectory=a.isDirectory;b.isFile=a.isFile;b.name=a.name;b.fullPath=a.fullPath;return b},LocalFileSystem.prototype._castDate=function(a){if(a.message.modificationTime){var b=new Metadata;b.modificationTime=new Date(a.message.modificationTime);a.message=b}else if(a.message.lastModifiedDate){b=new File;b.size=a.message.size;b.type=a.message.type;b.name=a.message.name;b.fullPath=
a.message.fullPath;b.lastModifiedDate=new Date(a.message.lastModifiedDate);a.message=b}return a},LocalFileSystem.prototype._castError=function(a){var b=new FileError;b.code=a.message;a.message=b;return a},Metadata=function(){this.modificationTime=null},Flags=function(a,b){this.create=a||false;this.exclusive=b||false},FileSystem=function(){this.root=this.name=null},DirectoryEntry=function(){this.isFile=false;this.isDirectory=true;this.filesystem=this.fullPath=this.name=null},DirectoryEntry.prototype.copyTo=
function(a,b,c,e){PhoneGap.exec(c,e,"com.phonegap.file","copyTo",[this.fullPath,a,b])},DirectoryEntry.prototype.getMetadata=function(a,b){PhoneGap.exec(a,b,"com.phonegap.file","getMetadata",[this.fullPath])},DirectoryEntry.prototype.getParent=function(a,b){PhoneGap.exec(a,b,"com.phonegap.file","getParent",[this.fullPath])},DirectoryEntry.prototype.moveTo=function(a,b,c,e){PhoneGap.exec(c,e,"com.phonegap.file","moveTo",[this.fullPath,a,b])},DirectoryEntry.prototype.remove=function(a,b){PhoneGap.exec(a,
b,"com.phonegap.file","remove",[this.fullPath])},DirectoryEntry.prototype.toURI=function(){return"file://localhost"+this.fullPath},DirectoryEntry.prototype.createReader=function(){return new DirectoryReader(this.fullPath)},DirectoryEntry.prototype.getDirectory=function(a,b,c,e){PhoneGap.exec(c,e,"com.phonegap.file","getDirectory",[this.fullPath,a,b])},DirectoryEntry.prototype.getFile=function(a,b,c,e){PhoneGap.exec(c,e,"com.phonegap.file","getFile",[this.fullPath,a,b])},DirectoryEntry.prototype.removeRecursively=
function(a,b){PhoneGap.exec(a,b,"com.phonegap.file","removeRecursively",[this.fullPath])},DirectoryReader=function(a){this.fullPath=a||null},DirectoryReader.prototype.readEntries=function(a,b){PhoneGap.exec(a,b,"com.phonegap.file","readEntries",[this.fullPath])},FileEntry=function(){this.isFile=true;this.isDirectory=false;this.filesystem=this.fullPath=this.name=null},FileEntry.prototype.copyTo=function(a,b,c,e){PhoneGap.exec(c,e,"com.phonegap.file","copyTo",[this.fullPath,a,b])},FileEntry.prototype.getMetadata=
function(a,b){PhoneGap.exec(a,b,"com.phonegap.file","getMetadata",[this.fullPath])},FileEntry.prototype.getParent=function(a,b){PhoneGap.exec(a,b,"com.phonegap.file","getParent",[this.fullPath])},FileEntry.prototype.moveTo=function(a,b,c,e){PhoneGap.exec(c,e,"com.phonegap.file","moveTo",[this.fullPath,a,b])},FileEntry.prototype.remove=function(a,b){PhoneGap.exec(a,b,"com.phonegap.file","remove",[this.fullPath])},FileEntry.prototype.toURI=function(){return"file://localhost"+this.fullPath},FileEntry.prototype.createWriter=
function(a,b){this.file(function(c){c=new FileWriter(c);(c.fileName==null||c.fileName=="")&&typeof b=="function"&&b({code:FileError.INVALID_STATE_ERR});typeof a=="function"&&a(c)},b)},FileEntry.prototype.file=function(a,b){PhoneGap.exec(a,b,"com.phonegap.file","getFileMetadata",[this.fullPath])},PhoneGap.addConstructor(function(){var a=new LocalFileSystem;if(typeof window.localFileSystem=="undefined")window.localFileSystem=a;if(typeof window.requestFileSystem=="undefined")window.requestFileSystem=
a.requestFileSystem;if(typeof window.resolveLocalFileSystemURI=="undefined")window.resolveLocalFileSystemURI=a.resolveLocalFileSystemURI}));
PhoneGap.hasResource("filetransfer")||(PhoneGap.addResource("filetransfer"),FileTransfer=function(){},FileUploadResult=function(){this.bytesSent=0;this.response=this.responseCode=null},FileTransferError=function(a){this.code=a||null},FileTransferError.FILE_NOT_FOUND_ERR=1,FileTransferError.INVALID_URL_ERR=2,FileTransferError.CONNECTION_ERR=3,FileTransfer.prototype.upload=function(a,b,c,e,f){if(!f.params)f.params={};f.filePath=a;f.server=b;if(!f.fileKey)f.fileKey="file";if(!f.fileName)f.fileName="image.jpg";
if(!f.mimeType)f.mimeType="image/jpeg";typeof c!="function"?console.log("FileTransfer Error: successCallback is not a function"):e&&typeof e!="function"?console.log("FileTransfer Error: errorCallback is not a function"):PhoneGap.exec(c,e,"com.phonegap.filetransfer","upload",[f])},FileTransfer.prototype._castTransferError=function(a){var b=new FileTransferError(a.message);a.message=b;return a},FileTransfer.prototype._castUploadResult=function(a){var b=new FileUploadResult;b.bytesSent=a.message.bytesSent;
b.responseCode=a.message.responseCode;b.response=decodeURIComponent(a.message.response);a.message=b;return a},FileUploadOptions=function(a,b,c,e){this.fileKey=a||null;this.fileName=b||null;this.mimeType=c||null;this.params=e||null},PhoneGap.addConstructor(function(){if(typeof navigator.fileTransfer=="undefined")navigator.fileTransfer=new FileTransfer}));
PhoneGap.hasResource("geolocation")||(PhoneGap.addResource("geolocation"),Geolocation=function(){this.listener=this.lastPosition=null;this.timeoutTimerId=0},Geolocation.prototype.getCurrentPosition=function(a,b,c){if(!a||typeof a!="function")a=function(){};if(!b||typeof b!="function")b=function(){};var e=this,f=new PositionOptions;if(c){if(c.maximumAge){if(this.lastPosition&&(new Date).getTime()-this.lastPosition.timestamp<c.maximumAge){a(this.lastPosition);return}f.maximumAge=c.maximumAge}if(c.enableHighAccuracy)f.enableHighAccuracy=
c.enableHighAccuracy==true;if(c.timeout)f.timeout=c.timeout}this.listener={success:a,fail:b};this.start(f);clearTimeout(this.timeoutTimerId);this.timeoutTimerId=setTimeout(function(){e.setError(new PositionError(PositionError.TIMEOUT,"Geolocation Error: Timeout."))},f.timeout)},Geolocation.prototype.watchPosition=function(a,b,c){var e=new PositionOptions;if(c){if(c.maximumAge)e.maximumAge=c.maximumAge;if(c.enableHighAccuracy)e.enableHighAccuracy=c.enableHighAccuracy;if(c.timeout)e.timeout=c.timeout}var f=
this,g=f.lastPosition?f.lastPosition.clone():null,c=function(){f.getCurrentPosition(function(b){(g==null||!b.equals(g))&&a(b);g=b.clone()},b,e)};c();return setInterval(c,e.timeout)},Geolocation.prototype.clearWatch=function(a){clearInterval(a)},Geolocation.prototype.setLocation=function(a){a=new Position(a.coords,a.timestamp);if(this.timeoutTimerId){clearTimeout(this.timeoutTimerId);this.timeoutTimerId=0}this.lastError=null;this.lastPosition=a;this.listener&&typeof this.listener.success=="function"&&
this.listener.success(a);this.listener=null},Geolocation.prototype.setError=function(a){a=new PositionError(a.code,a.message);if(this.timeoutTimerId){clearTimeout(this.timeoutTimerId);this.timeoutTimerId=0}this.lastError=a;this.listener&&typeof this.listener.fail=="function"&&this.listener.fail(a);this.listener=null},Geolocation.prototype.start=function(a){PhoneGap.exec(null,null,"com.phonegap.geolocation","startLocation",[a])},Geolocation.prototype.stop=function(){PhoneGap.exec(null,null,"com.phonegap.geolocation",
"stopLocation",[])},PhoneGap.addConstructor(function(){if(typeof navigator._geo=="undefined"){navigator._geo=new Geolocation;(function(a,b,c){var e=function(a,b,c){a[c]=function(){return b[c].apply(b,arguments)}},f;for(f in c)e(a,b,c[f])})(navigator.geolocation,navigator._geo,["setLocation","getCurrentPosition","watchPosition","clearWatch","setError","start","stop"])}}));
PhoneGap.hasResource("compass")||(PhoneGap.addResource("compass"),CompassError=function(){this.code=null},CompassError.COMPASS_INTERNAL_ERR=0,CompassError.COMPASS_NOT_SUPPORTED=20,CompassHeading=function(){this.timestamp=this.headingAccuracy=this.trueHeading=this.magneticHeading=null},Compass=function(){this.timers={}},Compass.prototype.getCurrentHeading=function(a,b){typeof a!=="function"?console.log("Compass Error: successCallback is not a function"):b&&typeof b!=="function"?console.log("Compass Error: errorCallback is not a function"):
PhoneGap.exec(a,b,"com.phonegap.geolocation","getCurrentHeading",[])},Compass.prototype.watchHeading=function(a,b,c){c=c!==void 0?c.frequency:100;if(typeof a!=="function")console.log("Compass Error: successCallback is not a function");else if(b&&typeof b!=="function")console.log("Compass Error: errorCallback is not a function");else{var e=PhoneGap.createUUID();navigator.compass.timers[e]=setInterval(function(){PhoneGap.exec(a,b,"com.phonegap.geolocation","getCurrentHeading",[{repeats:1}])},c);return e}},
Compass.prototype.clearWatch=function(a){if(a&&navigator.compass.timers[a]){clearInterval(navigator.compass.timers[a]);delete navigator.compass.timers[a]}navigator.compass.timers.length==0&&PhoneGap.exec(null,null,"com.phonegap.geolocation","stopHeading",[])},Compass.prototype.watchHeadingFilter=function(a,b,c){c===void 0||c.filter===void 0?console.log("Compass Error:  options.filter not specified"):typeof a!=="function"?console.log("Compass Error: successCallback is not a function"):b&&typeof b!==
"function"?console.log("Compass Error: errorCallback is not a function"):PhoneGap.exec(a,b,"com.phonegap.geolocation","watchHeadingFilter",[c])},Compass.prototype.clearWatchFilter=function(){PhoneGap.exec(null,null,"com.phonegap.geolocation","stopHeading",[])},PhoneGap.addConstructor(function(){if(typeof navigator.compass=="undefined")navigator.compass=new Compass}));
PhoneGap.hasResource("media")||(PhoneGap.addResource("media"),PhoneGap.mediaObjects={},PhoneGap.Media=function(){},PhoneGap.Media.getMediaObject=function(a){return PhoneGap.mediaObjects[a]},PhoneGap.Media.onStatus=function(a,b,c){a=PhoneGap.mediaObjects[a];if(b==Media.MEDIA_STATE){c==Media.MEDIA_STOPPED&&a.successCallback&&a.successCallback();a.statusCallback&&a.statusCallback(c)}else if(b==Media.MEDIA_DURATION)a._duration=c;else if(b==Media.MEDIA_ERROR)a.errorCallback&&a.errorCallback(c);else if(b==
Media.MEDIA_POSITION)a._position=c},Media=function(a,b,c,e,f){if(b&&typeof b!="function")console.log("Media Error: successCallback is not a function");else if(c&&typeof c!="function")console.log("Media Error: errorCallback is not a function");else if(e&&typeof e!="function")console.log("Media Error: statusCallback is not a function");else if(f&&typeof f!="function")console.log("Media Error: positionCallback is not a function");else{this.id=PhoneGap.createUUID();PhoneGap.mediaObjects[this.id]=this;
this.src=a;this.successCallback=b;this.errorCallback=c;this.statusCallback=e;this.positionCallback=f;this._position=this._duration=-1}},Media.MEDIA_STATE=1,Media.MEDIA_DURATION=2,Media.MEDIA_POSITION=3,Media.MEDIA_ERROR=9,Media.MEDIA_NONE=0,Media.MEDIA_STARTING=1,Media.MEDIA_RUNNING=2,Media.MEDIA_PAUSED=3,Media.MEDIA_STOPPED=4,Media.MEDIA_MSG=["None","Starting","Running","Paused","Stopped"],MediaError=function(){this.code=null;this.message=""},MediaError.MEDIA_ERR_ABORTED=1,MediaError.MEDIA_ERR_NETWORK=
2,MediaError.MEDIA_ERR_DECODE=3,MediaError.MEDIA_ERR_NONE_SUPPORTED=4,Media.prototype.play=function(a){PhoneGap.exec(null,null,"com.phonegap.media","play",[this.id,this.src,a])},Media.prototype.stop=function(){PhoneGap.exec(null,null,"com.phonegap.media","stop",[this.id,this.src])},Media.prototype.pause=function(){PhoneGap.exec(null,null,"com.phonegap.media","pause",[this.id,this.src])},Media.prototype.seekTo=function(a){PhoneGap.exec(null,null,"com.phonegap.media","seekTo",[this.id,this.src,a])},
Media.prototype.getDuration=function(){return this._duration},Media.prototype.getCurrentPosition=function(a,b){PhoneGap.exec(a,b,"com.phonegap.media","getCurrentPosition",[this.id,this.src])},Media.prototype.prepare=function(a,b){PhoneGap.exec(a,b,"com.phonegap.media","prepare",[this.id,this.src])},Media.prototype.startRecord=function(){PhoneGap.exec(null,null,"com.phonegap.media","startAudioRecord",[this.id,this.src])},Media.prototype.stopRecord=function(){PhoneGap.exec(null,null,"com.phonegap.media",
"stopAudioRecord",[this.id,this.src])},Media.prototype.release=function(){PhoneGap.exec(null,null,"com.phonegap.media","release",[this.id,this.src])});
PhoneGap.hasResource("notification")||(PhoneGap.addResource("notification"),Notification=function(){},Notification.prototype.alert=function(a,b,c,e){var f=c;if(c==null||typeof c==="undefined")f="Alert";PhoneGap.exec(b,null,"com.phonegap.notification","alert",[a,{title:f,buttonLabel:e||"OK"}])},Notification.prototype.confirm=function(a,b,c,e){this.alert(a,b,c||"Confirm",e||"OK,Cancel")},Notification.prototype.blink=function(){},Notification.prototype.vibrate=function(){PhoneGap.exec(null,null,"com.phonegap.notification",
"vibrate",[])},Notification.prototype.beep=function(){(new Media("beep.wav")).play()},PhoneGap.addConstructor(function(){if(typeof navigator.notification=="undefined")navigator.notification=new Notification}));
PhoneGap.hasResource("orientation")||(PhoneGap.addResource("orientation"),Orientation=function(){this.currentOrientation=null},Orientation.prototype.setOrientation=function(a){Orientation.currentOrientation=a;var b=document.createEvent("Events");b.initEvent("orientationChanged","false","false");b.orientation=a;document.dispatchEvent(b)},Orientation.prototype.getCurrentOrientation=function(){},Orientation.prototype.watchOrientation=function(a,b){this.getCurrentPosition(a,b);return setInterval(function(){navigator.orientation.getCurrentOrientation(a,
b)},1E4)},Orientation.prototype.clearWatch=function(a){clearInterval(a)},Orientation.install=function(){if(typeof navigator.orientation=="undefined")navigator.orientation=new Orientation;var a=window.dispatchEvent!==void 0;if(!a){var b=window.addEventListener,c=window.removeEventListener;window.onorientationchange=function(){PhoneGap.fireEvent("orientationchange_pg",window)};window.addEventListener=function(){arguments[0]==="orientationchange"&&(arguments[0]="orientationchange_pg");return!a?document.addEventListener.apply(this,
arguments):b.apply(this,arguments)};window.removeEventListener=function(){arguments[0]==="orientationchange"&&(arguments[0]="orientationchange_pg");return!a?document.removeEventListener.apply(this,arguments):c.apply(this,arguments)}}},PhoneGap.addConstructor(Orientation.install));PhoneGap.hasResource("sms")||(PhoneGap.addResource("sms"),Sms=function(){},Sms.prototype.send=function(){},PhoneGap.addConstructor(function(){if(typeof navigator.sms=="undefined")navigator.sms=new Sms}));
PhoneGap.hasResource("telephony")||(PhoneGap.addResource("telephony"),Telephony=function(){},Telephony.prototype.call=function(){},PhoneGap.addConstructor(function(){if(typeof navigator.telephony=="undefined")navigator.telephony=new Telephony}));
PhoneGap.hasResource("network")||(PhoneGap.addResource("network"),Connection=function(){this.type=Connection.UNKNOWN;try{this.type=DeviceInfo.connection.type}catch(a){}},Connection.UNKNOWN="unknown",Connection.ETHERNET="ethernet",Connection.WIFI="wifi",Connection.CELL_2G="2g",Connection.CELL_3G="3g",Connection.CELL_4G="4g",Connection.NONE="none",PhoneGap.addConstructor(function(){if(typeof navigator.network=="undefined")navigator.network={};if(typeof navigator.network.connection=="undefined")navigator.network.connection=
new Connection}));PhoneGap.hasResource("splashscreen")||(PhoneGap.addResource("splashscreen"),SplashScreen=function(){},SplashScreen.prototype.show=function(){PhoneGap.exec(null,null,"com.phonegap.splashscreen","show",[])},SplashScreen.prototype.hide=function(){PhoneGap.exec(null,null,"com.phonegap.splashscreen","hide",[])},PhoneGap.addConstructor(function(){if(typeof navigator.splashscreen=="undefined")navigator.splashscreen=new SplashScreen}));(function(){function a(){}function b(){}function c(){this._callback}PhoneGap.plugins=PhoneGap.plugins||{};window.plugins=window.plugins||{};a._onLocationChange=function(a){window.plugins.childBrowser.onLocationChange(a)};a._onClose=function(){window.plugins.childBrowser.onClose()};a._onOpenExternal=function(){window.plugins.childBrowser.onOpenExternal()};a.prototype.showWebPage=function(a){PhoneGap.exec("ChildBrowserCommand.showWebPage",a)};a.prototype.close=function(){PhoneGap.exec("ChildBrowserCommand.close")};
PhoneGap.addConstructor(function(){PhoneGap.plugins.childBrowser=new a;window.plugins.childBrowser=PhoneGap.plugins.childBrowser});b.prototype.request=function(a,b,c){return PhoneGap.exec(b,c,"HTTPRequest","grabURL",[a])};b.prototype.requestInBackground=function(a,b,c){return PhoneGap.exec(b,c,"HTTPRequest","grabURLInBackground",[a])};PhoneGap.addConstructor(function(){PhoneGap.plugins.httpRequest=new b});c.prototype.show=function(a,b){this._callback=b;PhoneGap.exec("Picker.show",a)};c.prototype._selected=
function(a){this._callback&&this._callback(a)};PhoneGap.addConstructor(function(){PhoneGap.plugins.picker=new c;window.plugins.picker=PhoneGap.plugins.picker})})();(function(){var a=PhoneGap.plugins,b={},c={};b.ChildBrowser=c;c.go=function(b){a.childBrowser.showWebPage(b)};c={};b.Device=c;c.getUUID=function(){return device.uuid};c.getName=function(){return device.name};c.getVersion=function(){return window.device?device.version:null};c.getPhoneGapVersion=function(){return window.device?device.phonegap:null};c.overrideBackButton=function(){device&&"function"==typeof device.overrideBackButton&&device.overrideBackButton()};c.exitApp=function(){navigator.app&&"function"==
typeof navigator.app.exitApp?(console.log("app.exit"),navigator.app.exitApp()):device&&"function"==typeof device.exitApp&&(console.log("device.exit"),device.exitApp())};c={};b.Event=c;c.onPause=function(a){document.addEventListener("pause",a)};c.onResume=function(a){document.addEventListener("resume",a)};c.onBackKeyDown=function(a){document.addEventListener("backbutton",a)};c={};b.File=c;c.write=function(a,b,c,l){window.requestFileSystem(LocalFileSystem.PERSISTENT,0,function(k){k.root.getFile(a,{create:!0},
function(a){a.createWriter(function(a){a.onwrite=function(){console.log("onwrite file");c()};a.write(b)},l)},l)},l)};c.read=function(a,b,c){window.requestFileSystem(LocalFileSystem.PERSISTENT,0,function(l){l.root.getFile(a,{create:!1},function(a){a.file(function(a){var c=new FileReader;c.onloadend=function(a){console.log("Read as text");b(a.target.result)};c.readAsText(a)},c)},c)},c)};c={};b.Geolocation=c;c.getCurrentPosition=function(a,b){navigator.geolocation.getCurrentPosition(function(b){a(b.coords)},
function(a){b(a)},{timeout:15E3,enableHighAccuracy:!0})};c.getAddressFromGeo=function(b,c,g,l){a.httpRequest.requestInBackground("http://maps.google.com/maps/api/geocode/json?latlng="+b+","+c+"&language=zh-TW&sensor=true",function(a){console.log("getAddressFromGeo http success");a=JSON.parse(a);g(a)},function(a){console.log("getAddressFromGeo http failed");l(a)})};c={};b.Picker=c;c.showPicker=function(b,c,g,l,k){var n={};n.dependent=b;n.components=c||[];n.setValues=g||[];n.maximunWordsInLine=24;n.rect=
k||[];a.picker.show(n,function(a){l(a)})};window.myapp=window.myapp||{};window.myapp.PG=b})();var i18n=function(){var a={},b={DST:-4,format:"D, d F Y H:i:s",AM:"AM",PM:"PM"};Date.prototype.format=function(a){var b="",c=Date.replaceChars,l="";c.reload();for(var k=0;k<a.length;k++)l=a.charAt(k),b+=c[l]?c[l].call(this):l;return b};Date.replaceChars={reload:function(){Date.replaceChars.shortMonths=a.hasOwnProperty("shortMonths")?a.shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(",");Date.replaceChars.longMonths=a.hasOwnProperty("longMonths")?a.longMonths:"January,February,March,April,May,June,July,August,September,October,November,December".split(",");
Date.replaceChars.shortDays=a.hasOwnProperty("shortDays")?a.shortDays:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(",");Date.replaceChars.longDays=a.hasOwnProperty("longDays")?a.longDays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(",")},shortMonths:[],longMonths:[],shortDays:[],longDays:[],d:function(){return(10>this.getUTCDate()?"0":"")+this.getUTCDate()},D:function(){return Date.replaceChars.shortDays[this.getUTCDay()]},j:function(){return this.getUTCDate()},l:function(){return Date.replaceChars.longDays[this.getUTCDay()]},
N:function(){return this.getDay()+1},S:function(){return 1===this.getUTCDate()%10&&11!==this.getUTCDate()?"st":2===this.getUTCDate()%10&&12!==this.getUTCDate()?"nd":3==this.getUTCDate()%10&&13!=this.getUTCDate()?"rd":"th"},w:function(){return this.getUTCDay()},z:function(){return""},W:function(){return""},F:function(){return Date.replaceChars.longMonths[this.getUTCMonth()]},m:function(){return(9>this.getUTCMonth()?"0":"")+(this.getUTCMonth()+1)},M:function(){return Date.replaceChars.shortMonths[this.getUTCMonth()]},
n:function(){return this.getUTCMonth()+1},t:function(){return""},L:function(){return""},o:function(){return""},Y:function(){return this.getUTCFullYear()},y:function(){return(""+this.getUTCFullYear()).substr(2)},a:function(){var c=a.hasOwnProperty("setting")?a.setting:b;return 12>this.getUTCHours()?c.AM:c.PM},A:function(){var c=a.hasOwnProperty("setting")?a.setting:b;return 12>this.getUTCHours()?c.AM:c.PM},B:function(){return""},g:function(){return this.getUTCHours()%12||12},G:function(){return this.getUTCHours()},
h:function(){return(10>(this.getUTCHours()%12||12)?"0":"")+(this.getUTCHours()%12||12)},H:function(){return(10>this.getUTCHours()?"0":"")+this.getUTCHours()},i:function(){return(10>this.getUTCMinutes()?"0":"")+this.getUTCMinutes()},s:function(){return(10>this.getUTCSeconds()?"0":"")+this.getUTCSeconds()},e:function(){return""},I:function(){return""},O:function(){return(0>-this.getTimezoneOffset()?"-":"+")+(10>Math.abs(this.getTimezoneOffset()/60)?"0":"")+Math.abs(this.getTimezoneOffset()/60)+"00"},
T:function(){var a=this.getUTCMonth();this.setMonth(0);var b=this.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,"$1");this.setMonth(a);return b},Z:function(){return 60*-this.getTimezoneOffset()},c:function(){return""},r:function(){return this.toString()},U:function(){return this.getUTCTime()/1E3}};var c=function(a,b,c){var l,b=parseInt(b,10);"string"===typeof c&&(c=c.split(/\D/),--c[1],l=new Date(c.join(",")));l="object"===typeof l?l:c;switch(a){case "y":l.setFullYear(l.getFullYear()+b);break;case "m":l.setMonth(l.getMonth()+
b);break;case "d":l.setDate(l.getDate()+b);break;case "w":l.setDate(l.getDate()+7*b);break;case "h":l.setHours(l.getHours()+b);break;case "n":l.setMinutes(l.getMinutes()+b);break;case "s":l.setSeconds(l.getSeconds()+b);break;case "l":l.setMilliseconds(l.getMilliseconds()+b)}return l};return{set:function(b){a=b},datetime:function(e){var f=a.hasOwnProperty("setting")?a.setting:b;return(f.format?c("h",f.DST,e?new Date(e):new Date):e?new Date(e):new Date).format(f.format)},formatDate:function(e,f){var g=
a.hasOwnProperty("setting")?a.setting:b;return(g.format?c("h",g.DST,e?new Date(e):new Date):e?new Date(e):new Date).format(f)},_:function(b){try{var b=b.toString()||"",c=arguments,g=0<c.length?RegExp("%([1-"+c.length.toString()+"])","g"):null;return(""+(a.hasOwnProperty(b)?a[b]:b)).replace(g,function(a,b){return c[b]})}catch(l){}}}}();(function(a){String.prototype.trim===a&&(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")});Array.prototype.reduce===a&&(Array.prototype.reduce=function(b){if(void 0===this||null===this)throw new TypeError;var c=Object(this),e=c.length>>>0,f=0,g;if("function"!=typeof b)throw new TypeError;if(0==e&&1==arguments.length)throw new TypeError;if(2<=arguments.length)g=arguments[1];else{do{if(f in c){g=c[f++];break}if(++f>=e)throw new TypeError;}while(1)}for(;f<e;)f in c&&
(g=b.call(a,g,c[f],f,c)),f++;return g})})();
var Zepto=function(){function a(a){return"[object Function]"==D.call(a)}function b(a){return a instanceof Object}function c(b){var d,j;if("[object Object]"!==D.call(b))return!1;j=a(b.constructor)&&b.constructor.prototype;if(!j||!hasOwnProperty.call(j,"isPrototypeOf"))return!1;for(d in b);return d===p||hasOwnProperty.call(b,d)}function e(a){return a instanceof Array}function f(a){return"number"==typeof a.length}function g(a){return a.filter(function(a){return a!==p&&null!==a})}function l(a){return a.replace(/::/g,
"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function k(a){return a in h?h[a]:h[a]=RegExp("(^|\\s)"+a+"(\\s|$)")}function n(a,b){return b===p?m(a):m(a).filter(b)}function r(b,d,j,c){return a(d)?d.call(b,j,c):d}function z(a,b,d){var j=a%2?b:b.parentNode;j?j.insertBefore(d,a?1==a?j.firstChild:2==a?b:null:b.nextSibling):m(d).remove()}function s(a,b){b(a);for(var d in a.childNodes)s(a.childNodes[d],b)}var p,q,m,t,x=[],v=x.slice,u=window.document,
B={},h={},d=u.defaultView.getComputedStyle,o={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},F=/^\s*<(\w+|!)[^>]*>/,C=[1,3,8,9,11],E=u.createElement("table"),j=u.createElement("tr"),A={tr:u.createElement("tbody"),tbody:E,thead:E,tfoot:E,td:j,th:j,"*":u.createElement("div")},w=/complete|loaded|interactive/,J=/^\.([\w-]+)$/,K=/^#([\w-]+)$/,H=/^[\w-]+$/,D={}.toString,y={},I,G,L=u.createElement("div");return y.matches=function(a,b){if(!a||1!==a.nodeType)return!1;
var d=a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.matchesSelector;if(d)return d.call(a,b);var j,d=a.parentNode,c=!d;return c&&(d=L).appendChild(a),j=~y.qsa(d,b).indexOf(a),c&&L.removeChild(a),j},I=function(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})},G=function(a){return a.filter(function(b,d){return a.indexOf(b)==d})},y.fragment=function(a,b){b===p&&(b=F.test(a)&&RegExp.$1);b in A||(b="*");var d=A[b];return d.innerHTML=""+a,m.each(v.call(d.childNodes),
function(){d.removeChild(this)})},y.Z=function(a,b){return a=a||[],a.__proto__=arguments.callee.prototype,a.selector=b||"",a},y.isZ=function(a){return a instanceof y.Z},y.init=function(b,d){if(!b)return y.Z();if(a(b))return m(u).ready(b);if(y.isZ(b))return b;var j;if(e(b))j=g(b);else if(c(b))j=[m.extend({},b)],b=null;else if(0<=C.indexOf(b.nodeType)||b===window)j=[b],b=null;else if(F.test(b))j=y.fragment(b.trim(),RegExp.$1),b=null;else{if(d!==p)return m(d).find(b);j=y.qsa(u,b)}return y.Z(j,b)},m=
function(a,b){return y.init(a,b)},m.extend=function(a){return v.call(arguments,1).forEach(function(b){for(q in b)b[q]!==p&&(a[q]=b[q])}),a},y.qsa=function(a,b){var d;return a===u&&K.test(b)?(d=a.getElementById(RegExp.$1))?[d]:x:1!==a.nodeType&&9!==a.nodeType?x:v.call(J.test(b)?a.getElementsByClassName(RegExp.$1):H.test(b)?a.getElementsByTagName(b):a.querySelectorAll(b))},m.isFunction=a,m.isObject=b,m.isArray=e,m.isPlainObject=c,m.inArray=function(a,b,d){return x.indexOf.call(b,a,d)},m.trim=function(a){return a.trim()},
m.uuid=0,m.map=function(a,b){var d,j=[],c;if(f(a))for(c=0;c<a.length;c++)d=b(a[c],c),null!=d&&j.push(d);else for(c in a)d=b(a[c],c),null!=d&&j.push(d);return 0<j.length?[].concat.apply([],j):j},m.each=function(a,b){var d;if(f(a))for(d=0;d<a.length&&!1!==b.call(a[d],d,a[d]);d++);else for(d in a)if(!1===b.call(a[d],d,a[d]))break;return a},m.fn={forEach:x.forEach,reduce:x.reduce,push:x.push,indexOf:x.indexOf,concat:x.concat,map:function(a){return m.map(this,function(b,d){return a.call(b,d,b)})},slice:function(){return m(v.apply(this,
arguments))},ready:function(a){return w.test(u.readyState)?a(m):u.addEventListener("DOMContentLoaded",function(){a(m)},!1),this},get:function(a){return a===p?v.call(this):this[a]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(a){return this.forEach(function(b,d){a.call(b,d,b)}),this},filter:function(a){return m([].filter.call(this,function(b){return y.matches(b,
a)}))},add:function(a,b){return m(G(this.concat(m(a,b))))},is:function(a){return 0<this.length&&y.matches(this[0],a)},not:function(b){var d=[];if(a(b)&&b.call!==p)this.each(function(a){b.call(this,a)||d.push(this)});else{var j="string"==typeof b?this.filter(b):f(b)&&a(b.item)?v.call(b):m(b);this.forEach(function(a){0>j.indexOf(a)&&d.push(a)})}return m(d)},eq:function(a){return-1===a?this.slice(a):this.slice(a,+a+1)},first:function(){var a=this[0];return a&&!b(a)?a:m(a)},last:function(){var a=this[this.length-
1];return a&&!b(a)?a:m(a)},find:function(a){var b;return 1==this.length?b=y.qsa(this[0],a):b=this.map(function(){return y.qsa(this,a)}),m(b)},closest:function(a,b){for(var d=this[0];d&&!y.matches(d,a);)d=d!==b&&d!==u&&d.parentNode;return m(d)},parents:function(a){for(var b=[],d=this;0<d.length;)d=m.map(d,function(a){if((a=a.parentNode)&&a!==u&&0>b.indexOf(a))return b.push(a),a});return n(b,a)},parent:function(a){return n(G(this.pluck("parentNode")),a)},children:function(a){return n(this.map(function(){return v.call(this.children)}),
a)},siblings:function(a){return n(this.map(function(a,b){return v.call(b.parentNode.children).filter(function(a){return a!==b})}),a)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(a){return this.map(function(){return this[a]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=null);if("none"==d(this,"").getPropertyValue("display")){var a=this.style,b;b=this.nodeName;var j,c;b=(B[b]||(j=u.createElement(b),u.body.appendChild(j),
c=d(j,"").getPropertyValue("display"),j.parentNode.removeChild(j),"none"==c&&(c="block"),B[b]=c),B[b]);a.display=b}})},replaceWith:function(a){return this.before(a).remove()},wrap:function(a){return this.each(function(){m(this).wrapAll(m(a)[0].cloneNode(!1))})},wrapAll:function(a){return this[0]&&(m(this[0]).before(a=m(a)),a.append(this)),this},unwrap:function(){return this.parent().each(function(){m(this).replaceWith(m(this).children())}),this},clone:function(){return m(this.map(function(){return this.cloneNode(!0)}))},
hide:function(){return this.css("display","none")},toggle:function(a){return(a===p?"none"==this.css("display"):a)?this.show():this.hide()},prev:function(){return m(this.pluck("previousElementSibling"))},next:function(){return m(this.pluck("nextElementSibling"))},html:function(a){return a===p?0<this.length?this[0].innerHTML:null:this.each(function(b){var d=this.innerHTML;m(this).empty().append(r(this,a,b,d))})},text:function(a){return a===p?0<this.length?this[0].textContent:null:this.each(function(){this.textContent=
a})},attr:function(a,d){var j;return"string"==typeof a&&d===p?0==this.length||1!==this[0].nodeType?p:"value"==a&&"INPUT"==this[0].nodeName?this.val():!(j=this[0].getAttribute(a))&&a in this[0]?this[0][a]:j:this.each(function(j){if(1===this.nodeType)if(b(a))for(q in a)this.setAttribute(q,a[q]);else this.setAttribute(a,r(this,d,j,this.getAttribute(a)))})},removeAttr:function(a){return this.each(function(){1===this.nodeType&&this.removeAttribute(a)})},prop:function(a,b){return b===p?this[0]?this[0][a]:
p:this.each(function(d){this[a]=r(this,b,d,this[a])})},data:function(a,b){var d=this.attr("data-"+l(a),b);return null!==d?d:p},val:function(a){return a===p?0<this.length?this[0].value:p:this.each(function(b){this.value=r(this,a,b,this.value)})},offset:function(){if(0==this.length)return null;var a=this[0].getBoundingClientRect();return{left:a.left+window.pageXOffset,top:a.top+window.pageYOffset,width:a.width,height:a.height}},css:function(a,b){if(b===p&&"string"==typeof a)return 0==this.length?p:
this[0].style[I(a)]||d(this[0],"").getPropertyValue(a);var j="";for(q in a)"string"==typeof a[q]&&""==a[q]?this.each(function(){this.style.removeProperty(l(q))}):j+=l(q)+":"+("number"==typeof a[q]&&!o[l(q)]?a[q]+"px":a[q])+";";return"string"==typeof a&&(""==b?this.each(function(){this.style.removeProperty(l(a))}):j=l(a)+":"+("number"==typeof b&&!o[l(a)]?b+"px":b)),this.each(function(){this.style.cssText+=";"+j})},index:function(a){return a?this.indexOf(m(a)[0]):this.parent().children().indexOf(this[0])},
hasClass:function(a){return 1>this.length?!1:k(a).test(this[0].className)},addClass:function(a){return this.each(function(b){t=[];var d=this.className;r(this,a,b,d).split(/\s+/g).forEach(function(a){m(this).hasClass(a)||t.push(a)},this);t.length&&(this.className+=(d?" ":"")+t.join(" "))})},removeClass:function(a){return this.each(function(b){if(a===p)return this.className="";t=this.className;r(this,a,b,t).split(/\s+/g).forEach(function(a){t=t.replace(k(a)," ")});this.className=t.trim()})},toggleClass:function(a,
b){return this.each(function(d){d=r(this,a,d,this.className);(b===p?!m(this).hasClass(d):b)?m(this).addClass(d):m(this).removeClass(d)})}},["width","height"].forEach(function(a){m.fn[a]=function(b){var d,j=a.replace(/./,function(a){return a[0].toUpperCase()});return b===p?this[0]==window?window["inner"+j]:this[0]==u?u.documentElement["offset"+j]:(d=this.offset())&&d[a]:this.each(function(d){var j=m(this);j.css(a,r(this,b,d,j[a]()))})}}),["after","prepend","before","append"].forEach(function(a,d){m.fn[a]=
function(){var a=m.map(arguments,function(a){return b(a)?a:y.fragment(a)});if(1>a.length)return this;var j=this.length,c=1<j,G=2>d;return this.each(function(b,k){for(var h=0;h<a.length;h++){var e=a[G?a.length-h-1:h];s(e,function(a){null!=a.nodeName&&"SCRIPT"===a.nodeName.toUpperCase()&&(!a.type||"text/javascript"===a.type)&&window.eval.call(window,a.innerHTML)});c&&b<j-1&&(e=e.cloneNode(!0));z(d,k,e)}})};m.fn[d%2?a+"To":"insert"+(d?"Before":"After")]=function(b){return m(b)[a](this),this}}),y.Z.prototype=
m.fn,y.camelize=I,y.uniq=G,m.zepto=y,m}();window.Zepto=Zepto;"$"in window||(window.$=Zepto);
(function(a){function b(a){return a._zid||(a._zid=z++)}function c(a,c,k,n){c=e(c);if(c.ns)var m=RegExp("(?:^| )"+c.ns.replace(" "," .* ?")+"(?: |$)");return(r[b(a)]||[]).filter(function(a){return a&&(!c.e||a.e==c.e)&&(!c.ns||m.test(a.ns))&&(!k||b(a.fn)===b(k))&&(!n||a.sel==n)})}function e(a){a=(""+a).split(".");return{e:a[0],ns:a.slice(1).sort().join(" ")}}function f(b,c,k){a.isObject(b)?a.each(b,k):b.split(/\s/).forEach(function(a){k(a,c)})}function g(c,k,n,m,g,h){var h=!!h,d=b(c),o=r[d]||(r[d]=
[]);f(k,n,function(b,d){var k=g&&g(d,b),j=k||d,A=function(a){var b=j.apply(c,[a].concat(a.data));return!1===b&&a.preventDefault(),b},k=a.extend(e(b),{fn:d,proxy:A,sel:m,del:k,i:o.length});o.push(k);c.addEventListener(k.e,A,h)})}function l(a,k,e,n){var m=b(a);f(k||"",e,function(b,d){c(a,b,d,n).forEach(function(b){delete r[m][b.i];a.removeEventListener(b.e,b.proxy,!1)})})}function k(b){var c=a.extend({originalEvent:b},b);return a.each(m,function(a,k){c[a]=function(){return this[k]=p,b[a].apply(b,arguments)};
c[k]=q}),c}function n(a){if(!("defaultPrevented"in a)){a.defaultPrevented=!1;var b=a.preventDefault;a.preventDefault=function(){this.defaultPrevented=!0;b.call(this)}}}var r={},z=1,s={};s.click=s.mousedown=s.mouseup=s.mousemove="MouseEvents";a.event={add:g,remove:l};a.proxy=function(c,k){if(a.isFunction(c)){var e=function(){return c.apply(k,arguments)};return e._zid=b(c),e}if("string"==typeof k)return a.proxy(c[k],c);throw new TypeError("expected function");};a.fn.bind=function(a,b){return this.each(function(){g(this,
a,b)})};a.fn.unbind=function(a,b){return this.each(function(){l(this,a,b)})};a.fn.one=function(a,b){return this.each(function(c,k){g(this,a,b,null,function(a,b){return function(){var d=a.apply(k,arguments);return l(k,b,a),d}})})};var p=function(){return!0},q=function(){return!1},m={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};a.fn.delegate=function(b,c,e){var n=!1;if("blur"==c||"focus"==c)a.iswebkit?c="blur"==
c?"focusout":"focus"==c?"focusin":c:n=!0;return this.each(function(m,h){g(h,c,e,b,function(d){return function(c){var e,n=a(c.target).closest(b,h).get(0);if(n)return e=a.extend(k(c),{currentTarget:n,liveFired:h}),d.apply(n,[e].concat([].slice.call(arguments,1)))}},n)})};a.fn.undelegate=function(a,b,c){return this.each(function(){l(this,b,c,a)})};a.fn.live=function(b,c){return a(document.body).delegate(this.selector,b,c),this};a.fn.die=function(b,c){return a(document.body).undelegate(this.selector,
b,c),this};a.fn.on=function(b,c,k){return void 0==c||a.isFunction(c)?this.bind(b,c):this.delegate(c,b,k)};a.fn.off=function(b,c,k){return void 0==c||a.isFunction(c)?this.unbind(b,c):this.undelegate(c,b,k)};a.fn.trigger=function(b,c){return"string"==typeof b&&(b=a.Event(b)),n(b),b.data=c,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(b)})};a.fn.triggerHandler=function(b,e){var n,m;return this.each(function(r,h){n=k("string"==typeof b?a.Event(b):b);n.data=e;n.target=h;a.each(c(h,b.type||
b),function(a,b){m=b.proxy(n);if(n.isImmediatePropagationStopped())return!1})}),m};"focusin,focusout,load,resize,scroll,unload,click,dblclick,mousedown,mouseup,mousemove,mouseover,mouseout,change,select,keydown,keypress,keyup,error".split(",").forEach(function(b){a.fn[b]=function(a){return this.bind(b,a)}});["focus","blur"].forEach(function(b){a.fn[b]=function(a){if(a)this.bind(b,a);else if(this.length)try{this.get(0)[b]()}catch(c){}return this}});a.Event=function(a,b){var c=document.createEvent(s[a]||
"Events"),k=!0;if(b)for(var e in b)"bubbles"==e?k=!!b[e]:c[e]=b[e];return c.initEvent(a,k,!0,null,null,null,null,null,null,null,null,null,null,null,null),c}})(Zepto);
(function(a){function b(a){var b=this.os={},f=this.browser={},g=a.match(/WebKit\/([\d.]+)/),l=a.match(/(Android)\s+([\d.]+)/),k=a.match(/(iPad).*OS\s([\d_]+)/),n=!k&&a.match(/(iPhone\sOS)\s([\d_]+)/),r=a.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),z=r&&a.match(/TouchPad/),s=a.match(/Kindle\/([\d.]+)/),p=a.match(/Silk\/([\d._]+)/),q=a.match(/(BlackBerry).*Version\/([\d.]+)/);if(f.webkit=!!g)f.version=g[1];l&&(b.android=!0,b.version=l[2]);n&&(b.ios=b.iphone=!0,b.version=n[2].replace(/_/g,"."));k&&(b.ios=b.ipad=
!0,b.version=k[2].replace(/_/g,"."));r&&(b.webos=!0,b.version=r[2]);z&&(b.touchpad=!0);q&&(b.blackberry=!0,b.version=q[2]);s&&(b.kindle=!0,b.version=s[1]);p&&(f.silk=!0,f.version=p[1]);!p&&b.android&&a.match(/Kindle Fire/)&&(f.silk=!0)}b.call(a,navigator.userAgent);a.__detect=b})(Zepto);
(function(a,b){var c="",e,f=window.document.createElement("div"),g=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,l={};a.each({Webkit:"webkit",Moz:"",O:"o",ms:"MS"},function(a,n){if(f.style[a+"TransitionProperty"]!==b)return c="-"+a.toLowerCase()+"-",e=n,!1});l[c+"transition-property"]=l[c+"transition-duration"]=l[c+"transition-timing-function"]=l[c+"animation-name"]=l[c+"animation-duration"]="";a.fx={off:e===b&&f.style.transitionProperty===b,cssPrefix:c,transitionEnd:e?
e+"TransitionEnd":"transitionend",animationEnd:e?e+"AnimationEnd":"animationend"};a.fn.animate=function(b,c,e,f){return a.isObject(c)&&(e=c.easing,f=c.complete,c=c.duration),c&&(c/=1E3),this.anim(b,c,e,f)};a.fn.anim=function(k,e,r,f){var s,p={},q,m=this,t,x=a.fx.transitionEnd;e===b&&(e=0.4);a.fx.off&&(e=0);if("string"==typeof k)p[c+"animation-name"]=k,p[c+"animation-duration"]=e+"s",x=a.fx.animationEnd;else{for(q in k)g.test(q)?(s||(s=[]),s.push(q+"("+k[q]+")")):p[q]=k[q];s&&(p[c+"transform"]=s.join(" "));
!a.fx.off&&"object"==typeof k&&(p[c+"transition-property"]=Object.keys(k).join(", "),p[c+"transition-duration"]=e+"s",p[c+"transition-timing-function"]=r||"linear")}return t=function(b){if("undefined"!=typeof b){if(b.target!==b.currentTarget)return;a(b.target).unbind(x,arguments.callee)}a(this).css(l);f&&f.call(this)},0<e&&this.bind(x,t),setTimeout(function(){m.css(p);0>=e&&setTimeout(function(){m.each(function(){t.call(this)})},0)},0),this};f=null})(Zepto);
(function(a){function b(b,d,c,j){if(b.global)return b=d||q,c=a.Event(c),a(b).trigger(c,j),!c.defaultPrevented}function c(d){d.global&&0===a.active++&&b(d,null,"ajaxStart")}function e(a,d){var c=d.context;if(!1===d.beforeSend.call(c,a,d)||!1===b(d,c,"ajaxBeforeSend",[a,d]))return!1;b(d,c,"ajaxSend",[a,d])}function f(a,d,c){var j=c.context;c.success.call(j,a,"success",d);b(c,j,"ajaxSuccess",[d,c,a]);l("success",d,c)}function g(a,d,c,j){var k=j.context;j.error.call(k,c,d,a);b(j,k,"ajaxError",[c,j,a]);
l(d,c,j)}function l(d,c,k){var j=k.context;k.complete.call(j,c,d);b(k,j,"ajaxComplete",[c,k]);k.global&&!--a.active&&b(k,null,"ajaxStop")}function k(){}function n(a){return a&&(a==h?"html":a==B?"json":v.test(a)?"script":u.test(a)&&"xml")||"text"}function r(b){p(b.data)&&(b.data=a.param(b.data));b.data&&(!b.type||"GET"==b.type.toUpperCase())&&(b.url=(b.url+"&"+b.data).replace(/[&?]{1,2}/,"?"))}function z(b,d,c,j){var k=a.isArray(d);a.each(d,function(d,h){j&&(d=c?j:j+"["+(k?"":d)+"]");!j&&k?b.add(h.name,
h.value):(c?a.isArray(h):p(h))?z(b,h,c,d):b.add(d,h)})}var s=0,p=a.isObject,q=window.document,m,t,x=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,v=/^(?:text|application)\/javascript/i,u=/^(?:text|application)\/xml/i,B="application/json",h="text/html",d=/^\s*$/;a.active=0;a.ajaxJSONP=function(b){var d="jsonp"+ ++s,c=q.createElement("script"),j={abort:function(){a(c).remove();d in window&&(window[d]=k);l("abort",j,b)}},h;return b.error&&(c.onerror=function(){j.abort();b.error()}),window[d]=
function(k){clearTimeout(h);a(c).remove();delete window[d];f(k,j,b)},r(b),c.src=b.url.replace(/=\?/,"="+d),a("head").append(c),0<b.timeout&&(h=setTimeout(function(){j.abort();l("timeout",j,b)},b.timeout)),j};a.ajaxSettings={type:"GET",beforeSend:k,success:k,error:k,complete:k,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:B,xml:"application/xml, text/xml",html:h,text:"text/plain"},crossDomain:!1,timeout:0};a.ajax=
function(b){var h=a.extend({},b||{});for(m in a.ajaxSettings)void 0===h[m]&&(h[m]=a.ajaxSettings[m]);c(h);h.crossDomain||(h.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(h.url)&&RegExp.$2!=window.location.host);var o=h.dataType,b=/=\?/.test(h.url);if("jsonp"==o||b)return b||(h.url=(h.url+"&callback=?").replace(/[&?]{1,2}/,"?")),a.ajaxJSONP(h);h.url||(h.url=window.location.toString());r(h);var b=h.accepts[o],j={},A=/^([\w-]+:)\/\//.test(h.url)?RegExp.$1:window.location.protocol,w=a.ajaxSettings.xhr(),
l;h.crossDomain||(j["X-Requested-With"]="XMLHttpRequest");b&&(j.Accept=b,-1<b.indexOf(",")&&(b=b.split(",",2)[0]),w.overrideMimeType&&w.overrideMimeType(b));if(h.contentType||h.data&&"GET"!=h.type.toUpperCase())j["Content-Type"]=h.contentType||"application/x-www-form-urlencoded";h.headers=a.extend(j,h.headers||{});w.onreadystatechange=function(){if(4==w.readyState){clearTimeout(l);var a,b=!1;if(200<=w.status&&300>w.status||304==w.status||0==w.status&&"file:"==A){o=o||n(w.getResponseHeader("content-type"));
a=w.responseText;try{"script"==o?(0,eval)(a):"xml"==o?a=w.responseXML:"json"==o&&(a=d.test(a)?null:JSON.parse(a))}catch(c){b=c}b?g(b,"parsererror",w,h):f(a,w,h)}else g(null,"error",w,h)}};w.open(h.type,h.url,"async"in h?h.async:!0);for(t in h.headers)w.setRequestHeader(t,h.headers[t]);return!1===e(w,h)?(w.abort(),!1):(0<h.timeout&&(l=setTimeout(function(){w.onreadystatechange=k;w.abort();g(null,"timeout",w,h)},h.timeout)),w.send(h.data?h.data:null),w)};a.get=function(b,d){return a.ajax({url:b,success:d})};
a.post=function(b,d,c,j){return a.isFunction(d)&&(j=j||c,c=d,d=null),a.ajax({type:"POST",url:b,data:d,success:c,dataType:j})};a.getJSON=function(b,d){return a.ajax({url:b,success:d,dataType:"json"})};a.fn.load=function(b,d){if(!this.length)return this;var c=this,j=b.split(/\s/),k;return 1<j.length&&(b=j[0],k=j[1]),a.get(b,function(b){c.html(k?a(q.createElement("div")).html(b.replace(x,"")).find(k).html():b);d&&d.call(c)}),this};var o=encodeURIComponent;a.param=function(a,b){var d=[];return d.add=
function(a,b){this.push(o(a)+"="+o(b))},z(d,a,b),d.join("&").replace("%20","+")}})(Zepto);
(function(a){a.fn.serializeArray=function(){var b=[],c;return a(Array.prototype.slice.call(this.get(0).elements)).each(function(){c=a(this);var e=c.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=e&&"reset"!=e&&"button"!=e&&("radio"!=e&&"checkbox"!=e||this.checked)&&b.push({name:c.attr("name"),value:c.val()})}),b};a.fn.serialize=function(){var a=[];return this.serializeArray().forEach(function(c){a.push(encodeURIComponent(c.name)+"="+encodeURIComponent(c.value))}),
a.join("&")};a.fn.submit=function(b){b?this.bind("submit",b):this.length&&(b=a.Event("submit"),this.eq(0).trigger(b),b.defaultPrevented||this.get(0).submit());return this}})(Zepto);
(function(a){function b(a,b,c,e){var f=Math.abs(a-b),g=Math.abs(c-e);return f>=g?0<a-b?"Left":"Right":0<c-e?"Up":"Down"}function c(){g=null;e.last&&(e.el.trigger("longTap"),e={})}var e={},f,g;a(document).ready(function(){var l,k;a(document.body).bind("touchstart",function(b){l=Date.now();k=l-(e.last||l);e.el=a("tagName"in b.touches[0].target?b.touches[0].target:b.touches[0].target.parentNode);f&&clearTimeout(f);e.x1=b.touches[0].pageX;e.y1=b.touches[0].pageY;0<k&&250>=k&&(e.isDoubleTap=!0);e.last=
l;g=setTimeout(c,750)}).bind("touchmove",function(a){g&&clearTimeout(g);g=null;e.x2=a.touches[0].pageX;e.y2=a.touches[0].pageY}).bind("touchend",function(){g&&clearTimeout(g);g=null;e.isDoubleTap?(e.el.trigger("doubleTap"),e={}):e.x2&&30<Math.abs(e.x1-e.x2)||e.y2&&30<Math.abs(e.y1-e.y2)?(e.el.trigger("swipe")&&e.el.trigger("swipe"+b(e.x1,e.x2,e.y1,e.y2)),e={}):"last"in e&&(e.el.trigger("tap"),f=setTimeout(function(){f=null;e.el.trigger("singleTap");e={}},250))}).bind("touchcancel",function(){f&&clearTimeout(f);
g&&clearTimeout(g);g=f=null;e={}})});"swipe,swipeLeft,swipeRight,swipeUp,swipeDown,doubleTap,tap,singleTap,longTap".split(",").forEach(function(b){a.fn[b]=function(a){return this.bind(b,a)}})})(Zepto);(function(){function a(b,c,j){if(b===c)return 0!==b||1/b==1/c;if(null==b||null==c)return b===c;b._chain&&(b=b._wrapped);c._chain&&(c=c._wrapped);if(b.isEqual&&d.isFunction(b.isEqual))return b.isEqual(c);if(c.isEqual&&d.isFunction(c.isEqual))return c.isEqual(b);var k=n.call(b);if(k!=n.call(c))return!1;switch(k){case "[object String]":return b==""+c;case "[object Number]":return b!=+b?c!=+c:0==b?1/b==1/c:b==+c;case "[object Date]":case "[object Boolean]":return+b==+c;case "[object RegExp]":return b.source==
c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase}if("object"!=typeof b||"object"!=typeof c)return!1;for(var h=j.length;h--;)if(j[h]==b)return!0;j.push(b);var h=0,e=!0;if("[object Array]"==k){if(h=b.length,e=h==c.length)for(;h--&&(e=h in b==h in c&&a(b[h],c[h],j)););}else{if("constructor"in b!="constructor"in c||b.constructor!=c.constructor)return!1;for(var A in b)if(d.has(b,A)&&(h++,!(e=d.has(c,A)&&a(b[A],c[A],j))))break;if(e){for(A in c)if(d.has(c,A)&&!h--)break;
e=!h}}j.pop();return e}var b=this,c=b._,e={},f=Array.prototype,g=Object.prototype,l=f.slice,k=f.unshift,n=g.toString,r=g.hasOwnProperty,z=f.forEach,s=f.map,p=f.reduce,q=f.reduceRight,m=f.filter,t=f.every,x=f.some,v=f.indexOf,u=f.lastIndexOf,g=Array.isArray,B=Object.keys,h=Function.prototype.bind,d=function(a){return new D(a)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=d),exports._=d):b._=d;d.VERSION="1.3.2";var o=d.each=d.forEach=function(a,
b,c){if(null!=a)if(z&&a.forEach===z)a.forEach(b,c);else if(a.length===+a.length)for(var j=0,h=a.length;j<h&&!(j in a&&b.call(c,a[j],j,a)===e);j++);else for(j in a)if(d.has(a,j)&&b.call(c,a[j],j,a)===e)break};d.map=d.collect=function(a,b,d){var c=[];if(null==a)return c;if(s&&a.map===s)return a.map(b,d);o(a,function(a,j,h){c[c.length]=b.call(d,a,j,h)});a.length===+a.length&&(c.length=a.length);return c};d.reduce=d.foldl=d.inject=function(a,b,c,j){var h=2<arguments.length;null==a&&(a=[]);if(p&&a.reduce===
p)return j&&(b=d.bind(b,j)),h?a.reduce(b,c):a.reduce(b);o(a,function(a,d,k){h?c=b.call(j,c,a,d,k):(c=a,h=!0)});if(!h)throw new TypeError("Reduce of empty array with no initial value");return c};d.reduceRight=d.foldr=function(a,b,c,j){var h=2<arguments.length;null==a&&(a=[]);if(q&&a.reduceRight===q)return j&&(b=d.bind(b,j)),h?a.reduceRight(b,c):a.reduceRight(b);var k=d.toArray(a).reverse();j&&!h&&(b=d.bind(b,j));return h?d.reduce(k,b,c,j):d.reduce(k,b)};d.find=d.detect=function(a,b,d){var c;F(a,function(a,
j,h){if(b.call(d,a,j,h))return c=a,!0});return c};d.filter=d.select=function(a,b,d){var c=[];if(null==a)return c;if(m&&a.filter===m)return a.filter(b,d);o(a,function(a,j,h){b.call(d,a,j,h)&&(c[c.length]=a)});return c};d.reject=function(a,b,d){var c=[];if(null==a)return c;o(a,function(a,j,h){b.call(d,a,j,h)||(c[c.length]=a)});return c};d.every=d.all=function(a,b,d){var c=!0;if(null==a)return c;if(t&&a.every===t)return a.every(b,d);o(a,function(a,j,h){if(!(c=c&&b.call(d,a,j,h)))return e});return!!c};
var F=d.some=d.any=function(a,b,c){b||(b=d.identity);var j=!1;if(null==a)return j;if(x&&a.some===x)return a.some(b,c);o(a,function(a,d,h){if(j||(j=b.call(c,a,d,h)))return e});return!!j};d.include=d.contains=function(a,b){return null==a?!1:v&&a.indexOf===v?-1!=a.indexOf(b):F(a,function(a){return a===b})};d.invoke=function(a,b){var c=l.call(arguments,2);return d.map(a,function(a){return(d.isFunction(b)?b||a:a[b]).apply(a,c)})};d.pluck=function(a,b){return d.map(a,function(a){return a[b]})};d.max=function(a,
b,c){if(!b&&d.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!b&&d.isEmpty(a))return-Infinity;var j={computed:-Infinity};o(a,function(a,d,h){d=b?b.call(c,a,d,h):a;d>=j.computed&&(j={value:a,computed:d})});return j.value};d.min=function(a,b,c){if(!b&&d.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&d.isEmpty(a))return Infinity;var j={computed:Infinity};o(a,function(a,d,h){d=b?b.call(c,a,d,h):a;d<j.computed&&(j={value:a,computed:d})});return j.value};d.shuffle=function(a){var b=
[],d;o(a,function(a,c){d=Math.floor(Math.random()*(c+1));b[c]=b[d];b[d]=a});return b};d.sortBy=function(a,b,c){var j=d.isFunction(b)?b:function(a){return a[b]};return d.pluck(d.map(a,function(a,b,d){return{value:a,criteria:j.call(c,a,b,d)}}).sort(function(a,b){var d=a.criteria,c=b.criteria;return void 0===d?1:void 0===c?-1:d<c?-1:d>c?1:0}),"value")};d.groupBy=function(a,b){var c={},j=d.isFunction(b)?b:function(a){return a[b]};o(a,function(a,b){var d=j(a,b);(c[d]||(c[d]=[])).push(a)});return c};d.sortedIndex=
function(a,b,c){c||(c=d.identity);for(var j=0,h=a.length;j<h;){var k=j+h>>1;c(a[k])<c(b)?j=k+1:h=k}return j};d.toArray=function(a){return!a?[]:d.isArray(a)||d.isArguments(a)?l.call(a):a.toArray&&d.isFunction(a.toArray)?a.toArray():d.values(a)};d.size=function(a){return d.isArray(a)?a.length:d.keys(a).length};d.first=d.head=d.take=function(a,b,d){return null!=b&&!d?l.call(a,0,b):a[0]};d.initial=function(a,b,d){return l.call(a,0,a.length-(null==b||d?1:b))};d.last=function(a,b,d){return null!=b&&!d?
l.call(a,Math.max(a.length-b,0)):a[a.length-1]};d.rest=d.tail=function(a,b,d){return l.call(a,null==b||d?1:b)};d.compact=function(a){return d.filter(a,function(a){return!!a})};d.flatten=function(a,b){return d.reduce(a,function(a,c){if(d.isArray(c))return a.concat(b?c:d.flatten(c));a[a.length]=c;return a},[])};d.without=function(a){return d.difference(a,l.call(arguments,1))};d.uniq=d.unique=function(a,b,c){var c=c?d.map(a,c):a,j=[];3>a.length&&(b=!0);d.reduce(c,function(c,h,k){if(b?d.last(c)!==h||
!c.length:!d.include(c,h))c.push(h),j.push(a[k]);return c},[]);return j};d.union=function(){return d.uniq(d.flatten(arguments,!0))};d.intersection=d.intersect=function(a){var b=l.call(arguments,1);return d.filter(d.uniq(a),function(a){return d.every(b,function(b){return 0<=d.indexOf(b,a)})})};d.difference=function(a){var b=d.flatten(l.call(arguments,1),!0);return d.filter(a,function(a){return!d.include(b,a)})};d.zip=function(){for(var a=l.call(arguments),b=d.max(d.pluck(a,"length")),c=Array(b),j=
0;j<b;j++)c[j]=d.pluck(a,""+j);return c};d.indexOf=function(a,b,c){if(null==a)return-1;var j;if(c)return c=d.sortedIndex(a,b),a[c]===b?c:-1;if(v&&a.indexOf===v)return a.indexOf(b);c=0;for(j=a.length;c<j;c++)if(c in a&&a[c]===b)return c;return-1};d.lastIndexOf=function(a,b){if(null==a)return-1;if(u&&a.lastIndexOf===u)return a.lastIndexOf(b);for(var d=a.length;d--;)if(d in a&&a[d]===b)return d;return-1};d.range=function(a,b,d){1>=arguments.length&&(b=a||0,a=0);for(var d=arguments[2]||1,c=Math.max(Math.ceil((b-
a)/d),0),j=0,h=Array(c);j<c;)h[j++]=a,a+=d;return h};var C=function(){};d.bind=function(a,b){var c,j;if(a.bind===h&&h)return h.apply(a,l.call(arguments,1));if(!d.isFunction(a))throw new TypeError;j=l.call(arguments,2);return c=function(){if(!(this instanceof c))return a.apply(b,j.concat(l.call(arguments)));C.prototype=a.prototype;var d=new C,h=a.apply(d,j.concat(l.call(arguments)));return Object(h)===h?h:d}};d.bindAll=function(a){var b=l.call(arguments,1);0==b.length&&(b=d.functions(a));o(b,function(b){a[b]=
d.bind(a[b],a)});return a};d.memoize=function(a,b){var c={};b||(b=d.identity);return function(){var j=b.apply(this,arguments);return d.has(c,j)?c[j]:c[j]=a.apply(this,arguments)}};d.delay=function(a,b){var d=l.call(arguments,2);return setTimeout(function(){return a.apply(null,d)},b)};d.defer=function(a){return d.delay.apply(d,[a,1].concat(l.call(arguments,1)))};d.throttle=function(a,b){var c,j,h,k,e,A,n=d.debounce(function(){e=k=!1},b);return function(){c=this;j=arguments;h||(h=setTimeout(function(){h=
null;e&&a.apply(c,j);n()},b));k?e=!0:A=a.apply(c,j);n();k=!0;return A}};d.debounce=function(a,b,d){var c;return function(){var j=this,h=arguments;d&&!c&&a.apply(j,h);clearTimeout(c);c=setTimeout(function(){c=null;d||a.apply(j,h)},b)}};d.once=function(a){var b=!1,d;return function(){if(b)return d;b=!0;return d=a.apply(this,arguments)}};d.wrap=function(a,b){return function(){var d=[a].concat(l.call(arguments,0));return b.apply(this,d)}};d.compose=function(){var a=arguments;return function(){for(var b=
arguments,d=a.length-1;0<=d;d--)b=[a[d].apply(this,b)];return b[0]}};d.after=function(a,b){return 0>=a?b():function(){if(1>--a)return b.apply(this,arguments)}};d.keys=B||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)d.has(a,c)&&(b[b.length]=c);return b};d.values=function(a){return d.map(a,d.identity)};d.functions=d.methods=function(a){var b=[],c;for(c in a)d.isFunction(a[c])&&b.push(c);return b.sort()};d.extend=function(a){o(l.call(arguments,1),function(b){for(var d in b)a[d]=
b[d]});return a};d.pick=function(a){var b={};o(d.flatten(l.call(arguments,1)),function(d){d in a&&(b[d]=a[d])});return b};d.defaults=function(a){o(l.call(arguments,1),function(b){for(var d in b)null==a[d]&&(a[d]=b[d])});return a};d.clone=function(a){return!d.isObject(a)?a:d.isArray(a)?a.slice():d.extend({},a)};d.tap=function(a,b){b(a);return a};d.isEqual=function(b,d){return a(b,d,[])};d.isEmpty=function(a){if(null==a)return!0;if(d.isArray(a)||d.isString(a))return 0===a.length;for(var b in a)if(d.has(a,
b))return!1;return!0};d.isElement=function(a){return!!(a&&1==a.nodeType)};d.isArray=g||function(a){return"[object Array]"==n.call(a)};d.isObject=function(a){return a===Object(a)};d.isArguments=function(a){return"[object Arguments]"==n.call(a)};d.isArguments(arguments)||(d.isArguments=function(a){return!(!a||!d.has(a,"callee"))});d.isFunction=function(a){return"[object Function]"==n.call(a)};d.isString=function(a){return"[object String]"==n.call(a)};d.isNumber=function(a){return"[object Number]"==
n.call(a)};d.isFinite=function(a){return d.isNumber(a)&&isFinite(a)};d.isNaN=function(a){return a!==a};d.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==n.call(a)};d.isDate=function(a){return"[object Date]"==n.call(a)};d.isRegExp=function(a){return"[object RegExp]"==n.call(a)};d.isNull=function(a){return null===a};d.isUndefined=function(a){return void 0===a};d.has=function(a,b){return r.call(a,b)};d.noConflict=function(){b._=c;return this};d.identity=function(a){return a};d.times=
function(a,b,d){for(var c=0;c<a;c++)b.call(d,c)};d.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};d.result=function(a,b){if(null==a)return null;var c=a[b];return d.isFunction(c)?c.call(a):c};d.mixin=function(a){o(d.functions(a),function(b){I(b,d[b]=a[b])})};var E=0;d.uniqueId=function(a){var b=E++;return a?a+b:b};d.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,
escape:/<%-([\s\S]+?)%>/g};var j=/.^/,A={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},w;for(w in A)A[A[w]]=w;var J=/\\|'|\r|\n|\t|\u2028|\u2029/g,K=/\\(\\|'|r|n|t|u2028|u2029)/g,H=function(a){return a.replace(K,function(a,b){return A[b]})};d.template=function(a,b,c){c=d.extend(d.templateSettings,c);a="__p+='"+a.replace(J,function(a){return"\\"+A[a]}).replace(c.escape||j,function(a,b){return"'+\n_.escape("+H(b)+")+\n'"}).replace(c.interpolate||j,function(a,b){return"'+\n("+
H(b)+")+\n'"}).replace(c.evaluate||j,function(a,b){return"';\n"+H(b)+"\n;__p+='"})+"';\n";c.variable||(a="with(obj||{}){\n"+a+"}\n");var a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n",h=new Function(c.variable||"obj","_",a);if(b)return h(b,d);b=function(a){return h.call(this,a,d)};b.source="function("+(c.variable||"obj")+"){\n"+a+"}";return b};d.chain=function(a){return d(a).chain()};var D=function(a){this._wrapped=a};d.prototype=D.prototype;
var y=function(a,b){return b?d(a).chain():a},I=function(a,b){D.prototype[a]=function(){var a=l.call(arguments);k.call(a,this._wrapped);return y(b.apply(d,a),this._chain)}};d.mixin(d);o("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){var b=f[a];D.prototype[a]=function(){var d=this._wrapped;b.apply(d,arguments);var c=d.length;(a=="shift"||a=="splice")&&c===0&&delete d[0];return y(d,this._chain)}});o(["concat","join","slice"],function(a){var b=f[a];D.prototype[a]=function(){return y(b.apply(this._wrapped,
arguments),this._chain)}});D.prototype.chain=function(){this._chain=!0;return this};D.prototype.value=function(){return this._wrapped}}).call(this);(function(){var a=this,b=a.Backbone,c=Array.prototype.slice,e=Array.prototype.splice,f;f="undefined"!==typeof exports?exports:a.Backbone={};f.VERSION="0.9.2";var g=a._;!g&&"undefined"!==typeof require&&(g=require("underscore"));var l=a.jQuery||a.Zepto||a.ender;f.setDomLibrary=function(a){l=a};f.noConflict=function(){a.Backbone=b;return this};f.emulateHTTP=!1;f.emulateJSON=!1;var k=/\s+/,n=f.Events={on:function(a,b,d){var c,h,e,n,o;if(!b)return this;a=a.split(k);for(c=this._callbacks||(this._callbacks=
{});h=a.shift();)e=(o=c[h])?o.tail:{},e.next=n={},e.context=d,e.callback=b,c[h]={tail:n,next:o?o.next:e};return this},off:function(a,b,d){var c,h,e,n,o,m;if(h=this._callbacks){if(!a&&!b&&!d)return delete this._callbacks,this;for(a=a?a.split(k):g.keys(h);c=a.shift();)if(e=h[c],delete h[c],e&&(b||d))for(n=e.tail;(e=e.next)!==n;)if(o=e.callback,m=e.context,b&&o!==b||d&&m!==d)this.on(c,o,m);return this}},trigger:function(a){var b,d,h,e,n,o;if(!(h=this._callbacks))return this;n=h.all;a=a.split(k);for(o=
c.call(arguments,1);b=a.shift();){if(d=h[b])for(e=d.tail;(d=d.next)!==e;)d.callback.apply(d.context||this,o);if(d=n){e=d.tail;for(b=[b].concat(o);(d=d.next)!==e;)d.callback.apply(d.context||this,b)}}return this}};n.bind=n.on;n.unbind=n.off;var r=f.Model=function(a,b){var d;a||(a={});b&&b.parse&&(a=this.parse(a));if(d=C(this,"defaults"))a=g.extend({},d,a);b&&b.collection&&(this.collection=b.collection);this.attributes={};this._escapedAttributes={};this.cid=g.uniqueId("c");this.changed={};this._silent=
{};this._pending={};this.set(a,{silent:!0});this.changed={};this._silent={};this._pending={};this._previousAttributes=g.clone(this.attributes);this.initialize.apply(this,arguments)};g.extend(r.prototype,n,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return g.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;b=this.get(a);return this._escapedAttributes[a]=g.escape(null==
b?"":""+b)},has:function(a){return null!=this.get(a)},set:function(a,b,d){var c,h;g.isObject(a)||null==a?(c=a,d=b):(c={},c[a]=b);d||(d={});if(!c)return this;c instanceof r&&(c=c.attributes);if(d.unset)for(h in c)c[h]=void 0;if(!this._validate(c,d))return!1;this.idAttribute in c&&(this.id=c[this.idAttribute]);var b=d.changes={},k=this.attributes,e=this._escapedAttributes,n=this._previousAttributes||{};for(h in c){a=c[h];if(!g.isEqual(k[h],a)||d.unset&&g.has(k,h))delete e[h],(d.silent?this._silent:
b)[h]=!0;d.unset?delete k[h]:k[h]=a;!g.isEqual(n[h],a)||g.has(k,h)!=g.has(n,h)?(this.changed[h]=a,d.silent||(this._pending[h]=!0)):(delete this.changed[h],delete this._pending[h])}d.silent||this.change(d);return this},unset:function(a,b){(b||(b={})).unset=!0;return this.set(a,null,b)},clear:function(a){(a||(a={})).unset=!0;return this.set(g.clone(this.attributes),a)},fetch:function(a){var a=a?g.clone(a):{},b=this,d=a.success;a.success=function(c,h,k){if(!b.set(b.parse(c,k),a))return!1;d&&d(b,c)};
a.error=f.wrapError(a.error,b,a);return(this.sync||f.sync).call(this,"read",this,a)},save:function(a,b,d){var c,h;g.isObject(a)||null==a?(c=a,d=b):(c={},c[a]=b);d=d?g.clone(d):{};if(d.wait){if(!this._validate(c,d))return!1;h=g.clone(this.attributes)}a=g.extend({},d,{silent:!0});if(c&&!this.set(c,d.wait?a:d))return!1;var k=this,e=d.success;d.success=function(a,b,j){b=k.parse(a,j);d.wait&&(delete d.wait,b=g.extend(c||{},b));if(!k.set(b,d))return!1;e?e(k,a):k.trigger("sync",k,a,d)};d.error=f.wrapError(d.error,
k,d);b=this.isNew()?"create":"update";b=(this.sync||f.sync).call(this,b,this,d);d.wait&&this.set(h,a);return b},destroy:function(a){var a=a?g.clone(a):{},b=this,d=a.success,c=function(){b.trigger("destroy",b,b.collection,a)};if(this.isNew())return c(),!1;a.success=function(h){a.wait&&c();d?d(b,h):b.trigger("sync",b,h,a)};a.error=f.wrapError(a.error,b,a);var h=(this.sync||f.sync).call(this,"delete",this,a);a.wait||c();return h},url:function(){var a=C(this,"urlRoot")||C(this.collection,"url")||E();
return this.isNew()?a:a+("/"==a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(a){a||(a={});var b=this._changing;this._changing=!0;for(var d in this._silent)this._pending[d]=!0;var c=g.extend({},a.changes,this._silent);this._silent={};for(d in c)this.trigger("change:"+d,this,this.get(d),a);if(b)return this;for(;!g.isEmpty(this._pending);){this._pending=
{};this.trigger("change",this,a);for(d in this.changed)!this._pending[d]&&!this._silent[d]&&delete this.changed[d];this._previousAttributes=g.clone(this.attributes)}this._changing=!1;return this},hasChanged:function(a){return!arguments.length?!g.isEmpty(this.changed):g.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?g.clone(this.changed):!1;var b,d=!1,c=this._previousAttributes,h;for(h in a)if(!g.isEqual(c[h],b=a[h]))(d||(d={}))[h]=b;return d},previous:function(a){return!arguments.length||
!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return g.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(a,b){if(b.silent||!this.validate)return!0;var a=g.extend({},this.attributes,a),d=this.validate(a,b);if(!d)return!0;b&&b.error?b.error(this,d,b):this.trigger("error",this,d,b);return!1}});var z=f.Collection=function(a,b){b||(b={});b.model&&(this.model=b.model);b.comparator&&(this.comparator=b.comparator);
this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,{silent:!0,parse:b.parse})};g.extend(z.prototype,n,{model:r,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},add:function(a,b){var d,c,h,k,n,o={},m={},r=[];b||(b={});a=g.isArray(a)?a.slice():[a];d=0;for(c=a.length;d<c;d++){if(!(h=a[d]=this._prepareModel(a[d],b)))throw Error("Can't add an invalid model to a collection");k=h.cid;n=h.id;o[k]||this._byCid[k]||null!=n&&(m[n]||this._byId[n])?
r.push(d):o[k]=m[n]=h}for(d=r.length;d--;)a.splice(r[d],1);d=0;for(c=a.length;d<c;d++)(h=a[d]).on("all",this._onModelEvent,this),this._byCid[h.cid]=h,null!=h.id&&(this._byId[h.id]=h);this.length+=c;e.apply(this.models,[null!=b.at?b.at:this.models.length,0].concat(a));this.comparator&&this.sort({silent:!0});if(b.silent)return this;d=0;for(c=this.models.length;d<c;d++)if(o[(h=this.models[d]).cid])b.index=d,h.trigger("add",h,this,b);return this},remove:function(a,b){var d,c,h,k;b||(b={});a=g.isArray(a)?
a.slice():[a];d=0;for(c=a.length;d<c;d++)if(k=this.getByCid(a[d])||this.get(a[d]))delete this._byId[k.id],delete this._byCid[k.cid],h=this.indexOf(k),this.models.splice(h,1),this.length--,b.silent||(b.index=h,k.trigger("remove",k,this,b)),this._removeReference(k);return this},push:function(a,b){a=this._prepareModel(a,b);this.add(a,b);return a},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){a=this._prepareModel(a,b);this.add(a,g.extend({at:0},b));return a},
shift:function(a){var b=this.at(0);this.remove(b,a);return b},get:function(a){return null==a?void 0:this._byId[null!=a.id?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},where:function(a){return g.isEmpty(a)?[]:this.filter(function(b){for(var d in a)if(a[d]!==b.get(d))return!1;return!0})},sort:function(a){a||(a={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var b=g.bind(this.comparator,this);1==this.comparator.length?
this.models=this.sortBy(b):this.models.sort(b);a.silent||this.trigger("reset",this,a);return this},pluck:function(a){return g.map(this.models,function(b){return b.get(a)})},reset:function(a,b){a||(a=[]);b||(b={});for(var d=0,c=this.models.length;d<c;d++)this._removeReference(this.models[d]);this._reset();this.add(a,g.extend({silent:!0},b));b.silent||this.trigger("reset",this,b);return this},fetch:function(a){a=a?g.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=this,d=a.success;a.success=function(c,
h,k){b[a.add?"add":"reset"](b.parse(c,k),a);d&&d(b,c)};a.error=f.wrapError(a.error,b,a);return(this.sync||f.sync).call(this,"read",this,a)},create:function(a,b){var d=this,b=b?g.clone(b):{},a=this._prepareModel(a,b);if(!a)return!1;b.wait||d.add(a,b);var c=b.success;b.success=function(h,k){b.wait&&d.add(h,b);c?c(h,k):h.trigger("sync",a,k,b)};a.save(null,b);return a},parse:function(a){return a},chain:function(){return g(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId=
{};this._byCid={}},_prepareModel:function(a,b){b||(b={});a instanceof r?a.collection||(a.collection=this):(b.collection=this,a=new this.model(a,b),a._validate(a.attributes,b)||(a=!1));return a},_removeReference:function(a){this==a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,d,c){("add"==a||"remove"==a)&&d!=this||("destroy"==a&&this.remove(b,c),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,
arguments))}});g.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),function(a){z.prototype[a]=function(){return g[a].apply(g,[this.models].concat(g.toArray(arguments)))}});var s=f.Router=function(a){a||(a={});a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)},p=/:\w+/g,
q=/\*\w+/g,m=/[-[\]{}()+?.,\\^$|#\s]/g;g.extend(s.prototype,n,{initialize:function(){},route:function(a,b,d){f.history||(f.history=new t);g.isRegExp(a)||(a=this._routeToRegExp(a));d||(d=this[b]);f.history.route(a,g.bind(function(c){c=this._extractParameters(a,c);d&&d.apply(this,c);this.trigger.apply(this,["route:"+b].concat(c));f.history.trigger("route",this,b,c)},this));return this},navigate:function(a,b){f.history.navigate(a,b)},_bindRoutes:function(){if(this.routes){var a=[],b;for(b in this.routes)a.unshift([b,
this.routes[b]]);b=0;for(var d=a.length;b<d;b++)this.route(a[b][0],a[b][1],this[a[b][1]])}},_routeToRegExp:function(a){a=a.replace(m,"\\$&").replace(p,"([^/]+)").replace(q,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});var t=f.History=function(){this.handlers=[];g.bindAll(this,"checkUrl")},x=/^[#\/]/,v=/msie [\w.]+/;t.started=!1;g.extend(t.prototype,n,{interval:50,getHash:function(a){return(a=(a?a.location:window.location).href.match(/#(.*)$/))?a[1]:
""},getFragment:function(a,b){if(null==a)if(this._hasPushState||b){var a=window.location.pathname,d=window.location.search;d&&(a+=d)}else a=this.getHash();a=decodeURIComponent(a);a.indexOf(this.options.root)||(a=a.substr(this.options.root.length));return a.replace(x,"")},start:function(a){if(t.started)throw Error("Backbone.history has already been started");t.started=!0;this.options=g.extend({},{root:"/"},this.options,a);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;
this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);var a=this.getFragment(),b=document.documentMode;if(b=v.exec(navigator.userAgent.toLowerCase())&&(!b||7>=b))this.iframe=l('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(a);this._hasPushState?l(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!b?l(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=
setInterval(this.checkUrl,this.interval));this.fragment=a;a=window.location;b=a.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&b&&a.hash&&(this.fragment=this.getHash().replace(x,""),window.history.replaceState({},document.title,a.protocol+"//"+a.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},
stop:function(){l(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);t.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a==this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));if(a==this.fragment)return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return g.any(this.handlers,
function(a){if(a.route.test(b))return a.callback(b),!0})},navigate:function(a,b){if(!t.started)return!1;if(!b||!0===b)b={trigger:b};var d=(a||"").replace(x,"");this.fragment!=d&&(this._hasPushState?(0!=d.indexOf(this.options.root)&&(d=this.options.root+d),this.fragment=d,window.history[b.replace?"replaceState":"pushState"]({},document.title,d)):this._wantsHashChange?(this.fragment=d,this._updateHash(window.location,d,b.replace),this.iframe&&d!=this.getFragment(this.getHash(this.iframe))&&(b.replace||
this.iframe.document.open().close(),this._updateHash(this.iframe.location,d,b.replace))):window.location.assign(this.options.root+a),b.trigger&&this.loadUrl(a))},_updateHash:function(a,b,d){d?a.replace(a.toString().replace(/(javascript:|#).*$/,"")+"#"+b):a.hash=b}});var u=f.View=function(a){this.cid=g.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},B=/^(\S+)\s*(.*)$/,h="model,collection,el,id,attributes,className,tagName".split(",");
g.extend(u.prototype,n,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(a,b,d){a=document.createElement(a);b&&l(a).attr(b);d&&l(a).html(d);return a},setElement:function(a,b){this.$el&&this.undelegateEvents();this.$el=a instanceof l?a:l(a);this.el=this.$el[0];!1!==b&&this.delegateEvents();return this},delegateEvents:function(a){if(a||(a=C(this,"events"))){this.undelegateEvents();
for(var b in a){var d=a[b];g.isFunction(d)||(d=this[a[b]]);if(!d)throw Error('Method "'+a[b]+'" does not exist');var c=b.match(B),h=c[1],c=c[2],d=g.bind(d,this),h=h+(".delegateEvents"+this.cid);""===c?this.$el.bind(h,d):this.$el.delegate(c,h,d)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=g.extend({},this.options,a));for(var b=0,d=h.length;b<d;b++){var c=h[b];a[c]&&(this[c]=a[c])}this.options=a},_ensureElement:function(){if(this.el)this.setElement(this.el,
!1);else{var a=C(this,"attributes")||{};this.id&&(a.id=this.id);this.className&&(a["class"]=this.className);this.setElement(this.make(this.tagName,a),!1)}}});r.extend=z.extend=s.extend=u.extend=function(a,b){var d=F(this,a,b);d.extend=this.extend;return d};var d={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};f.sync=function(a,b,c){var h=d[a];c||(c={});var k={type:h,dataType:"json"};c.url||(k.url=C(b,"url")||E());if(!c.data&&b&&("create"==a||"update"==a))k.contentType="application/json",
k.data=JSON.stringify(b.toJSON());f.emulateJSON&&(k.contentType="application/x-www-form-urlencoded",k.data=k.data?{model:k.data}:{});if(f.emulateHTTP&&("PUT"===h||"DELETE"===h))f.emulateJSON&&(k.data._method=h),k.type="POST",k.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",h)};"GET"!==k.type&&!f.emulateJSON&&(k.processData=!1);return l.ajax(g.extend(k,c))};f.wrapError=function(a,b,d){return function(c,h){h=c===b?h:c;a?a(b,h,d):b.trigger("error",b,h,d)}};var o=function(){},F=function(a,
b,d){var c;c=b&&b.hasOwnProperty("constructor")?b.constructor:function(){a.apply(this,arguments)};g.extend(c,a);o.prototype=a.prototype;c.prototype=new o;b&&g.extend(c.prototype,b);d&&g.extend(c,d);c.prototype.constructor=c;c.__super__=a.prototype;return c},C=function(a,b){return!a||!a[b]?null:g.isFunction(a[b])?a[b]():a[b]},E=function(){throw Error('A "url" property or function must be specified');}}).call(this);(function(){var a,b,c;"undefined"===typeof window?(a=require("underscore"),b=require("backbone"),c=module.exports=b):(a=window._,b=window.Backbone,c=window);b.Relational={showWarnings:!0};b.Semaphore={_permitsAvailable:null,_permitsUsed:0,acquire:function(){if(this._permitsAvailable&&this._permitsUsed>=this._permitsAvailable)throw Error("Max permits acquired");this._permitsUsed++},release:function(){if(this._permitsUsed===0)throw Error("All permits released");this._permitsUsed--},isLocked:function(){return this._permitsUsed>
0},setAvailablePermits:function(a){if(this._permitsUsed>a)throw Error("Available permits cannot be less than used permits");this._permitsAvailable=a}};b.BlockingQueue=function(){this._queue=[]};a.extend(b.BlockingQueue.prototype,b.Semaphore,{_queue:null,add:function(a){this.isBlocked()?this._queue.push(a):a()},process:function(){for(;this._queue&&this._queue.length;)this._queue.shift()()},block:function(){this.acquire()},unblock:function(){this.release();this.isBlocked()||this.process()},isBlocked:function(){return this.isLocked()}});
b.Relational.eventQueue=new b.BlockingQueue;b.Store=function(){this._collections=[];this._reverseRelations=[]};a.extend(b.Store.prototype,b.Events,{_collections:null,_reverseRelations:null,addReverseRelation:function(b){if(!a.any(this._reverseRelations,function(c){return a.all(b,function(a,b){return a===c[b]})})&&b.model&&b.type){this._reverseRelations.push(b);if(!b.model.prototype.relations)b.model.prototype.relations=[];b.model.prototype.relations.push(b);this.retroFitRelation(b)}},retroFitRelation:function(a){this.getCollection(a.model).each(function(b){new a.type(b,
a)},this)},getCollection:function(b){var c=a.detect(this._collections,function(a){return b===a.model||b.constructor===a.model});c||(c=this._createCollection(b));return c},getObjectByName:function(b){b=a.reduce(b.split("."),function(a,b){return a[b]},c);return b!==c?b:null},_createCollection:function(a){var c;if(a instanceof b.RelationalModel)a=a.constructor;if(a.prototype instanceof b.RelationalModel.prototype.constructor){c=new b.Collection;c.model=a;this._collections.push(c)}return c},resolveIdForItem:function(c,
e){var f=a.isString(e)||a.isNumber(e)?e:null;if(f==null)e instanceof b.RelationalModel?f=e.id:a.isObject(e)&&(f=e[c.prototype.idAttribute]);return f},find:function(a,b){var c=this.resolveIdForItem(a,b),e=this.getCollection(a);return e&&e.get(c)},register:function(a){var b=a.collection,c=this.getCollection(a);c&&c.add(a);a.bind("destroy",this.unregister,this);a.collection=b},update:function(a){var b=this.getCollection(a);b._onModelEvent("change:"+a.idAttribute,a,b)},unregister:function(a){a.unbind("destroy",
this.unregister);var b=this.getCollection(a);b&&b.remove(a)}});b.Relational.store=new b.Store;b.Relation=function(c,e){this.instance=c;e=typeof e==="object"&&e||{};this.reverseRelation=a.defaults(e.reverseRelation||{},this.options.reverseRelation);this.reverseRelation.type=!a.isString(this.reverseRelation.type)?this.reverseRelation.type:b[this.reverseRelation.type]||b.Relational.store.getObjectByName(this.reverseRelation.type);this.model=e.model||this.instance.constructor;this.options=a.defaults(e,
this.options,b.Relation.prototype.options);this.key=this.options.key;this.keySource=this.options.keySource||this.key;this.keyDestination=this.options.keyDestination||this.options.keySource||this.key;this.relatedModel=this.options.relatedModel;if(a.isString(this.relatedModel))this.relatedModel=b.Relational.store.getObjectByName(this.relatedModel);if(!this.checkPreconditions())return false;if(c){this.keyContents=this.instance.get(this.keySource);this.key!==this.keySource&&this.instance.unset(this.keySource,
{silent:true});this.instance._relations.push(this)}!this.options.isAutoRelation&&this.reverseRelation.type&&this.reverseRelation.key&&b.Relational.store.addReverseRelation(a.defaults({isAutoRelation:true,model:this.relatedModel,relatedModel:this.model,reverseRelation:this.options},this.reverseRelation));a.bindAll(this,"_modelRemovedFromCollection","_relatedModelAdded","_relatedModelRemoved");if(c){this.initialize();b.Relational.store.getCollection(this.instance).bind("relational:remove",this._modelRemovedFromCollection);
b.Relational.store.getCollection(this.relatedModel).bind("relational:add",this._relatedModelAdded).bind("relational:remove",this._relatedModelRemoved)}};b.Relation.extend=b.Model.extend;a.extend(b.Relation.prototype,b.Events,b.Semaphore,{options:{createModels:!0,includeInJSON:!0,isAutoRelation:!1},instance:null,key:null,keyContents:null,relatedModel:null,reverseRelation:null,related:null,_relatedModelAdded:function(a,b,c){var e=this;a.queue(function(){e.tryAddRelated(a,c)})},_relatedModelRemoved:function(a,
b,c){this.removeRelated(a,c)},_modelRemovedFromCollection:function(a){a===this.instance&&this.destroy()},checkPreconditions:function(){var c=this.instance,e=this.key,f=this.model,g=this.relatedModel,l=b.Relational.showWarnings&&typeof console!=="undefined";if(!f||!e||!g){l&&console.warn("Relation=%o; no model, key or relatedModel (%o, %o, %o)",this,f,e,g);return false}if(!(f.prototype instanceof b.RelationalModel.prototype.constructor)){l&&console.warn("Relation=%o; model does not inherit from Backbone.RelationalModel (%o)",
this,c);return false}if(!(g.prototype instanceof b.RelationalModel.prototype.constructor)){l&&console.warn("Relation=%o; relatedModel does not inherit from Backbone.RelationalModel (%o)",this,g);return false}if(this instanceof b.HasMany&&this.reverseRelation.type===b.HasMany.prototype.constructor){l&&console.warn("Relation=%o; relation is a HasMany, and the reverseRelation is HasMany as well.",this);return false}if(c&&c._relations.length&&a.any(c._relations,function(a){var b=this.reverseRelation.key&&
a.reverseRelation.key;return a.relatedModel===g&&a.key===e&&(!b||this.reverseRelation.key===a.reverseRelation.key)},this)){l&&console.warn("Relation=%o between instance=%o.%s and relatedModel=%o.%s already exists",this,c,e,g,this.reverseRelation.key);return false}return true},setRelated:function(b,c){this.related=b;this.instance.acquire();this.instance.set(this.key,b,a.defaults(c||{},{silent:true}));this.instance.release()},createModel:function(a){if(this.options.createModels&&typeof a==="object")return new this.relatedModel(a)},
_isReverseRelation:function(a){return a.instance instanceof this.relatedModel&&this.reverseRelation.key===a.key&&this.key===a.reverseRelation.key?true:false},getReverseRelations:function(b){var c=[],b=!a.isUndefined(b)?[b]:this.related&&(this.related.models||[this.related]);a.each(b,function(b){a.each(b.getRelations(),function(a){this._isReverseRelation(a)&&c.push(a)},this)},this);return c},sanitizeOptions:function(b){b=b?a.clone(b):{};if(b.silent){b=a.extend({},b,{silentChange:true});delete b.silent}return b},
unsanitizeOptions:function(b){b=b?a.clone(b):{};if(b.silentChange){b=a.extend({},b,{silent:true});delete b.silentChange}return b},destroy:function(){b.Relational.store.getCollection(this.instance).unbind("relational:remove",this._modelRemovedFromCollection);b.Relational.store.getCollection(this.relatedModel).unbind("relational:add",this._relatedModelAdded).unbind("relational:remove",this._relatedModelRemoved);a.each(this.getReverseRelations(),function(a){a.removeRelated(this.instance)},this)}});b.HasOne=
b.Relation.extend({options:{reverseRelation:{type:"HasMany"}},initialize:function(){a.bindAll(this,"onChange");this.instance.bind("relational:change:"+this.key,this.onChange);this.setRelated(this.findRelated({silent:true}));var b=this;a.each(b.getReverseRelations(),function(a){a.addRelated(b.instance)})},findRelated:function(c){var e=this.keyContents,f=null;if(e instanceof this.relatedModel)f=e;else if(e)(f=b.Relational.store.find(this.relatedModel,e))&&a.isObject(e)?f.set(e,c):f||(f=this.createModel(e));
return f},onChange:function(c,e,f){if(!this.isLocked()){this.acquire();var f=this.sanitizeOptions(f),g=(c=a.isUndefined(f._related))?this.related:f._related;if(c){this.keyContents=e;e instanceof this.relatedModel?this.related=e:e?this.setRelated(this.findRelated(f)):this.setRelated(null)}g&&this.related!==g&&a.each(this.getReverseRelations(g),function(a){a.removeRelated(this.instance,f)},this);a.each(this.getReverseRelations(),function(a){a.addRelated(this.instance,f)},this);if(!f.silentChange&&this.related!==
g){var l=this;b.Relational.eventQueue.add(function(){l.instance.trigger("update:"+l.key,l.instance,l.related,f)})}this.release()}},tryAddRelated:function(a,c){if(!this.related){var c=this.sanitizeOptions(c),e=this.keyContents;if(e){e=b.Relational.store.resolveIdForItem(this.relatedModel,e);a.id===e&&this.addRelated(a,c)}}},addRelated:function(a){if(a!==this.related){var b=this.related||null;this.setRelated(a);this.onChange(this.instance,a,{_related:b})}},removeRelated:function(a){if(this.related&&
a===this.related){var b=this.related||null;this.setRelated(null);this.onChange(this.instance,a,{_related:b})}}});b.HasMany=b.Relation.extend({collectionType:null,options:{reverseRelation:{type:"HasOne"},collectionType:b.Collection,collectionKey:!0,collectionOptions:{}},initialize:function(){a.bindAll(this,"onChange","handleAddition","handleRemoval","handleReset");this.instance.bind("relational:change:"+this.key,this.onChange);this.collectionType=this.options.collectionType;if(a(this.collectionType).isString())this.collectionType=
b.Relational.store.getObjectByName(this.collectionType);if(!this.collectionType.prototype instanceof b.Collection.prototype.constructor)throw Error("collectionType must inherit from Backbone.Collection");this.keyContents instanceof b.Collection?this.setRelated(this._prepareCollection(this.keyContents)):this.setRelated(this._prepareCollection());this.findRelated({silent:true})},_getCollectionOptions:function(){return a.isFunction(this.options.collectionOptions)?this.options.collectionOptions(this.instance):
this.options.collectionOptions},_prepareCollection:function(a){this.related&&this.related.unbind("relational:add",this.handleAddition).unbind("relational:remove",this.handleRemoval).unbind("relational:reset",this.handleReset);if(!a||!(a instanceof b.Collection))a=new this.collectionType([],this._getCollectionOptions());a.model=this.relatedModel;if(this.options.collectionKey){var c=this.options.collectionKey===true?this.options.reverseRelation.key:this.options.collectionKey;if(a[c]&&a[c]!==this.instance)b.Relational.showWarnings&&
typeof console!=="undefined"&&console.warn("Relation=%o; collectionKey=%s already exists on collection=%o",this,c,this.options.collectionKey);else if(c)a[c]=this.instance}a.bind("relational:add",this.handleAddition).bind("relational:remove",this.handleRemoval).bind("relational:reset",this.handleReset);return a},findRelated:function(c){if(this.keyContents){var e=[];if(this.keyContents instanceof b.Collection)e=this.keyContents.models;else{this.keyContents=a.isArray(this.keyContents)?this.keyContents:
[this.keyContents];a.each(this.keyContents,function(f){var g=b.Relational.store.find(this.relatedModel,f);g&&a.isObject(f)?g.set(f,c):g||(g=this.createModel(f));g&&!this.related.getByCid(g)&&!this.related.get(g)&&e.push(g)},this)}if(e.length){c=this.unsanitizeOptions(c);this.related.add(e,c)}}},onChange:function(c,e,f){f=this.sanitizeOptions(f);this.keyContents=e;a.each(this.getReverseRelations(),function(a){a.removeRelated(this.instance,f)},this);if(e instanceof b.Collection){this._prepareCollection(e);
this.related=e}else{if(this.related instanceof b.Collection){c=this.related;c.reset([],{silent:true})}else c=this._prepareCollection();this.setRelated(c);this.findRelated(f)}a.each(this.getReverseRelations(),function(a){a.addRelated(this.instance,f)},this);var g=this;b.Relational.eventQueue.add(function(){!f.silentChange&&g.instance.trigger("update:"+g.key,g.instance,g.related,f)})},tryAddRelated:function(c,e){e=this.sanitizeOptions(e);!this.related.getByCid(c)&&!this.related.get(c)&&a.any(this.keyContents,
function(a){return(a=b.Relational.store.resolveIdForItem(this.relatedModel,a))&&a===c.id},this)&&this.related.add(c,e)},handleAddition:function(c,e,f){if(c instanceof b.Model){f=this.sanitizeOptions(f);a.each(this.getReverseRelations(c),function(a){a.addRelated(this.instance,f)},this);var g=this;b.Relational.eventQueue.add(function(){!f.silentChange&&g.instance.trigger("add:"+g.key,c,g.related,f)})}},handleRemoval:function(c,e,f){if(c instanceof b.Model){f=this.sanitizeOptions(f);a.each(this.getReverseRelations(c),
function(a){a.removeRelated(this.instance,f)},this);var g=this;b.Relational.eventQueue.add(function(){!f.silentChange&&g.instance.trigger("remove:"+g.key,c,g.related,f)})}},handleReset:function(a,c){var c=this.sanitizeOptions(c),e=this;b.Relational.eventQueue.add(function(){!c.silentChange&&e.instance.trigger("reset:"+e.key,e.related,c)})},addRelated:function(a,b){var c=this,b=this.unsanitizeOptions(b);a.queue(function(){c.related&&!c.related.getByCid(a)&&!c.related.get(a)&&c.related.add(a,b)})},
removeRelated:function(a,b){b=this.unsanitizeOptions(b);(this.related.getByCid(a)||this.related.get(a))&&this.related.remove(a,b)}});b.RelationalModel=b.Model.extend({relations:null,_relations:null,_isInitialized:!1,_deferProcessing:!1,_queue:null,constructor:function(c,e){var f=this;if(e&&e.collection){this._deferProcessing=true;var g=function(a){if(a===f){f._deferProcessing=false;f.processQueue();e.collection.unbind("relational:add",g)}};e.collection.bind("relational:add",g);a.defer(function(){g(f)})}this._queue=
new b.BlockingQueue;this._queue.block();b.Relational.eventQueue.block();b.Model.prototype.constructor.apply(this,arguments);b.Relational.eventQueue.unblock()},trigger:function(a){if(a.length>5&&"change"===a.substr(0,6)){var c=this,e=arguments;b.Relational.eventQueue.add(function(){b.Model.prototype.trigger.apply(c,e)})}else b.Model.prototype.trigger.apply(this,arguments);return this},initializeRelations:function(){this.acquire();this._relations=[];a.each(this.relations,function(c){var e=!a.isString(c.type)?
c.type:b[c.type]||b.Relational.store.getObjectByName(c.type);e&&e.prototype instanceof b.Relation.prototype.constructor?new e(this,c):b.Relational.showWarnings&&typeof console!=="undefined"&&console.warn("Relation=%o; missing or invalid type!",c)},this);this._isInitialized=true;this.release();this.processQueue()},updateRelations:function(b){this._isInitialized&&!this.isLocked()&&a.each(this._relations,function(a){var c=this.attributes[a.key];a.related!==c&&this.trigger("relational:change:"+a.key,
this,c,b||{})},this)},queue:function(a){this._queue.add(a)},processQueue:function(){this._isInitialized&&!this._deferProcessing&&this._queue.isBlocked()&&this._queue.unblock()},getRelation:function(b){return a.detect(this._relations,function(a){if(a.key===b)return true},this)},getRelations:function(){return this._relations},fetchRelated:function(c,e){e||(e={});var f,g=[],l=this.getRelation(c),p=l&&l.keyContents;if((p=p&&a.select(a.isArray(p)?p:[p],function(a){return(a=b.Relational.store.resolveIdForItem(l.relatedModel,
a))&&!b.Relational.store.find(l.relatedModel,a)},this))&&p.length){var q=a.map(p,function(a){if(typeof a==="object")a=new l.relatedModel(a);else{var b={};b[l.relatedModel.prototype.idAttribute]=a;a=new l.relatedModel(b)}return a},this);l.related instanceof b.Collection&&a.isFunction(l.related.url)&&(f=l.related.url(q));if(f&&f!==l.related.url()){f=a.defaults({error:function(){var b=arguments;a.each(q,function(a){a.trigger("destroy",a,a.collection,e);e.error&&e.error.apply(a,b)})},url:f},e,{add:true});
g=[l.related.fetch(f)]}else g=a.map(q,function(b){var c=a.defaults({error:function(){b.trigger("destroy",b,b.collection,e);e.error&&e.error.apply(b,arguments)}},e);return b.fetch(c)},this)}return g},set:function(c,e,f){b.Relational.eventQueue.block();var g;if(a.isObject(c)||c==null){g=c;f=e}else{g={};g[c]=e}var l=b.Model.prototype.set.apply(this,arguments);if(!this._isInitialized&&!this.isLocked()){b.Relational.store.register(this);this.initializeRelations()}else g&&this.idAttribute in g&&b.Relational.store.update(this);
g&&this.updateRelations(f);b.Relational.eventQueue.unblock();return l},unset:function(a,c){b.Relational.eventQueue.block();var e=b.Model.prototype.unset.apply(this,arguments);this.updateRelations(c);b.Relational.eventQueue.unblock();return e},clear:function(a){b.Relational.eventQueue.block();var c=b.Model.prototype.clear.apply(this,arguments);this.updateRelations(a);b.Relational.eventQueue.unblock();return c},change:function(a){var c=this,e=arguments;b.Relational.eventQueue.add(function(){b.Model.prototype.change.apply(c,
e)})},clone:function(){var b=a.clone(this.attributes);a.isUndefined(b[this.idAttribute])||(b[this.idAttribute]=null);a.each(this.getRelations(),function(a){delete b[a.key]});return new this.constructor(b)},toJSON:function(){if(this.isLocked())return this.id;this.acquire();var c=b.Model.prototype.toJSON.call(this);a.each(this._relations,function(e){var f=c[e.key];e.options.includeInJSON===true&&f&&a.isFunction(f.toJSON)?c[e.keyDestination]=f.toJSON():a.isString(e.options.includeInJSON)?f instanceof
b.Collection?c[e.keyDestination]=f.pluck(e.options.includeInJSON):f instanceof b.Model&&(c[e.keyDestination]=f.get(e.options.includeInJSON)):delete c[e.key];e.keyDestination!==e.key&&delete c[e.key]},this);this.release();return c}});a.extend(b.RelationalModel.prototype,b.Semaphore);var e=b.Collection.prototype.__add=b.Collection.prototype.add;b.Collection.prototype.add=function(c,f){f||(f={});a.isArray(c)||(c=[c]);var g=[];a.each(c,function(a){if(!(a instanceof b.Model)){var c=b.Relational.store.find(this.model,
a[this.model.prototype.idAttribute]);if(c){c.set(c.parse?c.parse(a):a,f);a=c}else a=b.Collection.prototype._prepareModel.call(this,a,f)}a instanceof b.Model&&!this.get(a)&&!this.getByCid(a)&&g.push(a)},this);if(g.length){e.call(this,g,f);a.each(g,function(a){this.trigger("relational:add",a,this,f)},this)}return this};var f=b.Collection.prototype.__remove=b.Collection.prototype.remove;b.Collection.prototype.remove=function(c,e){e||(e={});a.isArray(c)||(c=[c]);a.each(c,function(a){a=this.getByCid(a)||
this.get(a);if(a instanceof b.Model){f.call(this,a,e);this.trigger("relational:remove",a,this,e)}},this);return this};var g=b.Collection.prototype.__reset=b.Collection.prototype.reset;b.Collection.prototype.reset=function(a,b){g.call(this,a,b);this.trigger("relational:reset",a,b);return this};var l=b.Collection.prototype.__trigger=b.Collection.prototype.trigger;b.Collection.prototype.trigger=function(a){if(a==="add"||a==="remove"||a==="reset"){var c=this,e=arguments;b.Relational.eventQueue.add(function(){l.apply(c,
e)})}else l.apply(this,arguments);return this};b.RelationalModel.extend=function(c,e){var f=b.Model.extend.apply(this,arguments);a.each(c&&c.relations||[],function(c){if(c.reverseRelation){c.model=f;var e=true;if(a.isString(c.relatedModel))e=(e=b.Relational.store.getObjectByName(c.relatedModel))&&e.prototype instanceof b.RelationalModel.prototype.constructor;var g=!a.isString(c.type)?c.type:b[c.type]||b.Relational.store.getObjectByName(c.type);e&&g&&g.prototype instanceof b.Relation.prototype.constructor&&
new g(null,c)}});return f}})();(function(){var a=Math,b=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":/trident/i.test(navigator.userAgent)?"ms":"opera"in window?"O":"",c=/android/gi.test(navigator.appVersion),e=/iphone|ipad/gi.test(navigator.appVersion),f=/playbook/gi.test(navigator.appVersion),g=/hp-tablet/gi.test(navigator.appVersion),l="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,k="ontouchstart"in window&&!g,n=b+"Transform"in document.documentElement.style,r=e||f,z=function(){return window.requestAnimationFrame||
window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return setTimeout(a,1)}}(),s=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout,p="onorientationchange"in window?"orientationchange":"resize",q=k?"touchstart":"mousedown",
m=k?"touchmove":"mousemove",t=k?"touchend":"mouseup",x=k?"touchcancel":"mouseup",v="Moz"==b?"DOMMouseScroll":"mousewheel",u="translate"+(l?"3d(":"("),B=l?",0)":")",f=function(a,d){var o=this,f;o.wrapper="object"==typeof a?a:document.getElementById(a);o.wrapper.style.overflow="hidden";o.scroller=o.wrapper.children[0];o.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,hScrollbar:!0,vScrollbar:!0,
fixedScrollbar:c,hideScrollbar:e,fadeScrollbar:e&&l,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(a){a.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(f in d)o.options[f]=d[f];o.x=o.options.x;o.y=o.options.y;o.options.useTransform=n?o.options.useTransform:
!1;o.options.hScrollbar=o.options.hScroll&&o.options.hScrollbar;o.options.vScrollbar=o.options.vScroll&&o.options.vScrollbar;o.options.zoom=o.options.useTransform&&o.options.zoom;o.options.useTransition=r&&o.options.useTransition;o.options.zoom&&c&&(u="translate(",B=")");o.scroller.style[b+"TransitionProperty"]=o.options.useTransform?"-"+b.toLowerCase()+"-transform":"top left";o.scroller.style[b+"TransitionDuration"]="0";o.scroller.style[b+"TransformOrigin"]="0 0";o.options.useTransition&&(o.scroller.style[b+
"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)");o.options.useTransform?o.scroller.style[b+"Transform"]=u+o.x+"px,"+o.y+"px"+B:o.scroller.style.cssText+=";position:absolute;top:"+o.y+"px;left:"+o.x+"px";o.options.useTransition&&(o.options.fixedScrollbar=!0);o.refresh();o._bind(p,window);o._bind(q);k||(o._bind("mouseout",o.wrapper),"none"!=o.options.wheelAction&&o._bind(v));o.options.checkDOMChanges&&(o.checkDOMTime=setInterval(function(){o._checkDOMChanges()},500))};f.prototype={enabled:!0,
x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(a){switch(a.type){case q:if(!k&&0!==a.button)break;this._start(a);break;case m:this._move(a);break;case t:case x:this._end(a);break;case p:this._resize();break;case v:this._wheel(a);break;case "mouseout":this._mouseout(a);break;case "webkitTransitionEnd":this._transitionEnd(a)}},_checkDOMChanges:function(){!this.moved&&!this.zoomed&&!(this.animating||this.scrollerW==this.scroller.offsetWidth*
this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)&&this.refresh()},_scrollbar:function(c){var d=document,e;this[c+"Scrollbar"]?(this[c+"ScrollbarWrapper"]||(e=d.createElement("div"),this.options.scrollbarClass?e.className=this.options.scrollbarClass+c.toUpperCase():e.style.cssText="position:absolute;z-index:100;"+("h"==c?"height:7px;bottom:1px;left:2px;right:"+(this.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(this.hScrollbar?"7":"2")+"px;top:2px;right:1px"),e.style.cssText+=";pointer-events:none;-"+
b+"-transition-property:opacity;-"+b+"-transition-duration:"+(this.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(this.options.hideScrollbar?"0":"1"),this.wrapper.appendChild(e),this[c+"ScrollbarWrapper"]=e,e=d.createElement("div"),this.options.scrollbarClass||(e.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-"+b+"-background-clip:padding-box;-"+b+"-box-sizing:border-box;"+("h"==c?"height:100%":"width:100%")+";-"+b+
"-border-radius:3px;border-radius:3px"),e.style.cssText+=";pointer-events:none;-"+b+"-transition-property:-"+b+"-transform;-"+b+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-"+b+"-transition-duration:0;-"+b+"-transform:"+u+"0,0"+B,this.options.useTransition&&(e.style.cssText+=";-"+b+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),this[c+"ScrollbarWrapper"].appendChild(e),this[c+"ScrollbarIndicator"]=e),"h"==c?(this.hScrollbarSize=this.hScrollbarWrapper.clientWidth,this.hScrollbarIndicatorSize=
a.max(this.hScrollbarSize*this.hScrollbarSize/this.scrollerW>>0,8),this.hScrollbarIndicator.style.width=this.hScrollbarIndicatorSize+"px",this.hScrollbarMaxScroll=this.hScrollbarSize-this.hScrollbarIndicatorSize,this.hScrollbarProp=this.hScrollbarMaxScroll/this.maxScrollX):(this.vScrollbarSize=this.vScrollbarWrapper.clientHeight,this.vScrollbarIndicatorSize=a.max(this.vScrollbarSize*this.vScrollbarSize/this.scrollerH>>0,8),this.vScrollbarIndicator.style.height=this.vScrollbarIndicatorSize+"px",this.vScrollbarMaxScroll=
this.vScrollbarSize-this.vScrollbarIndicatorSize,this.vScrollbarProp=this.vScrollbarMaxScroll/this.maxScrollY),this._scrollbarPos(c,!0)):this[c+"ScrollbarWrapper"]&&(n&&(this[c+"ScrollbarIndicator"].style[b+"Transform"]=""),this[c+"ScrollbarWrapper"].parentNode.removeChild(this[c+"ScrollbarWrapper"]),this[c+"ScrollbarWrapper"]=null,this[c+"ScrollbarIndicator"]=null)},_resize:function(){var a=this;setTimeout(function(){a.refresh()},c?200:0)},_pos:function(a,c){a=this.hScroll?a:0;c=this.vScroll?c:0;
this.options.useTransform?this.scroller.style[b+"Transform"]=u+a+"px,"+c+"px"+B+" scale("+this.scale+")":(a>>=0,c>>=0,this.scroller.style.left=a+"px",this.scroller.style.top=c+"px");this.x=a;this.y=c;this._scrollbarPos("h");this._scrollbarPos("v")},_scrollbarPos:function(a,c){var e="h"==a?this.x:this.y;this[a+"Scrollbar"]&&(e*=this[a+"ScrollbarProp"],0>e?(this.options.fixedScrollbar||(e=this[a+"ScrollbarIndicatorSize"]+(3*e>>0),8>e&&(e=8),this[a+"ScrollbarIndicator"].style["h"==a?"width":"height"]=
e+"px"),e=0):e>this[a+"ScrollbarMaxScroll"]&&(this.options.fixedScrollbar?e=this[a+"ScrollbarMaxScroll"]:(e=this[a+"ScrollbarIndicatorSize"]-(3*(e-this[a+"ScrollbarMaxScroll"])>>0),8>e&&(e=8),this[a+"ScrollbarIndicator"].style["h"==a?"width":"height"]=e+"px",e=this[a+"ScrollbarMaxScroll"]+(this[a+"ScrollbarIndicatorSize"]-e))),this[a+"ScrollbarWrapper"].style[b+"TransitionDelay"]="0",this[a+"ScrollbarWrapper"].style.opacity=c&&this.options.hideScrollbar?"0":"1",this[a+"ScrollbarIndicator"].style[b+
"Transform"]=u+("h"==a?e+"px,0":"0,"+e+"px")+B)},_start:function(c){var d=k?c.touches[0]:c,e,f;if(this.enabled){this.options.onBeforeScrollStart&&this.options.onBeforeScrollStart.call(this,c);(this.options.useTransition||this.options.zoom)&&this._transitionTime(0);this.zoomed=this.animating=this.moved=!1;this.dirY=this.dirX=this.absDistY=this.absDistX=this.distY=this.distX=0;this.options.zoom&&k&&1<c.touches.length&&(f=a.abs(c.touches[0].pageX-c.touches[1].pageX),e=a.abs(c.touches[0].pageY-c.touches[1].pageY),
this.touchesDistStart=a.sqrt(f*f+e*e),this.originX=a.abs(c.touches[0].pageX+c.touches[1].pageX-2*this.wrapperOffsetLeft)/2-this.x,this.originY=a.abs(c.touches[0].pageY+c.touches[1].pageY-2*this.wrapperOffsetTop)/2-this.y,this.options.onZoomStart&&this.options.onZoomStart.call(this,c));if(this.options.momentum&&(this.options.useTransform?(e=getComputedStyle(this.scroller,null)[b+"Transform"].replace(/[^0-9-.,]/g,"").split(","),f=1*e[4],e=1*e[5]):(f=1*getComputedStyle(this.scroller,null).left.replace(/[^0-9-]/g,
""),e=1*getComputedStyle(this.scroller,null).top.replace(/[^0-9-]/g,"")),f!=this.x||e!=this.y))this.options.useTransition?this._unbind("webkitTransitionEnd"):s(this.aniTime),this.steps=[],this._pos(f,e);this.absStartX=this.x;this.absStartY=this.y;this.startX=this.x;this.startY=this.y;this.pointX=d.pageX;this.pointY=d.pageY;this.startTime=c.timeStamp||Date.now();this.options.onScrollStart&&this.options.onScrollStart.call(this,c);this._bind(m);this._bind(t);this._bind(x)}},_move:function(c){var d=k?
c.touches[0]:c,e=d.pageX-this.pointX,f=d.pageY-this.pointY,g=this.x+e,m=this.y+f,j=c.timeStamp||Date.now();this.options.onBeforeScrollMove&&this.options.onBeforeScrollMove.call(this,c);if(this.options.zoom&&k&&1<c.touches.length)g=a.abs(c.touches[0].pageX-c.touches[1].pageX),m=a.abs(c.touches[0].pageY-c.touches[1].pageY),this.touchesDist=a.sqrt(g*g+m*m),this.zoomed=!0,d=1/this.touchesDistStart*this.touchesDist*this.scale,d<this.options.zoomMin?d=0.5*this.options.zoomMin*Math.pow(2,d/this.options.zoomMin):
d>this.options.zoomMax&&(d=2*this.options.zoomMax*Math.pow(0.5,this.options.zoomMax/d)),this.lastScale=d/this.scale,g=this.originX-this.originX*this.lastScale+this.x,m=this.originY-this.originY*this.lastScale+this.y,this.scroller.style[b+"Transform"]=u+g+"px,"+m+"px"+B+" scale("+d+")",this.options.onZoom&&this.options.onZoom.call(this,c);else{this.pointX=d.pageX;this.pointY=d.pageY;if(0<g||g<this.maxScrollX)g=this.options.bounce?this.x+e/2:0<=g||0<=this.maxScrollX?0:this.maxScrollX;if(m>this.minScrollY||
m<this.maxScrollY)m=this.options.bounce?this.y+f/2:m>=this.minScrollY||0<=this.maxScrollY?this.minScrollY:this.maxScrollY;this.distX+=e;this.distY+=f;this.absDistX=a.abs(this.distX);this.absDistY=a.abs(this.distY);6>this.absDistX&&6>this.absDistY||(this.options.lockDirection&&(this.absDistX>this.absDistY+5?(m=this.y,f=0):this.absDistY>this.absDistX+5&&(g=this.x,e=0)),this.moved=!0,this._pos(g,m),this.dirX=0<e?-1:0>e?1:0,this.dirY=0<f?-1:0>f?1:0,300<j-this.startTime&&(this.startTime=j,this.startX=
this.x,this.startY=this.y),this.options.onScrollMove&&this.options.onScrollMove.call(this,c))}},_end:function(c){if(!(k&&0!=c.touches.length)){var d=this,e=k?c.changedTouches[0]:c,f,g,l={dist:0,time:0},j={dist:0,time:0},n=(c.timeStamp||Date.now())-d.startTime,p=d.x,v=d.y;d._unbind(m);d._unbind(t);d._unbind(x);d.options.onBeforeScrollEnd&&d.options.onBeforeScrollEnd.call(d,c);if(d.zoomed)p=d.scale*d.lastScale,p=Math.max(d.options.zoomMin,p),p=Math.min(d.options.zoomMax,p),d.lastScale=p/d.scale,d.scale=
p,d.x=d.originX-d.originX*d.lastScale+d.x,d.y=d.originY-d.originY*d.lastScale+d.y,d.scroller.style[b+"TransitionDuration"]="200ms",d.scroller.style[b+"Transform"]=u+d.x+"px,"+d.y+"px"+B+" scale("+d.scale+")",d.zoomed=!1,d.refresh(),d.options.onZoomEnd&&d.options.onZoomEnd.call(d,c);else{if(d.moved){if(300>n&&d.options.momentum){l=p?d._momentum(p-d.startX,n,-d.x,d.scrollerW-d.wrapperW+d.x,d.options.bounce?d.wrapperW:0):l;j=v?d._momentum(v-d.startY,n,-d.y,0>d.maxScrollY?d.scrollerH-d.wrapperH+d.y-d.minScrollY:
0,d.options.bounce?d.wrapperH:0):j;p=d.x+l.dist;v=d.y+j.dist;if(0<d.x&&0<p||d.x<d.maxScrollX&&p<d.maxScrollX)l={dist:0,time:0};if(d.y>d.minScrollY&&v>d.minScrollY||d.y<d.maxScrollY&&v<d.maxScrollY)j={dist:0,time:0}}l.dist||j.dist?(l=a.max(a.max(l.time,j.time),10),d.options.snap&&(j=p-d.absStartX,n=v-d.absStartY,a.abs(j)<d.options.snapThreshold&&a.abs(n)<d.options.snapThreshold?d.scrollTo(d.absStartX,d.absStartY,200):(j=d._snap(p,v),p=j.x,v=j.y,l=a.max(j.time,l))),d.scrollTo(p>>0,v>>0,l)):d.options.snap?
(j=p-d.absStartX,n=v-d.absStartY,a.abs(j)<d.options.snapThreshold&&a.abs(n)<d.options.snapThreshold?d.scrollTo(d.absStartX,d.absStartY,200):(j=d._snap(d.x,d.y),(j.x!=d.x||j.y!=d.y)&&d.scrollTo(j.x,j.y,j.time))):d._resetPos(200)}else k&&(d.doubleTapTimer&&d.options.zoom?(clearTimeout(d.doubleTapTimer),d.doubleTapTimer=null,d.options.onZoomStart&&d.options.onZoomStart.call(d,c),d.zoom(d.pointX,d.pointY,1==d.scale?d.options.doubleTapZoom:1),d.options.onZoomEnd&&setTimeout(function(){d.options.onZoomEnd.call(d,
c)},200)):d.doubleTapTimer=setTimeout(function(){d.doubleTapTimer=null;for(f=e.target;1!=f.nodeType;)f=f.parentNode;"SELECT"!=f.tagName&&"INPUT"!=f.tagName&&"TEXTAREA"!=f.tagName&&(g=document.createEvent("MouseEvents"),g.initMouseEvent("click",!0,!0,c.view,1,e.screenX,e.screenY,e.clientX,e.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,0,null),g._fake=!0,f.dispatchEvent(g))},d.options.zoom?250:0)),d._resetPos(200);d.options.onTouchEnd&&d.options.onTouchEnd.call(d,c)}}},_resetPos:function(a){var c=
0<=this.x?0:this.x<this.maxScrollX?this.maxScrollX:this.x,e=this.y>=this.minScrollY||0<this.maxScrollY?this.minScrollY:this.y<this.maxScrollY?this.maxScrollY:this.y;if(c==this.x&&e==this.y){if(this.moved&&(this.moved=!1,this.options.onScrollEnd&&this.options.onScrollEnd.call(this)),this.hScrollbar&&this.options.hideScrollbar&&("webkit"==b&&(this.hScrollbarWrapper.style[b+"TransitionDelay"]="300ms"),this.hScrollbarWrapper.style.opacity="0"),this.vScrollbar&&this.options.hideScrollbar)"webkit"==b&&
(this.vScrollbarWrapper.style[b+"TransitionDelay"]="300ms"),this.vScrollbarWrapper.style.opacity="0"}else this.scrollTo(c,e,a||0)},_wheel:function(a){var b=this,c,e;if("wheelDeltaX"in a)c=a.wheelDeltaX/12,e=a.wheelDeltaY/12;else if("wheelDelta"in a)c=e=a.wheelDelta/12;else if("detail"in a)c=e=3*-a.detail;else return;if("zoom"==b.options.wheelAction){if(e=b.scale*Math.pow(2,1/3*(e?e/Math.abs(e):0)),e<b.options.zoomMin&&(e=b.options.zoomMin),e>b.options.zoomMax&&(e=b.options.zoomMax),e!=b.scale)!b.wheelZoomCount&&
b.options.onZoomStart&&b.options.onZoomStart.call(b,a),b.wheelZoomCount++,b.zoom(a.pageX,a.pageY,e,400),setTimeout(function(){b.wheelZoomCount--;!b.wheelZoomCount&&b.options.onZoomEnd&&b.options.onZoomEnd.call(b,a)},400)}else c=b.x+c,e=b.y+e,0<c?c=0:c<b.maxScrollX&&(c=b.maxScrollX),e>b.minScrollY?e=b.minScrollY:e<b.maxScrollY&&(e=b.maxScrollY),b.scrollTo(c,e,0)},_mouseout:function(a){var b=a.relatedTarget;if(b)for(;b=b.parentNode;)if(b==this.wrapper)return;this._end(a)},_transitionEnd:function(a){a.target==
this.scroller&&(this._unbind("webkitTransitionEnd"),this._startAni())},_startAni:function(){var b=this,c=b.x,e=b.y,f=Date.now(),g,m,j;b.animating||(b.steps.length?(g=b.steps.shift(),g.x==c&&g.y==e&&(g.time=0),b.animating=!0,b.moved=!0,b.options.useTransition)?(b._transitionTime(g.time),b._pos(g.x,g.y),b.animating=!1,g.time?b._bind("webkitTransitionEnd"):b._resetPos(0)):(j=function(){var k=Date.now();if(k>=f+g.time){b._pos(g.x,g.y);b.animating=false;b.options.onAnimationEnd&&b.options.onAnimationEnd.call(b);
b._startAni()}else{k=(k-f)/g.time-1;m=a.sqrt(1-k*k);k=(g.x-c)*m+c;b._pos(k,(g.y-e)*m+e);if(b.animating)b.aniTime=z(j)}},j()):b._resetPos(400))},_transitionTime:function(a){a+="ms";this.scroller.style[b+"TransitionDuration"]=a;this.hScrollbar&&(this.hScrollbarIndicator.style[b+"TransitionDuration"]=a);this.vScrollbar&&(this.vScrollbarIndicator.style[b+"TransitionDuration"]=a)},_momentum:function(b,c,e,f,g){var c=a.abs(b)/c,m=c*c/0.0012;0<b&&m>e?(e+=g/(6/(6.0E-4*(m/c))),c=c*e/m,m=e):0>b&&m>f&&(f+=g/
(6/(6.0E-4*(m/c))),c=c*f/m,m=f);return{dist:m*(0>b?-1:1),time:c/6.0E-4>>0}},_offset:function(a){for(var b=-a.offsetLeft,c=-a.offsetTop;a=a.offsetParent;)b-=a.offsetLeft,c-=a.offsetTop;a!=this.wrapper&&(b*=this.scale,c*=this.scale);return{left:b,top:c}},_snap:function(b,c){var e,f,g;g=this.pagesX.length-1;e=0;for(f=this.pagesX.length;e<f;e++)if(b>=this.pagesX[e]){g=e;break}g==this.currPageX&&0<g&&0>this.dirX&&g--;b=this.pagesX[g];f=(f=a.abs(b-this.pagesX[this.currPageX]))?500*(a.abs(this.x-b)/f):0;
this.currPageX=g;g=this.pagesY.length-1;for(e=0;e<g;e++)if(c>=this.pagesY[e]){g=e;break}g==this.currPageY&&0<g&&0>this.dirY&&g--;c=this.pagesY[g];e=(e=a.abs(c-this.pagesY[this.currPageY]))?500*(a.abs(this.y-c)/e):0;this.currPageY=g;g=a.max(f,e)>>0;return{x:b,y:c,time:g||200}},_bind:function(a,b,c){(b||this.scroller).addEventListener(a,this,!!c)},_unbind:function(a,b,c){(b||this.scroller).removeEventListener(a,this,!!c)},destroy:function(){this.scroller.style[b+"Transform"]="";this.vScrollbar=this.hScrollbar=
!1;this._scrollbar("h");this._scrollbar("v");this._unbind(p,window);this._unbind(q);this._unbind(m);this._unbind(t);this._unbind(x);this.options.hasTouch||(this._unbind("mouseout",this.wrapper),this._unbind(v));this.options.useTransition&&this._unbind("webkitTransitionEnd");this.options.checkDOMChanges&&clearInterval(this.checkDOMTime);this.options.onDestroy&&this.options.onDestroy.call(this)},setOption:function(a){for(i in a)this.options[i]=a[i];this.refresh()},refresh:function(a){console.log("refresh SCROLL by "+
a);var c,e,f;e=a=0;this.scale<this.options.zoomMin&&(this.scale=this.options.zoomMin);this.wrapperW=this.wrapper.clientWidth||1;this.wrapperH=this.wrapper.clientHeight||1;this.minScrollY=-this.options.topOffset||0;this.scrollerW=this.scroller.offsetWidth*this.scale>>0;this.scrollerH=(this.scroller.offsetHeight+this.minScrollY)*this.scale>>0;this.maxScrollX=this.wrapperW-this.scrollerW;this.maxScrollY=this.wrapperH-this.scrollerH+this.minScrollY;this.dirY=this.dirX=0;this.options.onRefresh&&this.options.onRefresh.call(this);
this.hScroll=this.options.hScroll&&0>this.maxScrollX;this.vScroll=this.options.vScroll&&(!this.options.bounceLock&&!this.hScroll||this.scrollerH>this.wrapperH);this.hScrollbar=this.hScroll&&this.options.hScrollbar;this.vScrollbar=this.vScroll&&this.options.vScrollbar&&this.scrollerH>this.wrapperH;c=this._offset(this.wrapper);this.wrapperOffsetLeft=-c.left;this.wrapperOffsetTop=-c.top;if("string"==typeof this.options.snap){this.pagesX=[];this.pagesY=[];f=this.scroller.querySelectorAll(this.options.snap);
c=0;for(e=f.length;c<e;c++)a=this._offset(f[c]),a.left+=this.wrapperOffsetLeft,a.top+=this.wrapperOffsetTop,this.pagesX[c]=a.left<this.maxScrollX?this.maxScrollX:a.left*this.scale,this.pagesY[c]=a.top<this.maxScrollY?this.maxScrollY:a.top*this.scale}else if(this.options.snap){for(this.pagesX=[];a>=this.maxScrollX;)this.pagesX[e]=a,a-=this.wrapperW,e++;this.maxScrollX%this.wrapperW&&(this.pagesX[this.pagesX.length]=this.maxScrollX-this.pagesX[this.pagesX.length-1]+this.pagesX[this.pagesX.length-1]);
e=a=0;for(this.pagesY=[];a>=this.maxScrollY;)this.pagesY[e]=a,a-=this.wrapperH,e++;this.maxScrollY%this.wrapperH&&(this.pagesY[this.pagesY.length]=this.maxScrollY-this.pagesY[this.pagesY.length-1]+this.pagesY[this.pagesY.length-1])}this._scrollbar("h");this._scrollbar("v");this.zoomed||(this.scroller.style[b+"TransitionDuration"]="0",this._resetPos(200))},scrollTo:function(a,b,c,e){var f=a;this.stop();f.length||(f=[{x:a,y:b,time:c,relative:e}]);a=0;for(b=f.length;a<b;a++)f[a].relative&&(f[a].x=this.x-
f[a].x,f[a].y=this.y-f[a].y),this.steps.push({x:f[a].x,y:f[a].y,time:f[a].time||0});this._startAni()},scrollToElement:function(b,c){var e;if(b=b.nodeType?b:this.scroller.querySelector(b))e=this._offset(b),e.left+=this.wrapperOffsetLeft,e.top+=this.wrapperOffsetTop,e.left=0<e.left?0:e.left<this.maxScrollX?this.maxScrollX:e.left,e.top=e.top>this.minScrollY?this.minScrollY:e.top<this.maxScrollY?this.maxScrollY:e.top,c=void 0===c?a.max(2*a.abs(e.left),2*a.abs(e.top)):c,this.scrollTo(e.left,e.top,c)},
scrollToPage:function(a,b,c){c=void 0===c?400:c;this.options.onScrollStart&&this.options.onScrollStart.call(this);if(this.options.snap)a="next"==a?this.currPageX+1:"prev"==a?this.currPageX-1:a,b="next"==b?this.currPageY+1:"prev"==b?this.currPageY-1:b,a=0>a?0:a>this.pagesX.length-1?this.pagesX.length-1:a,b=0>b?0:b>this.pagesY.length-1?this.pagesY.length-1:b,this.currPageX=a,this.currPageY=b,a=this.pagesX[a],b=this.pagesY[b];else if(a*=-this.wrapperW,b*=-this.wrapperH,a<this.maxScrollX&&(a=this.maxScrollX),
b<this.maxScrollY)b=this.maxScrollY;this.scrollTo(a,b,c)},disable:function(){this.stop();this._resetPos(0);this.enabled=!1;this._unbind(m);this._unbind(t);this._unbind(x)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind("webkitTransitionEnd"):s(this.aniTime);this.steps=[];this.animating=this.moved=!1},zoom:function(a,c,e,f){var g=e/this.scale;this.options.useTransform&&(this.zoomed=!0,f=void 0===f?200:f,a=a-this.wrapperOffsetLeft-this.x,c=c-this.wrapperOffsetTop-
this.y,this.x=a-a*g+this.x,this.y=c-c*g+this.y,this.scale=e,this.refresh(),this.x=0<this.x?0:this.x<this.maxScrollX?this.maxScrollX:this.x,this.y=this.y>this.minScrollY?this.minScrollY:this.y<this.maxScrollY?this.maxScrollY:this.y,this.scroller.style[b+"TransitionDuration"]=f+"ms",this.scroller.style[b+"Transform"]=u+this.x+"px,"+this.y+"px"+B+" scale("+e+")",this.zoomed=!1)},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}};"undefined"!==typeof exports?exports.iScroll=f:window.iScroll=
f})();(function(a){function b(a,c){if(a){this.element=a;this.options={};for(var e in b.defaults)this.options[e]=b.defaults[e];for(e in c)this.options[e]=c[e];this._create();this.build()}}function c(b,c,e){b.addEventListener?b.addEventListener(c,e,!1):b.attachEvent&&(b["e"+c+e]=e,b[c+e]=function(){b["e"+c+e](a.event)},b.attachEvent("on"+c,b[c+e]))}function e(a,b,c){var e="height"!==b,g=e?a.offsetWidth:a.offsetHeight,k=e?"Left":"Top",h=e?"Right":"Bottom",e=s(a),d=parseFloat(e["padding"+k])||0,l=parseFloat(e["padding"+
h])||0,n=parseFloat(e["border"+k+"Width"])||0,q=parseFloat(e["border"+h+"Width"])||0,k=e["margin"+k],h=e["margin"+h];p||(k=f(a,e,k),h=f(a,e,h));k=parseFloat(k)||0;h=parseFloat(h)||0;if(0<g)c?g+=k+h:g-=d+l+n+q;else{g=e[b];if(0>g||null==g)g=a.style[b]||0;g=parseFloat(g)||0;c&&(g+=d+l+k+h+n+q)}return g}function f(a,b,c){if(-1===c.indexOf("%"))return c;var a=a.style,e=a.width;a.width=c;b=b.width;a.width=e;return b}var g=a.document,l="classList"in g.createElement("div"),k=l?function(a,b){return a.classList.contains(b)}:
function(a,b){return RegExp("(^|\\s+)"+b+"(\\s+|$)").test(a.className)},n=l?function(a,b){a.classList.add(b)}:function(a,b){k(a,b)||(a.className=a.className+" "+b)},r=l?function(a,b){a.classList.remove(b)}:function(a,b){a.className=a.className.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)")," ")},z=g.defaultView,s=z&&z.getComputedStyle?function(a){return z.getComputedStyle(a,null)}:function(a){return a.currentStyle},l=g.getElementsByTagName("body")[0],g=g.createElement("div");g.style.marginTop="1%";l.appendChild(g);
var p="1%"!==s(g).marginTop;l.removeChild(g);var q=["position","height"];b.defaults={isResizable:!0,gutterWidth:0,isRTL:!1,isFitWidth:!1};b.prototype={_getBricks:function(a){for(var b,c=0,e=a.length;c<e;c++)b=a[c],b.style.position="absolute",n(b,"masonry-brick"),this.bricks.push(b)},_create:function(){this.reloadItems();var b=this.element.style;this._originalStyle={};for(var e=0,f=q.length;e<f;e++){var g=q[e];this._originalStyle[g]=b[g]||""}this.element.style.position="relative";this.horizontalDirection=
this.options.isRTL?"right":"left";this.offset={};b=s(this.element);e=this.options.isRTL?"paddingRight":"paddingLeft";this.offset.y=parseFloat(b.paddingTop)||0;this.offset.x=parseFloat(b[e])||0;this.isFluid=this.options.columnWidth&&"function"==typeof this.options.columnWidth;var k=this;setTimeout(function(){n(k.element,"masonry")});this.options.isResizable&&c(a,"resize",function(){k._handleResize()})},build:function(a){this._getColumns();this._reLayout(a)},_getColumns:function(){var a=e(this.options.isFitWidth?
this.element.parentNode:this.element,"width");this.columnWidth=this.isFluid?this.options.columnWidth(a):this.options.columnWidth||e(this.bricks[0],"width",!0)||a;this.columnWidth+=this.options.gutterWidth;this.cols=Math.floor((a+this.options.gutterWidth)/this.columnWidth);this.cols=Math.max(this.cols,1)},reloadItems:function(){this.bricks=[];this._getBricks(this.element.children)},_reLayout:function(a){var b=this.cols;for(this.colYs=[];b--;)this.colYs.push(0);this.layout(this.bricks,a)},layout:function(a,
b){for(var c,f,g,k,h,d,l=0,n=a.length;l<n;l++)if(c=a[l],1===c.nodeType){f=Math.ceil(e(c,"width",!0)/(this.columnWidth+this.options.gutterWidth));f=Math.min(f,this.cols);if(1===f)d=this.colYs;else{g=this.cols+1-f;d=[];for(h=0;h<g;h++)k=this.colYs.slice(h,h+f),d[h]=Math.max.apply(Math,k)}g=Math.min.apply(Math,d);f=0;for(h=d.length;f<h&&d[f]!==g;f++);c.style.top=g+this.offset.y+"px";c.style[this.horizontalDirection]=this.columnWidth*f+this.offset.x+"px";c=g+e(c,"height",!0);d=this.cols+1-h;for(h=0;h<
d;h++)this.colYs[f+h]=c}this.element.style.height=Math.max.apply(Math,this.colYs)+"px";if(this.options.isFitWidth){n=0;for(l=this.cols;--l&&0===this.colYs[l];)n++;this.element.style.width=(this.cols-n)*this.columnWidth-this.options.gutterWidth+"px"}b&&b.call(a)},_handleResize:function(){var a=this;this._resizeTimeout&&clearTimeout(this._resizeTimeout);this._resizeTimeout=setTimeout(function(){a.resize();a._resizeTimeout=null},100)},resize:function(){var a=this.cols;this._getColumns();(this.isFluid||
this.cols!==a)&&this._reLayout()},reload:function(a){this.reloadItems();this.build(a)},appended:function(a,b,c){var f=this,g=function(){f._appended(a,c)};if(b){for(var b=e(this.element,"height")+"px",k=0,h=a.length;k<h;k++)a[k].style.top=b;setTimeout(g,1)}else g()},_appended:function(a,b){this._getBricks(a);this.layout(a,b)},destroy:function(){for(var b,c=0,e=this.bricks.length;c<e;c++)b=this.bricks[c],b.style.position="",b.style.top="",b.style.left="",r(b,"masonry-brick");b=this.element.style;e=
q.length;for(c=0;c<e;c++){var f=q[c];b[f]=this._originalStyle[f]}r(this.element,"masonry");this.resizeHandler&&(c=a,e=this.resizeHandler,c.removeEventListener?c.removeEventListener("resize",e,!1):c.detachEvent&&(c.detachEvent("onresize",c["resize"+e]),c["resize"+e]=null,c["eresize"+e]=null))}};b.getWH=e;a.Masonry=b})(window);
