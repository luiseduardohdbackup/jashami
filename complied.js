var i18n=function(){var f={},a={DST:-4,format:"D, d F Y H:i:s",AM:"AM",PM:"PM"};Date.prototype.format=function(f){var a="",k=Date.replaceChars,m="";k.reload();for(var d=0;d<f.length;d++)m=f.charAt(d),a+=k[m]?k[m].call(this):m;return a};Date.replaceChars={reload:function(){Date.replaceChars.shortMonths=f.hasOwnProperty("shortMonths")?f.shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(",");Date.replaceChars.longMonths=f.hasOwnProperty("longMonths")?f.longMonths:"January,February,March,April,May,June,July,August,September,October,November,December".split(",");
Date.replaceChars.shortDays=f.hasOwnProperty("shortDays")?f.shortDays:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(",");Date.replaceChars.longDays=f.hasOwnProperty("longDays")?f.longDays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(",")},shortMonths:[],longMonths:[],shortDays:[],longDays:[],d:function(){return(10>this.getUTCDate()?"0":"")+this.getUTCDate()},D:function(){return Date.replaceChars.shortDays[this.getUTCDay()]},j:function(){return this.getUTCDate()},l:function(){return Date.replaceChars.longDays[this.getUTCDay()]},
N:function(){return this.getDay()+1},S:function(){return 1===this.getUTCDate()%10&&11!==this.getUTCDate()?"st":2===this.getUTCDate()%10&&12!==this.getUTCDate()?"nd":3==this.getUTCDate()%10&&13!=this.getUTCDate()?"rd":"th"},w:function(){return this.getUTCDay()},z:function(){return""},W:function(){return""},F:function(){return Date.replaceChars.longMonths[this.getUTCMonth()]},m:function(){return(9>this.getUTCMonth()?"0":"")+(this.getUTCMonth()+1)},M:function(){return Date.replaceChars.shortMonths[this.getUTCMonth()]},
n:function(){return this.getUTCMonth()+1},t:function(){return""},L:function(){return""},o:function(){return""},Y:function(){return this.getUTCFullYear()},y:function(){return(""+this.getUTCFullYear()).substr(2)},a:function(){var l=f.hasOwnProperty("setting")?f.setting:a;return 12>this.getUTCHours()?l.AM:l.PM},A:function(){var l=f.hasOwnProperty("setting")?f.setting:a;return 12>this.getUTCHours()?l.AM:l.PM},B:function(){return""},g:function(){return this.getUTCHours()%12||12},G:function(){return this.getUTCHours()},
h:function(){return(10>(this.getUTCHours()%12||12)?"0":"")+(this.getUTCHours()%12||12)},H:function(){return(10>this.getUTCHours()?"0":"")+this.getUTCHours()},i:function(){return(10>this.getUTCMinutes()?"0":"")+this.getUTCMinutes()},s:function(){return(10>this.getUTCSeconds()?"0":"")+this.getUTCSeconds()},e:function(){return""},I:function(){return""},O:function(){return(0>-this.getTimezoneOffset()?"-":"+")+(10>Math.abs(this.getTimezoneOffset()/60)?"0":"")+Math.abs(this.getTimezoneOffset()/60)+"00"},
T:function(){var f=this.getUTCMonth();this.setMonth(0);var a=this.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,"$1");this.setMonth(f);return a},Z:function(){return 60*-this.getTimezoneOffset()},c:function(){return""},r:function(){return this.toString()},U:function(){return this.getUTCTime()/1E3}};var o=function(f,a,k){var m,a=parseInt(a,10);"string"===typeof k&&(k=k.split(/\D/),--k[1],m=new Date(k.join(",")));m="object"===typeof m?m:k;switch(f){case "y":m.setFullYear(m.getFullYear()+a);break;case "m":m.setMonth(m.getMonth()+
a);break;case "d":m.setDate(m.getDate()+a);break;case "w":m.setDate(m.getDate()+7*a);break;case "h":m.setHours(m.getHours()+a);break;case "n":m.setMinutes(m.getMinutes()+a);break;case "s":m.setSeconds(m.getSeconds()+a);break;case "l":m.setMilliseconds(m.getMilliseconds()+a)}return m};return{set:function(a){f=a},datetime:function(l){var g=f.hasOwnProperty("setting")?f.setting:a;return(g.format?o("h",g.DST,l?new Date(l):new Date):l?new Date(l):new Date).format(g.format)},_:function(a){try{var a=a.toString()||
"",g=arguments,k=0<g.length?RegExp("%([1-"+g.length.toString()+"])","g"):null;return(""+(f.hasOwnProperty(a)?f[a]:a)).replace(k,function(a,f){return g[f]})}catch(m){}}}}();(function(f){String.prototype.trim===f&&(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")});Array.prototype.reduce===f&&(Array.prototype.reduce=function(a){if(void 0===this||null===this)throw new TypeError;var o=Object(this),l=o.length>>>0,g=0,k;if("function"!=typeof a)throw new TypeError;if(0==l&&1==arguments.length)throw new TypeError;if(2<=arguments.length)k=arguments[1];else{do{if(g in o){k=o[g++];break}if(++g>=l)throw new TypeError;}while(1)}for(;g<l;)g in o&&
(k=a.call(f,k,o[g],g,o)),g++;return k})})();
var Zepto=function(){function f(b){return"[object Function]"=={}.toString.call(b)}function a(b){return b instanceof Object}function o(b){return b instanceof Array}function l(b){return"number"==typeof b.length}function g(b){return b.filter(function(b){return b!==r&&null!==b})}function k(b){return b.replace(/-+(.)?/g,function(b,c){return c?c.toUpperCase():""})}function m(b){return b.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}
function d(b){return b.filter(function(b,c,h){return h.indexOf(b)==c})}function e(b){return b in C?C[b]:C[b]=RegExp("(^|\\s)"+b+"(\\s|$)")}function j(c,h){h===r&&D.test(c);h in p||(h="*");var a=p[h];return a.innerHTML=""+c,b.call(a.childNodes)}function s(b,h){return b=b||c,b.__proto__=s.prototype,b.selector=h||"",b}function n(b,c){if(!b)return s();if(c!==r)return n(c).find(b);if(f(b))return n(h).ready(b);if(b instanceof s)return b;var p;return o(b)?p=g(b):0<=A.indexOf(b.nodeType)||b===window?(p=[b],
b=null):D.test(b)?(p=j(b.trim(),RegExp.$1),b=null):b.nodeType&&3==b.nodeType?p=[b]:p=t(h,b),s(p,b)}function q(b,c){return c===r?n(b):n(b).filter(c)}function u(b,c,h,p){return f(c)?c.call(b,h,p):c}function x(b,c,h){var p=b%2?c:c.parentNode;p&&p.insertBefore(h,b?1==b?p.firstChild:2==b?c:null:c.nextSibling)}function z(b,c){c(b);for(var h in b.childNodes)z(b.childNodes[h],c)}var r,v,t,w,c=[],b=c.slice,h=window.document,y={},C={},F=h.defaultView.getComputedStyle,E={"column-count":1,columns:1,"font-weight":1,
"line-height":1,opacity:1,"z-index":1,zoom:1},D=/^\s*<(\w+)[^>]*>/,A=[1,9,11],B=h.createElement("table"),G=h.createElement("tr"),p={tr:h.createElement("tbody"),tbody:B,thead:B,tfoot:B,td:G,th:G,"*":h.createElement("div")},H=/complete|loaded|interactive/,I=/^\.([\w-]+)$/,J=/^#([\w-]+)$/,K=/^[\w-]+$/;return n.extend=function(c){return b.call(arguments,1).forEach(function(b){for(v in b)c[v]=b[v]}),c},n.qsa=t=function(p,a){var d;return p===h&&J.test(a)?(d=p.getElementById(RegExp.$1))?[d]:c:b.call(I.test(a)?
p.getElementsByClassName(RegExp.$1):K.test(a)?p.getElementsByTagName(a):p.querySelectorAll(a))},n.isFunction=f,n.isObject=a,n.isArray=o,n.map=function(b,c){var h,p=[],a;if(l(b))for(a=0;a<b.length;a++)h=c(b[a],a),null!=h&&p.push(h);else for(a in b)h=c(b[a],a),null!=h&&p.push(h);return 0<p.length?[].concat.apply([],p):p},n.each=function(b,c){var h;if(l(b))for(h=0;h<b.length&&!1!==c(h,b[h]);h++);else for(h in b)if(!1===c(h,b[h]))break;return b},n.fn={forEach:c.forEach,reduce:c.reduce,push:c.push,indexOf:c.indexOf,
concat:c.concat,map:function(b){return n.map(this,function(c,h){return b.call(c,h,c)})},slice:function(){return n(b.apply(this,arguments))},ready:function(b){return H.test(h.readyState)?b(n):h.addEventListener("DOMContentLoaded",function(){b(n)},!1),this},get:function(b){return b===r?this:this[b]},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(b){return this.forEach(function(c,h){b.call(c,
h,c)}),this},filter:function(b){return n([].filter.call(this,function(c){return c.parentNode&&0<=t(c.parentNode,b).indexOf(c)}))},end:function(){return this.prevObject||n()},andSelf:function(){return this.add(this.prevObject||n())},add:function(b,c){return n(d(this.concat(n(b,c))))},is:function(b){return 0<this.length&&0<n(this[0]).filter(b).length},not:function(c){var h=[];if(f(c)&&c.call!==r)this.each(function(b){c.call(this,b)||h.push(this)});else{var p="string"==typeof c?this.filter(c):l(c)&&
f(c.item)?b.call(c):n(c);this.forEach(function(b){0>p.indexOf(b)&&h.push(b)})}return n(h)},eq:function(b){return-1===b?this.slice(b):this.slice(b,+b+1)},first:function(){var b=this[0];return b&&!a(b)?b:n(b)},last:function(){var b=this[this.length-1];return b&&!a(b)?b:n(b)},find:function(b){var c;return 1==this.length?c=t(this[0],b):c=this.map(function(){return t(this,b)}),n(c)},closest:function(b,c){var p=this[0],a=t(c||h,b);for(a.length||(p=null);p&&0>a.indexOf(p);)p=p!==c&&p!==h&&p.parentNode;return n(p)},
parents:function(b){for(var c=[],p=this;0<p.length;)p=n.map(p,function(b){if((b=b.parentNode)&&b!==h&&0>c.indexOf(b))return c.push(b),b});return q(c,b)},parent:function(b){return q(d(this.pluck("parentNode")),b)},children:function(c){return q(this.map(function(){return b.call(this.children)}),c)},siblings:function(c){return q(this.map(function(c,h){return b.call(h.parentNode.children).filter(function(b){return b!==h})}),c)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(b){return this.map(function(){return this[b]})},
show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=null);if("none"==F(this,"").getPropertyValue("display")){var b=this.style,c;c=this.nodeName;var p,a;c=(y[c]||(p=h.createElement(c),h.body.appendChild(p),a=F(p,"").getPropertyValue("display"),p.parentNode.removeChild(p),"none"==a&&(a="block"),y[c]=a),y[c]);b.display=c}})},replaceWith:function(b){return this.each(function(){n(this).before(b).remove()})},wrap:function(b){return this.each(function(){n(this).wrapAll(n(b)[0].cloneNode(!1))})},
wrapAll:function(b){return this[0]&&(n(this[0]).before(b=n(b)),b.append(this)),this},unwrap:function(){return this.parent().each(function(){n(this).replaceWith(n(this).children())}),this},hide:function(){return this.css("display","none")},toggle:function(b){return(b===r?"none"==this.css("display"):b)?this.show():this.hide()},prev:function(){return n(this.pluck("previousElementSibling"))},next:function(){return n(this.pluck("nextElementSibling"))},html:function(b){return b===r?0<this.length?this[0].innerHTML:
null:this.each(function(c){var h=this.innerHTML;n(this).empty().append(u(this,b,c,h))})},text:function(b){return b===r?0<this.length?this[0].textContent:null:this.each(function(){this.textContent=b})},attr:function(b,c){var h;return"string"==typeof b&&c===r?0==this.length?r:"value"==b&&"INPUT"==this[0].nodeName?this.val():!(h=this[0].getAttribute(b))&&b in this[0]?this[0][b]:h:this.each(function(h){if(a(b))for(v in b)this.setAttribute(v,b[v]);else this.setAttribute(b,u(this,c,h,this.getAttribute(b)))})},
removeAttr:function(b){return this.each(function(){this.removeAttribute(b)})},data:function(b,c){return this.attr("data-"+b,c)},val:function(b){return b===r?0<this.length?this[0].value:null:this.each(function(c){this.value=u(this,b,c,this.value)})},offset:function(){if(0==this.length)return null;var b=this[0].getBoundingClientRect();return{left:b.left+window.pageXOffset,top:b.top+window.pageYOffset,width:b.width,height:b.height}},css:function(b,c){if(c===r&&"string"==typeof b)return 0==this.length?
r:this[0].style[k(b)]||F(this[0],"").getPropertyValue(b);var h="";for(v in b)h+=m(v)+":"+("number"==typeof b[v]&&!E[m(v)]?b[v]+"px":b[v])+";";return"string"==typeof b&&(h=m(b)+":"+("number"==typeof c&&!E[m(b)]?c+"px":c)),this.each(function(){this.style.cssText+=";"+h})},index:function(b){return b?this.indexOf(n(b)[0]):this.parent().children().indexOf(this[0])},hasClass:function(b){return 1>this.length?!1:e(b).test(this[0].className)},addClass:function(b){return this.each(function(c){w=[];var h=this.className;
u(this,b,c,h).split(/\s+/g).forEach(function(b){n(this).hasClass(b)||w.push(b)},this);w.length&&(this.className+=(h?" ":"")+w.join(" "))})},removeClass:function(b){return this.each(function(c){if(b===r)return this.className="";w=this.className;u(this,b,c,w).split(/\s+/g).forEach(function(b){w=w.replace(e(b)," ")});this.className=w.trim()})},toggleClass:function(b,c){return this.each(function(h){h=u(this,b,h,this.className);(c===r?!n(this).hasClass(h):c)?n(this).addClass(h):n(this).removeClass(h)})}},
"filter,add,not,eq,first,last,find,closest,parents,parent,children,siblings".split(",").forEach(function(b){var c=n.fn[b];n.fn[b]=function(){var b=c.apply(this,arguments);return b.prevObject=this,b}}),["width","height"].forEach(function(b){n.fn[b]=function(c){var p,a=b.replace(/./,function(b){return b[0].toUpperCase()});return c===r?this[0]==window?window["inner"+a]:this[0]==h?h.documentElement["offset"+a]:(p=this.offset())&&p[b]:this.each(function(h){var p=n(this);p.css(b,u(this,c,h,p[b]()))})}}),
["after","prepend","before","append"].forEach(function(b,c){n.fn[b]=function(b){var h=a(b)?b:j(b);if(!("length"in h)||h.nodeType)h=[h];if(1>h.length)return this;var p=this.length,d=1<p,f=2>c;return this.each(function(b,a){for(var e=0;e<h.length;e++){var y=h[f?h.length-e-1:e];z(y,function(b){null!=b.nodeName&&"SCRIPT"===b.nodeName.toUpperCase()&&(!b.type||"text/javascript"===b.type)&&window.eval.call(window,b.innerHTML)});d&&b<p-1&&(y=y.cloneNode(!0));x(c,a,y)}})};n.fn[c%2?b+"To":"insert"+(c?"Before":
"After")]=function(c){return n(c)[b](this),this}}),s.prototype=n.fn,n}();window.Zepto=Zepto;"$"in window||(window.$=Zepto);
(function(f){function a(a,d,f,g){d=o(d);if(d.ns)var l=RegExp("(?:^| )"+d.ns.replace(" "," .* ?")+"(?: |$)");return(e[a._zid||(a._zid=j++)]||[]).filter(function(a){return a&&(!d.e||a.e==d.e)&&(!d.ns||l.test(a.ns))&&(!f||a.fn==f)&&(!g||a.sel==g)})}function o(a){a=(""+a).split(".");return{e:a[0],ns:a.slice(1).sort().join(" ")}}function l(a,d,e){f.isObject(a)?f.each(a,e):a.split(/\s/).forEach(function(a){e(a,d)})}function g(a,d,g,k,m){var n=a._zid||(a._zid=j++),c=e[n]||(e[n]=[]);l(d,g,function(b,h){var d=
m&&m(h,b),e=d||h,j=function(b){var c=e.apply(a,[b].concat(b.data));return!1===c&&b.preventDefault(),c},d=f.extend(o(b),{fn:h,proxy:j,sel:k,del:d,i:c.length});c.push(d);a.addEventListener(d.e,j,!1)})}function k(d,f,g,k){var m=d._zid||(d._zid=j++);l(f||"",g,function(f,c){a(d,f,c,k).forEach(function(b){delete e[m][b.i];d.removeEventListener(b.e,b.proxy,!1)})})}function m(a){var d=f.extend({originalEvent:a},a);return f.each(u,function(f,e){d[f]=function(){return this[e]=n,a[f].apply(a,arguments)};d[e]=
q}),d}function d(a){if(!("defaultPrevented"in a)){a.defaultPrevented=!1;var d=a.preventDefault;a.preventDefault=function(){this.defaultPrevented=!0;d.call(this)}}}var e={},j=1,s={};s.click=s.mousedown=s.mouseup=s.mousemove="MouseEvents";f.event={add:g,remove:k};f.fn.bind=function(a,d){return this.each(function(){g(this,a,d)})};f.fn.unbind=function(a,d){return this.each(function(){k(this,a,d)})};f.fn.one=function(a,d){return this.each(function(f,e){g(this,a,d,null,function(a,d){return function(){var c=
a.apply(e,arguments);return k(e,d,a),c}})})};var n=function(){return!0},q=function(){return!1},u={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};f.fn.delegate=function(a,d,e){return this.each(function(j,l){g(l,d,e,a,function(d){return function(c){var b,h=f(c.target).closest(a,l).get(0);if(h)return b=f.extend(m(c),{currentTarget:h,liveFired:l}),d.apply(h,[b].concat([].slice.call(arguments,1)))}})})};f.fn.undelegate=
function(a,d,f){return this.each(function(){k(this,d,f,a)})};f.fn.live=function(a,d){return f(document.body).delegate(this.selector,a,d),this};f.fn.die=function(a,d){return f(document.body).undelegate(this.selector,a,d),this};f.fn.on=function(a,d,e){return void 0===d||f.isFunction(d)?this.bind(a,d):this.delegate(d,a,e)};f.fn.off=function(a,d,e){return void 0===d||f.isFunction(d)?this.unbind(a,d):this.undelegate(d,a,e)};f.fn.trigger=function(a,e){return"string"==typeof a&&(a=f.Event(a)),d(a),a.data=
e,this.each(function(){this.dispatchEvent(a)})};f.fn.triggerHandler=function(d,e){var j,g;return this.each(function(l,k){j=m("string"==typeof d?f.Event(d):d);j.data=e;j.target=k;f.each(a(k,d.type||d),function(c,b){g=b.proxy(j);if(j.isImmediatePropagationStopped())return!1})}),g};"focusin,focusout,load,resize,scroll,unload,click,dblclick,mousedown,mouseup,mousemove,mouseover,mouseout,change,select,keydown,keypress,keyup,error".split(",").forEach(function(a){f.fn[a]=function(d){return this.bind(a,d)}});
["focus","blur"].forEach(function(a){f.fn[a]=function(d){if(d)this.bind(a,d);else if(this.length)try{this.get(0)[a]()}catch(f){}return this}});f.Event=function(a,d){var f=document.createEvent(s[a]||"Events"),e=!0;if(d)for(var j in d)"bubbles"==j?e=!!d[j]:f[j]=d[j];return f.initEvent(a,e,!0,null,null,null,null,null,null,null,null,null,null,null,null),f}})(Zepto);
(function(f){function a(a){var f=this.os={},g=this.browser={},k=a.match(/WebKit\/([\d.]+)/),m=a.match(/(Android)\s+([\d.]+)/),d=a.match(/(iPad).*OS\s([\d_]+)/),e=!d&&a.match(/(iPhone\sOS)\s([\d_]+)/),j=a.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),s=j&&a.match(/TouchPad/),a=a.match(/(BlackBerry).*Version\/([\d.]+)/);k&&(g.version=k[1]);g.webkit=!!k;m&&(f.android=!0,f.version=m[2]);e&&(f.ios=!0,f.version=e[2].replace(/_/g,"."),f.iphone=!0);d&&(f.ios=!0,f.version=d[2].replace(/_/g,"."),f.ipad=!0);j&&(f.webos=
!0,f.version=j[2]);s&&(f.touchpad=!0);a&&(f.blackberry=!0,f.version=a[2])}a.call(f,navigator.userAgent);f.__detect=a})(Zepto);
(function(f,a){var o="",l,g=window.document.createElement("div"),k=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;f.each({Webkit:"webkit",Moz:"",O:"o",ms:"MS"},function(f,d){if(g.style[f+"TransitionProperty"]!==a)return o="-"+f.toLowerCase()+"-",l=d,!1});f.fx={off:l===a&&g.style.transitionProperty===a,cssPrefix:o,transitionEnd:l?l+"TransitionEnd":"transitionend",animationEnd:l?l+"AnimationEnd":"animationend"};f.fn.animate=function(a,d,e,j){return f.isObject(d)&&(e=d.easing,
j=d.complete,d=d.duration),d&&(d/=1E3),this.anim(a,d,e,j)};f.fn.anim=function(g,d,e,j){var l,n={},q,u=this,x,z=f.fx.transitionEnd;d===a&&(d=0.4);f.fx.off&&(d=0);if("string"==typeof g)n[o+"animation-name"]=g,n[o+"animation-duration"]=d+"s",z=f.fx.animationEnd;else{for(q in g)k.test(q)?(l||(l=[]),l.push(q+"("+g[q]+")")):n[q]=g[q];l&&(n[o+"transform"]=l.join(" "));f.fx.off||(n[o+"transition"]="all "+d+"s "+(e||""))}return x=function(){var a={};a[o+"transition"]=a[o+"animation-name"]="none";f(this).css(a);
j&&j.call(this)},0<d&&this.one(z,x),setTimeout(function(){u.css(n);0>=d&&setTimeout(function(){u.each(function(){x.call(this)})},0)},0),this};g=null})(Zepto);
(function(f){function a(a,d,e,j){if(a.global)return a=d||n,e=f.Event(e),f(a).trigger(e,j),!e.defaultPrevented}function o(d){d.global&&0===f.active++&&a(d,null,"ajaxStart")}function l(d,f){var e=f.context;if(!1===f.beforeSend.call(e,d,f)||!1===a(f,e,"ajaxBeforeSend",[d,f]))return!1;a(f,e,"ajaxSend",[d,f])}function g(d,f,e){var j=e.context;e.success.call(j,d,"success",f);a(e,j,"ajaxSuccess",[f,e,d]);m("success",f,e)}function k(d,f,e,j){var g=j.context;j.error.call(g,e,f,d);a(j,g,"ajaxError",[e,j,d]);
m(f,e,j)}function m(d,e,j){var g=j.context;j.complete.call(g,e,d);a(j,g,"ajaxComplete",[e,j]);j.global&&!--f.active&&a(j,null,"ajaxStop")}function d(){}function e(a,d,j,g){var k=f.isArray(d);f.each(d,function(c,b){g&&(c=j?g:g+"["+(k?"":c)+"]");!g&&k?a.add(b.name,b.value):(j?f.isArray(b):s(b))?e(a,b,j,c):a.add(c,b)})}var j=0,s=f.isObject,n=window.document,q,u;f.active=0;f.ajaxJSONP=function(a){var e="jsonp"+ ++j,k=n.createElement("script"),l={abort:function(){f(k).remove();e in window&&(window[e]=
d);m(l,a,"abort")}},o;return window[e]=function(c){clearTimeout(o);f(k).remove();delete window[e];g(c,l,a)},k.src=a.url.replace(/=\?/,"="+e),f("head").append(k),0<a.timeout&&(o=setTimeout(function(){l.abort();m(l,a,"timeout")},a.timeout)),l};f.ajaxSettings={type:"GET",beforeSend:d,success:d,error:d,complete:d,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:"application/json",xml:"application/xml, text/xml",html:"text/html",
text:"text/plain"},crossDomain:!1,timeout:0};f.ajax=function(a){var e=f.extend({},a||{});for(q in f.ajaxSettings)void 0===e[q]&&(e[q]=f.ajaxSettings[q]);o(e);e.crossDomain||(e.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(e.url)&&RegExp.$2!=window.location.host);if(/=\?/.test(e.url))return f.ajaxJSONP(e);e.url||(e.url=window.location.toString());e.data&&!e.contentType&&(e.contentType="application/x-www-form-urlencoded");s(e.data)&&(e.data=f.param(e.data));e.type.match(/get/i)&&e.data&&(a=e.data,e.url.match(/\?.*=/)?
a="&"+a:"?"!=a[0]&&(a="?"+a),e.url+=a);var j=e.accepts[e.dataType],a={},n=/^([\w-]+:)\/\//.test(e.url)?RegExp.$1:window.location.protocol,m=f.ajaxSettings.xhr(),c;e.crossDomain||(a["X-Requested-With"]="XMLHttpRequest");j&&(a.Accept=j);e.headers=f.extend(a,e.headers||{});m.onreadystatechange=function(){if(m.readyState==4){clearTimeout(c);var b,h=false;if(m.status>=200&&m.status<300||m.status==0&&n=="file:"){if(j=="application/json"&&!/^\s*$/.test(m.responseText))try{b=JSON.parse(m.responseText)}catch(a){h=
a}else b=m.responseText;h?k(h,"parsererror",m,e):g(b,m,e)}else k(null,"error",m,e)}};m.open(e.type,e.url,!0);e.contentType&&(e.headers["Content-Type"]=e.contentType);for(u in e.headers)m.setRequestHeader(u,e.headers[u]);return!1===l(m,e)?(m.abort(),!1):(0<e.timeout&&(c=setTimeout(function(){m.onreadystatechange=d;m.abort();k(null,"timeout",m,e)},e.timeout)),m.send(e.data),m)};f.get=function(a,d){return f.ajax({url:a,success:d})};f.post=function(a,d,e,j){return f.isFunction(d)&&(j=j||e,e=d,d=null),
f.ajax({type:"POST",url:a,data:d,success:e,dataType:j})};f.getJSON=function(a,d){return f.ajax({url:a,success:d,dataType:"json"})};f.fn.load=function(a,d){if(!this.length)return this;var e=this,j=a.split(/\s/),g;return 1<j.length&&(a=j[0],g=j[1]),f.get(a,function(c){e.html(g?f(n.createElement("div")).html(c).find(g).html():c);d&&d.call(e)}),this};var x=encodeURIComponent;f.param=function(a,d){var f=[];return f.add=function(a,d){this.push(x(a)+"="+x(d))},e(f,a,d),f.join("&").replace("%20","+")}})(Zepto);
(function(f){f.fn.serializeArray=function(){var a=[],o;return f(Array.prototype.slice.call(this.get(0).elements)).each(function(){o=f(this);var l=o.attr("type");!this.disabled&&"submit"!=l&&"reset"!=l&&"button"!=l&&("radio"!=l&&"checkbox"!=l||this.checked)&&a.push({name:o.attr("name"),value:o.val()})}),a};f.fn.serialize=function(){var a=[];return this.serializeArray().forEach(function(f){a.push(encodeURIComponent(f.name)+"="+encodeURIComponent(f.value))}),a.join("&")};f.fn.submit=function(a){a?this.bind("submit",
a):this.length&&(a=f.Event("submit"),this.eq(0).trigger(a),a.defaultPrevented||this.get(0).submit());return this}})(Zepto);
(function(f){function a(a,d,e,f){var g=Math.abs(a-d),k=Math.abs(e-f);return g>=k?0<a-d?"Left":"Right":0<e-f?"Up":"Down"}function o(){l.last&&Date.now()-l.last>=k&&(f(l.target).trigger("longTap"),l={})}var l={},g,k=750;f(document).ready(function(){f(document.body).bind("touchstart",function(a){var d=Date.now(),e=d-(l.last||d);l.target="tagName"in a.touches[0].target?a.touches[0].target:a.touches[0].target.parentNode;g&&clearTimeout(g);l.x1=a.touches[0].pageX;l.y1=a.touches[0].pageY;0<e&&250>=e&&(l.isDoubleTap=
!0);l.last=d;setTimeout(o,k)}).bind("touchmove",function(a){l.x2=a.touches[0].pageX;l.y2=a.touches[0].pageY}).bind("touchend",function(){l.isDoubleTap?(f(l.target).trigger("doubleTap"),l={}):0<l.x2||0<l.y2?((30<Math.abs(l.x1-l.x2)||30<Math.abs(l.y1-l.y2))&&f(l.target).trigger("swipe")&&f(l.target).trigger("swipe"+a(l.x1,l.x2,l.y1,l.y2)),l.x1=l.x2=l.y1=l.y2=l.last=0):"last"in l&&(g=setTimeout(function(){g=null;f(l.target).trigger("tap");l={}},250))}).bind("touchcancel",function(){l={}})});"swipe,swipeLeft,swipeRight,swipeUp,swipeDown,doubleTap,tap,longTap".split(",").forEach(function(a){f.fn[a]=
function(d){return this.bind(a,d)}})})(Zepto);(function(){function f(c,a,h){if(c===a)return 0!==c||1/c==1/a;if(null==c||null==a)return c===a;c._chain&&(c=c._wrapped);a._chain&&(a=a._wrapped);if(c.isEqual&&b.isFunction(c.isEqual))return c.isEqual(a);if(a.isEqual&&b.isFunction(a.isEqual))return a.isEqual(c);var d=e.call(c);if(d!=e.call(a))return!1;switch(d){case "[object String]":return c==""+a;case "[object Number]":return c!=+c?a!=+a:0==c?1/c==1/a:c==+a;case "[object Date]":case "[object Boolean]":return+c==+a;case "[object RegExp]":return c.source==
a.source&&c.global==a.global&&c.multiline==a.multiline&&c.ignoreCase==a.ignoreCase}if("object"!=typeof c||"object"!=typeof a)return!1;for(var j=h.length;j--;)if(h[j]==c)return!0;h.push(c);var j=0,g=!0;if("[object Array]"==d){if(j=c.length,g=j==a.length)for(;j--&&(g=j in c==j in a&&f(c[j],a[j],h)););}else{if("constructor"in c!="constructor"in a||c.constructor!=a.constructor)return!1;for(var y in c)if(b.has(c,y)&&(j++,!(g=b.has(a,y)&&f(c[y],a[y],h))))break;if(g){for(y in a)if(b.has(a,y)&&!j--)break;
g=!j}}h.pop();return g}var a=this,o=a._,l={},g=Array.prototype,k=Object.prototype,m=g.slice,d=g.unshift,e=k.toString,j=k.hasOwnProperty,s=g.forEach,n=g.map,q=g.reduce,u=g.reduceRight,x=g.filter,z=g.every,r=g.some,v=g.indexOf,t=g.lastIndexOf,k=Array.isArray,w=Object.keys,c=Function.prototype.bind,b=function(b){return new A(b)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=b),exports._=b):a._=b;b.VERSION="1.3.1";var h=b.each=b.forEach=function(c,
a,h){if(c!=null)if(s&&c.forEach===s)c.forEach(a,h);else if(c.length===+c.length)for(var d=0,e=c.length;d<e;d++){if(d in c&&a.call(h,c[d],d,c)===l)break}else for(d in c)if(b.has(c,d)&&a.call(h,c[d],d,c)===l)break};b.map=b.collect=function(b,c,a){var d=[];if(b==null)return d;if(n&&b.map===n)return b.map(c,a);h(b,function(b,h,e){d[d.length]=c.call(a,b,h,e)});if(b.length===+b.length)d.length=b.length;return d};b.reduce=b.foldl=b.inject=function(c,a,d,e){var f=arguments.length>2;c==null&&(c=[]);if(q&&
c.reduce===q)return e&&(a=b.bind(a,e)),f?c.reduce(a,d):c.reduce(a);h(c,function(b,c,h){f?d=a.call(e,d,b,c,h):(d=b,f=true)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return d};b.reduceRight=b.foldr=function(c,a,h,d){var e=arguments.length>2;c==null&&(c=[]);if(u&&c.reduceRight===u)return d&&(a=b.bind(a,d)),e?c.reduceRight(a,h):c.reduceRight(a);var f=b.toArray(c).reverse();d&&!e&&(a=b.bind(a,d));return e?b.reduce(f,a,h,d):b.reduce(f,a)};b.find=b.detect=function(b,c,a){var h;
y(b,function(b,d,e){if(c.call(a,b,d,e))return h=b,true});return h};b.filter=b.select=function(b,c,a){var d=[];if(b==null)return d;if(x&&b.filter===x)return b.filter(c,a);h(b,function(b,h,e){c.call(a,b,h,e)&&(d[d.length]=b)});return d};b.reject=function(b,c,a){var d=[];if(b==null)return d;h(b,function(b,h,e){c.call(a,b,h,e)||(d[d.length]=b)});return d};b.every=b.all=function(b,c,a){var d=true;if(b==null)return d;if(z&&b.every===z)return b.every(c,a);h(b,function(b,h,e){if(!(d=d&&c.call(a,b,h,e)))return l});
return d};var y=b.some=b.any=function(c,a,d){a||(a=b.identity);var e=false;if(c==null)return e;if(r&&c.some===r)return c.some(a,d);h(c,function(b,c,h){if(e||(e=a.call(d,b,c,h)))return l});return!!e};b.include=b.contains=function(b,c){return b==null?false:v&&b.indexOf===v?b.indexOf(c)!=-1:y(b,function(b){return b===c})};b.invoke=function(c,a){var h=m.call(arguments,2);return b.map(c,function(c){return(b.isFunction(a)?a||c:c[a]).apply(c,h)})};b.pluck=function(c,a){return b.map(c,function(b){return b[a]})};
b.max=function(c,a,d){if(!a&&b.isArray(c))return Math.max.apply(Math,c);if(!a&&b.isEmpty(c))return-Infinity;var e={computed:-Infinity};h(c,function(b,c,h){c=a?a.call(d,b,c,h):b;c>=e.computed&&(e={value:b,computed:c})});return e.value};b.min=function(c,a,d){if(!a&&b.isArray(c))return Math.min.apply(Math,c);if(!a&&b.isEmpty(c))return Infinity;var e={computed:Infinity};h(c,function(b,c,h){c=a?a.call(d,b,c,h):b;c<e.computed&&(e={value:b,computed:c})});return e.value};b.shuffle=function(b){var c=[],a;
h(b,function(b,h){h==0?c[0]=b:(a=Math.floor(Math.random()*(h+1)),c[h]=c[a],c[a]=b)});return c};b.sortBy=function(c,a,h){return b.pluck(b.map(c,function(b,c,d){return{value:b,criteria:a.call(h,b,c,d)}}).sort(function(b,c){var a=b.criteria,h=c.criteria;return a<h?-1:a>h?1:0}),"value")};b.groupBy=function(c,a){var d={},e=b.isFunction(a)?a:function(b){return b[a]};h(c,function(b,c){var a=e(b,c);(d[a]||(d[a]=[])).push(b)});return d};b.sortedIndex=function(c,a,h){h||(h=b.identity);for(var d=0,e=c.length;d<
e;){var f=d+e>>1;h(c[f])<h(a)?d=f+1:e=f}return d};b.toArray=function(c){return!c?[]:c.toArray?c.toArray():b.isArray(c)?m.call(c):b.isArguments(c)?m.call(c):b.values(c)};b.size=function(c){return b.toArray(c).length};b.first=b.head=function(b,c,a){return c!=null&&!a?m.call(b,0,c):b[0]};b.initial=function(b,c,a){return m.call(b,0,b.length-(c==null||a?1:c))};b.last=function(b,c,a){return c!=null&&!a?m.call(b,Math.max(b.length-c,0)):b[b.length-1]};b.rest=b.tail=function(b,c,a){return m.call(b,c==null||
a?1:c)};b.compact=function(c){return b.filter(c,function(b){return!!b})};b.flatten=function(c,a){return b.reduce(c,function(c,h){if(b.isArray(h))return c.concat(a?h:b.flatten(h));c[c.length]=h;return c},[])};b.without=function(c){return b.difference(c,m.call(arguments,1))};b.uniq=b.unique=function(c,a,h){var h=h?b.map(c,h):c,d=[];b.reduce(h,function(h,e,f){if(0==f||(a===true?b.last(h)!=e:!b.include(h,e))){h[h.length]=e;d[d.length]=c[f]}return h},[]);return d};b.union=function(){return b.uniq(b.flatten(arguments,
true))};b.intersection=b.intersect=function(c){var a=m.call(arguments,1);return b.filter(b.uniq(c),function(c){return b.every(a,function(a){return b.indexOf(a,c)>=0})})};b.difference=function(c){var a=b.flatten(m.call(arguments,1));return b.filter(c,function(c){return!b.include(a,c)})};b.zip=function(){for(var c=m.call(arguments),a=b.max(b.pluck(c,"length")),h=Array(a),d=0;d<a;d++)h[d]=b.pluck(c,""+d);return h};b.indexOf=function(c,a,h){if(c==null)return-1;var d;if(h)return h=b.sortedIndex(c,a),c[h]===
a?h:-1;if(v&&c.indexOf===v)return c.indexOf(a);h=0;for(d=c.length;h<d;h++)if(h in c&&c[h]===a)return h;return-1};b.lastIndexOf=function(b,c){if(b==null)return-1;if(t&&b.lastIndexOf===t)return b.lastIndexOf(c);for(var a=b.length;a--;)if(a in b&&b[a]===c)return a;return-1};b.range=function(b,c,a){arguments.length<=1&&(c=b||0,b=0);for(var a=arguments[2]||1,h=Math.max(Math.ceil((c-b)/a),0),d=0,e=Array(h);d<h;){e[d++]=b;b=b+a}return e};var C=function(){};b.bind=function(a,h){var d,e;if(a.bind===c&&c)return c.apply(a,
m.call(arguments,1));if(!b.isFunction(a))throw new TypeError;e=m.call(arguments,2);return d=function(){if(!(this instanceof d))return a.apply(h,e.concat(m.call(arguments)));C.prototype=a.prototype;var b=new C,c=a.apply(b,e.concat(m.call(arguments)));return Object(c)===c?c:b}};b.bindAll=function(c){var a=m.call(arguments,1);a.length==0&&(a=b.functions(c));h(a,function(a){c[a]=b.bind(c[a],c)});return c};b.memoize=function(c,a){var h={};a||(a=b.identity);return function(){var d=a.apply(this,arguments);
return b.has(h,d)?h[d]:h[d]=c.apply(this,arguments)}};b.delay=function(b,c){var a=m.call(arguments,2);return setTimeout(function(){return b.apply(b,a)},c)};b.defer=function(c){return b.delay.apply(b,[c,1].concat(m.call(arguments,1)))};b.throttle=function(c,a){var h,d,e,f,j,g=b.debounce(function(){j=f=false},a);return function(){h=this;d=arguments;e||(e=setTimeout(function(){e=null;j&&c.apply(h,d);g()},a));f?j=true:c.apply(h,d);g();f=true}};b.debounce=function(b,c){var a;return function(){var h=this,
d=arguments;clearTimeout(a);a=setTimeout(function(){a=null;b.apply(h,d)},c)}};b.once=function(b){var c=false,a;return function(){if(c)return a;c=true;return a=b.apply(this,arguments)}};b.wrap=function(b,c){return function(){var a=[b].concat(m.call(arguments,0));return c.apply(this,a)}};b.compose=function(){var b=arguments;return function(){for(var c=arguments,a=b.length-1;a>=0;a--)c=[b[a].apply(this,c)];return c[0]}};b.after=function(b,c){return b<=0?c():function(){if(--b<1)return c.apply(this,arguments)}};
b.keys=w||function(c){if(c!==Object(c))throw new TypeError("Invalid object");var a=[],h;for(h in c)b.has(c,h)&&(a[a.length]=h);return a};b.values=function(c){return b.map(c,b.identity)};b.functions=b.methods=function(c){var a=[],h;for(h in c)b.isFunction(c[h])&&a.push(h);return a.sort()};b.extend=function(b){h(m.call(arguments,1),function(c){for(var a in c)b[a]=c[a]});return b};b.defaults=function(b){h(m.call(arguments,1),function(c){for(var a in c)b[a]==null&&(b[a]=c[a])});return b};b.clone=function(c){return!b.isObject(c)?
c:b.isArray(c)?c.slice():b.extend({},c)};b.tap=function(b,c){c(b);return b};b.isEqual=function(b,c){return f(b,c,[])};b.isEmpty=function(c){if(b.isArray(c)||b.isString(c))return c.length===0;for(var a in c)if(b.has(c,a))return false;return true};b.isElement=function(b){return!!(b&&b.nodeType==1)};b.isArray=k||function(b){return e.call(b)=="[object Array]"};b.isObject=function(b){return b===Object(b)};b.isArguments=function(b){return e.call(b)=="[object Arguments]"};b.isArguments(arguments)||(b.isArguments=
function(c){return!(!c||!b.has(c,"callee"))});b.isFunction=function(b){return e.call(b)=="[object Function]"};b.isString=function(b){return e.call(b)=="[object String]"};b.isNumber=function(b){return e.call(b)=="[object Number]"};b.isNaN=function(b){return b!==b};b.isBoolean=function(b){return b===true||b===false||e.call(b)=="[object Boolean]"};b.isDate=function(b){return e.call(b)=="[object Date]"};b.isRegExp=function(b){return e.call(b)=="[object RegExp]"};b.isNull=function(b){return b===null};
b.isUndefined=function(b){return b===void 0};b.has=function(b,c){return j.call(b,c)};b.noConflict=function(){a._=o;return this};b.identity=function(b){return b};b.times=function(b,c,a){for(var h=0;h<b;h++)c.call(a,h)};b.escape=function(b){return(""+b).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};b.mixin=function(c){h(b.functions(c),function(a){G(a,b[a]=c[a])})};var F=0;b.uniqueId=function(b){var c=F++;return b?
b+c:c};b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var E=/.^/,D=function(b){return b.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};b.template=function(c,a){var h=b.templateSettings,h="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+c.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(h.escape||E,function(b,c){return"',_.escape("+D(c)+"),'"}).replace(h.interpolate||E,function(b,c){return"',"+D(c)+",'"}).replace(h.evaluate||
E,function(b,c){return"');"+D(c).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",d=new Function("obj","_",h);return a?d(a,b):function(c){return d.call(this,c,b)}};b.chain=function(c){return b(c).chain()};var A=function(b){this._wrapped=b};b.prototype=A.prototype;var B=function(c,a){return a?b(c).chain():c},G=function(c,a){A.prototype[c]=function(){var c=m.call(arguments);d.call(c,this._wrapped);return B(a.apply(b,c),
this._chain)}};b.mixin(b);h("pop,push,reverse,shift,sort,splice,unshift".split(","),function(b){var c=g[b];A.prototype[b]=function(){var a=this._wrapped;c.apply(a,arguments);var h=a.length;(b=="shift"||b=="splice")&&h===0&&delete a[0];return B(a,this._chain)}});h(["concat","join","slice"],function(b){var c=g[b];A.prototype[b]=function(){return B(c.apply(this._wrapped,arguments),this._chain)}});A.prototype.chain=function(){this._chain=true;return this};A.prototype.value=function(){return this._wrapped}}).call(this);(function(){var f=this,a=f.Backbone,o=Array.prototype.slice,l=Array.prototype.splice,g;g="undefined"!==typeof exports?exports:f.Backbone={};g.VERSION="0.9.1";var k=f._;!k&&"undefined"!==typeof require&&(k=require("underscore"));var m=f.jQuery||f.Zepto||f.ender;g.setDomLibrary=function(c){m=c};g.noConflict=function(){f.Backbone=a;return this};g.emulateHTTP=!1;g.emulateJSON=!1;g.Events={on:function(c,b,a){for(var d,c=c.split(/\s+/),e=this._callbacks||(this._callbacks={});d=c.shift();){d=e[d]||(e[d]=
{});var f=d.tail||(d.tail=d.next={});f.callback=b;f.context=a;d.tail=f.next={}}return this},off:function(c,b,a){var d,e,f;if(c){if(e=this._callbacks)for(c=c.split(/\s+/);d=c.shift();)if(f=e[d],delete e[d],b&&f)for(;(f=f.next)&&f.next;)if(!(f.callback===b&&(!a||f.context===a)))this.on(d,f.callback,f.context)}else delete this._callbacks;return this},trigger:function(c){var b,a,d,e;if(!(d=this._callbacks))return this;e=d.all;for((c=c.split(/\s+/)).push(null);b=c.shift();)e&&c.push({next:e.next,tail:e.tail,
event:b}),(a=d[b])&&c.push({next:a.next,tail:a.tail});for(e=o.call(arguments,1);a=c.pop();){b=a.tail;for(d=a.event?[a.event].concat(e):e;(a=a.next)!==b;)a.callback.apply(a.context||this,d)}return this}};g.Events.bind=g.Events.on;g.Events.unbind=g.Events.off;g.Model=function(c,b){var a;c||(c={});b&&b.parse&&(c=this.parse(c));if(a=t(this,"defaults"))c=k.extend({},a,c);b&&b.collection&&(this.collection=b.collection);this.attributes={};this._escapedAttributes={};this.cid=k.uniqueId("c");if(!this.set(c,
{silent:!0}))throw Error("Can't create an invalid model");delete this._changed;this._previousAttributes=k.clone(this.attributes);this.initialize.apply(this,arguments)};k.extend(g.Model.prototype,g.Events,{idAttribute:"id",initialize:function(){},toJSON:function(){return k.clone(this.attributes)},get:function(c){return this.attributes[c]},escape:function(c){var b;if(b=this._escapedAttributes[c])return b;b=this.attributes[c];return this._escapedAttributes[c]=k.escape(null==b?"":""+b)},has:function(c){return null!=
this.attributes[c]},set:function(c,b,a){var d,e;k.isObject(c)||null==c?(d=c,a=b):(d={},d[c]=b);a||(a={});if(!d)return this;d instanceof g.Model&&(d=d.attributes);if(a.unset)for(e in d)d[e]=void 0;if(!this._validate(d,a))return!1;this.idAttribute in d&&(this.id=d[this.idAttribute]);var b=this.attributes,f=this._escapedAttributes,j=this._previousAttributes||{},l=this._setting;this._changed||(this._changed={});this._setting=!0;for(e in d)if(c=d[e],k.isEqual(b[e],c)||delete f[e],a.unset?delete b[e]:b[e]=
c,this._changing&&!k.isEqual(this._changed[e],c)&&(this.trigger("change:"+e,this,c,a),this._moreChanges=!0),delete this._changed[e],!k.isEqual(j[e],c)||k.has(b,e)!=k.has(j,e))this._changed[e]=c;l||(!a.silent&&this.hasChanged()&&this.change(a),this._setting=!1);return this},unset:function(c,b){(b||(b={})).unset=!0;return this.set(c,null,b)},clear:function(c){(c||(c={})).unset=!0;return this.set(k.clone(this.attributes),c)},fetch:function(c){var c=c?k.clone(c):{},b=this,a=c.success;c.success=function(d,
e,f){if(!b.set(b.parse(d,f),c))return!1;a&&a(b,d)};c.error=g.wrapError(c.error,b,c);return(this.sync||g.sync).call(this,"read",this,c)},save:function(c,b,a){var d,e;k.isObject(c)||null==c?(d=c,a=b):(d={},d[c]=b);a=a?k.clone(a):{};a.wait&&(e=k.clone(this.attributes));c=k.extend({},a,{silent:!0});if(d&&!this.set(d,a.wait?c:a))return!1;var f=this,j=a.success;a.success=function(b,c,e){c=f.parse(b,e);a.wait&&(c=k.extend(d||{},c));if(!f.set(c,a))return!1;j?j(f,b):f.trigger("sync",f,b,a)};a.error=g.wrapError(a.error,
f,a);b=this.isNew()?"create":"update";b=(this.sync||g.sync).call(this,b,this,a);a.wait&&this.set(e,c);return b},destroy:function(c){var c=c?k.clone(c):{},b=this,a=c.success,d=function(){b.trigger("destroy",b,b.collection,c)};if(this.isNew())return d();c.success=function(e){c.wait&&d();a?a(b,e):b.trigger("sync",b,e,c)};c.error=g.wrapError(c.error,b,c);var e=(this.sync||g.sync).call(this,"delete",this,c);c.wait||d();return e},url:function(){var c=t(this.collection,"url")||t(this,"urlRoot")||w();return this.isNew()?
c:c+("/"==c.charAt(c.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(c){return c},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(c){if(this._changing||!this.hasChanged())return this;this._moreChanges=this._changing=!0;for(var b in this._changed)this.trigger("change:"+b,this,this._changed[b],c);for(;this._moreChanges;)this._moreChanges=!1,this.trigger("change",this,c);this._previousAttributes=k.clone(this.attributes);
delete this._changed;this._changing=!1;return this},hasChanged:function(c){return!arguments.length?!k.isEmpty(this._changed):this._changed&&k.has(this._changed,c)},changedAttributes:function(c){if(!c)return this.hasChanged()?k.clone(this._changed):!1;var b,a=!1,d=this._previousAttributes,e;for(e in c)if(!k.isEqual(d[e],b=c[e]))(a||(a={}))[e]=b;return a},previous:function(c){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[c]},previousAttributes:function(){return k.clone(this._previousAttributes)},
isValid:function(){return!this.validate(this.attributes)},_validate:function(c,b){if(b.silent||!this.validate)return!0;var c=k.extend({},this.attributes,c),a=this.validate(c,b);if(!a)return!0;b&&b.error?b.error(this,a,b):this.trigger("error",this,a,b);return!1}});g.Collection=function(c,b){b||(b={});b.comparator&&(this.comparator=b.comparator);this._reset();this.initialize.apply(this,arguments);c&&this.reset(c,{silent:!0,parse:b.parse})};k.extend(g.Collection.prototype,g.Events,{model:g.Model,initialize:function(){},
toJSON:function(){return this.map(function(c){return c.toJSON()})},add:function(c,b){var a,d,e,f,j,g={},n={};b||(b={});c=k.isArray(c)?c.slice():[c];a=0;for(d=c.length;a<d;a++){if(!(e=c[a]=this._prepareModel(c[a],b)))throw Error("Can't add an invalid model to a collection");if(g[f=e.cid]||this._byCid[f]||null!=(j=e.id)&&(n[j]||this._byId[j]))throw Error("Can't add the same model to a collection twice");g[f]=n[j]=e}for(a=0;a<d;a++)(e=c[a]).on("all",this._onModelEvent,this),this._byCid[e.cid]=e,null!=
e.id&&(this._byId[e.id]=e);this.length+=d;l.apply(this.models,[null!=b.at?b.at:this.models.length,0].concat(c));this.comparator&&this.sort({silent:!0});if(b.silent)return this;a=0;for(d=this.models.length;a<d;a++)if(g[(e=this.models[a]).cid])b.index=a,e.trigger("add",e,this,b);return this},remove:function(c,b){var a,d,e,f;b||(b={});c=k.isArray(c)?c.slice():[c];a=0;for(d=c.length;a<d;a++)if(f=this.getByCid(c[a])||this.get(c[a]))delete this._byId[f.id],delete this._byCid[f.cid],e=this.indexOf(f),this.models.splice(e,
1),this.length--,b.silent||(b.index=e,f.trigger("remove",f,this,b)),this._removeReference(f);return this},get:function(c){return null==c?null:this._byId[null!=c.id?c.id:c]},getByCid:function(c){return c&&this._byCid[c.cid||c]},at:function(c){return this.models[c]},sort:function(c){c||(c={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var b=k.bind(this.comparator,this);1==this.comparator.length?this.models=this.sortBy(b):this.models.sort(b);c.silent||this.trigger("reset",
this,c);return this},pluck:function(c){return k.map(this.models,function(b){return b.get(c)})},reset:function(c,b){c||(c=[]);b||(b={});for(var a=0,d=this.models.length;a<d;a++)this._removeReference(this.models[a]);this._reset();this.add(c,{silent:!0,parse:b.parse});b.silent||this.trigger("reset",this,b);return this},fetch:function(c){c=c?k.clone(c):{};void 0===c.parse&&(c.parse=!0);var b=this,a=c.success;c.success=function(d,e,f){b[c.add?"add":"reset"](b.parse(d,f),c);a&&a(b,d)};c.error=g.wrapError(c.error,
b,c);return(this.sync||g.sync).call(this,"read",this,c)},create:function(c,b){var a=this,b=b?k.clone(b):{},c=this._prepareModel(c,b);if(!c)return!1;b.wait||a.add(c,b);var d=b.success;b.success=function(e,f){b.wait&&a.add(e,b);d?d(e,f):e.trigger("sync",c,f,b)};c.save(null,b);return c},parse:function(c){return c},chain:function(){return k(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(c,b){c instanceof g.Model?c.collection||
(c.collection=this):(b.collection=this,c=new this.model(c,b),c._validate(c.attributes,b)||(c=!1));return c},_removeReference:function(c){this==c.collection&&delete c.collection;c.off("all",this._onModelEvent,this)},_onModelEvent:function(c,b,a,d){("add"==c||"remove"==c)&&a!=this||("destroy"==c&&this.remove(b,d),b&&c==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments))}});k.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),
function(c){g.Collection.prototype[c]=function(){return k[c].apply(k,[this.models].concat(k.toArray(arguments)))}});g.Router=function(c){c||(c={});c.routes&&(this.routes=c.routes);this._bindRoutes();this.initialize.apply(this,arguments)};var d=/:\w+/g,e=/\*\w+/g,j=/[-[\]{}()+?.,\\^$|#\s]/g;k.extend(g.Router.prototype,g.Events,{initialize:function(){},route:function(c,b,a){g.history||(g.history=new g.History);k.isRegExp(c)||(c=this._routeToRegExp(c));a||(a=this[b]);g.history.route(c,k.bind(function(d){d=
this._extractParameters(c,d);a&&a.apply(this,d);this.trigger.apply(this,["route:"+b].concat(d));g.history.trigger("route",this,b,d)},this));return this},navigate:function(c,b){g.history.navigate(c,b)},_bindRoutes:function(){if(this.routes){var c=[],b;for(b in this.routes)c.unshift([b,this.routes[b]]);b=0;for(var a=c.length;b<a;b++)this.route(c[b][0],c[b][1],this[c[b][1]])}},_routeToRegExp:function(c){c=c.replace(j,"\\$&").replace(d,"([^/]+)").replace(e,"(.*?)");return RegExp("^"+c+"$")},_extractParameters:function(c,
b){return c.exec(b).slice(1)}});g.History=function(){this.handlers=[];k.bindAll(this,"checkUrl")};var s=/^[#\/]/,n=/msie [\w.]+/,q=!1;k.extend(g.History.prototype,g.Events,{interval:50,getFragment:function(c,b){if(null==c)if(this._hasPushState||b){var c=window.location.pathname,a=window.location.search;a&&(c+=a)}else c=window.location.hash;c=decodeURIComponent(c);c.indexOf(this.options.root)||(c=c.substr(this.options.root.length));return c.replace(s,"")},start:function(c){if(q)throw Error("Backbone.history has already been started");
this.options=k.extend({},{root:"/"},this.options,c);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);var c=this.getFragment(),b=document.documentMode;if(b=n.exec(navigator.userAgent.toLowerCase())&&(!b||7>=b))this.iframe=m('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(c);this._hasPushState?m(window).bind("popstate",
this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!b?m(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));this.fragment=c;q=!0;c=window.location;b=c.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&b&&c.hash&&
(this.fragment=c.hash.replace(s,""),window.history.replaceState({},document.title,c.protocol+"//"+c.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){m(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);q=!1},route:function(c,b){this.handlers.unshift({route:c,callback:b})},checkUrl:function(){var c=this.getFragment();c==this.fragment&&this.iframe&&(c=this.getFragment(this.iframe.location.hash));
if(c==this.fragment||c==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(c);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(c){var b=this.fragment=this.getFragment(c);return k.any(this.handlers,function(c){if(c.route.test(b))return c.callback(b),!0})},navigate:function(c,b){if(!q)return!1;if(!b||!0===b)b={trigger:b};var a=(c||"").replace(s,"");this.fragment==a||this.fragment==decodeURIComponent(a)||(this._hasPushState?(0!=a.indexOf(this.options.root)&&(a=
this.options.root+a),this.fragment=a,window.history[b.replace?"replaceState":"pushState"]({},document.title,a)):this._wantsHashChange?(this.fragment=a,this._updateHash(window.location,a,b.replace),this.iframe&&a!=this.getFragment(this.iframe.location.hash)&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))):window.location.assign(this.options.root+c),b.trigger&&this.loadUrl(c))},_updateHash:function(c,b,a){a?c.replace(c.toString().replace(/(javascript:|#).*$/,
"")+"#"+b):c.hash=b}});g.View=function(c){this.cid=k.uniqueId("view");this._configure(c||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var u=/^(\S+)\s*(.*)$/,x="model,collection,el,id,attributes,className,tagName".split(",");k.extend(g.View.prototype,g.Events,{tagName:"div",$:function(c){return this.$el.find(c)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(c,b,a){c=document.createElement(c);
b&&m(c).attr(b);a&&m(c).html(a);return c},setElement:function(c,b){this.$el=m(c);this.el=this.$el[0];!1!==b&&this.delegateEvents();return this},delegateEvents:function(c){if(c||(c=t(this,"events"))){this.undelegateEvents();for(var b in c){var a=c[b];k.isFunction(a)||(a=this[c[b]]);if(!a)throw Error('Event "'+c[b]+'" does not exist');var d=b.match(u),e=d[1],d=d[2],a=k.bind(a,this),e=e+(".delegateEvents"+this.cid);""===d?this.$el.bind(e,a):this.$el.delegate(d,e,a)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+
this.cid)},_configure:function(c){this.options&&(c=k.extend({},this.options,c));for(var b=0,a=x.length;b<a;b++){var d=x[b];c[d]&&(this[d]=c[d])}this.options=c},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var c=t(this,"attributes")||{};this.id&&(c.id=this.id);this.className&&(c["class"]=this.className);this.setElement(this.make(this.tagName,c),!1)}}});g.Model.extend=g.Collection.extend=g.Router.extend=g.View.extend=function(c,b){var a=v(this,c,b);a.extend=this.extend;return a};
var z={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};g.sync=function(c,b,a){var d=z[c],e={type:d,dataType:"json"};a.url||(e.url=t(b,"url")||w());if(!a.data&&b&&("create"==c||"update"==c))e.contentType="application/json",e.data=JSON.stringify(b.toJSON());g.emulateJSON&&(e.contentType="application/x-www-form-urlencoded",e.data=e.data?{model:e.data}:{});if(g.emulateHTTP&&("PUT"===d||"DELETE"===d))g.emulateJSON&&(e.data._method=d),e.type="POST",e.beforeSend=function(b){b.setRequestHeader("X-HTTP-Method-Override",
d)};"GET"!==e.type&&!g.emulateJSON&&(e.processData=!1);return m.ajax(k.extend(e,a))};g.wrapError=function(c,b,a){return function(d,e){e=d===b?e:d;c?c(b,e,a):b.trigger("error",b,e,a)}};var r=function(){},v=function(c,b,a){var d;d=b&&b.hasOwnProperty("constructor")?b.constructor:function(){c.apply(this,arguments)};k.extend(d,c);r.prototype=c.prototype;d.prototype=new r;b&&k.extend(d.prototype,b);a&&k.extend(d,a);d.prototype.constructor=d;d.__super__=c.prototype;return d},t=function(c,b){return!c||!c[b]?
null:k.isFunction(c[b])?c[b]():c[b]},w=function(){throw Error('A "url" property or function must be specified');}}).call(this);(function(){var f,a,o;"undefined"===typeof window?(f=require("underscore"),a=require("backbone"),o=module.exports=a):(f=window._,a=window.Backbone,o=window);a.Relational={showWarnings:!0};a.Semaphore={_permitsAvailable:null,_permitsUsed:0,acquire:function(){if(this._permitsAvailable&&this._permitsUsed>=this._permitsAvailable)throw Error("Max permits acquired");this._permitsUsed++},release:function(){if(this._permitsUsed===0)throw Error("All permits released");this._permitsUsed--},isLocked:function(){return this._permitsUsed>
0},setAvailablePermits:function(a){if(this._permitsUsed>a)throw Error("Available permits cannot be less than used permits");this._permitsAvailable=a}};a.BlockingQueue=function(){this._queue=[]};f.extend(a.BlockingQueue.prototype,a.Semaphore,{_queue:null,add:function(a){this.isBlocked()?this._queue.push(a):a()},process:function(){for(;this._queue&&this._queue.length;)this._queue.shift()()},block:function(){this.acquire()},unblock:function(){this.release();this.isBlocked()||this.process()},isBlocked:function(){return this.isLocked()}});
a.Relational.eventQueue=new a.BlockingQueue;a.Store=function(){this._collections=[];this._reverseRelations=[]};f.extend(a.Store.prototype,a.Events,{_collections:null,_reverseRelations:null,addReverseRelation:function(a){if(!f.any(this._reverseRelations,function(e){return f.all(a,function(a,d){return a===e[d]})})&&a.model&&a.type){this._reverseRelations.push(a);if(!a.model.prototype.relations)a.model.prototype.relations=[];a.model.prototype.relations.push(a);this.retroFitRelation(a)}},retroFitRelation:function(a){this.getCollection(a.model).each(function(e){new a.type(e,
a)},this)},getCollection:function(a){var e=f.detect(this._collections,function(e){return a===e.model||a.constructor===e.model});e||(e=this._createCollection(a));return e},getObjectByName:function(a){a=f.reduce(a.split("."),function(a,d){return a[d]},o);return a!==o?a:null},_createCollection:function(d){var e;if(d instanceof a.RelationalModel)d=d.constructor;if(d.prototype instanceof a.RelationalModel.prototype.constructor){e=new a.Collection;e.model=d;this._collections.push(e)}return e},find:function(a,
e){var f=this.getCollection(a);return f&&f.get(e)},register:function(a){var e=a.collection,f=this.getCollection(a);f&&f.add(a);a.bind("destroy",this.unregister,this);a.collection=e},update:function(a){var e=this.getCollection(a);e._onModelEvent("change:"+a.idAttribute,a,e)},unregister:function(a){a.unbind("destroy",this.unregister);var e=this.getCollection(a);e&&e.remove(a)}});a.Relational.store=new a.Store;a.Relation=function(d,e){this.instance=d;e=typeof e==="object"&&e||{};this.reverseRelation=
f.defaults(e.reverseRelation||{},this.options.reverseRelation);this.reverseRelation.type=!f.isString(this.reverseRelation.type)?this.reverseRelation.type:a[this.reverseRelation.type]||a.Relational.store.getObjectByName(this.reverseRelation.type);this.model=e.model||this.instance.constructor;this.options=f.defaults(e,this.options,a.Relation.prototype.options);this.key=this.options.key;this.keySource=this.options.keySource||this.key;this.relatedModel=this.options.relatedModel;if(f.isString(this.relatedModel))this.relatedModel=
a.Relational.store.getObjectByName(this.relatedModel);if(!this.checkPreconditions())return false;if(d){this.keyContents=this.instance.get(this.keySource);this.key!==this.keySource&&this.instance.unset(this.keySource,{silent:true});this.instance._relations.push(this)}!this.options.isAutoRelation&&this.reverseRelation.type&&this.reverseRelation.key&&a.Relational.store.addReverseRelation(f.defaults({isAutoRelation:true,model:this.relatedModel,relatedModel:this.model,reverseRelation:this.options},this.reverseRelation));
f.bindAll(this,"_modelRemovedFromCollection","_relatedModelAdded","_relatedModelRemoved");if(d){this.initialize();a.Relational.store.getCollection(this.instance).bind("relational:remove",this._modelRemovedFromCollection);a.Relational.store.getCollection(this.relatedModel).bind("relational:add",this._relatedModelAdded).bind("relational:remove",this._relatedModelRemoved)}};a.Relation.extend=a.Model.extend;f.extend(a.Relation.prototype,a.Events,a.Semaphore,{options:{createModels:!0,includeInJSON:!0,
isAutoRelation:!1},instance:null,key:null,keyContents:null,relatedModel:null,reverseRelation:null,related:null,_relatedModelAdded:function(a,e,f){var g=this;a.queue(function(){g.tryAddRelated(a,f)})},_relatedModelRemoved:function(a,e,f){this.removeRelated(a,f)},_modelRemovedFromCollection:function(a){a===this.instance&&this.destroy()},checkPreconditions:function(){var d=this.instance,e=this.key,j=this.model,g=this.relatedModel,k=a.Relational.showWarnings&&typeof console!=="undefined";if(!j||!e||!g){k&&
console.warn("Relation=%o; no model, key or relatedModel (%o, %o, %o)",this,j,e,g);return false}if(!(j.prototype instanceof a.RelationalModel.prototype.constructor)){k&&console.warn("Relation=%o; model does not inherit from Backbone.RelationalModel (%o)",this,d);return false}if(!(g.prototype instanceof a.RelationalModel.prototype.constructor)){k&&console.warn("Relation=%o; relatedModel does not inherit from Backbone.RelationalModel (%o)",this,g);return false}if(this instanceof a.HasMany&&this.reverseRelation.type===
a.HasMany.prototype.constructor){k&&console.warn("Relation=%o; relation is a HasMany, and the reverseRelation is HasMany as well.",this);return false}if(d&&d._relations.length&&f.any(d._relations,function(a){var d=this.reverseRelation.key&&a.reverseRelation.key;return a.relatedModel===g&&a.key===e&&(!d||this.reverseRelation.key===a.reverseRelation.key)},this)){k&&console.warn("Relation=%o between instance=%o.%s and relatedModel=%o.%s already exists",this,d,e,g,this.reverseRelation.key);return false}return true},
setRelated:function(a,e){this.related=a;this.instance.acquire();this.instance.set(this.key,a,f.defaults(e||{},{silent:true}));this.instance.release()},createModel:function(a){if(this.options.createModels&&typeof a==="object")return new this.relatedModel(a)},_isReverseRelation:function(a){return a.instance instanceof this.relatedModel&&this.reverseRelation.key===a.key&&this.key===a.reverseRelation.key?true:false},getReverseRelations:function(a){var e=[],a=!f.isUndefined(a)?[a]:this.related&&(this.related.models||
[this.related]);f.each(a,function(a){f.each(a.getRelations(),function(a){this._isReverseRelation(a)&&e.push(a)},this)},this);return e},sanitizeOptions:function(a){a||(a={});if(a.silent){a=f.extend({},a,{silentChange:true});delete a.silent}return a},destroy:function(){a.Relational.store.getCollection(this.instance).unbind("relational:remove",this._modelRemovedFromCollection);a.Relational.store.getCollection(this.relatedModel).unbind("relational:add",this._relatedModelAdded).unbind("relational:remove",
this._relatedModelRemoved);f.each(this.getReverseRelations(),function(a){a.removeRelated(this.instance)},this)}});a.HasOne=a.Relation.extend({options:{reverseRelation:{type:"HasMany"}},initialize:function(){f.bindAll(this,"onChange");this.instance.bind("relational:change:"+this.key,this.onChange);this.setRelated(this.findRelated({silent:true}));var a=this;f.each(a.getReverseRelations(),function(e){e.addRelated(a.instance)})},findRelated:function(d){var e=this.keyContents,j=null;if(e instanceof this.relatedModel)j=
e;else if(e&&(f.isString(e)||f.isNumber(e)||typeof e==="object")){j=f.isString(e)||f.isNumber(e)?e:e[this.relatedModel.prototype.idAttribute];(j=a.Relational.store.find(this.relatedModel,j))&&f.isObject(e)?j.set(e,d):j||(j=this.createModel(e))}return j},onChange:function(d,e,j){if(!this.isLocked()){this.acquire();var j=this.sanitizeOptions(j),g=(d=f.isUndefined(j._related))?this.related:j._related;if(d){this.keyContents=e;e instanceof this.relatedModel?this.related=e:e?this.setRelated(this.findRelated(j)):
this.setRelated(null)}g&&this.related!==g&&f.each(this.getReverseRelations(g),function(a){a.removeRelated(this.instance,j)},this);f.each(this.getReverseRelations(),function(a){a.addRelated(this.instance,j)},this);if(!j.silentChange&&this.related!==g){var k=this;a.Relational.eventQueue.add(function(){k.instance.trigger("update:"+k.key,k.instance,k.related,j)})}this.release()}},tryAddRelated:function(a,e){if(!this.related){var e=this.sanitizeOptions(e),j=this.keyContents;if(j&&(f.isString(j)||f.isNumber(j)||
typeof j==="object")){j=f.isString(j)||f.isNumber(j)?j:j[this.relatedModel.prototype.idAttribute];a.id===j&&this.addRelated(a,e)}}},addRelated:function(a){if(a!==this.related){var e=this.related||null;this.setRelated(a);this.onChange(this.instance,a,{_related:e})}},removeRelated:function(a){if(this.related&&a===this.related){var e=this.related||null;this.setRelated(null);this.onChange(this.instance,a,{_related:e})}}});a.HasMany=a.Relation.extend({collectionType:null,options:{reverseRelation:{type:"HasOne"},
collectionType:a.Collection,collectionKey:!0},initialize:function(){f.bindAll(this,"onChange","handleAddition","handleRemoval","handleReset");this.instance.bind("relational:change:"+this.key,this.onChange);this.collectionType=this.options.collectionType;if(f(this.collectionType).isString())this.collectionType=a.Relational.store.getObjectByName(this.collectionType);if(!this.collectionType.prototype instanceof a.Collection.prototype.constructor)throw Error("collectionType must inherit from Backbone.Collection");
this.setRelated(this.prepareCollection(new this.collectionType));this.findRelated({silent:true})},prepareCollection:function(d){this.related&&this.related.unbind("relational:add",this.handleAddition).unbind("relational:remove",this.handleRemoval).unbind("relational:reset",this.handleReset);d.reset();d.model=this.relatedModel;if(this.options.collectionKey){var e=this.options.collectionKey===true?this.options.reverseRelation.key:this.options.collectionKey;d[e]&&d[e]!==this.instance?a.Relational.showWarnings&&
typeof console!=="undefined"&&console.warn("Relation=%o; collectionKey=%s already exists on collection=%o",this,e,this.options.collectionKey):d[e]=this.instance}d.bind("relational:add",this.handleAddition).bind("relational:remove",this.handleRemoval).bind("relational:reset",this.handleReset);return d},findRelated:function(d){if(this.keyContents){this.keyContents=f.isArray(this.keyContents)?this.keyContents:[this.keyContents];f.each(this.keyContents,function(e){var j=f.isString(e)||f.isNumber(e)?e:
e[this.relatedModel.prototype.idAttribute];(j=a.Relational.store.find(this.relatedModel,j))&&f.isObject(e)?j.set(e,d):j||(j=this.createModel(e));j&&!this.related.getByCid(j)&&!this.related.get(j)&&this.related.add(j)},this)}},onChange:function(d,e,j){j=this.sanitizeOptions(j);this.keyContents=e;f.each(this.getReverseRelations(),function(a){a.removeRelated(this.instance,j)},this);if(e instanceof a.Collection){this.prepareCollection(e);this.related=e}else{this.setRelated(this.prepareCollection(this.related instanceof
a.Collection?this.related:new this.collectionType));this.findRelated(j)}f.each(this.getReverseRelations(),function(a){a.addRelated(this.instance,j)},this);var g=this;a.Relational.eventQueue.add(function(){!j.silentChange&&g.instance.trigger("update:"+g.key,g.instance,g.related,j)})},tryAddRelated:function(a,e){e=this.sanitizeOptions(e);!this.related.getByCid(a)&&!this.related.get(a)&&f.any(this.keyContents,function(e){return(e=f.isString(e)||f.isNumber(e)?e:e[this.relatedModel.prototype.idAttribute])&&
e===a.id},this)&&this.related.add(a,e)},handleAddition:function(d,e,j){if(d instanceof a.Model){j=this.sanitizeOptions(j);f.each(this.getReverseRelations(d),function(a){a.addRelated(this.instance,j)},this);var g=this;a.Relational.eventQueue.add(function(){!j.silentChange&&g.instance.trigger("add:"+g.key,d,g.related,j)})}},handleRemoval:function(d,e,j){if(d instanceof a.Model){j=this.sanitizeOptions(j);f.each(this.getReverseRelations(d),function(a){a.removeRelated(this.instance,j)},this);var g=this;
a.Relational.eventQueue.add(function(){!j.silentChange&&g.instance.trigger("remove:"+g.key,d,g.related,j)})}},handleReset:function(d,e){var e=this.sanitizeOptions(e),f=this;a.Relational.eventQueue.add(function(){!e.silentChange&&f.instance.trigger("reset:"+f.key,f.related,e)})},addRelated:function(a,e){var f=this;a.queue(function(){f.related&&!f.related.getByCid(a)&&!f.related.get(a)&&f.related.add(a,e)})},removeRelated:function(a,e){(this.related.getByCid(a)||this.related.get(a))&&this.related.remove(a,
e)}});a.RelationalModel=a.Model.extend({relations:null,_relations:null,_isInitialized:!1,_deferProcessing:!1,_queue:null,constructor:function(d,e){var g=this;if(e&&e.collection){this._deferProcessing=true;var k=function(a){if(a===g){g._deferProcessing=false;g.processQueue();e.collection.unbind("relational:add",k)}};e.collection.bind("relational:add",k);f.defer(function(){k(g)})}this._queue=new a.BlockingQueue;this._queue.block();a.Relational.eventQueue.block();a.Model.prototype.constructor.apply(this,
arguments);a.Relational.eventQueue.unblock()},trigger:function(d){if(d.length>5&&"change"===d.substr(0,6)){var e=this,f=arguments;a.Relational.eventQueue.add(function(){a.Model.prototype.trigger.apply(e,f)})}else a.Model.prototype.trigger.apply(this,arguments);return this},initializeRelations:function(){this.acquire();this._relations=[];f.each(this.relations,function(d){var e=!f.isString(d.type)?d.type:a[d.type]||a.Relational.store.getObjectByName(d.type);e&&e.prototype instanceof a.Relation.prototype.constructor?
new e(this,d):a.Relational.showWarnings&&typeof console!=="undefined"&&console.warn("Relation=%o; missing or invalid type!",d)},this);this._isInitialized=true;this.release();this.processQueue()},updateRelations:function(a){this._isInitialized&&!this.isLocked()&&f.each(this._relations,function(e){var f=this.attributes[e.key];e.related!==f&&this.trigger("relational:change:"+e.key,this,f,a||{})},this)},queue:function(a){this._queue.add(a)},processQueue:function(){this._isInitialized&&!this._deferProcessing&&
this._queue.isBlocked()&&this._queue.unblock()},getRelation:function(a){return f.detect(this._relations,function(e){if(e.key===a)return true},this)},getRelations:function(){return this._relations},fetchRelated:function(d,e){e||(e={});var g,k=[],l=this.getRelation(d),m=l&&l.keyContents;if((m=m&&f.select(f.isArray(m)?m:[m],function(e){return(e=f.isString(e)||f.isNumber(e)?e:e[l.relatedModel.prototype.idAttribute])&&!a.Relational.store.find(l.relatedModel,e)},this))&&m.length){var o=f.map(m,function(a){if(typeof a===
"object")a=new l.relatedModel(a);else{var e={};e[l.relatedModel.prototype.idAttribute]=a;a=new l.relatedModel(e)}return a},this);l.related instanceof a.Collection&&f.isFunction(l.related.url)&&(g=l.related.url(o));if(g&&g!==l.related.url()){g=f.defaults({error:function(){var a=arguments;f.each(o,function(d){d.trigger("destroy",d,d.collection,e);e.error&&e.error.apply(d,a)})},url:g},e,{add:true});k=[l.related.fetch(g)]}else k=f.map(o,function(a){var d=f.defaults({error:function(){a.trigger("destroy",
a,a.collection,e);e.error&&e.error.apply(a,arguments)}},e);return a.fetch(d)},this)}return k},set:function(d,e,g){a.Relational.eventQueue.block();var k;if(f.isObject(d)||d==null){k=d;g=e}else{k={};k[d]=e}var l=a.Model.prototype.set.apply(this,arguments);if(!this._isInitialized&&!this.isLocked()){a.Relational.store.register(this);this.initializeRelations()}else k&&this.idAttribute in k&&a.Relational.store.update(this);k&&this.updateRelations(g);a.Relational.eventQueue.unblock();return l},unset:function(d,
e){a.Relational.eventQueue.block();var f=a.Model.prototype.unset.apply(this,arguments);this.updateRelations(e);a.Relational.eventQueue.unblock();return f},clear:function(d){a.Relational.eventQueue.block();var e=a.Model.prototype.clear.apply(this,arguments);this.updateRelations(d);a.Relational.eventQueue.unblock();return e},change:function(){var d=this;a.Relational.eventQueue.add(function(){a.Model.prototype.change.apply(d,arguments)})},clone:function(){var a=f.clone(this.attributes);f.isUndefined(a[this.idAttribute])||
(a[this.idAttribute]=null);f.each(this.getRelations(),function(e){delete a[e.key]});return new this.constructor(a)},toJSON:function(){if(this.isLocked())return this.id;this.acquire();var d=a.Model.prototype.toJSON.call(this);f.each(this._relations,function(e){var g=d[e.key];e.options.includeInJSON===true&&g&&f.isFunction(g.toJSON)?d[e.keySource]=g.toJSON():f.isString(e.options.includeInJSON)?g instanceof a.Collection?d[e.keySource]=g.pluck(e.options.includeInJSON):g instanceof a.Model&&(d[e.keySource]=
g.get(e.options.includeInJSON)):delete d[e.key];e.keySource!==e.key&&delete d[e.key]},this);this.release();return d}});f.extend(a.RelationalModel.prototype,a.Semaphore);var l=a.Collection.prototype.__add=a.Collection.prototype.add;a.Collection.prototype.add=function(d,e){e||(e={});f.isArray(d)||(d=[d]);f.each(d,function(d){if(!(d instanceof a.Model)){var f=a.Relational.store.find(this.model,d[this.model.prototype.idAttribute]);if(f){f.set(d,e);d=f}else d=a.Collection.prototype._prepareModel.call(this,
d,e)}if(d instanceof a.Model&&!this.get(d)&&!this.getByCid(d)){l.call(this,d,e);this.trigger("relational:add",d,this,e)}},this);return this};var g=a.Collection.prototype.__remove=a.Collection.prototype.remove;a.Collection.prototype.remove=function(d,e){e||(e={});f.isArray(d)||(d=[d]);f.each(d,function(d){d=this.getByCid(d)||this.get(d);if(d instanceof a.Model){g.call(this,d,e);this.trigger("relational:remove",d,this,e)}},this);return this};var k=a.Collection.prototype.__reset=a.Collection.prototype.reset;
a.Collection.prototype.reset=function(a,e){k.call(this,a,e);this.trigger("relational:reset",a,e);return this};var m=a.Collection.prototype.__trigger=a.Collection.prototype.trigger;a.Collection.prototype.trigger=function(d){if(d==="add"||d==="remove"||d==="reset"){var e=this,f=arguments;a.Relational.eventQueue.add(function(){m.apply(e,f)})}else m.apply(this,arguments);return this};a.RelationalModel.extend=function(d,e){var g=a.Model.extend.apply(this,arguments);f.each(d&&d.relations||[],function(d){if(d.reverseRelation){d.model=
g;var e=true;if(f.isString(d.relatedModel))e=(e=a.Relational.store.getObjectByName(d.relatedModel))&&e.prototype instanceof a.RelationalModel.prototype.constructor;var k=!f.isString(d.type)?d.type:a[d.type]||a.Relational.store.getObjectByName(d.type);e&&k&&k.prototype instanceof a.Relation.prototype.constructor&&new k(null,d)}});return g}})();(function(){var f=Math,a=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":/trident/i.test(navigator.userAgent)?"ms":"opera"in window?"O":"",o=/android/gi.test(navigator.appVersion),l=/iphone|ipad/gi.test(navigator.appVersion),g=/playbook/gi.test(navigator.appVersion),k=/hp-tablet/gi.test(navigator.appVersion),m="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,d="ontouchstart"in window&&!k,e=a+"Transform"in document.documentElement.style,j=l||g,s=function(){return window.requestAnimationFrame||
window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(c){return setTimeout(c,1)}}(),n=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout,q="onorientationchange"in window?"orientationchange":"resize",u=d?"touchstart":"mousedown",
x=d?"touchmove":"mousemove",z=d?"touchend":"mouseup",r=d?"touchcancel":"mouseup",v="Moz"==a?"DOMMouseScroll":"mousewheel",t="translate"+(m?"3d(":"("),w=m?",0)":")",g=function(c,b){var f=this,g;f.wrapper="object"==typeof c?c:document.getElementById(c);f.wrapper.style.overflow="hidden";f.scroller=f.wrapper.children[0];f.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,hScrollbar:!0,vScrollbar:!0,
fixedScrollbar:o,hideScrollbar:l,fadeScrollbar:l&&m,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(b){b.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(g in b)f.options[g]=b[g];f.x=f.options.x;f.y=f.options.y;f.options.useTransform=e?f.options.useTransform:
!1;f.options.hScrollbar=f.options.hScroll&&f.options.hScrollbar;f.options.vScrollbar=f.options.vScroll&&f.options.vScrollbar;f.options.zoom=f.options.useTransform&&f.options.zoom;f.options.useTransition=j&&f.options.useTransition;f.options.zoom&&o&&(t="translate(",w=")");f.scroller.style[a+"TransitionProperty"]=f.options.useTransform?"-"+a.toLowerCase()+"-transform":"top left";f.scroller.style[a+"TransitionDuration"]="0";f.scroller.style[a+"TransformOrigin"]="0 0";f.options.useTransition&&(f.scroller.style[a+
"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)");f.options.useTransform?f.scroller.style[a+"Transform"]=t+f.x+"px,"+f.y+"px"+w:f.scroller.style.cssText+=";position:absolute;top:"+f.y+"px;left:"+f.x+"px";f.options.useTransition&&(f.options.fixedScrollbar=!0);f.refresh();f._bind(q,window);f._bind(u);d||(f._bind("mouseout",f.wrapper),"none"!=f.options.wheelAction&&f._bind(v));f.options.checkDOMChanges&&(f.checkDOMTime=setInterval(function(){f._checkDOMChanges()},500))};g.prototype={enabled:!0,
x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(c){switch(c.type){case u:if(!d&&0!==c.button)break;this._start(c);break;case x:this._move(c);break;case z:case r:this._end(c);break;case q:this._resize();break;case v:this._wheel(c);break;case "mouseout":this._mouseout(c);break;case "webkitTransitionEnd":this._transitionEnd(c)}},_checkDOMChanges:function(){!this.moved&&!this.zoomed&&!(this.animating||this.scrollerW==this.scroller.offsetWidth*
this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)&&this.refresh()},_scrollbar:function(c){var b=document,d;this[c+"Scrollbar"]?(this[c+"ScrollbarWrapper"]||(d=b.createElement("div"),this.options.scrollbarClass?d.className=this.options.scrollbarClass+c.toUpperCase():d.style.cssText="position:absolute;z-index:100;"+("h"==c?"height:7px;bottom:1px;left:2px;right:"+(this.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(this.hScrollbar?"7":"2")+"px;top:2px;right:1px"),d.style.cssText+=";pointer-events:none;-"+
a+"-transition-property:opacity;-"+a+"-transition-duration:"+(this.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(this.options.hideScrollbar?"0":"1"),this.wrapper.appendChild(d),this[c+"ScrollbarWrapper"]=d,d=b.createElement("div"),this.options.scrollbarClass||(d.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-"+a+"-background-clip:padding-box;-"+a+"-box-sizing:border-box;"+("h"==c?"height:100%":"width:100%")+";-"+a+
"-border-radius:3px;border-radius:3px"),d.style.cssText+=";pointer-events:none;-"+a+"-transition-property:-"+a+"-transform;-"+a+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-"+a+"-transition-duration:0;-"+a+"-transform:"+t+"0,0"+w,this.options.useTransition&&(d.style.cssText+=";-"+a+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),this[c+"ScrollbarWrapper"].appendChild(d),this[c+"ScrollbarIndicator"]=d),"h"==c?(this.hScrollbarSize=this.hScrollbarWrapper.clientWidth,this.hScrollbarIndicatorSize=
f.max(this.hScrollbarSize*this.hScrollbarSize/this.scrollerW>>0,8),this.hScrollbarIndicator.style.width=this.hScrollbarIndicatorSize+"px",this.hScrollbarMaxScroll=this.hScrollbarSize-this.hScrollbarIndicatorSize,this.hScrollbarProp=this.hScrollbarMaxScroll/this.maxScrollX):(this.vScrollbarSize=this.vScrollbarWrapper.clientHeight,this.vScrollbarIndicatorSize=f.max(this.vScrollbarSize*this.vScrollbarSize/this.scrollerH>>0,8),this.vScrollbarIndicator.style.height=this.vScrollbarIndicatorSize+"px",this.vScrollbarMaxScroll=
this.vScrollbarSize-this.vScrollbarIndicatorSize,this.vScrollbarProp=this.vScrollbarMaxScroll/this.maxScrollY),this._scrollbarPos(c,!0)):this[c+"ScrollbarWrapper"]&&(e&&(this[c+"ScrollbarIndicator"].style[a+"Transform"]=""),this[c+"ScrollbarWrapper"].parentNode.removeChild(this[c+"ScrollbarWrapper"]),this[c+"ScrollbarWrapper"]=null,this[c+"ScrollbarIndicator"]=null)},_resize:function(){var c=this;setTimeout(function(){c.refresh()},o?200:0)},_pos:function(c,b){c=this.hScroll?c:0;b=this.vScroll?b:0;
this.options.useTransform?this.scroller.style[a+"Transform"]=t+c+"px,"+b+"px"+w+" scale("+this.scale+")":(c>>=0,b>>=0,this.scroller.style.left=c+"px",this.scroller.style.top=b+"px");this.x=c;this.y=b;this._scrollbarPos("h");this._scrollbarPos("v")},_scrollbarPos:function(c,b){var d="h"==c?this.x:this.y;this[c+"Scrollbar"]&&(d*=this[c+"ScrollbarProp"],0>d?(this.options.fixedScrollbar||(d=this[c+"ScrollbarIndicatorSize"]+(3*d>>0),8>d&&(d=8),this[c+"ScrollbarIndicator"].style["h"==c?"width":"height"]=
d+"px"),d=0):d>this[c+"ScrollbarMaxScroll"]&&(this.options.fixedScrollbar?d=this[c+"ScrollbarMaxScroll"]:(d=this[c+"ScrollbarIndicatorSize"]-(3*(d-this[c+"ScrollbarMaxScroll"])>>0),8>d&&(d=8),this[c+"ScrollbarIndicator"].style["h"==c?"width":"height"]=d+"px",d=this[c+"ScrollbarMaxScroll"]+(this[c+"ScrollbarIndicatorSize"]-d))),this[c+"ScrollbarWrapper"].style[a+"TransitionDelay"]="0",this[c+"ScrollbarWrapper"].style.opacity=b&&this.options.hideScrollbar?"0":"1",this[c+"ScrollbarIndicator"].style[a+
"Transform"]=t+("h"==c?d+"px,0":"0,"+d+"px")+w)},_start:function(c){var b=d?c.touches[0]:c,e,g;if(this.enabled){this.options.onBeforeScrollStart&&this.options.onBeforeScrollStart.call(this,c);(this.options.useTransition||this.options.zoom)&&this._transitionTime(0);this.zoomed=this.animating=this.moved=!1;this.dirY=this.dirX=this.absDistY=this.absDistX=this.distY=this.distX=0;this.options.zoom&&d&&1<c.touches.length&&(g=f.abs(c.touches[0].pageX-c.touches[1].pageX),e=f.abs(c.touches[0].pageY-c.touches[1].pageY),
this.touchesDistStart=f.sqrt(g*g+e*e),this.originX=f.abs(c.touches[0].pageX+c.touches[1].pageX-2*this.wrapperOffsetLeft)/2-this.x,this.originY=f.abs(c.touches[0].pageY+c.touches[1].pageY-2*this.wrapperOffsetTop)/2-this.y,this.options.onZoomStart&&this.options.onZoomStart.call(this,c));if(this.options.momentum&&(this.options.useTransform?(e=getComputedStyle(this.scroller,null)[a+"Transform"].replace(/[^0-9-.,]/g,"").split(","),g=1*e[4],e=1*e[5]):(g=1*getComputedStyle(this.scroller,null).left.replace(/[^0-9-]/g,
""),e=1*getComputedStyle(this.scroller,null).top.replace(/[^0-9-]/g,"")),g!=this.x||e!=this.y))this.options.useTransition?this._unbind("webkitTransitionEnd"):n(this.aniTime),this.steps=[],this._pos(g,e);this.absStartX=this.x;this.absStartY=this.y;this.startX=this.x;this.startY=this.y;this.pointX=b.pageX;this.pointY=b.pageY;this.startTime=c.timeStamp||Date.now();this.options.onScrollStart&&this.options.onScrollStart.call(this,c);this._bind(x);this._bind(z);this._bind(r)}},_move:function(c){var b=d?
c.touches[0]:c,e=b.pageX-this.pointX,g=b.pageY-this.pointY,j=this.x+e,k=this.y+g,l=c.timeStamp||Date.now();this.options.onBeforeScrollMove&&this.options.onBeforeScrollMove.call(this,c);if(this.options.zoom&&d&&1<c.touches.length)j=f.abs(c.touches[0].pageX-c.touches[1].pageX),k=f.abs(c.touches[0].pageY-c.touches[1].pageY),this.touchesDist=f.sqrt(j*j+k*k),this.zoomed=!0,b=1/this.touchesDistStart*this.touchesDist*this.scale,b<this.options.zoomMin?b=0.5*this.options.zoomMin*Math.pow(2,b/this.options.zoomMin):
b>this.options.zoomMax&&(b=2*this.options.zoomMax*Math.pow(0.5,this.options.zoomMax/b)),this.lastScale=b/this.scale,j=this.originX-this.originX*this.lastScale+this.x,k=this.originY-this.originY*this.lastScale+this.y,this.scroller.style[a+"Transform"]=t+j+"px,"+k+"px"+w+" scale("+b+")",this.options.onZoom&&this.options.onZoom.call(this,c);else{this.pointX=b.pageX;this.pointY=b.pageY;if(0<j||j<this.maxScrollX)j=this.options.bounce?this.x+e/2:0<=j||0<=this.maxScrollX?0:this.maxScrollX;if(k>this.minScrollY||
k<this.maxScrollY)k=this.options.bounce?this.y+g/2:k>=this.minScrollY||0<=this.maxScrollY?this.minScrollY:this.maxScrollY;this.distX+=e;this.distY+=g;this.absDistX=f.abs(this.distX);this.absDistY=f.abs(this.distY);6>this.absDistX&&6>this.absDistY||(this.options.lockDirection&&(this.absDistX>this.absDistY+5?(k=this.y,g=0):this.absDistY>this.absDistX+5&&(j=this.x,e=0)),this.moved=!0,this._pos(j,k),this.dirX=0<e?-1:0>e?1:0,this.dirY=0<g?-1:0>g?1:0,300<l-this.startTime&&(this.startTime=l,this.startX=
this.x,this.startY=this.y),this.options.onScrollMove&&this.options.onScrollMove.call(this,c))}},_end:function(c){if(!(d&&0!=c.touches.length)){var b=this,e=d?c.changedTouches[0]:c,g,j,k={dist:0,time:0},l={dist:0,time:0},m=(c.timeStamp||Date.now())-b.startTime,o=b.x,n=b.y;b._unbind(x);b._unbind(z);b._unbind(r);b.options.onBeforeScrollEnd&&b.options.onBeforeScrollEnd.call(b,c);if(b.zoomed)o=b.scale*b.lastScale,o=Math.max(b.options.zoomMin,o),o=Math.min(b.options.zoomMax,o),b.lastScale=o/b.scale,b.scale=
o,b.x=b.originX-b.originX*b.lastScale+b.x,b.y=b.originY-b.originY*b.lastScale+b.y,b.scroller.style[a+"TransitionDuration"]="200ms",b.scroller.style[a+"Transform"]=t+b.x+"px,"+b.y+"px"+w+" scale("+b.scale+")",b.zoomed=!1,b.refresh(),b.options.onZoomEnd&&b.options.onZoomEnd.call(b,c);else{if(b.moved){if(300>m&&b.options.momentum){k=o?b._momentum(o-b.startX,m,-b.x,b.scrollerW-b.wrapperW+b.x,b.options.bounce?b.wrapperW:0):k;l=n?b._momentum(n-b.startY,m,-b.y,0>b.maxScrollY?b.scrollerH-b.wrapperH+b.y-b.minScrollY:
0,b.options.bounce?b.wrapperH:0):l;o=b.x+k.dist;n=b.y+l.dist;if(0<b.x&&0<o||b.x<b.maxScrollX&&o<b.maxScrollX)k={dist:0,time:0};if(b.y>b.minScrollY&&n>b.minScrollY||b.y<b.maxScrollY&&n<b.maxScrollY)l={dist:0,time:0}}k.dist||l.dist?(k=f.max(f.max(k.time,l.time),10),b.options.snap&&(l=o-b.absStartX,m=n-b.absStartY,f.abs(l)<b.options.snapThreshold&&f.abs(m)<b.options.snapThreshold?b.scrollTo(b.absStartX,b.absStartY,200):(l=b._snap(o,n),o=l.x,n=l.y,k=f.max(l.time,k))),b.scrollTo(o>>0,n>>0,k)):b.options.snap?
(l=o-b.absStartX,m=n-b.absStartY,f.abs(l)<b.options.snapThreshold&&f.abs(m)<b.options.snapThreshold?b.scrollTo(b.absStartX,b.absStartY,200):(l=b._snap(b.x,b.y),(l.x!=b.x||l.y!=b.y)&&b.scrollTo(l.x,l.y,l.time))):b._resetPos(200)}else d&&(b.doubleTapTimer&&b.options.zoom?(clearTimeout(b.doubleTapTimer),b.doubleTapTimer=null,b.options.onZoomStart&&b.options.onZoomStart.call(b,c),b.zoom(b.pointX,b.pointY,1==b.scale?b.options.doubleTapZoom:1),b.options.onZoomEnd&&setTimeout(function(){b.options.onZoomEnd.call(b,
c)},200)):b.doubleTapTimer=setTimeout(function(){b.doubleTapTimer=null;for(g=e.target;1!=g.nodeType;)g=g.parentNode;"SELECT"!=g.tagName&&"INPUT"!=g.tagName&&"TEXTAREA"!=g.tagName&&(j=document.createEvent("MouseEvents"),j.initMouseEvent("click",!0,!0,c.view,1,e.screenX,e.screenY,e.clientX,e.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,0,null),j._fake=!0,g.dispatchEvent(j))},b.options.zoom?250:0)),b._resetPos(200);b.options.onTouchEnd&&b.options.onTouchEnd.call(b,c)}}},_resetPos:function(c){var b=
0<=this.x?0:this.x<this.maxScrollX?this.maxScrollX:this.x,d=this.y>=this.minScrollY||0<this.maxScrollY?this.minScrollY:this.y<this.maxScrollY?this.maxScrollY:this.y;if(b==this.x&&d==this.y){if(this.moved&&(this.moved=!1,this.options.onScrollEnd&&this.options.onScrollEnd.call(this)),this.hScrollbar&&this.options.hideScrollbar&&("webkit"==a&&(this.hScrollbarWrapper.style[a+"TransitionDelay"]="300ms"),this.hScrollbarWrapper.style.opacity="0"),this.vScrollbar&&this.options.hideScrollbar)"webkit"==a&&
(this.vScrollbarWrapper.style[a+"TransitionDelay"]="300ms"),this.vScrollbarWrapper.style.opacity="0"}else this.scrollTo(b,d,c||0)},_wheel:function(c){var b=this,a,d;if("wheelDeltaX"in c)a=c.wheelDeltaX/12,d=c.wheelDeltaY/12;else if("wheelDelta"in c)a=d=c.wheelDelta/12;else if("detail"in c)a=d=3*-c.detail;else return;if("zoom"==b.options.wheelAction){if(d=b.scale*Math.pow(2,1/3*(d?d/Math.abs(d):0)),d<b.options.zoomMin&&(d=b.options.zoomMin),d>b.options.zoomMax&&(d=b.options.zoomMax),d!=b.scale)!b.wheelZoomCount&&
b.options.onZoomStart&&b.options.onZoomStart.call(b,c),b.wheelZoomCount++,b.zoom(c.pageX,c.pageY,d,400),setTimeout(function(){b.wheelZoomCount--;!b.wheelZoomCount&&b.options.onZoomEnd&&b.options.onZoomEnd.call(b,c)},400)}else a=b.x+a,d=b.y+d,0<a?a=0:a<b.maxScrollX&&(a=b.maxScrollX),d>b.minScrollY?d=b.minScrollY:d<b.maxScrollY&&(d=b.maxScrollY),b.scrollTo(a,d,0)},_mouseout:function(c){var b=c.relatedTarget;if(b)for(;b=b.parentNode;)if(b==this.wrapper)return;this._end(c)},_transitionEnd:function(c){c.target==
this.scroller&&(this._unbind("webkitTransitionEnd"),this._startAni())},_startAni:function(){var c=this,b=c.x,a=c.y,d=Date.now(),e,g,k;c.animating||(c.steps.length?(e=c.steps.shift(),e.x==b&&e.y==a&&(e.time=0),c.animating=!0,c.moved=!0,c.options.useTransition)?(c._transitionTime(e.time),c._pos(e.x,e.y),c.animating=!1,e.time?c._bind("webkitTransitionEnd"):c._resetPos(0)):(k=function(){var j=Date.now();if(j>=d+e.time){c._pos(e.x,e.y);c.animating=false;c.options.onAnimationEnd&&c.options.onAnimationEnd.call(c);
c._startAni()}else{j=(j-d)/e.time-1;g=f.sqrt(1-j*j);j=(e.x-b)*g+b;c._pos(j,(e.y-a)*g+a);if(c.animating)c.aniTime=s(k)}},k()):c._resetPos(400))},_transitionTime:function(c){c+="ms";this.scroller.style[a+"TransitionDuration"]=c;this.hScrollbar&&(this.hScrollbarIndicator.style[a+"TransitionDuration"]=c);this.vScrollbar&&(this.vScrollbarIndicator.style[a+"TransitionDuration"]=c)},_momentum:function(a,b,d,e,g){var b=f.abs(a)/b,j=b*b/0.0012;0<a&&j>d?(d+=g/(6/(6.0E-4*(j/b))),b=b*d/j,j=d):0>a&&j>e&&(e+=g/
(6/(6.0E-4*(j/b))),b=b*e/j,j=e);return{dist:j*(0>a?-1:1),time:b/6.0E-4>>0}},_offset:function(a){for(var b=-a.offsetLeft,d=-a.offsetTop;a=a.offsetParent;)b-=a.offsetLeft,d-=a.offsetTop;a!=this.wrapper&&(b*=this.scale,d*=this.scale);return{left:b,top:d}},_snap:function(a,b){var d,e,g;g=this.pagesX.length-1;d=0;for(e=this.pagesX.length;d<e;d++)if(a>=this.pagesX[d]){g=d;break}g==this.currPageX&&0<g&&0>this.dirX&&g--;a=this.pagesX[g];e=(e=f.abs(a-this.pagesX[this.currPageX]))?500*(f.abs(this.x-a)/e):0;
this.currPageX=g;g=this.pagesY.length-1;for(d=0;d<g;d++)if(b>=this.pagesY[d]){g=d;break}g==this.currPageY&&0<g&&0>this.dirY&&g--;b=this.pagesY[g];d=(d=f.abs(b-this.pagesY[this.currPageY]))?500*(f.abs(this.y-b)/d):0;this.currPageY=g;g=f.max(e,d)>>0;return{x:a,y:b,time:g||200}},_bind:function(a,b,d){(b||this.scroller).addEventListener(a,this,!!d)},_unbind:function(a,b,d){(b||this.scroller).removeEventListener(a,this,!!d)},destroy:function(){this.scroller.style[a+"Transform"]="";this.vScrollbar=this.hScrollbar=
!1;this._scrollbar("h");this._scrollbar("v");this._unbind(q,window);this._unbind(u);this._unbind(x);this._unbind(z);this._unbind(r);this.options.hasTouch||(this._unbind("mouseout",this.wrapper),this._unbind(v));this.options.useTransition&&this._unbind("webkitTransitionEnd");this.options.checkDOMChanges&&clearInterval(this.checkDOMTime);this.options.onDestroy&&this.options.onDestroy.call(this)},setOption:function(a){for(i in a)this.options[i]=a[i];this.refresh()},refresh:function(){var c,b,d,e=0;b=
0;this.scale<this.options.zoomMin&&(this.scale=this.options.zoomMin);this.wrapperW=this.wrapper.clientWidth||1;this.wrapperH=this.wrapper.clientHeight||1;this.minScrollY=-this.options.topOffset||0;this.scrollerW=this.scroller.offsetWidth*this.scale>>0;this.scrollerH=(this.scroller.offsetHeight+this.minScrollY)*this.scale>>0;this.maxScrollX=this.wrapperW-this.scrollerW;this.maxScrollY=this.wrapperH-this.scrollerH+this.minScrollY;this.dirY=this.dirX=0;this.options.onRefresh&&this.options.onRefresh.call(this);
this.hScroll=this.options.hScroll&&0>this.maxScrollX;this.vScroll=this.options.vScroll&&(!this.options.bounceLock&&!this.hScroll||this.scrollerH>this.wrapperH);this.hScrollbar=this.hScroll&&this.options.hScrollbar;this.vScrollbar=this.vScroll&&this.options.vScrollbar&&this.scrollerH>this.wrapperH;c=this._offset(this.wrapper);this.wrapperOffsetLeft=-c.left;this.wrapperOffsetTop=-c.top;if("string"==typeof this.options.snap){this.pagesX=[];this.pagesY=[];d=this.scroller.querySelectorAll(this.options.snap);
c=0;for(b=d.length;c<b;c++)e=this._offset(d[c]),e.left+=this.wrapperOffsetLeft,e.top+=this.wrapperOffsetTop,this.pagesX[c]=e.left<this.maxScrollX?this.maxScrollX:e.left*this.scale,this.pagesY[c]=e.top<this.maxScrollY?this.maxScrollY:e.top*this.scale}else if(this.options.snap){for(this.pagesX=[];e>=this.maxScrollX;)this.pagesX[b]=e,e-=this.wrapperW,b++;this.maxScrollX%this.wrapperW&&(this.pagesX[this.pagesX.length]=this.maxScrollX-this.pagesX[this.pagesX.length-1]+this.pagesX[this.pagesX.length-1]);
b=e=0;for(this.pagesY=[];e>=this.maxScrollY;)this.pagesY[b]=e,e-=this.wrapperH,b++;this.maxScrollY%this.wrapperH&&(this.pagesY[this.pagesY.length]=this.maxScrollY-this.pagesY[this.pagesY.length-1]+this.pagesY[this.pagesY.length-1])}this._scrollbar("h");this._scrollbar("v");this.zoomed||(this.scroller.style[a+"TransitionDuration"]="0",this._resetPos(200))},scrollTo:function(a,b,d,e){var f=a;this.stop();f.length||(f=[{x:a,y:b,time:d,relative:e}]);a=0;for(b=f.length;a<b;a++)f[a].relative&&(f[a].x=this.x-
f[a].x,f[a].y=this.y-f[a].y),this.steps.push({x:f[a].x,y:f[a].y,time:f[a].time||0});this._startAni()},scrollToElement:function(a,b){var d;if(a=a.nodeType?a:this.scroller.querySelector(a))d=this._offset(a),d.left+=this.wrapperOffsetLeft,d.top+=this.wrapperOffsetTop,d.left=0<d.left?0:d.left<this.maxScrollX?this.maxScrollX:d.left,d.top=d.top>this.minScrollY?this.minScrollY:d.top<this.maxScrollY?this.maxScrollY:d.top,b=void 0===b?f.max(2*f.abs(d.left),2*f.abs(d.top)):b,this.scrollTo(d.left,d.top,b)},
scrollToPage:function(a,b,d){d=void 0===d?400:d;this.options.onScrollStart&&this.options.onScrollStart.call(this);if(this.options.snap)a="next"==a?this.currPageX+1:"prev"==a?this.currPageX-1:a,b="next"==b?this.currPageY+1:"prev"==b?this.currPageY-1:b,a=0>a?0:a>this.pagesX.length-1?this.pagesX.length-1:a,b=0>b?0:b>this.pagesY.length-1?this.pagesY.length-1:b,this.currPageX=a,this.currPageY=b,a=this.pagesX[a],b=this.pagesY[b];else if(a*=-this.wrapperW,b*=-this.wrapperH,a<this.maxScrollX&&(a=this.maxScrollX),
b<this.maxScrollY)b=this.maxScrollY;this.scrollTo(a,b,d)},disable:function(){this.stop();this._resetPos(0);this.enabled=!1;this._unbind(x);this._unbind(z);this._unbind(r)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind("webkitTransitionEnd"):n(this.aniTime);this.steps=[];this.animating=this.moved=!1},zoom:function(c,b,d,e){var f=d/this.scale;this.options.useTransform&&(this.zoomed=!0,e=void 0===e?200:e,c=c-this.wrapperOffsetLeft-this.x,b=b-this.wrapperOffsetTop-
this.y,this.x=c-c*f+this.x,this.y=b-b*f+this.y,this.scale=d,this.refresh(),this.x=0<this.x?0:this.x<this.maxScrollX?this.maxScrollX:this.x,this.y=this.y>this.minScrollY?this.minScrollY:this.y<this.maxScrollY?this.maxScrollY:this.y,this.scroller.style[a+"TransitionDuration"]=e+"ms",this.scroller.style[a+"Transform"]=t+this.x+"px,"+this.y+"px"+w+" scale("+d+")",this.zoomed=!1)},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}};"undefined"!==typeof exports?exports.iScroll=g:window.iScroll=
g})();window.languages=window.languages||{};window.languages["zh-tw"]={setting:{DST:8,format:"Y 年 m 月 d 日 (D) H:i:s",AM:"上午",PM:"下午"},shortMonths:"1 月,2 月,3 月,4 月,5 月,6 月,7 月,8 月,9 月,10 月,11 月,12 月".split(","),longMonths:"一月,二月,三月,四月,五月,六月,七月,八月,九月,十月,十一月,十二月".split(","),shortDays:"日,一,二,三,四,五,六".split(","),longDays:"星期日,星期一,星期二,星期三,星期四,星期五,星期六".split(","),orderTab:"點餐",historyTab:"紀錄",feedbackTab:"意見",aboutUsTab:"關於","Hello World":"哈囉! 世界","Nice to meet you, %1":"很高興認識你，%1","My name is %1, I'm %2 years old":"我的名字是 %1，我今年 %2 歲"};var supportedLang="zh-tw",defaultLang="zh-tw",language=window.navigator.userLanguage||window.navigator.language||defaultLang,language=language.toLowerCase();0>supportedLang.indexOf(language)&&(language=defaultLang);i18n.set(window.languages[language]);$(document).ready(function(){$("#backgroundLogo").remove();new myapp.Router;Backbone.history.start()});(function(){var f=Backbone.RelationalModel.extend({idAttribute:"_productId"}),a=Backbone.RelationalModel.extend({idAttribute:"_menuId",relations:[{type:Backbone.HasMany,key:"products",relatedModel:f,reverseRelation:{key:"menu",includeInJSON:"_menuId"}}]}),o=Backbone.RelationalModel.extend({defaults:{deliveryLimit:99999,deliveryFee:99999,lat:99999,lng:99999},idAttribute:"_storeNameId",relations:[{type:Backbone.HasOne,key:"_menuId",relatedModel:a,reverseRelation:{key:"store",includeInJSON:"_storeNameId"}}]}),
l=Backbone.RelationalModel.extend({url:"/jashami/testData/menuData",relations:[{type:Backbone.HasMany,key:"stores",relatedModel:o},{type:Backbone.HasMany,key:"menus",relatedModel:a}]});window.myapp=window.myapp||{};window.myapp.Model=window.myapp.Model||{};window.myapp.Model.Product=f;window.myapp.Model.Menu=a;window.myapp.Model.Store=o;window.myapp.Model.MenuData=l})();window.myapp=window.myapp||{};
window.myapp.Images={JashamiLogo:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAR0AAABeCAYAAAAe0cANAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAIH9JREFUeNrsnQuUXEWZx+v2e3pePXmcxWAyE2EBNTAdFIOATLOyh5dJBuVoVCSTPZzVlXWZFQQElQkHVhZwCa6InHXNRN0F9pWZBIOyETryUlbJBIIaIJInjzxmel7dM/3c+918NVNdXXVv3e6eySSp75w63dNz7+17q6t+9/999VVdo1AoEG3atGmbLjM0dLRp06aho02bNg0dbdq0adPQ0aZNm4aONm3atB3r0PFg8ZnFj4V+ZmChBheTx5IxS455zemfW5s2DR3hOZklYJYgAxk/QseHsPEKoEMvJM8UAE0WSwbLOJas/vm1aTuxoQOQCeFrEMET4IDjBJ0Cp3ZE0GHBAyWlAaRN24kDHQBG2Cw1CBweOn4BdLyce0WPI1M61MWi4EljodAZQ/Ck8L02bdqOQ+gAJGoZ4PDQCUiUjlcAHSf3KidQOjx0oCQRPPRVmzZtxwl0wgxwaAnZQIcGkL0O0CGMa1VA2OQZ9yrrAB2qdkYRPKP4f23atB2j0AFw1GFhocMqHVE8xy9xrWTQKUiUjgw6vItFgQNlBEteNxVt2o4t6ABk6hng0FLDFBpIDkigwysdQwE6VOnkBNBJc0pnjIFOEmED4BnGolWPNm3HAHQADg0IHB46sniOahDZwwGHhU5BonTsgsk8dFi1A9AZwvfatGmbodABYDQibBokrpVdPEfkWsmgw49esdCRxXXGBWpH5mINM+AZZL5LmzZtMwQ6QQROI6dy6iSulUzliOI5ohwdFjq8e2UX10m7iOtQ6EBJEJ3hrE3bjIEOACSCwGkQQCfMQcfNULndyBVxgI7q0DnvYomgM4jg0UmF2rS5NN8UASeCwGkQuFaieI7KqJXTyJUopmOndtL4GnAJO9at0+DRpu0oQifIAKeRAQ5VOm5GrXxEPmolGrni3SsVtRPAVz+xD1zbBa8L2tXSpu3oQMfPxHAobGTxHDcqx0vE8634ILJI6ajGdvzoXvkUXToebPDar5uSNm3TBx0P50rxCkc2VK4yTC5TGh4BcJzAkyuMDuRTz/wkmO77eSi7//f+wtiIZ6IiWqJDgUUXHwie077PN++MARtVJTp+DuM82rRpc7BqBJJB0cwySxPjWjVKXKtwfvhQY+aNF+dmdjw7lxgen1m8hsfw+pqjucAHYlmjtslDxDPKeQAYNufEQ6Ew/tJGY7j770KF1LBhWyHBcDa89OY/hi+5bicRj2INkeJRrAQqnQHcTps2bVMInVoGODx0ilyr8d/2tqSe+pczMq//+iTpydTUFwJnXZKp/9zd40Y4IhoeVwFOCXjGnvt3AI7XzYWFr/jqjtr2W3cQ+SjWIJkcxRpA8BxGl02bNm1TAB1QIrMROrOIOIhclx98d9bQQ6timZ0vnqx8UjUNJHJjb8a34Ey7+I2SZfduLwzcETNEgAud++l0Ppkg6ZefDIgU0KzVzz3nnXf6YSJOFOShM4DQ0fEdbdqmCDpNDHCo0ilyrdKvPt089P1rriikU37XJwbg+dqGgm/+IqOSCxx68AtkvO8JEdTSJtSseVnZ3dvyA3d+vJHfN7j48gMNX/7xywx0RiXQSXDQ0dMltGmTmKfM/WrQteLzbyZiN+lXn5pvBxwjVJf3n7okEzjrLzPhK27IAAiKfKPUEADDqPQCeeCAhc77LDGBA+6WFbj2Nbd6g0uuSvPbZd58KYLXys6Ip+9rBYXWhU83LW3a5C5SubEcdjSqaKmKfOKdpuF//ZtLZMAJX3b9cPjSr6SNcGRipCr4oaX5xL3LPAAbarnDe8nY849YkCjHMjueE35uKhiC8aKJGFHgjAsK47/5r6LtzOuAETUYYXMadmezm2lmsx7N0qatSkqHn7AZ5pXAyCNfPzc/fLhWpG6abtt8sPaT3xxH4Ezk44AbJYJLavMPyr647N5XhJ/7Tz+fvX5rWN47p0VYF+lXNs8ik8P7NYzaqZHUAa0fv25e2rRVBzphgbsxkWGcH3y3Ib1986ki4ERuWH/I1xKlT3vg83AMVCAcOF4lhWR5oiGfHFIKHzHnIfivAfAIkuLZ8CyAamxgpE2btgqhIwJNiH0d3/qzZpFbVXfV6oSvZTEh4pnjBqdAitWGxE0qy5+c/0ExeAxDHD8yPBQ6AQl8Qjbg0bEdbdoqhA4PmpKZ4tm92+eKdgy1rczYAWfiCz7+xZJ9C6nylA4oJ+/s+RN/w/vw0pslMFpk8MFsGFb3t0QJAxy+hBQgpG0KLdttRMwSO4GuN3asX6+bIXPoeACUOeRIfg7N0SnKzxn56Y0fTm3pPr0ohnLKR9KRWzYNk8n5VdSdEaoLCACPb91E8of3WOqn5uIvWZ/nzL+TG+4hY88/Onns084jofM/W3awmTU4fnrrpkI+OVjwznpvNnj2FRB7gqAwfT4WXbh9NLv/D7n80IFM4P1tbxJxkiCUg1iOWgPFt2wj7fN1FHqOwrm0mC/tWNoEm2wzS9ws3eb59SleWxdzrNXmfl3HOXCgXlqZ+upQqSvB79CBf0Jd75rJ0GngoCNMCsy89sK8we+uWFIYH52IkdTEViXrPn9vhovluFJZENcZuCNmjWgJVU30MlK/6nvECDdWo17Y1QbTHHSSqf99qG6099unFMaTPk/d7JHaT33r8dAFn3+FgQ6UQ1gAOmOSBhDFugMQJMq5y5sv9Bjw2oIlir+HWNV1FIxphg3AYKWL3XqxQyUkx4ROs5b7GMDfUk49HiPAAViv50FtXm/U5W/Rx7WNK6f7JuQm5iByLwKEW3zLf9pHx2bd/VLf2JbukwtjI0Hv3IVG6MJr8ridtxzggI33bZIC58j/nyDGY7dZ4KkGjPE8C2Rypju4htnk4/e9Z7T37nkTdBo5XDe87voVuXdeq6m9anWcc73o+zGnRmT+DXeuXdgoeKNQodZ2jHQUERxUbDnUBewv6RDtgs8a8fPu41ToiK65FUDiQq10CG5Ga8wyI6FTAhciXvzKKubd3xO+4ga484SZzieM4aia6fY4bgNuF7hZsoC0S+jQKRgWKAujA/7hf7upcfz/1teJdkg99cNLTeg8z9UThY7I+DtUK5blU/h7b5uuTonuz9oKDgGdY715nHVmp+oQdJTlko55vEInZvN5dwXgap7uC3EDHSfY2C1NIVqTxp2/ozhsPrrhH2H6RDXqxkOVTnbPy/7hH11Xl93/B2l9eWbPP8jUgaie+IxnuLt02rlBZdgWjC31oWqyytHw29Glktkgp+jslNtKcCPNa2hn3MO4+dluQYdZjtseVy4WuuHNijcvO9eqVfY/URvB743RNuU2flQN6PBg4YtPUioGjtTfi15GvPPPJOPPPzLhemVee94KCHtnL6iKm2VCzJ/ceG9QYVNDUCdS6MAPiA0hhg0nZtMBt+EPTxiY8MB6wDxm5wzpJBHJdQBsOs3z7BZs34GgEkEYYNLNKR6A9vWSO38POb6s3eZ/0SocowXbFPubrOHrF0Hfxf9+UwEdwwY0TrARPRyvPMAsvtwCCjUYtWq47idHQLPj2aJ4D4x+ec+rDDpwjOG1f+uxiyNxzDGY2I+olFb+kTtyj9tOgvGgxjIb33SY7Fy6RQ0W62ENgAXrok2ieOLM/t0S6ESPQ+jEqgAdp2PEBfEfkSu21vwduiqBj0cRTCxgVEHDr/jnqaTWYdicTezzn37BxHvvnGLA5A7tLft7YJTMhA1J3LecKAMHzmfh2W/b1Eu1p0R0HqOdxxYGAB+zQOdY5+SyodQfdNm5jlWzcz8bUTE7KU+7WGHE5flQ+MTx2FMCHR4sLGCcYFORwimqmRs3kNB5KzA3Z8XE59XI0QGDeV6Hb1lclAdUImhq6sU5BobHYwMdH9HZyery+4gbtUXU2DHOQC3usoMei/EcFYg6qZ1YGf9XUYtt5ahKVeh4bSDjcVA3VQMP5ODAkDgEitmYDYxWAYwqcaX6TdiMPPYNws5yL3HxllyVbvjSWmGQ0tfcmpDUE1tfJ4olymz8Ra6Ywl05Lumo0eOoLqsBnXaH/7dI1PTuClVY2dDx2kDGYwMa0aLmU2YAo/pV/0zCS28i4Yu/qLQPBJwT9y5zdKVg+kTkhvXphmt/MGa6X0J4eOpmZWzq5oSCjs0oR7uLw+xSAFq8wjjH8QKdWIXQaRa5urjfNod9d08FdDyKxSDyBdSnJQMW3KzaZTc5ZiUDbCBu03/L2UXB6VJXqsGC2Ky7t+b9Z3wM3Coju3e70E0KnnPlQa4+RFA+kaxX8Bkks6nGo/oEDX4dCzQbuLWcIPEcx+tF1eeYliFy46B+MeP5AcluW1zeSCZcp3KgMwGY/NDBQGbni3MMjy8caL0kR4qfS2XMpF8PYDP23KNW7MbOjToCsBWk7jN3sQCzrseEVElQ2NMwN8Vdt+j1RIMO+Pqi4OX92BG67PKH8E4bxZE6a0RKApktgo4Zc+hgUXQfYniX78Xz6ZtJFehiYmezTX6SKhSiMuWIqRidzLQdS4mWm/+lOmQuLYlvX3pR7tBu60Q8kfdkZnX9ar9R20RIBYupTwVs+ImiMoMgde2ym0VZzUYhmfBk3vhNCXR8LdHDNnU0IwE8DS5WN6oaUUIazMNaiVM/4qhqhMlnOA2ix0ERtSl2Yug0awTbLyeTc9dmkkVdbhuvEDrlus3TBh3rfxQ4YPnE2/7+rgvfG4xemvYtOIv433+hxzun+aj9YjBTHRIHReski+I2YdM1k4yEWdeb/uMzHjGozu8XQNYQ1OGJZu2kdIJhkbvFQsmEAlUufdiB4grZxQlF4HSZL7c7qIWOShPfpimeI8rGjvHQweHs1mpAB+sP6rq70ozvSoZxrRZiBGoy7KJdJnh8qfhaH9uZffMXWcrBN//MasyLsm9ce7ebLtQj1trKTi6UAmyKzFRKwnybwJkX90uAM6NAg40wxjSwGNd5+/A1Xo27GshvVBc9Lhp/GxZI/Bs097emi9g09F0K1xznvn8dEc96h/rodlBKMXQxWjhlxNZdfAqVDk0laFbYVqZytgl+j1aHKSQU2OBmtVfSPtxApyD627zLv5XevrlZ7trstQqrNiDJDwDkmb2ABEwIQdwEwFQuZGAtZBj2hqKa0OcGNtZ1HNptpLf9omQEyvtnp4z65p2R5OqoIKmzowmbNdgI7YKKy5l9tmFnj1cKHozNdJAjyX1upG8jwqEdXDWJCtnlAjgT0zAwoY53s1okx1E5d3qs283t4XvWVLK+D55fs8SdTCieu0wpwXmtdxPXYRWhWbaa53dRuW3DpwibAvd+ogSil+7noWN2wox3/qJC5vVf+/P9+4xSULxqFbDkxmIQeHClP4CSaBQKFvbKHdpjrSZIj+HGylz0q5DccI/QtQp+5JPvyupGUI4GcGhDapTI9Dh23Hbu7gfvnzb3r8p6KwiMbgwMx7C0uoAPZMASVfdHonDamY7S4xQLwmN0E3k2by9CoIVTTo0InxhmWFczntMncSlbFaEzCL+nZMJsTAE61DpdbOsaOnlBmXhOeE1bx77R//xWFha0mlAF/fu8kZsfHzLCkUAhOehP73jOZ6oQw1IkNkPUVBWB2W3n1gBmgejlFmzKUVTWqNcLj5VAxwjW5mouuvYdrk5kJT+DgCOaeNmFrgzfwaq63gofGMZzbCGTk17tQLAG51/tUviqNVxHfIC7M6u4BzIwreNdPpw39jSvftAV6akidOI2v3eMXqPNzPQe5vqbFZWRyCJlt4EyoFPg3weil+0b/81/T8i7wtiIZ/x3G32hj32hYKqVQnDx5VAM3iXK7kHXqIqAYV04/2kXlA0a1oa+J37oX+jCaw546menuTphn5HFvxc2FOyM8SngTo8EODGJTy66qzdP5XIReB59tDOguugk4qBvI7oGHQodto27ZleuDgZOhcARrO9jt9xGuRNQZSplF57fIBFP+o07ACTOvC6XuIgiGyRVWoZFBTo5SQeaeB++/O//xEIHbPTx+8LBDy1NmmqnUAqERUdAcF6xmsgf2mtBCB4dk7NeBx1VD7hLrDsWsALWi6q1bKmVRJjd92rps9BDdeZ1d77tABv+b7ZR0wWnGmkMxcXSk7ucfHqMQ4judNJ8FJTdC7HB0uP1TOf6NPhdoLriAuUgCo5GJXAqUj2K1xDnwFcSgBUBhzn3FiaviP5O5arEqMS1Yt+L8pPWSOqJVzpxmTqWtA/l1IRqQkdUrE7lm3fGSKD10nfS235+0oQ86t/vST75fX9t+61K8QyYSwVlqke33AJHlttTf/V9+zx1szOk+MmfOcHf7FNBWXWzXsEnt4OOKMDH+9wlMRyzQa1RCPx2l1tnzGgVPZ8tGEtJuIQPKAfRKFMj1zGcZP4g0xGdAq/0mB2Su3qXwnn3kArdUQwiNzq4VnEBBKIMNNsk0ExQhSlRSzFF13NaoEMXKs8JXnN1n/zmzoE/PjOXXZA9+bN/CgbPXjruW3AmBU9VhpBh+QnqooEqgvV0pDCbs2BilEwVaHR5C1l+j+k2JoJLrkrYwIWvM/oZG5zk7YEqxnJk+Rk9Cvt1ksnF3qFhux0CXsMBsA2vt72MS+kh4qHtiELsw0nltNh0amkA1qH+6NMuWvDGEC8z70fmGvU5xKSa8TeU1XW34HqX26ilowadrE2Z6FzeeaePhC64+q3ULx+eX6QWfnSdv6nrV7Bt2SsHAgTggXvpvk2uhsVZ1wxGyWAuFcAneN5niehpotb2Rxbvkn5HYNHFqfpr7j9go/5kdZVn7qLNAgXiZo0cJ9XgOgjJ7Hc7BwwYhVns4rEwbVUMOqqoIyfodCt27G0MnFocOrzM1nN1txKDux0urztaJnTovu2Kv78MOlNqHkXoZLBkmdcs87fV2epW3PWm96RTU0U77/+9Z/hHX/aSMoaM6cRMWONm6PvXWK6OG+CUwCs1ZKkXOFa/tW7OIyXfZTfjHJ7f1XDtQwclUOHriP+b2PjabuV43xR2YqKoCtzcobunovHiXd0ud2adZO1fkfsRd3B1Vep8SwV15wSdQfZa8L1oEbMOIh7i3y24cYhuQo2KS4NM6egVWJrrSBkZiOo7vrtzcM2nPwAjWHTnsRf+w4SOka//qweVXazRDfeY6uQe9QuZv8jKvaEjVaCMQCFlXntWmM8DYBle+xUy+j93Ed97P0DSrz5le/zgkk+NN1z78GEWshxwsgLgZJi6s7MOGC2ZwQuKl4zA4Bq6/IJaIdn+ZY6AtZQJObcqRwX8iTLPNyJxwzq5GF0348a2KapUUXC33cbt5eNPbuI6iQpikK6VDmE6jx18rI5nqoGh2iu/sZ8/AOS5mK6WkisFa9zwwIFcm7rP3EkiNz1uLTfBPwIYYjwjj91mzSD3zJlvLXFhKi/S9K0tZM4DO621duhIF2v5wXccgVN71eoxEzhDDGwyDoARvWcbWMndBRpVhYtPqTwuI6IAF1W7nkxOWWhDt+wkm22t51i5XN6yw0Hp2UFni00sql3QAdltt5UBOCJRXaLO2cnV3UoymTKg4lrZKhWb+Jiqyx2rorouW+mMk8knXY4zfwtBVPMX1x7I9++tSf7iwTkceIzsvu3WguqypzUk7ltWpEwALgAQ+mhhy83583OthbqSmx8uWaYC3CcoACbYzzpGuNFSQVAgZjPy2K1K2cz+0z5aqPvMXWO+BWeN2SiaNAfltKC+stzdd6WkcW7FEZsuhwS4SJn+fszhjh5T+dxmTd5dRLzUBO0M8BwsyCymkzrpo3LoaFULcU4UZGMvdiDocnGd2wR12eoGyKhepG6gi4mrbuJxcWI/iZVar017mva4jqrSyQlAI4LPBIBMdfBW8MPtwyU/gNnZB1bHLPepwD3LauTR20pgAIFfGH3itwWQAFSabo9bj6LhDZTSwB1tVqymCCTm8UD9AJRkBqrKdBPzka9tBOBkJLEbXuHwwGHriL+j2o1UAZDehOdWg8sFgUi2kzPP8JbeybCBr5O4cRFJx4gSebp/1EWgU2W1OTqhEyAEuTgw3QJc7zfx7/ttzmUNE5dpdatyJJm6CQW3rBFzn2TW6QJyUQmwVYPIInVWjptZaVxnSqFjCRWmjAvu5iXwafjiD/eF2lYOiQK6AAUIEB8BzXYLKqlfPlwqsTDwe+j6U3BUaQ8HiAWWcorc2GvBQgQ4UDclLpMJLHC5RFbz8b/Oh87/HB+7kQFGVsZE0MHG0kmch8hb8S72NEKogB3zaUFn2y1oWF0Cl6tRBCybYXy2EcYUVARdiiJGqpgCwN2xuxXuxh0uXchdgs4sWvmwSwRtjG/ZJc61M9vKHrDYY3Ndu22UUq9Dne22G+o/Gk/VKAc64xIAiVyvTP3V33nXLAPC+I0JHwDNwB0x0v+NJc4n8Pyj1hKjoJJKXCFLwZSqHvgOGJFiR6qogbslAs/oxns9hWQiL1A2di7UuKR+MpIfGxrflaSMNWYFsZyS5DuU0zFBg7oeOgmoJ+hAePfuUwgMQodrx0xh0bYPMIlnCby+hUT+OBnXwOFgIrsTr3ZwTUWuYTteWwwLffjfNkHMJk4BjPvIHvpXpF5x2zWo4ojNTcPtyJlTTk2XQt3Gy4GO06NvqgGdPHaiFJYxB/hMdFBT7Qw03bb5oO/k92elBx8+pHwiMtcJXC5QPSLXCUaqZOARgWr8dxuJBDZpB8iw9ZOyDaiZdyBInTffrioTPhAbidpMa+jDxrNFENgFV2YAXZxmQScYFLhE6yV3dOHTRaHzY45KE15jr2LAm4+3rILHCnNgjUncqq4y6rERr+1pLLsQnKL1gVsZd3C9xA0UDZ2vl8BpN3fT2KIIBRV3fYticqIKdHoUAV5V6Fj9netQKa6zSeHja4kmm7qeORS+4qtj0mdHuTDqOoFrpuo6AXiErtaKu0o+S+941sNBh1c0/HWnJPBxjuabDQPhsxju1JKGxyobUA+wnknMacY1Lq4NDegi3G/QAWKr8Fxiiuex2CmxETtwN4IjggroIrzW1XicLVjW4WcAqYXQ8SUdp00AJ5Ws510K23RyinQhdmy7WNVu3GYh1vdqh7rupXXN3TT4R78MEueHFHYKvk+1PmRAiQtuYKuqIVmNQsF1/4dGA6NSs80yC0sEC9wx6s0C49l10J+x1GCBPI6g6boEk08+FB574THhejuuLqCmgTSa6kY0xQGUDYCG33723Vv5CaH5wzdHDfZcIBEwcsumtxiAAHBHsQxjGcIfOoGqAcphLIdw2/LBekS+sneTshfDdjhuQqaWcNso48704XkctUXMMci5lemU4GKoTuqkM8hFsZVePE7cYX9eBfSJvhvdNFp3ETL5HPo+p3NlvqPPxXXR73O9agGTO0RnqndKEitj6LK14Y0vPh3QCQig04Q/YCMDnnoGOmEGPEEs1qOKx196PJjue8I33veEobK8qMxA2YgW5hJN2gR3Cp+DTueE5RL3fMKbef3XnknonDMWueWJPYxiocAZwTKEJWEDnRmxcuDxZgjCDuzAZc+Cx07aMtOeAnG8WzlrJKex84WockEQ+ZlX/tnm7KNrigFw9ieg5ExCeU1XySyvGLlDew12Eie7tAUk+OXeeYPkhw6UuE6iWerwGBlr7R4ciocRLsz5oWvgWHOmCsmhoqVI/acuGZW4UFT1iMooUzRwpqrRHrkDd1XhOAkyxTOqtVVH6VBYzWbUThPjXjWie1WPLlYdKh2R2qGQ8jOQUnoUsUjBgOsEjxzmF+2ia/XgWswFHji5g7vz/bd+qK7Ih/z6z1/3v+/DA5xrxaucQSxU5fSjyunXTUubNrGV+wC4LNMBaRnlCqsAUlwR5fvQxEI6e51dnbDEQMHA6oCsWcPj9y4rCS6jAiqYwKGgKcq7GXv2p0X14Ft49igHHF7NJDl3a5SrC23atFUZOkTQ0UTg4QEkA8+YAD4sgHI8gEC1RG7cYAeeEkVDBEl+Y7/6sSe56f4we4zaT9y4RwCcUQFoRHWQ1s1Km7bqu1e8m9XEuFgRdK9kLlaYcbFC6GLR4kNXyyuIB/Eul/VqTRC9b5lHNJcqvPRr+dB5K3LeOc380qHZ8d/2+lKbHw5ldr4YKFZQd75Rc/GX9nLxGwoXdtSKDyL3a7dKm7aphw5BgMySQKeBgU4tBx0+EC2K79iBZyLeA+AZfPBqf+a1F4QxIMgL8p38wRzGd4z8wFtesct25+smcPYQ8TA5D51BBjoUOFndpLRpm3roEFQ0VO2wwWQKnXoOOmEOOjx4fDbgYZ8PThjVUxjt+XYg+bPvBFzLtZboECgc/6nnHiKlo1SsC0WhMyiAzphuTtq0TR90CKNyIhx06gVqp4aUjmTR3B3ezfIhZLx2aoda7uBuz2jvP9SkX34yWEgNS0e/YIVD//vOGQx97Oq3/acu6SfFmcYpLpbDjlrx0BkgFSYBatOmoVO+OQ2dsxnKdmrHJ1A8LHgMQXyHfwppPnfgTU/uwJ+8R+I4hbz5ac47tyVpAgcgwc6pYqc3pBRdKwqdYd2MtGk7etAxuLgOm53MKp2SqRE2asdH1ILKLHToSBf/SBjZrHE6epaSQGeYlObnaOBo0zYDoMOCh1U6IheLKh0WPAFJbIdXO6K4Dqty2Cduip7SoKJyRPEcFjoaONq0zRDoUHOK64Qlakc0kiWbUsHHdXjgiKBjN3Nc5lqxKmdIx3C0aZuZ0CEIGVbt1JLSnJ0QEQ+fq7pYdkon5+Ba8UtVsJM7k6Q46Y8CR49SadM2g6FDECZ8XMcuZ4eN68hcLFFch15InogzkVVdK3ZG+SjnWuk8HG3ajgHoEIQFm6/jxsXySVwsFffKzrVSHbXS86m0aTsGoUOtRuBi2UEnYAMd1r0yiFoQWRbPoXPB2LlWdIg8p5uJNm3HLnQoIMIInhqiPi3CLpjMKh1+uFzmWqWJOCGQulMZ3Ty0aTs+oMPDp1YS1xFBh81OpsPmxMG9UonnQBlEl0orG23ajlPosOZD8DRIoMNOiXCjdGjJCKADymYI1U2G6JX+tGk7oaDDmpdMLntB4z2imees0pHFdLKM2qHD4FTZaEWjTZuGjtT8CJYQo26CDHyoZRjVkkNFQ6GjTZs2DR1t2rRp6GjTpk2bho42bdo0dLRp06ZNQ0ebNm0aOtq0adPG2P8LMABslFzo2hseNAAAAABJRU5ErkJggg==",ShoppingCarIcon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAA6RwvCAAAEfUlEQVR42u1Xa0ybVRgeWebITJwzmrm4sOhmsqnjDzHYBEmlugKVJaAkg8CuLXRLGAT7C5M120S2GmsiRmRqolspCmSAW0eWbayZvQgMLaUX29qPFiUQCAPC/e7zLqfJScMPoHXxB1/ypOd7zvnOec9776ZNG8/G8z94ZmZm3l9eXj4JHOMgB8RAzBMRQqPRvLqwsPAQBwaBfzg8An4Ctj4RQerr67NxWM/s7OwnRUVFHxYWFj6GUqk8olAo3lzxI6lUuislJWVvUlLSK9EA7WU0Gq9AEJdcLj+wKslJRUATYAE6gE4O7cADNtcZBlL7r4CJjXm+DfgT0GdkZGxbiyBGwDE8PKw3mUzXQnC73dfBO4eGhkw8T7BYLDWLi4t2+EGH2WzWhXir1XoN3E18JxgMBvWqbUneC1yiA3U63W5+TiwWvwjeptfrNSt9OzU19RD4KpyfmJg4SoI0NzfL1uRYfr8/ixyrtbW1VCQSHUxMTIwnlJWVSUj92Pjn4uLix1xovqGhIX1packOQb5OTk4+GOIlEkk8uKvQVmd5efnONQmSnZ39Gg40A14gAPQy0NjOEOR4ggD8znwhnPfMzc39gK3XlisKCgq24eNaOtDn833R3t5+ntDb23sR3D3gN6/X+xnjL9DvyMjId+RXWP9jiIePnO/v778K3m+32wvXFfddXV1qMk9qamo8z9tsNi1FQVpa2gs8D7/5gBIU1ot43ul0ltE+6enpiesSpKmpSUqmwY0u45ZSaECGTSUUSXRz8KfBHyIeeG98fPxLtv4jevd4PGmIrsPgbgMtOTk5z69LEPjJc8iC5CduUi3disHFfMHLcQQn8Afg4zga/+VwODSRZOUYRMf32Kh7dHT0Y5jqFGFsbOxzEg5RoIXdTwCKYDCoAHeLfCcQCKhoXXd390ms+ZYctba2Njei+gBPp8ooYCNxiENueYtuSrkhLP/UAIaEhIQtXP7QkKYaGxv3RiRISUmJiG4PLeigXjlQgPE50hJuewWZVkEcNHKWZeM7iKwzxLlcrjPIqGbkkEZstTkiQWQy2Q5s/gsr1yG7+5nf+MJ8xMNyiMC9++bn51VRKd9arXYfasch1Ix3VwtEzNsQ4hsSqrS09J2oCILeYatKpXqaktxqoFarY6urq7dDCEpklqysrD0RC4HYFzHbU0QYGKiStrAMe5ehZYV5L0Ud0sDmiAXJzMx8g/UeXuYbAhtbWXtXD9Sxdw+bF9jYiGp7OCpmodtgQ6oh7r6+vqLBwcHjrFm6AXO9jOr6DFS/C03xPVTeNkEQjvb09JRg7Jienq6OWp+JQ3Yz0+hDHMKSao0Tndbr9I7yv5+y7eTk5DmuL7kOQdowjI2KILm5uRS+N6gHyc/PP4DeYufAwAB1aR15eXn7aE1VVdVL0IANh9fExcXtqKys3I/8QaZqwfSWqGkFqlay3sPK+tW/wX3KJakY1KQKtsbIfCpQV1d3Kqp/A9AexsIHill03IfKy8E9y6+pqKggzV1ggrQCSvjXUxt/KTee/+L5FwmS/gs/m0cyAAAAAElFTkSuQmCC"};(function(f){var a=Backbone.View.extend({initialize:function(){this.container=document.createElement("div");this.content=document.createElement("div");this.container.appendChild(this.content);this.el=this.container;this.container.style.overflow="hidden";this.content.style.width="100%";this.content.style.height="100%";this.scroll=new f(this.container,{hScrollbar:!1,vScrollbar:!1});var a=this,l=function(){a.scroll.refresh();[].slice.call(a.content.querySelectorAll("input, select, button")).forEach(function(a){a.addEventListener("ontouchstart"in
window?"touchstart":"mousedown",function(a){a.stopPropagation()})})};$(this.container).bind("DOMNodeInsertedIntoDocument",l);$(window).bind("resize",l)},events:{},html:function(a){$(this.content).html(a)},getContent:function(){return $(this.content)},setPullToRefresh:function(a){var f={pullDownOffset:30,pullUpOffset:30};for(i in a)f[i]=a[i];pullDownEl=f.pullDownEl;pullUpEl=f.pullUpEl;pullDownOffset=f.pullDownOffset;pullUpOffset=f.pullUpOffset;pullUpAction=f.pullUpAction;pullDownAction=f.pullDownAction;
pullDownEl&&pullDownEl.html('<span class="pullDownIcon"></span><span class="pullDownLabel">Pull down to refresh...</span>');pullUpEl&&pullUpEl.html('<span class="pullUpIcon"></span><span class="pullUpLabel">Pull up to refresh...</span>');this.render({useTransition:!0,topOffset:pullDownOffset,onRefresh:function(){pullDownEl&&pullDownEl.hasClass("loading")?(pullDownEl.removeClass("loading"),$(".pullDownLabel",pullDownEl).html("Pull down to refresh...")):pullUpEl&&pullUpEl.hasClass("loading")&&(pullUpEl.removeClass("loading"),
$(".pullUpLabel",pullUpEl).html("Pull up to load more..."))},onScrollMove:function(){pullDownEl&&5<this.y&&!pullDownEl.hasClass("flip")?(pullDownEl.addClass("flip"),$(".pullDownLabel",pullDownEl).html("Release to refresh..."),this.minScrollY=0):pullDownEl&&5>this.y&&pullDownEl.hasClass("flip")?(pullDownEl.removeClass("flip"),$(".pullDownLabel",pullDownEl).html("Pull down to refresh..."),this.minScrollY=-pullDownOffset):pullUpEl&&this.y<this.maxScrollY-5&&!pullUpEl.hasClass("flip")?(pullUpEl.addClass("flip"),
$(".pullUpLabel",pullUpEl).html("Release to refresh..."),this.maxScrollY=this.maxScrollY):pullUpEl&&this.y>this.maxScrollY+5&&pullUpEl.hasClass("flip")&&(pullUpEl.removeClass("flip"),$(".pullUpLabel",pullUpEl).html("Pull up to load more..."),this.maxScrollY=pullUpOffset)},onScrollEnd:function(){pullDownEl&&pullDownEl.hasClass("flip")?(pullDownEl.removeClass("flip").addClass("loading"),$(".pullDownLabel",pullDownEl).html("Loading..."),pullDownAction()):pullUpEl&&pullUpEl.hasClass("flip")&&(pullUpEl.removeClass("flip").addClass("loading"),
$(".pullUpLabel",pullUpEl).html("Loading..."),pullUpAction())}})},scrollTo:function(a,f,g){g||(g=300);this.scroll.scrollTo(-a,-f,g)},render:function(a){a?this.scroll.setOption(a):this.scroll.refresh();return this}});window.myapp=window.myapp||{};window.myapp.Widget=window.myapp.Widget||{};window.myapp.Widget.Scroller=a})(iScroll);(function(){var f=Backbone.View.extend({initialize:function(){this._isEnabled=!0;this._clickStart=!1;this._lastY=this._lastX=null},events:{mouseout:"onMouseOut",mousedown:"mouseDown",touchstart:"touchStart",touchmove:"touchMove",mouseup:"mouseUp",touchend:"touchEnd"},onMouseOut:function(){this._clickStart=!1;$(this.el).removeClass("Pressed")},mouseDown:function(a){a.preventDefault();a.stopPropagation();this.start(a.clientX,a.clientY)},touchStart:function(a){a.preventDefault();a.stopPropagation();
this.start(a.changedTouches[0].pageX,a.changedTouches[0].pageY);for(a=a.target;!a.tagName;)a=a.parentElement;var f=a.getBoundingClientRect();this.topLeftX=f.left;this.topLeftY=f.top;this.bottomRightX=f.left+a.clientWidth;this.bottomRightY=f.top+a.clientHeight},touchMove:function(a){a.preventDefault();a.stopPropagation();var f=a.changedTouches[0].pageX,a=a.changedTouches[0].pageY;if(f<this.topLeftX||f>this.bottomRightX||a<this.topLeftY||a>this.bottomRightY)this._clickStart=!1,$(this.el).removeClass("Pressed")},
mouseUp:function(a){a.preventDefault();a.stopPropagation();this.end(a.clientX,a.clientY)},touchEnd:function(a){a.preventDefault();a.stopPropagation();this.end(a.changedTouches[0].pageX,a.changedTouches[0].pageY)},start:function(a,f){this._isEnabled&&null!=a&&null!=f&&(this._lastX=a,this._lastY=f,this._clickStart=!0,this.changeColorWhenTouch&&$(this.el).addClass("Pressed"))},end:function(a,f){this._isEnabled&&null!=a&&null!=f&&(this._lastY=this._lastX=null,this._clickStart&&$(this.el).trigger("clickByTouch"),
this._clickStart=!1,$(this.el).removeClass("Pressed"))}});window.myapp=window.myapp||{};window.myapp.Widget=window.myapp.Widget||{};window.myapp.Widget.TouchWidget=f})();(function(){var f=Backbone.View.extend({render:function(){var a=this.model.get("_storeNameId"),f=this.model.get("_displayedName"),l=this.model.get("_msg"),g=this.model.get("_imgUrl");$(this.el).html(_.template('<a href="#storePage/<%= id %>"><img src="<%= img %>"></img><div class="Tag"></div><div class="InfoWidget"><div class="NameWidget"><div class="Name"><%= name %></div><div class="Msg"><%= msg %></div></div><div class="Bar"><div></div></div><div class="Status"></div></div></a>',{id:a,name:f,msg:l,
img:g}));$(this.el).addClass("StoreBriefWidget3");return this}});window.myapp=window.myapp||{};window.myapp.View=window.myapp.View||{};window.myapp.View.StoreBrief=f})();(function(f,a,o){var l=Backbone.View.extend({initialize:function(){var g=new a;g.html(_.template('<div class="StoreList"></div>'));$(this.el).html(g.render().el);$(this.el).css("background-color","rgba(255, 255, 255, 0.75)");$(this.el).css("display","-webkit-box");$(g.el).css("width","100%");var k=this,l=new f;l.fetch({success:function(){window.menuData=l;_.each(l.get("stores").models,function(a){a=new o({model:a});$(".StoreList",k.el).append(a.render().el)});$("img",this.el).bind("load",function(){g.render()});
g.render()},error:function(a,e){console.log(e.status)}})},events:{},render:function(){this.delegateEvents();return this}});window.myapp=window.myapp||{};window.myapp.OrderTabView=l})(window.myapp.Model.MenuData,window.myapp.Widget.Scroller,window.myapp.View.StoreBrief);(function(f){var a=Backbone.View.extend({initialize:function(){var a=new f;a.html(_.template('<div id="pullDown"></div><div class="OrderHistory"><div><div class="gwt-Label">點餐紀錄:</div><div class="OrderHistoryPanelTitle"><div class="gwt-Label">✭</div><div class="gwt-Label">送餐時間</div><div class="gwt-Label">編號</div><div class="gwt-Label">狀態</div></div></div><div class="Accordion OrderHistoryPanel"></div></div><div id="pullUp"></div>'));$(this.el).html(a.el);$(this.el).css("background-color","rgba(255, 255, 255, 0.75)");
$(this.el).css("display","-webkit-box");$(a.el).css("width","100%");$(".OrderHistoryPanel",this.el).css("minHeight",window.clientHeight);pullDownEl=$("#pullDown",this.el);pullDownOffset=30;pullUpEl=$("#pullUp",this.el);pullUpOffset=30;var l=this;a.setPullToRefresh({pullDownEl:pullDownEl,pullDownAction:function(){setTimeout(function(){el=$(".OrderHistoryPanel",l.el);for(i=0;3>i;i++)el.prepend("<li>Generated row</li>");a.render()},1E3)}})},render:function(){return this}});window.myapp=window.myapp||
{};window.myapp.HistoryTabView=a})(window.myapp.Widget.Scroller);(function(f,a){var o=Backbone.View.extend({initialize:function(){var l=new a;l.html(_.template("<div class='about_text' style='width:100%;'>感謝您使用Jashami(甲蝦米)<br/>您希望哪些商家擁有Jashami的服務，請推薦給我們：<input id='recommendation' type='Text' class='INPUT Text'>請留下您的寶貴意見，我們將為您提供更好的服務:<input id='opinion' type='Text' class='INPUT Text'><div id='sendFeedbackBtn' class='SubmitButton'>送出</div></div>"));$(this.el).html(l.el);$(this.el).css("background-color","rgba(255, 255, 255, 0.75)");$(this.el).css("display","-webkit-box");
$(l.el).css("width","100%");this.sendFeedbackBtn=new f({el:$("#sendFeedbackBtn",this.el)});this.sendFeedbackBtn.changeColorWhenTouch=!0},events:{"clickByTouch #sendFeedbackBtn":"sendFeedback"},render:function(){this.sendFeedbackBtn.delegateEvents();this.delegateEvents();return this},sendFeedback:function(){var a=$("#recommendation",this.el).val(),f=$("#opinion",this.el).val();alert("sendFeedback"+a+f)}});window.myapp=window.myapp||{};window.myapp.FeedbackTabView=o})(window.myapp.Widget.TouchWidget,
window.myapp.Widget.Scroller);(function(f){var a=Backbone.View.extend({initialize:function(){var a=new f;a.html(_.template('<div id="content" data-scrollable="y" style="width:100%;">qqq</div>'));$(this.el).html(a.el);$(this.el).css("background-color","rgba(255, 255, 255, 0.75)");$(this.el).css("display","-webkit-box");$(a.el).css("width","100%")},events:{},render:function(){return this}});window.myapp=window.myapp||{};window.myapp.AboutUsTabView=a})(window.myapp.Widget.Scroller);(function(f,a,o){var l=['<div class="HeaderPanel"><div></div><div>','<img src="'+a.JashamiLogo+'">','</div><div></div></div><div class="TabPanel"><div class="TabContent"></div><div class="TabHeader">','<div class="TabButton"><a href="#startPage/orderTab">'+f._("orderTab")+"</a></div>",'<div class="TabButton"><a href="#startPage/historyTab">'+f._("historyTab")+"</a></div>",'<div class="TabButton"><a href="#startPage/feedbackTab">'+f._("feedbackTab")+"</a></div>",'<div class="TabButton"><a href="#startPage/aboutUsTab">'+
f._("aboutUsTab")+"</a></div>","</div></div>"].join(""),f=Backbone.View.extend({initialize:function(){this.tabs={};$(this.el).html(_.template(l));$(this.el).addClass("Base");$(this.el).attr("id","startPageView");$(this.el).attr("style","height:100%; width:100%;")},render:function(){return this},toTab:function(a){this.tabs[a]||(this.tabs[a]=new o[a]);$(".TabContent",this.el).html(this.tabs[a].render().el)}});window.myapp=window.myapp||{};window.myapp.StartPageView=f})(i18n,window.myapp.Images,{orderTab:window.myapp.OrderTabView,
historyTab:window.myapp.HistoryTabView,feedbackTab:window.myapp.FeedbackTabView,aboutUsTab:window.myapp.AboutUsTabView});(function(f,a,o){var l=['<div class="HeaderPanel"><div><div class="HeaderButton BackButton"><span class="Pointer"></span><span class="Button">返回</span></div></div><div id="storeName"></div><div></div></div><div id="storeContent" style="background-color:rgba(255, 255, 255, 0.75) ; -webkit-box-flex: 10;display: -webkit-box; -webkit-box-orient: horizontal;"></div><div class="ShoppingCar"><div style="position: relative; " class="Car"><div style="position: absolute; overflow-x: hidden; overflow-y: hidden; top: 0%; right: 0%; bottom: 0%; width: 25%; "><div class="Button" style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; ">',
'<div><img src="'+f.ShoppingCarIcon+'"></div><div class="ButtonText">查看</div>','</div></div><div style="position: absolute; overflow-x: hidden; overflow-y: hidden; left: 0%; top: 0%; right: 25%; height: 50%; "><div class="ProgressBarPanel" style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; "><div class="ProgressMsgOk">可外送</div><div style="" class="ProgressMsgNotOk">未達額度</div><div class="ProgressBar"><div class="Progress"></div></div><div class="gwt-Label">0/800</div></div></div><div style="position: absolute; overflow-x: hidden; overflow-y: hidden; left: 0%; top: 50%; bottom: 0%; width: 30%; "><div class="gwt-Label" style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; ">總共$</div></div><div style="position: absolute; overflow-x: hidden; overflow-y: hidden; left: 30%; top: 50%; right: 25%; bottom: 0%; "><div class="gwt-Label" style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; ">0元</div></div></div></div>'].join(""),
f=Backbone.View.extend({initialize:function(){var f=this;$(this.el).addClass("Base");$(this.el).attr("style","height:100%");$(this.el).attr("style","width:100%");this.scroller=new o;this._segmentPanelWidth=640<$(window).width()?60:30;this.segmentPanel=new o;$(this.el).html(_.template(l));$("#storeContent",this.el).append(this.scroller.render().el);$("#storeContent",this.el).append(this.segmentPanel.render().el);$(this.segmentPanel.getContent()).addClass("ScrollBar Segment");this.backBtn=new a({el:$(".BackButton",
this.el)});this.backBtn.changeColorWhenTouch=!0;this._col=3;this._gridWidth=100;this._gridHeight=75;this._gridHMargin=2;this._minCol=this._gridVMargin=3;this._minGridWidth=100;this._maxGridWidth=150;var k=function(){var a=$(window).width()-f._segmentPanelWidth;$(f.scroller.el).css("width",a+"px");for(var d=2*f._gridHMargin,e=a/f._col-d;e>f._maxGridWidth;)f._col++,e=a/f._col-d;for(;f._col>f._minCol&&e<f._minGridWidth;)f._col--,e=a/f._col-d;f._gridHeight=f._gridHeight*e/f._gridWidth;f._gridWidth=e;
f.setModel()};$(this.scroller.el).bind("DOMNodeInsertedIntoDocument",k);$(window).bind("resize",k)},setModel:function(a){a&&(this.model=a);var f=this,a=this.model.get("_displayedName");$("#storeName",this.el).html(a);this.scroller.getContent().empty();this.segmentPanel.getContent().empty();var a=this.model.get("_menuId").get("products").models,l,d;_.each(a,function(a){var g=document.createElement("div");g.style["float"]="left";g.style.marginTop=f._gridVMargin+"px";g.style.marginBottom=f._gridVMargin+
"px";g.style.marginLeft=f._gridHMargin+"px";g.style.marginRight=f._gridHMargin+"px";var o=a.get("_imgUrl"),n=a.get("_displayedName"),q=a.get("_price");if(o){g.style.width=f._gridWidth+"px";g.style.height=f._gridHeight*2+f._gridVMargin+"px";$(g).html(_.template('<div class="ProductBoxWidget2"><img class="ProductBoxWidget2-img" src="<%= img %>"/><div class="ProductBoxWidget2-info"><div class="ProductBoxWidget2-name"><%= name %></div><div class="ProductBoxWidget2-price"><%= price %>元</div></div></div>',
{img:o,name:n,price:q}))}else{g.style.width=f._gridWidth+"px";g.style.height=f._gridHeight+"px";$(g).html(_.template('<div class="ProductBoxWidget2"><div class="ProductBoxWidget2-infoNoImg"><div class="ProductBoxWidget2-name"><%= name %></div><div class="ProductBoxWidget2-price"><%= price %>元</div></div></div>',{name:n,price:q}))}a=a.get("_category");a=a.substring(a.indexOf(".")+1);if(a==l)$(d).append(g);else{l=a;n=document.createElement("div");n.className="FlexGridContainerTitle";o=l.indexOf("@");
o>=0&&(a=l.substring(0,o));n.innerHTML=a;d=document.createElement("div");d.className="FlexGridContainer color1";$(d).append(n);$(d).append(g);f.scroller.getContent().append(d);g=document.createElement("div");g.className="SegmentWidget color1";o=l.indexOf("@")+1;o>0&&(a=l.substring(o));g.innerHTML="<div>"+a+"</div>";f.segmentPanel.getContent().append(g);$(g).width(f._segmentPanelWidth);$(g).attr("loc",d.offsetTop-$(f.segmentPanel.getContent()).offset().top)}});this.scroller.render();this.segmentPanel.render();
this.scroller.scrollTo(0,0,0);this.segmentPanel.scrollTo(0,0,0);$(".SegmentWidget",this.el).bind("click",function(a){a=$(a.currentTarget).attr("loc");f.scroller.scrollTo(0,a)})},render:function(){this.backBtn.delegateEvents();this.scroller.render();this.delegateEvents();return this}});window.myapp=window.myapp||{};window.myapp.StorePageView=f})(window.myapp.Images,window.myapp.Widget.TouchWidget,window.myapp.Widget.Scroller);(function(f,a){var o=Backbone.Router.extend({routes:{"startPage/:tab":"startPage","storePage/:store":"storePage","*actions":"defaultAction"},initialize:function(){var a=this;this.views={};this.firstPage=this.useTransitionEffect=!0;this.isGoBack=!1;$(".BackButton").live("clickByTouch",function(){a.isGoBack=!0;window.history.back()})},defaultAction:function(){this.startPage("orderTab")},startPage:function(f){this.views.startPage||(this.views.startPage=new a.StartPageView);$("#startPageView").length&&
(this.firstPage=!0);this.views.startPage.toTab(f);this.changePage(this.views.startPage.render().el)},storePage:function(l){this.views.storePage||(this.views.storePage=new a.StorePageView);if(window.menuData)this.views.storePage.model=window.menuData.get("stores").get(l),this.changePage(this.views.storePage.render().el);else{var g=this;window.menuData=new f;window.menuData.fetch({success:function(){g.views.storePage.model=window.menuData.get("stores").get(l);g.changePage(g.views.storePage.render().el)}})}},
changePage:function(a){if(!this.useTransitionEffect||this.firstPage)$(".ActivePage").html(a),this.firstPage=!1;else{var f=$(".ActivePage").children(),k=$(a);f.addClass("transitionSlide transitionOut");k.addClass("transitionSlide transitionIn");this.isGoBack&&(f.addClass("reverse"),k.addClass("reverse"));$(".ActivePage").append(a);this.isGoBack?f.bind("webkitTransitionEnd",function(){f.unbind();f.removeClass("transitionSlide transitionOut reverse transitionStart");k.removeClass("transitionSlide transitionIn reverse transitionStart");
f.remove()}):k.bind("webkitTransitionEnd",function(){k.unbind();f.removeClass("transitionSlide transitionOut reverse transitionStart");k.removeClass("transitionSlide transitionIn reverse transitionStart");f.remove()});setTimeout(function(){f.addClass("transitionStart");k.addClass("transitionStart")},10);this.isGoBack=!1}}});window.myapp=window.myapp||{};window.myapp.Router=o})(window.myapp.Model.MenuData,{StartPageView:window.myapp.StartPageView,StorePageView:window.myapp.StorePageView});
