var i18n=function(){var d={},b={DST:-4,format:"D, d F Y H:i:s",AM:"AM",PM:"PM"};Date.prototype.format=function(d){var b="",l=Date.replaceChars,m="";l.reload();for(var e=0;e<d.length;e++)m=d.charAt(e),b+=l[m]?l[m].call(this):m;return b};Date.replaceChars={reload:function(){Date.replaceChars.shortMonths=d.hasOwnProperty("shortMonths")?d.shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(",");Date.replaceChars.longMonths=d.hasOwnProperty("longMonths")?d.longMonths:"January,February,March,April,May,June,July,August,September,October,November,December".split(",");
Date.replaceChars.shortDays=d.hasOwnProperty("shortDays")?d.shortDays:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(",");Date.replaceChars.longDays=d.hasOwnProperty("longDays")?d.longDays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(",")},shortMonths:[],longMonths:[],shortDays:[],longDays:[],d:function(){return(10>this.getUTCDate()?"0":"")+this.getUTCDate()},D:function(){return Date.replaceChars.shortDays[this.getUTCDay()]},j:function(){return this.getUTCDate()},l:function(){return Date.replaceChars.longDays[this.getUTCDay()]},
N:function(){return this.getDay()+1},S:function(){return 1===this.getUTCDate()%10&&11!==this.getUTCDate()?"st":2===this.getUTCDate()%10&&12!==this.getUTCDate()?"nd":3==this.getUTCDate()%10&&13!=this.getUTCDate()?"rd":"th"},w:function(){return this.getUTCDay()},z:function(){return""},W:function(){return""},F:function(){return Date.replaceChars.longMonths[this.getUTCMonth()]},m:function(){return(9>this.getUTCMonth()?"0":"")+(this.getUTCMonth()+1)},M:function(){return Date.replaceChars.shortMonths[this.getUTCMonth()]},
n:function(){return this.getUTCMonth()+1},t:function(){return""},L:function(){return""},o:function(){return""},Y:function(){return this.getUTCFullYear()},y:function(){return(""+this.getUTCFullYear()).substr(2)},a:function(){var k=d.hasOwnProperty("setting")?d.setting:b;return 12>this.getUTCHours()?k.AM:k.PM},A:function(){var k=d.hasOwnProperty("setting")?d.setting:b;return 12>this.getUTCHours()?k.AM:k.PM},B:function(){return""},g:function(){return this.getUTCHours()%12||12},G:function(){return this.getUTCHours()},
h:function(){return(10>(this.getUTCHours()%12||12)?"0":"")+(this.getUTCHours()%12||12)},H:function(){return(10>this.getUTCHours()?"0":"")+this.getUTCHours()},i:function(){return(10>this.getUTCMinutes()?"0":"")+this.getUTCMinutes()},s:function(){return(10>this.getUTCSeconds()?"0":"")+this.getUTCSeconds()},e:function(){return""},I:function(){return""},O:function(){return(0>-this.getTimezoneOffset()?"-":"+")+(10>Math.abs(this.getTimezoneOffset()/60)?"0":"")+Math.abs(this.getTimezoneOffset()/60)+"00"},
T:function(){var d=this.getUTCMonth();this.setMonth(0);var b=this.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,"$1");this.setMonth(d);return b},Z:function(){return 60*-this.getTimezoneOffset()},c:function(){return""},r:function(){return this.toString()},U:function(){return this.getUTCTime()/1E3}};var o=function(d,b,l){var m,b=parseInt(b,10);"string"===typeof l&&(l=l.split(/\D/),--l[1],m=new Date(l.join(",")));m="object"===typeof m?m:l;switch(d){case "y":m.setFullYear(m.getFullYear()+b);break;case "m":m.setMonth(m.getMonth()+
b);break;case "d":m.setDate(m.getDate()+b);break;case "w":m.setDate(m.getDate()+7*b);break;case "h":m.setHours(m.getHours()+b);break;case "n":m.setMinutes(m.getMinutes()+b);break;case "s":m.setSeconds(m.getSeconds()+b);break;case "l":m.setMilliseconds(m.getMilliseconds()+b)}return m};return{set:function(b){d=b},datetime:function(k){var g=d.hasOwnProperty("setting")?d.setting:b;return(g.format?o("h",g.DST,k?new Date(k):new Date):k?new Date(k):new Date).format(g.format)},_:function(b){try{var b=b.toString()||
"",g=arguments,l=0<g.length?RegExp("%([1-"+g.length.toString()+"])","g"):null;return(""+(d.hasOwnProperty(b)?d[b]:b)).replace(l,function(b,d){return g[d]})}catch(m){}}}}();(function(d){String.prototype.trim===d&&(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")});Array.prototype.reduce===d&&(Array.prototype.reduce=function(b){if(void 0===this||null===this)throw new TypeError;var o=Object(this),k=o.length>>>0,g=0,l;if("function"!=typeof b)throw new TypeError;if(0==k&&1==arguments.length)throw new TypeError;if(2<=arguments.length)l=arguments[1];else{do{if(g in o){l=o[g++];break}if(++g>=k)throw new TypeError;}while(1)}for(;g<k;)g in o&&
(l=b.call(d,l,o[g],g,o)),g++;return l})})();
var Zepto=function(){function d(a){return"[object Function]"=={}.toString.call(a)}function b(a){return a instanceof Object}function o(a){return a instanceof Array}function k(a){return"number"==typeof a.length}function g(a){return a.filter(function(a){return a!==r&&null!==a})}function l(a){return a.replace(/-+(.)?/g,function(a,c){return c?c.toUpperCase():""})}function m(a){return a.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}
function e(a){return a.filter(function(a,c,j){return j.indexOf(a)==c})}function f(a){return a in C?C[a]:C[a]=RegExp("(^|\\s)"+a+"(\\s|$)")}function h(c,j){j===r&&D.test(c);j in p||(j="*");var b=p[j];return b.innerHTML=""+c,a.call(b.childNodes)}function s(a,j){return a=a||c,a.__proto__=s.prototype,a.selector=j||"",a}function n(a,c){if(!a)return s();if(c!==r)return n(c).find(a);if(d(a))return n(j).ready(a);if(a instanceof s)return a;var p;return o(a)?p=g(a):0<=A.indexOf(a.nodeType)||a===window?(p=[a],
a=null):D.test(a)?(p=h(a.trim(),RegExp.$1),a=null):a.nodeType&&3==a.nodeType?p=[a]:p=t(j,a),s(p,a)}function q(a,c){return c===r?n(a):n(a).filter(c)}function u(a,c,j,p){return d(c)?c.call(a,j,p):c}function y(a,c,j){var p=a%2?c:c.parentNode;p&&p.insertBefore(j,a?1==a?p.firstChild:2==a?c:null:c.nextSibling)}function z(a,c){c(a);for(var j in a.childNodes)z(a.childNodes[j],c)}var r,v,t,w,c=[],a=c.slice,j=window.document,x={},C={},F=j.defaultView.getComputedStyle,E={"column-count":1,columns:1,"font-weight":1,
"line-height":1,opacity:1,"z-index":1,zoom:1},D=/^\s*<(\w+)[^>]*>/,A=[1,9,11],B=j.createElement("table"),G=j.createElement("tr"),p={tr:j.createElement("tbody"),tbody:B,thead:B,tfoot:B,td:G,th:G,"*":j.createElement("div")},H=/complete|loaded|interactive/,I=/^\.([\w-]+)$/,J=/^#([\w-]+)$/,K=/^[\w-]+$/;return n.extend=function(c){return a.call(arguments,1).forEach(function(a){for(v in a)c[v]=a[v]}),c},n.qsa=t=function(p,b){var d;return p===j&&J.test(b)?(d=p.getElementById(RegExp.$1))?[d]:c:a.call(I.test(b)?
p.getElementsByClassName(RegExp.$1):K.test(b)?p.getElementsByTagName(b):p.querySelectorAll(b))},n.isFunction=d,n.isObject=b,n.isArray=o,n.map=function(a,c){var j,p=[],b;if(k(a))for(b=0;b<a.length;b++)j=c(a[b],b),null!=j&&p.push(j);else for(b in a)j=c(a[b],b),null!=j&&p.push(j);return 0<p.length?[].concat.apply([],p):p},n.each=function(a,c){var j;if(k(a))for(j=0;j<a.length&&!1!==c(j,a[j]);j++);else for(j in a)if(!1===c(j,a[j]))break;return a},n.fn={forEach:c.forEach,reduce:c.reduce,push:c.push,indexOf:c.indexOf,
concat:c.concat,map:function(a){return n.map(this,function(c,j){return a.call(c,j,c)})},slice:function(){return n(a.apply(this,arguments))},ready:function(a){return H.test(j.readyState)?a(n):j.addEventListener("DOMContentLoaded",function(){a(n)},!1),this},get:function(a){return a===r?this:this[a]},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(a){return this.forEach(function(c,j){a.call(c,
j,c)}),this},filter:function(a){return n([].filter.call(this,function(c){return c.parentNode&&0<=t(c.parentNode,a).indexOf(c)}))},end:function(){return this.prevObject||n()},andSelf:function(){return this.add(this.prevObject||n())},add:function(a,c){return n(e(this.concat(n(a,c))))},is:function(a){return 0<this.length&&0<n(this[0]).filter(a).length},not:function(c){var j=[];if(d(c)&&c.call!==r)this.each(function(a){c.call(this,a)||j.push(this)});else{var p="string"==typeof c?this.filter(c):k(c)&&
d(c.item)?a.call(c):n(c);this.forEach(function(a){0>p.indexOf(a)&&j.push(a)})}return n(j)},eq:function(a){return-1===a?this.slice(a):this.slice(a,+a+1)},first:function(){var a=this[0];return a&&!b(a)?a:n(a)},last:function(){var a=this[this.length-1];return a&&!b(a)?a:n(a)},find:function(a){var c;return 1==this.length?c=t(this[0],a):c=this.map(function(){return t(this,a)}),n(c)},closest:function(a,c){var p=this[0],b=t(c||j,a);for(b.length||(p=null);p&&0>b.indexOf(p);)p=p!==c&&p!==j&&p.parentNode;return n(p)},
parents:function(a){for(var c=[],p=this;0<p.length;)p=n.map(p,function(a){if((a=a.parentNode)&&a!==j&&0>c.indexOf(a))return c.push(a),a});return q(c,a)},parent:function(a){return q(e(this.pluck("parentNode")),a)},children:function(c){return q(this.map(function(){return a.call(this.children)}),c)},siblings:function(c){return q(this.map(function(c,j){return a.call(j.parentNode.children).filter(function(a){return a!==j})}),c)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(a){return this.map(function(){return this[a]})},
show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=null);if("none"==F(this,"").getPropertyValue("display")){var a=this.style,c;c=this.nodeName;var p,b;c=(x[c]||(p=j.createElement(c),j.body.appendChild(p),b=F(p,"").getPropertyValue("display"),p.parentNode.removeChild(p),"none"==b&&(b="block"),x[c]=b),x[c]);a.display=c}})},replaceWith:function(a){return this.each(function(){n(this).before(a).remove()})},wrap:function(a){return this.each(function(){n(this).wrapAll(n(a)[0].cloneNode(!1))})},
wrapAll:function(a){return this[0]&&(n(this[0]).before(a=n(a)),a.append(this)),this},unwrap:function(){return this.parent().each(function(){n(this).replaceWith(n(this).children())}),this},hide:function(){return this.css("display","none")},toggle:function(a){return(a===r?"none"==this.css("display"):a)?this.show():this.hide()},prev:function(){return n(this.pluck("previousElementSibling"))},next:function(){return n(this.pluck("nextElementSibling"))},html:function(a){return a===r?0<this.length?this[0].innerHTML:
null:this.each(function(c){var j=this.innerHTML;n(this).empty().append(u(this,a,c,j))})},text:function(a){return a===r?0<this.length?this[0].textContent:null:this.each(function(){this.textContent=a})},attr:function(a,c){var j;return"string"==typeof a&&c===r?0==this.length?r:"value"==a&&"INPUT"==this[0].nodeName?this.val():!(j=this[0].getAttribute(a))&&a in this[0]?this[0][a]:j:this.each(function(j){if(b(a))for(v in a)this.setAttribute(v,a[v]);else this.setAttribute(a,u(this,c,j,this.getAttribute(a)))})},
removeAttr:function(a){return this.each(function(){this.removeAttribute(a)})},data:function(a,c){return this.attr("data-"+a,c)},val:function(a){return a===r?0<this.length?this[0].value:null:this.each(function(c){this.value=u(this,a,c,this.value)})},offset:function(){if(0==this.length)return null;var a=this[0].getBoundingClientRect();return{left:a.left+window.pageXOffset,top:a.top+window.pageYOffset,width:a.width,height:a.height}},css:function(a,c){if(c===r&&"string"==typeof a)return 0==this.length?
r:this[0].style[l(a)]||F(this[0],"").getPropertyValue(a);var j="";for(v in a)j+=m(v)+":"+("number"==typeof a[v]&&!E[m(v)]?a[v]+"px":a[v])+";";return"string"==typeof a&&(j=m(a)+":"+("number"==typeof c&&!E[m(a)]?c+"px":c)),this.each(function(){this.style.cssText+=";"+j})},index:function(a){return a?this.indexOf(n(a)[0]):this.parent().children().indexOf(this[0])},hasClass:function(a){return 1>this.length?!1:f(a).test(this[0].className)},addClass:function(a){return this.each(function(c){w=[];var j=this.className;
u(this,a,c,j).split(/\s+/g).forEach(function(a){n(this).hasClass(a)||w.push(a)},this);w.length&&(this.className+=(j?" ":"")+w.join(" "))})},removeClass:function(a){return this.each(function(c){if(a===r)return this.className="";w=this.className;u(this,a,c,w).split(/\s+/g).forEach(function(a){w=w.replace(f(a)," ")});this.className=w.trim()})},toggleClass:function(a,c){return this.each(function(j){j=u(this,a,j,this.className);(c===r?!n(this).hasClass(j):c)?n(this).addClass(j):n(this).removeClass(j)})}},
"filter,add,not,eq,first,last,find,closest,parents,parent,children,siblings".split(",").forEach(function(a){var c=n.fn[a];n.fn[a]=function(){var a=c.apply(this,arguments);return a.prevObject=this,a}}),["width","height"].forEach(function(a){n.fn[a]=function(c){var p,b=a.replace(/./,function(a){return a[0].toUpperCase()});return c===r?this[0]==window?window["inner"+b]:this[0]==j?j.documentElement["offset"+b]:(p=this.offset())&&p[a]:this.each(function(j){var p=n(this);p.css(a,u(this,c,j,p[a]()))})}}),
["after","prepend","before","append"].forEach(function(a,c){n.fn[a]=function(a){var j=b(a)?a:h(a);if(!("length"in j)||j.nodeType)j=[j];if(1>j.length)return this;var p=this.length,d=1<p,e=2>c;return this.each(function(a,b){for(var f=0;f<j.length;f++){var x=j[e?j.length-f-1:f];z(x,function(a){null!=a.nodeName&&"SCRIPT"===a.nodeName.toUpperCase()&&(!a.type||"text/javascript"===a.type)&&window.eval.call(window,a.innerHTML)});d&&a<p-1&&(x=x.cloneNode(!0));y(c,b,x)}})};n.fn[c%2?a+"To":"insert"+(c?"Before":
"After")]=function(c){return n(c)[a](this),this}}),s.prototype=n.fn,n}();window.Zepto=Zepto;"$"in window||(window.$=Zepto);
(function(d){function b(b,d,e,g){d=o(d);if(d.ns)var k=RegExp("(?:^| )"+d.ns.replace(" "," .* ?")+"(?: |$)");return(f[b._zid||(b._zid=h++)]||[]).filter(function(b){return b&&(!d.e||b.e==d.e)&&(!d.ns||k.test(b.ns))&&(!e||b.fn==e)&&(!g||b.sel==g)})}function o(b){b=(""+b).split(".");return{e:b[0],ns:b.slice(1).sort().join(" ")}}function k(b,e,f){d.isObject(b)?d.each(b,f):b.split(/\s/).forEach(function(b){f(b,e)})}function g(b,e,g,l,m){var n=b._zid||(b._zid=h++),c=f[n]||(f[n]=[]);k(e,g,function(a,j){var e=
m&&m(j,a),f=e||j,h=function(a){var c=f.apply(b,[a].concat(a.data));return!1===c&&a.preventDefault(),c},e=d.extend(o(a),{fn:j,proxy:h,sel:l,del:e,i:c.length});c.push(e);b.addEventListener(e.e,h,!1)})}function l(d,e,g,l){var m=d._zid||(d._zid=h++);k(e||"",g,function(e,c){b(d,e,c,l).forEach(function(a){delete f[m][a.i];d.removeEventListener(a.e,a.proxy,!1)})})}function m(b){var e=d.extend({originalEvent:b},b);return d.each(u,function(d,f){e[d]=function(){return this[f]=n,b[d].apply(b,arguments)};e[f]=
q}),e}function e(b){if(!("defaultPrevented"in b)){b.defaultPrevented=!1;var d=b.preventDefault;b.preventDefault=function(){this.defaultPrevented=!0;d.call(this)}}}var f={},h=1,s={};s.click=s.mousedown=s.mouseup=s.mousemove="MouseEvents";d.event={add:g,remove:l};d.fn.bind=function(b,d){return this.each(function(){g(this,b,d)})};d.fn.unbind=function(b,d){return this.each(function(){l(this,b,d)})};d.fn.one=function(b,d){return this.each(function(e,f){g(this,b,d,null,function(b,d){return function(){var c=
b.apply(f,arguments);return l(f,d,b),c}})})};var n=function(){return!0},q=function(){return!1},u={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};d.fn.delegate=function(b,e,f){return this.each(function(h,k){g(k,e,f,b,function(e){return function(c){var a,j=d(c.target).closest(b,k).get(0);if(j)return a=d.extend(m(c),{currentTarget:j,liveFired:k}),e.apply(j,[a].concat([].slice.call(arguments,1)))}})})};d.fn.undelegate=
function(b,d,e){return this.each(function(){l(this,d,e,b)})};d.fn.live=function(b,e){return d(document.body).delegate(this.selector,b,e),this};d.fn.die=function(b,e){return d(document.body).undelegate(this.selector,b,e),this};d.fn.on=function(b,e,f){return void 0===e||d.isFunction(e)?this.bind(b,e):this.delegate(e,b,f)};d.fn.off=function(b,e,f){return void 0===e||d.isFunction(e)?this.unbind(b,e):this.undelegate(e,b,f)};d.fn.trigger=function(b,f){return"string"==typeof b&&(b=d.Event(b)),e(b),b.data=
f,this.each(function(){this.dispatchEvent(b)})};d.fn.triggerHandler=function(e,f){var h,g;return this.each(function(k,l){h=m("string"==typeof e?d.Event(e):e);h.data=f;h.target=l;d.each(b(l,e.type||e),function(c,a){g=a.proxy(h);if(h.isImmediatePropagationStopped())return!1})}),g};"focusin,focusout,load,resize,scroll,unload,click,dblclick,mousedown,mouseup,mousemove,mouseover,mouseout,change,select,keydown,keypress,keyup,error".split(",").forEach(function(b){d.fn[b]=function(e){return this.bind(b,e)}});
["focus","blur"].forEach(function(b){d.fn[b]=function(e){if(e)this.bind(b,e);else if(this.length)try{this.get(0)[b]()}catch(d){}return this}});d.Event=function(b,e){var d=document.createEvent(s[b]||"Events"),f=!0;if(e)for(var h in e)"bubbles"==h?f=!!e[h]:d[h]=e[h];return d.initEvent(b,f,!0,null,null,null,null,null,null,null,null,null,null,null,null),d}})(Zepto);
(function(d){function b(b){var d=this.os={},g=this.browser={},l=b.match(/WebKit\/([\d.]+)/),m=b.match(/(Android)\s+([\d.]+)/),e=b.match(/(iPad).*OS\s([\d_]+)/),f=!e&&b.match(/(iPhone\sOS)\s([\d_]+)/),h=b.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),s=h&&b.match(/TouchPad/),b=b.match(/(BlackBerry).*Version\/([\d.]+)/);l&&(g.version=l[1]);g.webkit=!!l;m&&(d.android=!0,d.version=m[2]);f&&(d.ios=!0,d.version=f[2].replace(/_/g,"."),d.iphone=!0);e&&(d.ios=!0,d.version=e[2].replace(/_/g,"."),d.ipad=!0);h&&(d.webos=
!0,d.version=h[2]);s&&(d.touchpad=!0);b&&(d.blackberry=!0,d.version=b[2])}b.call(d,navigator.userAgent);d.__detect=b})(Zepto);
(function(d,b){var o="",k,g=window.document.createElement("div"),l=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;d.each({Webkit:"webkit",Moz:"",O:"o",ms:"MS"},function(d,e){if(g.style[d+"TransitionProperty"]!==b)return o="-"+d.toLowerCase()+"-",k=e,!1});d.fx={off:k===b&&g.style.transitionProperty===b,cssPrefix:o,transitionEnd:k?k+"TransitionEnd":"transitionend",animationEnd:k?k+"AnimationEnd":"animationend"};d.fn.animate=function(b,e,f,h){return d.isObject(e)&&(f=e.easing,
h=e.complete,e=e.duration),e&&(e/=1E3),this.anim(b,e,f,h)};d.fn.anim=function(g,e,f,h){var k,n={},q,u=this,y,z=d.fx.transitionEnd;e===b&&(e=0.4);d.fx.off&&(e=0);if("string"==typeof g)n[o+"animation-name"]=g,n[o+"animation-duration"]=e+"s",z=d.fx.animationEnd;else{for(q in g)l.test(q)?(k||(k=[]),k.push(q+"("+g[q]+")")):n[q]=g[q];k&&(n[o+"transform"]=k.join(" "));d.fx.off||(n[o+"transition"]="all "+e+"s "+(f||""))}return y=function(){var b={};b[o+"transition"]=b[o+"animation-name"]="none";d(this).css(b);
h&&h.call(this)},0<e&&this.one(z,y),setTimeout(function(){u.css(n);0>=e&&setTimeout(function(){u.each(function(){y.call(this)})},0)},0),this};g=null})(Zepto);
(function(d){function b(b,e,f,h){if(b.global)return b=e||n,f=d.Event(f),d(b).trigger(f,h),!f.defaultPrevented}function o(e){e.global&&0===d.active++&&b(e,null,"ajaxStart")}function k(e,d){var f=d.context;if(!1===d.beforeSend.call(f,e,d)||!1===b(d,f,"ajaxBeforeSend",[e,d]))return!1;b(d,f,"ajaxSend",[e,d])}function g(e,d,f){var h=f.context;f.success.call(h,e,"success",d);b(f,h,"ajaxSuccess",[d,f,e]);m("success",d,f)}function l(e,d,f,h){var g=h.context;h.error.call(g,f,d,e);b(h,g,"ajaxError",[f,h,e]);
m(d,f,h)}function m(e,f,h){var g=h.context;h.complete.call(g,f,e);b(h,g,"ajaxComplete",[f,h]);h.global&&!--d.active&&b(h,null,"ajaxStop")}function e(){}function f(b,e,h,g){var k=d.isArray(e);d.each(e,function(c,a){g&&(c=h?g:g+"["+(k?"":c)+"]");!g&&k?b.add(a.name,a.value):(h?d.isArray(a):s(a))?f(b,a,h,c):b.add(c,a)})}var h=0,s=d.isObject,n=window.document,q,u;d.active=0;d.ajaxJSONP=function(b){var f="jsonp"+ ++h,k=n.createElement("script"),l={abort:function(){d(k).remove();f in window&&(window[f]=
e);m(l,b,"abort")}},o;return window[f]=function(c){clearTimeout(o);d(k).remove();delete window[f];g(c,l,b)},k.src=b.url.replace(/=\?/,"="+f),d("head").append(k),0<b.timeout&&(o=setTimeout(function(){l.abort();m(l,b,"timeout")},b.timeout)),l};d.ajaxSettings={type:"GET",beforeSend:e,success:e,error:e,complete:e,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:"application/json",xml:"application/xml, text/xml",html:"text/html",
text:"text/plain"},crossDomain:!1,timeout:0};d.ajax=function(b){var f=d.extend({},b||{});for(q in d.ajaxSettings)void 0===f[q]&&(f[q]=d.ajaxSettings[q]);o(f);f.crossDomain||(f.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(f.url)&&RegExp.$2!=window.location.host);if(/=\?/.test(f.url))return d.ajaxJSONP(f);f.url||(f.url=window.location.toString());f.data&&!f.contentType&&(f.contentType="application/x-www-form-urlencoded");s(f.data)&&(f.data=d.param(f.data));f.type.match(/get/i)&&f.data&&(b=f.data,f.url.match(/\?.*=/)?
b="&"+b:"?"!=b[0]&&(b="?"+b),f.url+=b);var h=f.accepts[f.dataType],b={},n=/^([\w-]+:)\/\//.test(f.url)?RegExp.$1:window.location.protocol,m=d.ajaxSettings.xhr(),c;f.crossDomain||(b["X-Requested-With"]="XMLHttpRequest");h&&(b.Accept=h);f.headers=d.extend(b,f.headers||{});m.onreadystatechange=function(){if(m.readyState==4){clearTimeout(c);var a,j=false;if(m.status>=200&&m.status<300||m.status==0&&n=="file:"){if(h=="application/json"&&!/^\s*$/.test(m.responseText))try{a=JSON.parse(m.responseText)}catch(b){j=
b}else a=m.responseText;j?l(j,"parsererror",m,f):g(a,m,f)}else l(null,"error",m,f)}};m.open(f.type,f.url,!0);f.contentType&&(f.headers["Content-Type"]=f.contentType);for(u in f.headers)m.setRequestHeader(u,f.headers[u]);return!1===k(m,f)?(m.abort(),!1):(0<f.timeout&&(c=setTimeout(function(){m.onreadystatechange=e;m.abort();l(null,"timeout",m,f)},f.timeout)),m.send(f.data),m)};d.get=function(b,e){return d.ajax({url:b,success:e})};d.post=function(b,e,f,h){return d.isFunction(e)&&(h=h||f,f=e,e=null),
d.ajax({type:"POST",url:b,data:e,success:f,dataType:h})};d.getJSON=function(b,e){return d.ajax({url:b,success:e,dataType:"json"})};d.fn.load=function(b,e){if(!this.length)return this;var f=this,h=b.split(/\s/),g;return 1<h.length&&(b=h[0],g=h[1]),d.get(b,function(c){f.html(g?d(n.createElement("div")).html(c).find(g).html():c);e&&e.call(f)}),this};var y=encodeURIComponent;d.param=function(b,e){var d=[];return d.add=function(b,e){this.push(y(b)+"="+y(e))},f(d,b,e),d.join("&").replace("%20","+")}})(Zepto);
(function(d){d.fn.serializeArray=function(){var b=[],o;return d(Array.prototype.slice.call(this.get(0).elements)).each(function(){o=d(this);var k=o.attr("type");!this.disabled&&"submit"!=k&&"reset"!=k&&"button"!=k&&("radio"!=k&&"checkbox"!=k||this.checked)&&b.push({name:o.attr("name"),value:o.val()})}),b};d.fn.serialize=function(){var b=[];return this.serializeArray().forEach(function(d){b.push(encodeURIComponent(d.name)+"="+encodeURIComponent(d.value))}),b.join("&")};d.fn.submit=function(b){b?this.bind("submit",
b):this.length&&(b=d.Event("submit"),this.eq(0).trigger(b),b.defaultPrevented||this.get(0).submit());return this}})(Zepto);
(function(d){function b(b,e,d,h){var g=Math.abs(b-e),k=Math.abs(d-h);return g>=k?0<b-e?"Left":"Right":0<d-h?"Up":"Down"}function o(){k.last&&Date.now()-k.last>=l&&(d(k.target).trigger("longTap"),k={})}var k={},g,l=750;d(document).ready(function(){d(document.body).bind("touchstart",function(b){var e=Date.now(),d=e-(k.last||e);k.target="tagName"in b.touches[0].target?b.touches[0].target:b.touches[0].target.parentNode;g&&clearTimeout(g);k.x1=b.touches[0].pageX;k.y1=b.touches[0].pageY;0<d&&250>=d&&(k.isDoubleTap=
!0);k.last=e;setTimeout(o,l)}).bind("touchmove",function(b){k.x2=b.touches[0].pageX;k.y2=b.touches[0].pageY}).bind("touchend",function(){k.isDoubleTap?(d(k.target).trigger("doubleTap"),k={}):0<k.x2||0<k.y2?((30<Math.abs(k.x1-k.x2)||30<Math.abs(k.y1-k.y2))&&d(k.target).trigger("swipe")&&d(k.target).trigger("swipe"+b(k.x1,k.x2,k.y1,k.y2)),k.x1=k.x2=k.y1=k.y2=k.last=0):"last"in k&&(g=setTimeout(function(){g=null;d(k.target).trigger("tap");k={}},250))}).bind("touchcancel",function(){k={}})});"swipe,swipeLeft,swipeRight,swipeUp,swipeDown,doubleTap,tap,longTap".split(",").forEach(function(b){d.fn[b]=
function(e){return this.bind(b,e)}})})(Zepto);(function(){function d(c,b,j){if(c===b)return 0!==c||1/c==1/b;if(null==c||null==b)return c===b;c._chain&&(c=c._wrapped);b._chain&&(b=b._wrapped);if(c.isEqual&&a.isFunction(c.isEqual))return c.isEqual(b);if(b.isEqual&&a.isFunction(b.isEqual))return b.isEqual(c);var e=f.call(c);if(e!=f.call(b))return!1;switch(e){case "[object String]":return c==""+b;case "[object Number]":return c!=+c?b!=+b:0==c?1/c==1/b:c==+b;case "[object Date]":case "[object Boolean]":return+c==+b;case "[object RegExp]":return c.source==
b.source&&c.global==b.global&&c.multiline==b.multiline&&c.ignoreCase==b.ignoreCase}if("object"!=typeof c||"object"!=typeof b)return!1;for(var h=j.length;h--;)if(j[h]==c)return!0;j.push(c);var h=0,x=!0;if("[object Array]"==e){if(h=c.length,x=h==b.length)for(;h--&&(x=h in c==h in b&&d(c[h],b[h],j)););}else{if("constructor"in c!="constructor"in b||c.constructor!=b.constructor)return!1;for(var g in c)if(a.has(c,g)&&(h++,!(x=a.has(b,g)&&d(c[g],b[g],j))))break;if(x){for(g in b)if(a.has(b,g)&&!h--)break;
x=!h}}j.pop();return x}var b=this,o=b._,k={},g=Array.prototype,l=Object.prototype,m=g.slice,e=g.unshift,f=l.toString,h=l.hasOwnProperty,s=g.forEach,n=g.map,q=g.reduce,u=g.reduceRight,y=g.filter,z=g.every,r=g.some,v=g.indexOf,t=g.lastIndexOf,l=Array.isArray,w=Object.keys,c=Function.prototype.bind,a=function(a){return new A(a)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=a),exports._=a):b._=a;a.VERSION="1.3.1";var j=a.each=a.forEach=function(c,
b,j){if(c!=null)if(s&&c.forEach===s)c.forEach(b,j);else if(c.length===+c.length)for(var e=0,d=c.length;e<d;e++){if(e in c&&b.call(j,c[e],e,c)===k)break}else for(e in c)if(a.has(c,e)&&b.call(j,c[e],e,c)===k)break};a.map=a.collect=function(a,c,b){var e=[];if(a==null)return e;if(n&&a.map===n)return a.map(c,b);j(a,function(a,j,d){e[e.length]=c.call(b,a,j,d)});if(a.length===+a.length)e.length=a.length;return e};a.reduce=a.foldl=a.inject=function(c,b,e,d){var f=arguments.length>2;c==null&&(c=[]);if(q&&
c.reduce===q)return d&&(b=a.bind(b,d)),f?c.reduce(b,e):c.reduce(b);j(c,function(a,c,j){f?e=b.call(d,e,a,c,j):(e=a,f=true)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return e};a.reduceRight=a.foldr=function(c,b,j,e){var d=arguments.length>2;c==null&&(c=[]);if(u&&c.reduceRight===u)return e&&(b=a.bind(b,e)),d?c.reduceRight(b,j):c.reduceRight(b);var f=a.toArray(c).reverse();e&&!d&&(b=a.bind(b,e));return d?a.reduce(f,b,j,e):a.reduce(f,b)};a.find=a.detect=function(a,c,b){var j;
x(a,function(a,e,d){if(c.call(b,a,e,d))return j=a,true});return j};a.filter=a.select=function(a,c,b){var e=[];if(a==null)return e;if(y&&a.filter===y)return a.filter(c,b);j(a,function(a,j,d){c.call(b,a,j,d)&&(e[e.length]=a)});return e};a.reject=function(a,c,b){var e=[];if(a==null)return e;j(a,function(a,j,d){c.call(b,a,j,d)||(e[e.length]=a)});return e};a.every=a.all=function(a,c,b){var e=true;if(a==null)return e;if(z&&a.every===z)return a.every(c,b);j(a,function(a,j,d){if(!(e=e&&c.call(b,a,j,d)))return k});
return e};var x=a.some=a.any=function(c,b,e){b||(b=a.identity);var d=false;if(c==null)return d;if(r&&c.some===r)return c.some(b,e);j(c,function(a,c,j){if(d||(d=b.call(e,a,c,j)))return k});return!!d};a.include=a.contains=function(a,c){return a==null?false:v&&a.indexOf===v?a.indexOf(c)!=-1:x(a,function(a){return a===c})};a.invoke=function(c,b){var j=m.call(arguments,2);return a.map(c,function(c){return(a.isFunction(b)?b||c:c[b]).apply(c,j)})};a.pluck=function(c,b){return a.map(c,function(a){return a[b]})};
a.max=function(c,b,e){if(!b&&a.isArray(c))return Math.max.apply(Math,c);if(!b&&a.isEmpty(c))return-Infinity;var d={computed:-Infinity};j(c,function(a,c,j){c=b?b.call(e,a,c,j):a;c>=d.computed&&(d={value:a,computed:c})});return d.value};a.min=function(c,b,e){if(!b&&a.isArray(c))return Math.min.apply(Math,c);if(!b&&a.isEmpty(c))return Infinity;var d={computed:Infinity};j(c,function(a,c,j){c=b?b.call(e,a,c,j):a;c<d.computed&&(d={value:a,computed:c})});return d.value};a.shuffle=function(a){var c=[],b;
j(a,function(a,j){j==0?c[0]=a:(b=Math.floor(Math.random()*(j+1)),c[j]=c[b],c[b]=a)});return c};a.sortBy=function(c,b,j){return a.pluck(a.map(c,function(a,c,e){return{value:a,criteria:b.call(j,a,c,e)}}).sort(function(a,c){var b=a.criteria,j=c.criteria;return b<j?-1:b>j?1:0}),"value")};a.groupBy=function(c,b){var e={},d=a.isFunction(b)?b:function(a){return a[b]};j(c,function(a,c){var b=d(a,c);(e[b]||(e[b]=[])).push(a)});return e};a.sortedIndex=function(c,b,j){j||(j=a.identity);for(var e=0,d=c.length;e<
d;){var f=e+d>>1;j(c[f])<j(b)?e=f+1:d=f}return e};a.toArray=function(c){return!c?[]:c.toArray?c.toArray():a.isArray(c)?m.call(c):a.isArguments(c)?m.call(c):a.values(c)};a.size=function(c){return a.toArray(c).length};a.first=a.head=function(a,c,b){return c!=null&&!b?m.call(a,0,c):a[0]};a.initial=function(a,c,b){return m.call(a,0,a.length-(c==null||b?1:c))};a.last=function(a,c,b){return c!=null&&!b?m.call(a,Math.max(a.length-c,0)):a[a.length-1]};a.rest=a.tail=function(a,c,b){return m.call(a,c==null||
b?1:c)};a.compact=function(c){return a.filter(c,function(a){return!!a})};a.flatten=function(c,b){return a.reduce(c,function(c,j){if(a.isArray(j))return c.concat(b?j:a.flatten(j));c[c.length]=j;return c},[])};a.without=function(c){return a.difference(c,m.call(arguments,1))};a.uniq=a.unique=function(c,b,j){var j=j?a.map(c,j):c,e=[];a.reduce(j,function(j,d,f){if(0==f||(b===true?a.last(j)!=d:!a.include(j,d))){j[j.length]=d;e[e.length]=c[f]}return j},[]);return e};a.union=function(){return a.uniq(a.flatten(arguments,
true))};a.intersection=a.intersect=function(c){var b=m.call(arguments,1);return a.filter(a.uniq(c),function(c){return a.every(b,function(b){return a.indexOf(b,c)>=0})})};a.difference=function(c){var b=a.flatten(m.call(arguments,1));return a.filter(c,function(c){return!a.include(b,c)})};a.zip=function(){for(var c=m.call(arguments),b=a.max(a.pluck(c,"length")),j=Array(b),e=0;e<b;e++)j[e]=a.pluck(c,""+e);return j};a.indexOf=function(c,b,j){if(c==null)return-1;var e;if(j)return j=a.sortedIndex(c,b),c[j]===
b?j:-1;if(v&&c.indexOf===v)return c.indexOf(b);j=0;for(e=c.length;j<e;j++)if(j in c&&c[j]===b)return j;return-1};a.lastIndexOf=function(a,c){if(a==null)return-1;if(t&&a.lastIndexOf===t)return a.lastIndexOf(c);for(var b=a.length;b--;)if(b in a&&a[b]===c)return b;return-1};a.range=function(a,c,b){arguments.length<=1&&(c=a||0,a=0);for(var b=arguments[2]||1,j=Math.max(Math.ceil((c-a)/b),0),e=0,d=Array(j);e<j;){d[e++]=a;a=a+b}return d};var C=function(){};a.bind=function(b,j){var e,d;if(b.bind===c&&c)return c.apply(b,
m.call(arguments,1));if(!a.isFunction(b))throw new TypeError;d=m.call(arguments,2);return e=function(){if(!(this instanceof e))return b.apply(j,d.concat(m.call(arguments)));C.prototype=b.prototype;var a=new C,c=b.apply(a,d.concat(m.call(arguments)));return Object(c)===c?c:a}};a.bindAll=function(c){var b=m.call(arguments,1);b.length==0&&(b=a.functions(c));j(b,function(b){c[b]=a.bind(c[b],c)});return c};a.memoize=function(c,b){var j={};b||(b=a.identity);return function(){var e=b.apply(this,arguments);
return a.has(j,e)?j[e]:j[e]=c.apply(this,arguments)}};a.delay=function(a,c){var b=m.call(arguments,2);return setTimeout(function(){return a.apply(a,b)},c)};a.defer=function(c){return a.delay.apply(a,[c,1].concat(m.call(arguments,1)))};a.throttle=function(c,b){var j,e,d,f,h,x=a.debounce(function(){h=f=false},b);return function(){j=this;e=arguments;d||(d=setTimeout(function(){d=null;h&&c.apply(j,e);x()},b));f?h=true:c.apply(j,e);x();f=true}};a.debounce=function(a,c){var b;return function(){var j=this,
e=arguments;clearTimeout(b);b=setTimeout(function(){b=null;a.apply(j,e)},c)}};a.once=function(a){var c=false,b;return function(){if(c)return b;c=true;return b=a.apply(this,arguments)}};a.wrap=function(a,c){return function(){var b=[a].concat(m.call(arguments,0));return c.apply(this,b)}};a.compose=function(){var a=arguments;return function(){for(var c=arguments,b=a.length-1;b>=0;b--)c=[a[b].apply(this,c)];return c[0]}};a.after=function(a,c){return a<=0?c():function(){if(--a<1)return c.apply(this,arguments)}};
a.keys=w||function(c){if(c!==Object(c))throw new TypeError("Invalid object");var b=[],j;for(j in c)a.has(c,j)&&(b[b.length]=j);return b};a.values=function(c){return a.map(c,a.identity)};a.functions=a.methods=function(c){var b=[],j;for(j in c)a.isFunction(c[j])&&b.push(j);return b.sort()};a.extend=function(a){j(m.call(arguments,1),function(c){for(var b in c)a[b]=c[b]});return a};a.defaults=function(a){j(m.call(arguments,1),function(c){for(var b in c)a[b]==null&&(a[b]=c[b])});return a};a.clone=function(c){return!a.isObject(c)?
c:a.isArray(c)?c.slice():a.extend({},c)};a.tap=function(a,c){c(a);return a};a.isEqual=function(a,c){return d(a,c,[])};a.isEmpty=function(c){if(a.isArray(c)||a.isString(c))return c.length===0;for(var b in c)if(a.has(c,b))return false;return true};a.isElement=function(a){return!!(a&&a.nodeType==1)};a.isArray=l||function(a){return f.call(a)=="[object Array]"};a.isObject=function(a){return a===Object(a)};a.isArguments=function(a){return f.call(a)=="[object Arguments]"};a.isArguments(arguments)||(a.isArguments=
function(c){return!(!c||!a.has(c,"callee"))});a.isFunction=function(a){return f.call(a)=="[object Function]"};a.isString=function(a){return f.call(a)=="[object String]"};a.isNumber=function(a){return f.call(a)=="[object Number]"};a.isNaN=function(a){return a!==a};a.isBoolean=function(a){return a===true||a===false||f.call(a)=="[object Boolean]"};a.isDate=function(a){return f.call(a)=="[object Date]"};a.isRegExp=function(a){return f.call(a)=="[object RegExp]"};a.isNull=function(a){return a===null};
a.isUndefined=function(a){return a===void 0};a.has=function(a,c){return h.call(a,c)};a.noConflict=function(){b._=o;return this};a.identity=function(a){return a};a.times=function(a,c,b){for(var j=0;j<a;j++)c.call(b,j)};a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};a.mixin=function(c){j(a.functions(c),function(b){G(b,a[b]=c[b])})};var F=0;a.uniqueId=function(a){var c=F++;return a?
a+c:c};a.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var E=/.^/,D=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};a.template=function(c,b){var j=a.templateSettings,j="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+c.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(j.escape||E,function(a,c){return"',_.escape("+D(c)+"),'"}).replace(j.interpolate||E,function(a,c){return"',"+D(c)+",'"}).replace(j.evaluate||
E,function(a,c){return"');"+D(c).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",j);return b?e(b,a):function(c){return e.call(this,c,a)}};a.chain=function(c){return a(c).chain()};var A=function(a){this._wrapped=a};a.prototype=A.prototype;var B=function(c,b){return b?a(c).chain():c},G=function(c,b){A.prototype[c]=function(){var c=m.call(arguments);e.call(c,this._wrapped);return B(b.apply(a,c),
this._chain)}};a.mixin(a);j("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){var c=g[a];A.prototype[a]=function(){var b=this._wrapped;c.apply(b,arguments);var j=b.length;(a=="shift"||a=="splice")&&j===0&&delete b[0];return B(b,this._chain)}});j(["concat","join","slice"],function(a){var c=g[a];A.prototype[a]=function(){return B(c.apply(this._wrapped,arguments),this._chain)}});A.prototype.chain=function(){this._chain=true;return this};A.prototype.value=function(){return this._wrapped}}).call(this);(function(){var d=this,b=d.Backbone,o=Array.prototype.slice,k=Array.prototype.splice,g;g="undefined"!==typeof exports?exports:d.Backbone={};g.VERSION="0.9.1";var l=d._;!l&&"undefined"!==typeof require&&(l=require("underscore"));var m=d.jQuery||d.Zepto||d.ender;g.setDomLibrary=function(c){m=c};g.noConflict=function(){d.Backbone=b;return this};g.emulateHTTP=!1;g.emulateJSON=!1;g.Events={on:function(c,a,b){for(var e,c=c.split(/\s+/),d=this._callbacks||(this._callbacks={});e=c.shift();){e=d[e]||(d[e]=
{});var f=e.tail||(e.tail=e.next={});f.callback=a;f.context=b;e.tail=f.next={}}return this},off:function(c,a,b){var e,d,f;if(c){if(d=this._callbacks)for(c=c.split(/\s+/);e=c.shift();)if(f=d[e],delete d[e],a&&f)for(;(f=f.next)&&f.next;)if(!(f.callback===a&&(!b||f.context===b)))this.on(e,f.callback,f.context)}else delete this._callbacks;return this},trigger:function(c){var a,b,e,d;if(!(e=this._callbacks))return this;d=e.all;for((c=c.split(/\s+/)).push(null);a=c.shift();)d&&c.push({next:d.next,tail:d.tail,
event:a}),(b=e[a])&&c.push({next:b.next,tail:b.tail});for(d=o.call(arguments,1);b=c.pop();){a=b.tail;for(e=b.event?[b.event].concat(d):d;(b=b.next)!==a;)b.callback.apply(b.context||this,e)}return this}};g.Events.bind=g.Events.on;g.Events.unbind=g.Events.off;g.Model=function(c,a){var b;c||(c={});a&&a.parse&&(c=this.parse(c));if(b=t(this,"defaults"))c=l.extend({},b,c);a&&a.collection&&(this.collection=a.collection);this.attributes={};this._escapedAttributes={};this.cid=l.uniqueId("c");if(!this.set(c,
{silent:!0}))throw Error("Can't create an invalid model");delete this._changed;this._previousAttributes=l.clone(this.attributes);this.initialize.apply(this,arguments)};l.extend(g.Model.prototype,g.Events,{idAttribute:"id",initialize:function(){},toJSON:function(){return l.clone(this.attributes)},get:function(c){return this.attributes[c]},escape:function(c){var a;if(a=this._escapedAttributes[c])return a;a=this.attributes[c];return this._escapedAttributes[c]=l.escape(null==a?"":""+a)},has:function(c){return null!=
this.attributes[c]},set:function(c,a,b){var e,d;l.isObject(c)||null==c?(e=c,b=a):(e={},e[c]=a);b||(b={});if(!e)return this;e instanceof g.Model&&(e=e.attributes);if(b.unset)for(d in e)e[d]=void 0;if(!this._validate(e,b))return!1;this.idAttribute in e&&(this.id=e[this.idAttribute]);var a=this.attributes,f=this._escapedAttributes,h=this._previousAttributes||{},k=this._setting;this._changed||(this._changed={});this._setting=!0;for(d in e)if(c=e[d],l.isEqual(a[d],c)||delete f[d],b.unset?delete a[d]:a[d]=
c,this._changing&&!l.isEqual(this._changed[d],c)&&(this.trigger("change:"+d,this,c,b),this._moreChanges=!0),delete this._changed[d],!l.isEqual(h[d],c)||l.has(a,d)!=l.has(h,d))this._changed[d]=c;k||(!b.silent&&this.hasChanged()&&this.change(b),this._setting=!1);return this},unset:function(c,a){(a||(a={})).unset=!0;return this.set(c,null,a)},clear:function(c){(c||(c={})).unset=!0;return this.set(l.clone(this.attributes),c)},fetch:function(c){var c=c?l.clone(c):{},a=this,b=c.success;c.success=function(e,
d,f){if(!a.set(a.parse(e,f),c))return!1;b&&b(a,e)};c.error=g.wrapError(c.error,a,c);return(this.sync||g.sync).call(this,"read",this,c)},save:function(c,a,b){var e,d;l.isObject(c)||null==c?(e=c,b=a):(e={},e[c]=a);b=b?l.clone(b):{};b.wait&&(d=l.clone(this.attributes));c=l.extend({},b,{silent:!0});if(e&&!this.set(e,b.wait?c:b))return!1;var f=this,h=b.success;b.success=function(a,c,d){c=f.parse(a,d);b.wait&&(c=l.extend(e||{},c));if(!f.set(c,b))return!1;h?h(f,a):f.trigger("sync",f,a,b)};b.error=g.wrapError(b.error,
f,b);a=this.isNew()?"create":"update";a=(this.sync||g.sync).call(this,a,this,b);b.wait&&this.set(d,c);return a},destroy:function(c){var c=c?l.clone(c):{},a=this,b=c.success,e=function(){a.trigger("destroy",a,a.collection,c)};if(this.isNew())return e();c.success=function(d){c.wait&&e();b?b(a,d):a.trigger("sync",a,d,c)};c.error=g.wrapError(c.error,a,c);var d=(this.sync||g.sync).call(this,"delete",this,c);c.wait||e();return d},url:function(){var c=t(this.collection,"url")||t(this,"urlRoot")||w();return this.isNew()?
c:c+("/"==c.charAt(c.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(c){return c},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(c){if(this._changing||!this.hasChanged())return this;this._moreChanges=this._changing=!0;for(var a in this._changed)this.trigger("change:"+a,this,this._changed[a],c);for(;this._moreChanges;)this._moreChanges=!1,this.trigger("change",this,c);this._previousAttributes=l.clone(this.attributes);
delete this._changed;this._changing=!1;return this},hasChanged:function(c){return!arguments.length?!l.isEmpty(this._changed):this._changed&&l.has(this._changed,c)},changedAttributes:function(c){if(!c)return this.hasChanged()?l.clone(this._changed):!1;var a,b=!1,e=this._previousAttributes,d;for(d in c)if(!l.isEqual(e[d],a=c[d]))(b||(b={}))[d]=a;return b},previous:function(c){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[c]},previousAttributes:function(){return l.clone(this._previousAttributes)},
isValid:function(){return!this.validate(this.attributes)},_validate:function(c,a){if(a.silent||!this.validate)return!0;var c=l.extend({},this.attributes,c),b=this.validate(c,a);if(!b)return!0;a&&a.error?a.error(this,b,a):this.trigger("error",this,b,a);return!1}});g.Collection=function(c,a){a||(a={});a.comparator&&(this.comparator=a.comparator);this._reset();this.initialize.apply(this,arguments);c&&this.reset(c,{silent:!0,parse:a.parse})};l.extend(g.Collection.prototype,g.Events,{model:g.Model,initialize:function(){},
toJSON:function(){return this.map(function(c){return c.toJSON()})},add:function(c,a){var b,e,d,f,h,g={},n={};a||(a={});c=l.isArray(c)?c.slice():[c];b=0;for(e=c.length;b<e;b++){if(!(d=c[b]=this._prepareModel(c[b],a)))throw Error("Can't add an invalid model to a collection");if(g[f=d.cid]||this._byCid[f]||null!=(h=d.id)&&(n[h]||this._byId[h]))throw Error("Can't add the same model to a collection twice");g[f]=n[h]=d}for(b=0;b<e;b++)(d=c[b]).on("all",this._onModelEvent,this),this._byCid[d.cid]=d,null!=
d.id&&(this._byId[d.id]=d);this.length+=e;k.apply(this.models,[null!=a.at?a.at:this.models.length,0].concat(c));this.comparator&&this.sort({silent:!0});if(a.silent)return this;b=0;for(e=this.models.length;b<e;b++)if(g[(d=this.models[b]).cid])a.index=b,d.trigger("add",d,this,a);return this},remove:function(c,a){var b,e,d,f;a||(a={});c=l.isArray(c)?c.slice():[c];b=0;for(e=c.length;b<e;b++)if(f=this.getByCid(c[b])||this.get(c[b]))delete this._byId[f.id],delete this._byCid[f.cid],d=this.indexOf(f),this.models.splice(d,
1),this.length--,a.silent||(a.index=d,f.trigger("remove",f,this,a)),this._removeReference(f);return this},get:function(c){return null==c?null:this._byId[null!=c.id?c.id:c]},getByCid:function(c){return c&&this._byCid[c.cid||c]},at:function(c){return this.models[c]},sort:function(c){c||(c={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var a=l.bind(this.comparator,this);1==this.comparator.length?this.models=this.sortBy(a):this.models.sort(a);c.silent||this.trigger("reset",
this,c);return this},pluck:function(c){return l.map(this.models,function(a){return a.get(c)})},reset:function(c,a){c||(c=[]);a||(a={});for(var b=0,e=this.models.length;b<e;b++)this._removeReference(this.models[b]);this._reset();this.add(c,{silent:!0,parse:a.parse});a.silent||this.trigger("reset",this,a);return this},fetch:function(c){c=c?l.clone(c):{};void 0===c.parse&&(c.parse=!0);var a=this,b=c.success;c.success=function(e,d,f){a[c.add?"add":"reset"](a.parse(e,f),c);b&&b(a,e)};c.error=g.wrapError(c.error,
a,c);return(this.sync||g.sync).call(this,"read",this,c)},create:function(c,a){var b=this,a=a?l.clone(a):{},c=this._prepareModel(c,a);if(!c)return!1;a.wait||b.add(c,a);var e=a.success;a.success=function(d,f){a.wait&&b.add(d,a);e?e(d,f):d.trigger("sync",c,f,a)};c.save(null,a);return c},parse:function(c){return c},chain:function(){return l(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(c,a){c instanceof g.Model?c.collection||
(c.collection=this):(a.collection=this,c=new this.model(c,a),c._validate(c.attributes,a)||(c=!1));return c},_removeReference:function(c){this==c.collection&&delete c.collection;c.off("all",this._onModelEvent,this)},_onModelEvent:function(c,a,b,e){("add"==c||"remove"==c)&&b!=this||("destroy"==c&&this.remove(a,e),a&&c==="change:"+a.idAttribute&&(delete this._byId[a.previous(a.idAttribute)],this._byId[a.id]=a),this.trigger.apply(this,arguments))}});l.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),
function(c){g.Collection.prototype[c]=function(){return l[c].apply(l,[this.models].concat(l.toArray(arguments)))}});g.Router=function(c){c||(c={});c.routes&&(this.routes=c.routes);this._bindRoutes();this.initialize.apply(this,arguments)};var e=/:\w+/g,f=/\*\w+/g,h=/[-[\]{}()+?.,\\^$|#\s]/g;l.extend(g.Router.prototype,g.Events,{initialize:function(){},route:function(c,a,b){g.history||(g.history=new g.History);l.isRegExp(c)||(c=this._routeToRegExp(c));b||(b=this[a]);g.history.route(c,l.bind(function(e){e=
this._extractParameters(c,e);b&&b.apply(this,e);this.trigger.apply(this,["route:"+a].concat(e));g.history.trigger("route",this,a,e)},this));return this},navigate:function(c,a){g.history.navigate(c,a)},_bindRoutes:function(){if(this.routes){var c=[],a;for(a in this.routes)c.unshift([a,this.routes[a]]);a=0;for(var b=c.length;a<b;a++)this.route(c[a][0],c[a][1],this[c[a][1]])}},_routeToRegExp:function(c){c=c.replace(h,"\\$&").replace(e,"([^/]+)").replace(f,"(.*?)");return RegExp("^"+c+"$")},_extractParameters:function(c,
a){return c.exec(a).slice(1)}});g.History=function(){this.handlers=[];l.bindAll(this,"checkUrl")};var s=/^[#\/]/,n=/msie [\w.]+/,q=!1;l.extend(g.History.prototype,g.Events,{interval:50,getFragment:function(c,a){if(null==c)if(this._hasPushState||a){var c=window.location.pathname,b=window.location.search;b&&(c+=b)}else c=window.location.hash;c=decodeURIComponent(c);c.indexOf(this.options.root)||(c=c.substr(this.options.root.length));return c.replace(s,"")},start:function(c){if(q)throw Error("Backbone.history has already been started");
this.options=l.extend({},{root:"/"},this.options,c);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);var c=this.getFragment(),a=document.documentMode;if(a=n.exec(navigator.userAgent.toLowerCase())&&(!a||7>=a))this.iframe=m('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(c);this._hasPushState?m(window).bind("popstate",
this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!a?m(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));this.fragment=c;q=!0;c=window.location;a=c.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!a)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&a&&c.hash&&
(this.fragment=c.hash.replace(s,""),window.history.replaceState({},document.title,c.protocol+"//"+c.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){m(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);q=!1},route:function(c,a){this.handlers.unshift({route:c,callback:a})},checkUrl:function(){var c=this.getFragment();c==this.fragment&&this.iframe&&(c=this.getFragment(this.iframe.location.hash));
if(c==this.fragment||c==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(c);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(c){var a=this.fragment=this.getFragment(c);return l.any(this.handlers,function(c){if(c.route.test(a))return c.callback(a),!0})},navigate:function(c,a){if(!q)return!1;if(!a||!0===a)a={trigger:a};var b=(c||"").replace(s,"");this.fragment==b||this.fragment==decodeURIComponent(b)||(this._hasPushState?(0!=b.indexOf(this.options.root)&&(b=
this.options.root+b),this.fragment=b,window.history[a.replace?"replaceState":"pushState"]({},document.title,b)):this._wantsHashChange?(this.fragment=b,this._updateHash(window.location,b,a.replace),this.iframe&&b!=this.getFragment(this.iframe.location.hash)&&(a.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,b,a.replace))):window.location.assign(this.options.root+c),a.trigger&&this.loadUrl(c))},_updateHash:function(c,a,b){b?c.replace(c.toString().replace(/(javascript:|#).*$/,
"")+"#"+a):c.hash=a}});g.View=function(c){this.cid=l.uniqueId("view");this._configure(c||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var u=/^(\S+)\s*(.*)$/,y="model,collection,el,id,attributes,className,tagName".split(",");l.extend(g.View.prototype,g.Events,{tagName:"div",$:function(c){return this.$el.find(c)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(c,a,b){c=document.createElement(c);
a&&m(c).attr(a);b&&m(c).html(b);return c},setElement:function(c,a){this.$el=m(c);this.el=this.$el[0];!1!==a&&this.delegateEvents();return this},delegateEvents:function(c){if(c||(c=t(this,"events"))){this.undelegateEvents();for(var a in c){var b=c[a];l.isFunction(b)||(b=this[c[a]]);if(!b)throw Error('Event "'+c[a]+'" does not exist');var e=a.match(u),d=e[1],e=e[2],b=l.bind(b,this),d=d+(".delegateEvents"+this.cid);""===e?this.$el.bind(d,b):this.$el.delegate(e,d,b)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+
this.cid)},_configure:function(c){this.options&&(c=l.extend({},this.options,c));for(var a=0,b=y.length;a<b;a++){var e=y[a];c[e]&&(this[e]=c[e])}this.options=c},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var c=t(this,"attributes")||{};this.id&&(c.id=this.id);this.className&&(c["class"]=this.className);this.setElement(this.make(this.tagName,c),!1)}}});g.Model.extend=g.Collection.extend=g.Router.extend=g.View.extend=function(c,a){var b=v(this,c,a);b.extend=this.extend;return b};
var z={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};g.sync=function(c,a,b){var e=z[c],d={type:e,dataType:"json"};b.url||(d.url=t(a,"url")||w());if(!b.data&&a&&("create"==c||"update"==c))d.contentType="application/json",d.data=JSON.stringify(a.toJSON());g.emulateJSON&&(d.contentType="application/x-www-form-urlencoded",d.data=d.data?{model:d.data}:{});if(g.emulateHTTP&&("PUT"===e||"DELETE"===e))g.emulateJSON&&(d.data._method=e),d.type="POST",d.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",
e)};"GET"!==d.type&&!g.emulateJSON&&(d.processData=!1);return m.ajax(l.extend(d,b))};g.wrapError=function(c,a,b){return function(e,d){d=e===a?d:e;c?c(a,d,b):a.trigger("error",a,d,b)}};var r=function(){},v=function(c,a,b){var e;e=a&&a.hasOwnProperty("constructor")?a.constructor:function(){c.apply(this,arguments)};l.extend(e,c);r.prototype=c.prototype;e.prototype=new r;a&&l.extend(e.prototype,a);b&&l.extend(e,b);e.prototype.constructor=e;e.__super__=c.prototype;return e},t=function(c,a){return!c||!c[a]?
null:l.isFunction(c[a])?c[a]():c[a]},w=function(){throw Error('A "url" property or function must be specified');}}).call(this);(function(){var d,b,o;"undefined"===typeof window?(d=require("underscore"),b=require("backbone"),o=module.exports=b):(d=window._,b=window.Backbone,o=window);b.Relational={showWarnings:!0};b.Semaphore={_permitsAvailable:null,_permitsUsed:0,acquire:function(){if(this._permitsAvailable&&this._permitsUsed>=this._permitsAvailable)throw Error("Max permits acquired");this._permitsUsed++},release:function(){if(this._permitsUsed===0)throw Error("All permits released");this._permitsUsed--},isLocked:function(){return this._permitsUsed>
0},setAvailablePermits:function(b){if(this._permitsUsed>b)throw Error("Available permits cannot be less than used permits");this._permitsAvailable=b}};b.BlockingQueue=function(){this._queue=[]};d.extend(b.BlockingQueue.prototype,b.Semaphore,{_queue:null,add:function(b){this.isBlocked()?this._queue.push(b):b()},process:function(){for(;this._queue&&this._queue.length;)this._queue.shift()()},block:function(){this.acquire()},unblock:function(){this.release();this.isBlocked()||this.process()},isBlocked:function(){return this.isLocked()}});
b.Relational.eventQueue=new b.BlockingQueue;b.Store=function(){this._collections=[];this._reverseRelations=[]};d.extend(b.Store.prototype,b.Events,{_collections:null,_reverseRelations:null,addReverseRelation:function(b){if(!d.any(this._reverseRelations,function(f){return d.all(b,function(b,e){return b===f[e]})})&&b.model&&b.type){this._reverseRelations.push(b);if(!b.model.prototype.relations)b.model.prototype.relations=[];b.model.prototype.relations.push(b);this.retroFitRelation(b)}},retroFitRelation:function(b){this.getCollection(b.model).each(function(d){new b.type(d,
b)},this)},getCollection:function(b){var f=d.detect(this._collections,function(d){return b===d.model||b.constructor===d.model});f||(f=this._createCollection(b));return f},getObjectByName:function(b){b=d.reduce(b.split("."),function(b,e){return b[e]},o);return b!==o?b:null},_createCollection:function(e){var d;if(e instanceof b.RelationalModel)e=e.constructor;if(e.prototype instanceof b.RelationalModel.prototype.constructor){d=new b.Collection;d.model=e;this._collections.push(d)}return d},find:function(b,
d){var h=this.getCollection(b);return h&&h.get(d)},register:function(b){var d=b.collection,h=this.getCollection(b);h&&h.add(b);b.bind("destroy",this.unregister,this);b.collection=d},update:function(b){var d=this.getCollection(b);d._onModelEvent("change:"+b.idAttribute,b,d)},unregister:function(b){b.unbind("destroy",this.unregister);var d=this.getCollection(b);d&&d.remove(b)}});b.Relational.store=new b.Store;b.Relation=function(e,f){this.instance=e;f=typeof f==="object"&&f||{};this.reverseRelation=
d.defaults(f.reverseRelation||{},this.options.reverseRelation);this.reverseRelation.type=!d.isString(this.reverseRelation.type)?this.reverseRelation.type:b[this.reverseRelation.type]||b.Relational.store.getObjectByName(this.reverseRelation.type);this.model=f.model||this.instance.constructor;this.options=d.defaults(f,this.options,b.Relation.prototype.options);this.key=this.options.key;this.keySource=this.options.keySource||this.key;this.relatedModel=this.options.relatedModel;if(d.isString(this.relatedModel))this.relatedModel=
b.Relational.store.getObjectByName(this.relatedModel);if(!this.checkPreconditions())return false;if(e){this.keyContents=this.instance.get(this.keySource);this.key!==this.keySource&&this.instance.unset(this.keySource,{silent:true});this.instance._relations.push(this)}!this.options.isAutoRelation&&this.reverseRelation.type&&this.reverseRelation.key&&b.Relational.store.addReverseRelation(d.defaults({isAutoRelation:true,model:this.relatedModel,relatedModel:this.model,reverseRelation:this.options},this.reverseRelation));
d.bindAll(this,"_modelRemovedFromCollection","_relatedModelAdded","_relatedModelRemoved");if(e){this.initialize();b.Relational.store.getCollection(this.instance).bind("relational:remove",this._modelRemovedFromCollection);b.Relational.store.getCollection(this.relatedModel).bind("relational:add",this._relatedModelAdded).bind("relational:remove",this._relatedModelRemoved)}};b.Relation.extend=b.Model.extend;d.extend(b.Relation.prototype,b.Events,b.Semaphore,{options:{createModels:!0,includeInJSON:!0,
isAutoRelation:!1},instance:null,key:null,keyContents:null,relatedModel:null,reverseRelation:null,related:null,_relatedModelAdded:function(b,d,h){var g=this;b.queue(function(){g.tryAddRelated(b,h)})},_relatedModelRemoved:function(b,d,h){this.removeRelated(b,h)},_modelRemovedFromCollection:function(b){b===this.instance&&this.destroy()},checkPreconditions:function(){var e=this.instance,f=this.key,h=this.model,g=this.relatedModel,k=b.Relational.showWarnings&&typeof console!=="undefined";if(!h||!f||!g){k&&
console.warn("Relation=%o; no model, key or relatedModel (%o, %o, %o)",this,h,f,g);return false}if(!(h.prototype instanceof b.RelationalModel.prototype.constructor)){k&&console.warn("Relation=%o; model does not inherit from Backbone.RelationalModel (%o)",this,e);return false}if(!(g.prototype instanceof b.RelationalModel.prototype.constructor)){k&&console.warn("Relation=%o; relatedModel does not inherit from Backbone.RelationalModel (%o)",this,g);return false}if(this instanceof b.HasMany&&this.reverseRelation.type===
b.HasMany.prototype.constructor){k&&console.warn("Relation=%o; relation is a HasMany, and the reverseRelation is HasMany as well.",this);return false}if(e&&e._relations.length&&d.any(e._relations,function(b){var d=this.reverseRelation.key&&b.reverseRelation.key;return b.relatedModel===g&&b.key===f&&(!d||this.reverseRelation.key===b.reverseRelation.key)},this)){k&&console.warn("Relation=%o between instance=%o.%s and relatedModel=%o.%s already exists",this,e,f,g,this.reverseRelation.key);return false}return true},
setRelated:function(b,f){this.related=b;this.instance.acquire();this.instance.set(this.key,b,d.defaults(f||{},{silent:true}));this.instance.release()},createModel:function(b){if(this.options.createModels&&typeof b==="object")return new this.relatedModel(b)},_isReverseRelation:function(b){return b.instance instanceof this.relatedModel&&this.reverseRelation.key===b.key&&this.key===b.reverseRelation.key?true:false},getReverseRelations:function(b){var f=[],b=!d.isUndefined(b)?[b]:this.related&&(this.related.models||
[this.related]);d.each(b,function(b){d.each(b.getRelations(),function(b){this._isReverseRelation(b)&&f.push(b)},this)},this);return f},sanitizeOptions:function(b){b||(b={});if(b.silent){b=d.extend({},b,{silentChange:true});delete b.silent}return b},destroy:function(){b.Relational.store.getCollection(this.instance).unbind("relational:remove",this._modelRemovedFromCollection);b.Relational.store.getCollection(this.relatedModel).unbind("relational:add",this._relatedModelAdded).unbind("relational:remove",
this._relatedModelRemoved);d.each(this.getReverseRelations(),function(b){b.removeRelated(this.instance)},this)}});b.HasOne=b.Relation.extend({options:{reverseRelation:{type:"HasMany"}},initialize:function(){d.bindAll(this,"onChange");this.instance.bind("relational:change:"+this.key,this.onChange);this.setRelated(this.findRelated({silent:true}));var b=this;d.each(b.getReverseRelations(),function(d){d.addRelated(b.instance)})},findRelated:function(e){var f=this.keyContents,h=null;if(f instanceof this.relatedModel)h=
f;else if(f&&(d.isString(f)||d.isNumber(f)||typeof f==="object")){h=d.isString(f)||d.isNumber(f)?f:f[this.relatedModel.prototype.idAttribute];(h=b.Relational.store.find(this.relatedModel,h))&&d.isObject(f)?h.set(f,e):h||(h=this.createModel(f))}return h},onChange:function(e,f,h){if(!this.isLocked()){this.acquire();var h=this.sanitizeOptions(h),g=(e=d.isUndefined(h._related))?this.related:h._related;if(e){this.keyContents=f;f instanceof this.relatedModel?this.related=f:f?this.setRelated(this.findRelated(h)):
this.setRelated(null)}g&&this.related!==g&&d.each(this.getReverseRelations(g),function(b){b.removeRelated(this.instance,h)},this);d.each(this.getReverseRelations(),function(b){b.addRelated(this.instance,h)},this);if(!h.silentChange&&this.related!==g){var k=this;b.Relational.eventQueue.add(function(){k.instance.trigger("update:"+k.key,k.instance,k.related,h)})}this.release()}},tryAddRelated:function(b,f){if(!this.related){var f=this.sanitizeOptions(f),h=this.keyContents;if(h&&(d.isString(h)||d.isNumber(h)||
typeof h==="object")){h=d.isString(h)||d.isNumber(h)?h:h[this.relatedModel.prototype.idAttribute];b.id===h&&this.addRelated(b,f)}}},addRelated:function(b){if(b!==this.related){var d=this.related||null;this.setRelated(b);this.onChange(this.instance,b,{_related:d})}},removeRelated:function(b){if(this.related&&b===this.related){var d=this.related||null;this.setRelated(null);this.onChange(this.instance,b,{_related:d})}}});b.HasMany=b.Relation.extend({collectionType:null,options:{reverseRelation:{type:"HasOne"},
collectionType:b.Collection,collectionKey:!0},initialize:function(){d.bindAll(this,"onChange","handleAddition","handleRemoval","handleReset");this.instance.bind("relational:change:"+this.key,this.onChange);this.collectionType=this.options.collectionType;if(d(this.collectionType).isString())this.collectionType=b.Relational.store.getObjectByName(this.collectionType);if(!this.collectionType.prototype instanceof b.Collection.prototype.constructor)throw Error("collectionType must inherit from Backbone.Collection");
this.setRelated(this.prepareCollection(new this.collectionType));this.findRelated({silent:true})},prepareCollection:function(d){this.related&&this.related.unbind("relational:add",this.handleAddition).unbind("relational:remove",this.handleRemoval).unbind("relational:reset",this.handleReset);d.reset();d.model=this.relatedModel;if(this.options.collectionKey){var f=this.options.collectionKey===true?this.options.reverseRelation.key:this.options.collectionKey;d[f]&&d[f]!==this.instance?b.Relational.showWarnings&&
typeof console!=="undefined"&&console.warn("Relation=%o; collectionKey=%s already exists on collection=%o",this,f,this.options.collectionKey):d[f]=this.instance}d.bind("relational:add",this.handleAddition).bind("relational:remove",this.handleRemoval).bind("relational:reset",this.handleReset);return d},findRelated:function(e){if(this.keyContents){this.keyContents=d.isArray(this.keyContents)?this.keyContents:[this.keyContents];d.each(this.keyContents,function(f){var h=d.isString(f)||d.isNumber(f)?f:
f[this.relatedModel.prototype.idAttribute];(h=b.Relational.store.find(this.relatedModel,h))&&d.isObject(f)?h.set(f,e):h||(h=this.createModel(f));h&&!this.related.getByCid(h)&&!this.related.get(h)&&this.related.add(h)},this)}},onChange:function(e,f,h){h=this.sanitizeOptions(h);this.keyContents=f;d.each(this.getReverseRelations(),function(b){b.removeRelated(this.instance,h)},this);if(f instanceof b.Collection){this.prepareCollection(f);this.related=f}else{this.setRelated(this.prepareCollection(this.related instanceof
b.Collection?this.related:new this.collectionType));this.findRelated(h)}d.each(this.getReverseRelations(),function(b){b.addRelated(this.instance,h)},this);var g=this;b.Relational.eventQueue.add(function(){!h.silentChange&&g.instance.trigger("update:"+g.key,g.instance,g.related,h)})},tryAddRelated:function(b,f){f=this.sanitizeOptions(f);!this.related.getByCid(b)&&!this.related.get(b)&&d.any(this.keyContents,function(f){return(f=d.isString(f)||d.isNumber(f)?f:f[this.relatedModel.prototype.idAttribute])&&
f===b.id},this)&&this.related.add(b,f)},handleAddition:function(e,f,h){if(e instanceof b.Model){h=this.sanitizeOptions(h);d.each(this.getReverseRelations(e),function(b){b.addRelated(this.instance,h)},this);var g=this;b.Relational.eventQueue.add(function(){!h.silentChange&&g.instance.trigger("add:"+g.key,e,g.related,h)})}},handleRemoval:function(e,f,h){if(e instanceof b.Model){h=this.sanitizeOptions(h);d.each(this.getReverseRelations(e),function(b){b.removeRelated(this.instance,h)},this);var g=this;
b.Relational.eventQueue.add(function(){!h.silentChange&&g.instance.trigger("remove:"+g.key,e,g.related,h)})}},handleReset:function(d,f){var f=this.sanitizeOptions(f),h=this;b.Relational.eventQueue.add(function(){!f.silentChange&&h.instance.trigger("reset:"+h.key,h.related,f)})},addRelated:function(b,d){var h=this;b.queue(function(){h.related&&!h.related.getByCid(b)&&!h.related.get(b)&&h.related.add(b,d)})},removeRelated:function(b,d){(this.related.getByCid(b)||this.related.get(b))&&this.related.remove(b,
d)}});b.RelationalModel=b.Model.extend({relations:null,_relations:null,_isInitialized:!1,_deferProcessing:!1,_queue:null,constructor:function(e,f){var h=this;if(f&&f.collection){this._deferProcessing=true;var g=function(b){if(b===h){h._deferProcessing=false;h.processQueue();f.collection.unbind("relational:add",g)}};f.collection.bind("relational:add",g);d.defer(function(){g(h)})}this._queue=new b.BlockingQueue;this._queue.block();b.Relational.eventQueue.block();b.Model.prototype.constructor.apply(this,
arguments);b.Relational.eventQueue.unblock()},trigger:function(d){if(d.length>5&&"change"===d.substr(0,6)){var f=this,h=arguments;b.Relational.eventQueue.add(function(){b.Model.prototype.trigger.apply(f,h)})}else b.Model.prototype.trigger.apply(this,arguments);return this},initializeRelations:function(){this.acquire();this._relations=[];d.each(this.relations,function(e){var f=!d.isString(e.type)?e.type:b[e.type]||b.Relational.store.getObjectByName(e.type);f&&f.prototype instanceof b.Relation.prototype.constructor?
new f(this,e):b.Relational.showWarnings&&typeof console!=="undefined"&&console.warn("Relation=%o; missing or invalid type!",e)},this);this._isInitialized=true;this.release();this.processQueue()},updateRelations:function(b){this._isInitialized&&!this.isLocked()&&d.each(this._relations,function(d){var h=this.attributes[d.key];d.related!==h&&this.trigger("relational:change:"+d.key,this,h,b||{})},this)},queue:function(b){this._queue.add(b)},processQueue:function(){this._isInitialized&&!this._deferProcessing&&
this._queue.isBlocked()&&this._queue.unblock()},getRelation:function(b){return d.detect(this._relations,function(d){if(d.key===b)return true},this)},getRelations:function(){return this._relations},fetchRelated:function(e,f){f||(f={});var h,g=[],k=this.getRelation(e),l=k&&k.keyContents;if((l=l&&d.select(d.isArray(l)?l:[l],function(e){return(e=d.isString(e)||d.isNumber(e)?e:e[k.relatedModel.prototype.idAttribute])&&!b.Relational.store.find(k.relatedModel,e)},this))&&l.length){var m=d.map(l,function(b){if(typeof b===
"object")b=new k.relatedModel(b);else{var d={};d[k.relatedModel.prototype.idAttribute]=b;b=new k.relatedModel(d)}return b},this);k.related instanceof b.Collection&&d.isFunction(k.related.url)&&(h=k.related.url(m));if(h&&h!==k.related.url()){h=d.defaults({error:function(){var b=arguments;d.each(m,function(d){d.trigger("destroy",d,d.collection,f);f.error&&f.error.apply(d,b)})},url:h},f,{add:true});g=[k.related.fetch(h)]}else g=d.map(m,function(b){var e=d.defaults({error:function(){b.trigger("destroy",
b,b.collection,f);f.error&&f.error.apply(b,arguments)}},f);return b.fetch(e)},this)}return g},set:function(e,f,h){b.Relational.eventQueue.block();var g;if(d.isObject(e)||e==null){g=e;h=f}else{g={};g[e]=f}var k=b.Model.prototype.set.apply(this,arguments);if(!this._isInitialized&&!this.isLocked()){b.Relational.store.register(this);this.initializeRelations()}else g&&this.idAttribute in g&&b.Relational.store.update(this);g&&this.updateRelations(h);b.Relational.eventQueue.unblock();return k},unset:function(d,
f){b.Relational.eventQueue.block();var h=b.Model.prototype.unset.apply(this,arguments);this.updateRelations(f);b.Relational.eventQueue.unblock();return h},clear:function(d){b.Relational.eventQueue.block();var f=b.Model.prototype.clear.apply(this,arguments);this.updateRelations(d);b.Relational.eventQueue.unblock();return f},change:function(){var d=this;b.Relational.eventQueue.add(function(){b.Model.prototype.change.apply(d,arguments)})},clone:function(){var b=d.clone(this.attributes);d.isUndefined(b[this.idAttribute])||
(b[this.idAttribute]=null);d.each(this.getRelations(),function(d){delete b[d.key]});return new this.constructor(b)},toJSON:function(){if(this.isLocked())return this.id;this.acquire();var e=b.Model.prototype.toJSON.call(this);d.each(this._relations,function(f){var h=e[f.key];f.options.includeInJSON===true&&h&&d.isFunction(h.toJSON)?e[f.keySource]=h.toJSON():d.isString(f.options.includeInJSON)?h instanceof b.Collection?e[f.keySource]=h.pluck(f.options.includeInJSON):h instanceof b.Model&&(e[f.keySource]=
h.get(f.options.includeInJSON)):delete e[f.key];f.keySource!==f.key&&delete e[f.key]},this);this.release();return e}});d.extend(b.RelationalModel.prototype,b.Semaphore);var k=b.Collection.prototype.__add=b.Collection.prototype.add;b.Collection.prototype.add=function(e,f){f||(f={});d.isArray(e)||(e=[e]);d.each(e,function(d){if(!(d instanceof b.Model)){var e=b.Relational.store.find(this.model,d[this.model.prototype.idAttribute]);if(e){e.set(d,f);d=e}else d=b.Collection.prototype._prepareModel.call(this,
d,f)}if(d instanceof b.Model&&!this.get(d)&&!this.getByCid(d)){k.call(this,d,f);this.trigger("relational:add",d,this,f)}},this);return this};var g=b.Collection.prototype.__remove=b.Collection.prototype.remove;b.Collection.prototype.remove=function(e,f){f||(f={});d.isArray(e)||(e=[e]);d.each(e,function(d){d=this.getByCid(d)||this.get(d);if(d instanceof b.Model){g.call(this,d,f);this.trigger("relational:remove",d,this,f)}},this);return this};var l=b.Collection.prototype.__reset=b.Collection.prototype.reset;
b.Collection.prototype.reset=function(b,d){l.call(this,b,d);this.trigger("relational:reset",b,d);return this};var m=b.Collection.prototype.__trigger=b.Collection.prototype.trigger;b.Collection.prototype.trigger=function(d){if(d==="add"||d==="remove"||d==="reset"){var f=this,g=arguments;b.Relational.eventQueue.add(function(){m.apply(f,g)})}else m.apply(this,arguments);return this};b.RelationalModel.extend=function(e,f){var g=b.Model.extend.apply(this,arguments);d.each(e&&e.relations||[],function(e){if(e.reverseRelation){e.model=
g;var f=true;if(d.isString(e.relatedModel))f=(f=b.Relational.store.getObjectByName(e.relatedModel))&&f.prototype instanceof b.RelationalModel.prototype.constructor;var k=!d.isString(e.type)?e.type:b[e.type]||b.Relational.store.getObjectByName(e.type);f&&k&&k.prototype instanceof b.Relation.prototype.constructor&&new k(null,e)}});return g}})();(function(){var d=Math,b=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":/trident/i.test(navigator.userAgent)?"ms":"opera"in window?"O":"",o=/android/gi.test(navigator.appVersion),k=/iphone|ipad/gi.test(navigator.appVersion),g=/playbook/gi.test(navigator.appVersion),l=/hp-tablet/gi.test(navigator.appVersion),m="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,e="ontouchstart"in window&&!l,f=b+"Transform"in document.documentElement.style,h=k||g,s=function(){return window.requestAnimationFrame||
window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(c){return setTimeout(c,1)}}(),n=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout,q="onorientationchange"in window?"orientationchange":"resize",u=e?"touchstart":"mousedown",
y=e?"touchmove":"mousemove",z=e?"touchend":"mouseup",r=e?"touchcancel":"mouseup",v="Moz"==b?"DOMMouseScroll":"mousewheel",t="translate"+(m?"3d(":"("),w=m?",0)":")",g=function(c,a){var d=this,g;d.wrapper="object"==typeof c?c:document.getElementById(c);d.wrapper.style.overflow="hidden";d.scroller=d.wrapper.children[0];d.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,hScrollbar:!0,vScrollbar:!0,
fixedScrollbar:o,hideScrollbar:k,fadeScrollbar:k&&m,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(a){a.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(g in a)d.options[g]=a[g];d.x=d.options.x;d.y=d.options.y;d.options.useTransform=f?d.options.useTransform:
!1;d.options.hScrollbar=d.options.hScroll&&d.options.hScrollbar;d.options.vScrollbar=d.options.vScroll&&d.options.vScrollbar;d.options.zoom=d.options.useTransform&&d.options.zoom;d.options.useTransition=h&&d.options.useTransition;d.options.zoom&&o&&(t="translate(",w=")");d.scroller.style[b+"TransitionProperty"]=d.options.useTransform?"-"+b.toLowerCase()+"-transform":"top left";d.scroller.style[b+"TransitionDuration"]="0";d.scroller.style[b+"TransformOrigin"]="0 0";d.options.useTransition&&(d.scroller.style[b+
"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)");d.options.useTransform?d.scroller.style[b+"Transform"]=t+d.x+"px,"+d.y+"px"+w:d.scroller.style.cssText+=";position:absolute;top:"+d.y+"px;left:"+d.x+"px";d.options.useTransition&&(d.options.fixedScrollbar=!0);d.refresh();d._bind(q,window);d._bind(u);e||(d._bind("mouseout",d.wrapper),"none"!=d.options.wheelAction&&d._bind(v));d.options.checkDOMChanges&&(d.checkDOMTime=setInterval(function(){d._checkDOMChanges()},500))};g.prototype={enabled:!0,
x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(c){switch(c.type){case u:if(!e&&0!==c.button)break;this._start(c);break;case y:this._move(c);break;case z:case r:this._end(c);break;case q:this._resize();break;case v:this._wheel(c);break;case "mouseout":this._mouseout(c);break;case "webkitTransitionEnd":this._transitionEnd(c)}},_checkDOMChanges:function(){!this.moved&&!this.zoomed&&!(this.animating||this.scrollerW==this.scroller.offsetWidth*
this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)&&this.refresh()},_scrollbar:function(c){var a=document,e;this[c+"Scrollbar"]?(this[c+"ScrollbarWrapper"]||(e=a.createElement("div"),this.options.scrollbarClass?e.className=this.options.scrollbarClass+c.toUpperCase():e.style.cssText="position:absolute;z-index:100;"+("h"==c?"height:7px;bottom:1px;left:2px;right:"+(this.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(this.hScrollbar?"7":"2")+"px;top:2px;right:1px"),e.style.cssText+=";pointer-events:none;-"+
b+"-transition-property:opacity;-"+b+"-transition-duration:"+(this.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(this.options.hideScrollbar?"0":"1"),this.wrapper.appendChild(e),this[c+"ScrollbarWrapper"]=e,e=a.createElement("div"),this.options.scrollbarClass||(e.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-"+b+"-background-clip:padding-box;-"+b+"-box-sizing:border-box;"+("h"==c?"height:100%":"width:100%")+";-"+b+
"-border-radius:3px;border-radius:3px"),e.style.cssText+=";pointer-events:none;-"+b+"-transition-property:-"+b+"-transform;-"+b+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-"+b+"-transition-duration:0;-"+b+"-transform:"+t+"0,0"+w,this.options.useTransition&&(e.style.cssText+=";-"+b+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),this[c+"ScrollbarWrapper"].appendChild(e),this[c+"ScrollbarIndicator"]=e),"h"==c?(this.hScrollbarSize=this.hScrollbarWrapper.clientWidth,this.hScrollbarIndicatorSize=
d.max(this.hScrollbarSize*this.hScrollbarSize/this.scrollerW>>0,8),this.hScrollbarIndicator.style.width=this.hScrollbarIndicatorSize+"px",this.hScrollbarMaxScroll=this.hScrollbarSize-this.hScrollbarIndicatorSize,this.hScrollbarProp=this.hScrollbarMaxScroll/this.maxScrollX):(this.vScrollbarSize=this.vScrollbarWrapper.clientHeight,this.vScrollbarIndicatorSize=d.max(this.vScrollbarSize*this.vScrollbarSize/this.scrollerH>>0,8),this.vScrollbarIndicator.style.height=this.vScrollbarIndicatorSize+"px",this.vScrollbarMaxScroll=
this.vScrollbarSize-this.vScrollbarIndicatorSize,this.vScrollbarProp=this.vScrollbarMaxScroll/this.maxScrollY),this._scrollbarPos(c,!0)):this[c+"ScrollbarWrapper"]&&(f&&(this[c+"ScrollbarIndicator"].style[b+"Transform"]=""),this[c+"ScrollbarWrapper"].parentNode.removeChild(this[c+"ScrollbarWrapper"]),this[c+"ScrollbarWrapper"]=null,this[c+"ScrollbarIndicator"]=null)},_resize:function(){var c=this;setTimeout(function(){c.refresh()},o?200:0)},_pos:function(c,a){c=this.hScroll?c:0;a=this.vScroll?a:0;
this.options.useTransform?this.scroller.style[b+"Transform"]=t+c+"px,"+a+"px"+w+" scale("+this.scale+")":(c>>=0,a>>=0,this.scroller.style.left=c+"px",this.scroller.style.top=a+"px");this.x=c;this.y=a;this._scrollbarPos("h");this._scrollbarPos("v")},_scrollbarPos:function(c,a){var d="h"==c?this.x:this.y;this[c+"Scrollbar"]&&(d*=this[c+"ScrollbarProp"],0>d?(this.options.fixedScrollbar||(d=this[c+"ScrollbarIndicatorSize"]+(3*d>>0),8>d&&(d=8),this[c+"ScrollbarIndicator"].style["h"==c?"width":"height"]=
d+"px"),d=0):d>this[c+"ScrollbarMaxScroll"]&&(this.options.fixedScrollbar?d=this[c+"ScrollbarMaxScroll"]:(d=this[c+"ScrollbarIndicatorSize"]-(3*(d-this[c+"ScrollbarMaxScroll"])>>0),8>d&&(d=8),this[c+"ScrollbarIndicator"].style["h"==c?"width":"height"]=d+"px",d=this[c+"ScrollbarMaxScroll"]+(this[c+"ScrollbarIndicatorSize"]-d))),this[c+"ScrollbarWrapper"].style[b+"TransitionDelay"]="0",this[c+"ScrollbarWrapper"].style.opacity=a&&this.options.hideScrollbar?"0":"1",this[c+"ScrollbarIndicator"].style[b+
"Transform"]=t+("h"==c?d+"px,0":"0,"+d+"px")+w)},_start:function(c){var a=e?c.touches[0]:c,f,g;if(this.enabled){this.options.onBeforeScrollStart&&this.options.onBeforeScrollStart.call(this,c);(this.options.useTransition||this.options.zoom)&&this._transitionTime(0);this.zoomed=this.animating=this.moved=!1;this.dirY=this.dirX=this.absDistY=this.absDistX=this.distY=this.distX=0;this.options.zoom&&e&&1<c.touches.length&&(g=d.abs(c.touches[0].pageX-c.touches[1].pageX),f=d.abs(c.touches[0].pageY-c.touches[1].pageY),
this.touchesDistStart=d.sqrt(g*g+f*f),this.originX=d.abs(c.touches[0].pageX+c.touches[1].pageX-2*this.wrapperOffsetLeft)/2-this.x,this.originY=d.abs(c.touches[0].pageY+c.touches[1].pageY-2*this.wrapperOffsetTop)/2-this.y,this.options.onZoomStart&&this.options.onZoomStart.call(this,c));if(this.options.momentum&&(this.options.useTransform?(f=getComputedStyle(this.scroller,null)[b+"Transform"].replace(/[^0-9-.,]/g,"").split(","),g=1*f[4],f=1*f[5]):(g=1*getComputedStyle(this.scroller,null).left.replace(/[^0-9-]/g,
""),f=1*getComputedStyle(this.scroller,null).top.replace(/[^0-9-]/g,"")),g!=this.x||f!=this.y))this.options.useTransition?this._unbind("webkitTransitionEnd"):n(this.aniTime),this.steps=[],this._pos(g,f);this.absStartX=this.x;this.absStartY=this.y;this.startX=this.x;this.startY=this.y;this.pointX=a.pageX;this.pointY=a.pageY;this.startTime=c.timeStamp||Date.now();this.options.onScrollStart&&this.options.onScrollStart.call(this,c);this._bind(y);this._bind(z);this._bind(r)}},_move:function(c){var a=e?
c.touches[0]:c,f=a.pageX-this.pointX,g=a.pageY-this.pointY,h=this.x+f,k=this.y+g,l=c.timeStamp||Date.now();this.options.onBeforeScrollMove&&this.options.onBeforeScrollMove.call(this,c);if(this.options.zoom&&e&&1<c.touches.length)h=d.abs(c.touches[0].pageX-c.touches[1].pageX),k=d.abs(c.touches[0].pageY-c.touches[1].pageY),this.touchesDist=d.sqrt(h*h+k*k),this.zoomed=!0,a=1/this.touchesDistStart*this.touchesDist*this.scale,a<this.options.zoomMin?a=0.5*this.options.zoomMin*Math.pow(2,a/this.options.zoomMin):
a>this.options.zoomMax&&(a=2*this.options.zoomMax*Math.pow(0.5,this.options.zoomMax/a)),this.lastScale=a/this.scale,h=this.originX-this.originX*this.lastScale+this.x,k=this.originY-this.originY*this.lastScale+this.y,this.scroller.style[b+"Transform"]=t+h+"px,"+k+"px"+w+" scale("+a+")",this.options.onZoom&&this.options.onZoom.call(this,c);else{this.pointX=a.pageX;this.pointY=a.pageY;if(0<h||h<this.maxScrollX)h=this.options.bounce?this.x+f/2:0<=h||0<=this.maxScrollX?0:this.maxScrollX;if(k>this.minScrollY||
k<this.maxScrollY)k=this.options.bounce?this.y+g/2:k>=this.minScrollY||0<=this.maxScrollY?this.minScrollY:this.maxScrollY;this.distX+=f;this.distY+=g;this.absDistX=d.abs(this.distX);this.absDistY=d.abs(this.distY);6>this.absDistX&&6>this.absDistY||(this.options.lockDirection&&(this.absDistX>this.absDistY+5?(k=this.y,g=0):this.absDistY>this.absDistX+5&&(h=this.x,f=0)),this.moved=!0,this._pos(h,k),this.dirX=0<f?-1:0>f?1:0,this.dirY=0<g?-1:0>g?1:0,300<l-this.startTime&&(this.startTime=l,this.startX=
this.x,this.startY=this.y),this.options.onScrollMove&&this.options.onScrollMove.call(this,c))}},_end:function(c){if(!(e&&0!=c.touches.length)){var a=this,f=e?c.changedTouches[0]:c,g,h,k={dist:0,time:0},l={dist:0,time:0},m=(c.timeStamp||Date.now())-a.startTime,o=a.x,n=a.y;a._unbind(y);a._unbind(z);a._unbind(r);a.options.onBeforeScrollEnd&&a.options.onBeforeScrollEnd.call(a,c);if(a.zoomed)o=a.scale*a.lastScale,o=Math.max(a.options.zoomMin,o),o=Math.min(a.options.zoomMax,o),a.lastScale=o/a.scale,a.scale=
o,a.x=a.originX-a.originX*a.lastScale+a.x,a.y=a.originY-a.originY*a.lastScale+a.y,a.scroller.style[b+"TransitionDuration"]="200ms",a.scroller.style[b+"Transform"]=t+a.x+"px,"+a.y+"px"+w+" scale("+a.scale+")",a.zoomed=!1,a.refresh(),a.options.onZoomEnd&&a.options.onZoomEnd.call(a,c);else{if(a.moved){if(300>m&&a.options.momentum){k=o?a._momentum(o-a.startX,m,-a.x,a.scrollerW-a.wrapperW+a.x,a.options.bounce?a.wrapperW:0):k;l=n?a._momentum(n-a.startY,m,-a.y,0>a.maxScrollY?a.scrollerH-a.wrapperH+a.y-a.minScrollY:
0,a.options.bounce?a.wrapperH:0):l;o=a.x+k.dist;n=a.y+l.dist;if(0<a.x&&0<o||a.x<a.maxScrollX&&o<a.maxScrollX)k={dist:0,time:0};if(a.y>a.minScrollY&&n>a.minScrollY||a.y<a.maxScrollY&&n<a.maxScrollY)l={dist:0,time:0}}k.dist||l.dist?(k=d.max(d.max(k.time,l.time),10),a.options.snap&&(l=o-a.absStartX,m=n-a.absStartY,d.abs(l)<a.options.snapThreshold&&d.abs(m)<a.options.snapThreshold?a.scrollTo(a.absStartX,a.absStartY,200):(l=a._snap(o,n),o=l.x,n=l.y,k=d.max(l.time,k))),a.scrollTo(o>>0,n>>0,k)):a.options.snap?
(l=o-a.absStartX,m=n-a.absStartY,d.abs(l)<a.options.snapThreshold&&d.abs(m)<a.options.snapThreshold?a.scrollTo(a.absStartX,a.absStartY,200):(l=a._snap(a.x,a.y),(l.x!=a.x||l.y!=a.y)&&a.scrollTo(l.x,l.y,l.time))):a._resetPos(200)}else e&&(a.doubleTapTimer&&a.options.zoom?(clearTimeout(a.doubleTapTimer),a.doubleTapTimer=null,a.options.onZoomStart&&a.options.onZoomStart.call(a,c),a.zoom(a.pointX,a.pointY,1==a.scale?a.options.doubleTapZoom:1),a.options.onZoomEnd&&setTimeout(function(){a.options.onZoomEnd.call(a,
c)},200)):a.doubleTapTimer=setTimeout(function(){a.doubleTapTimer=null;for(g=f.target;1!=g.nodeType;)g=g.parentNode;"SELECT"!=g.tagName&&"INPUT"!=g.tagName&&"TEXTAREA"!=g.tagName&&(h=document.createEvent("MouseEvents"),h.initMouseEvent("click",!0,!0,c.view,1,f.screenX,f.screenY,f.clientX,f.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,0,null),h._fake=!0,g.dispatchEvent(h))},a.options.zoom?250:0)),a._resetPos(200);a.options.onTouchEnd&&a.options.onTouchEnd.call(a,c)}}},_resetPos:function(c){var a=
0<=this.x?0:this.x<this.maxScrollX?this.maxScrollX:this.x,d=this.y>=this.minScrollY||0<this.maxScrollY?this.minScrollY:this.y<this.maxScrollY?this.maxScrollY:this.y;if(a==this.x&&d==this.y){if(this.moved&&(this.moved=!1,this.options.onScrollEnd&&this.options.onScrollEnd.call(this)),this.hScrollbar&&this.options.hideScrollbar&&("webkit"==b&&(this.hScrollbarWrapper.style[b+"TransitionDelay"]="300ms"),this.hScrollbarWrapper.style.opacity="0"),this.vScrollbar&&this.options.hideScrollbar)"webkit"==b&&
(this.vScrollbarWrapper.style[b+"TransitionDelay"]="300ms"),this.vScrollbarWrapper.style.opacity="0"}else this.scrollTo(a,d,c||0)},_wheel:function(c){var a=this,b,d;if("wheelDeltaX"in c)b=c.wheelDeltaX/12,d=c.wheelDeltaY/12;else if("wheelDelta"in c)b=d=c.wheelDelta/12;else if("detail"in c)b=d=3*-c.detail;else return;if("zoom"==a.options.wheelAction){if(d=a.scale*Math.pow(2,1/3*(d?d/Math.abs(d):0)),d<a.options.zoomMin&&(d=a.options.zoomMin),d>a.options.zoomMax&&(d=a.options.zoomMax),d!=a.scale)!a.wheelZoomCount&&
a.options.onZoomStart&&a.options.onZoomStart.call(a,c),a.wheelZoomCount++,a.zoom(c.pageX,c.pageY,d,400),setTimeout(function(){a.wheelZoomCount--;!a.wheelZoomCount&&a.options.onZoomEnd&&a.options.onZoomEnd.call(a,c)},400)}else b=a.x+b,d=a.y+d,0<b?b=0:b<a.maxScrollX&&(b=a.maxScrollX),d>a.minScrollY?d=a.minScrollY:d<a.maxScrollY&&(d=a.maxScrollY),a.scrollTo(b,d,0)},_mouseout:function(c){var a=c.relatedTarget;if(a)for(;a=a.parentNode;)if(a==this.wrapper)return;this._end(c)},_transitionEnd:function(c){c.target==
this.scroller&&(this._unbind("webkitTransitionEnd"),this._startAni())},_startAni:function(){var c=this,a=c.x,b=c.y,e=Date.now(),f,g,h;c.animating||(c.steps.length?(f=c.steps.shift(),f.x==a&&f.y==b&&(f.time=0),c.animating=!0,c.moved=!0,c.options.useTransition)?(c._transitionTime(f.time),c._pos(f.x,f.y),c.animating=!1,f.time?c._bind("webkitTransitionEnd"):c._resetPos(0)):(h=function(){var k=Date.now();if(k>=e+f.time){c._pos(f.x,f.y);c.animating=false;c.options.onAnimationEnd&&c.options.onAnimationEnd.call(c);
c._startAni()}else{k=(k-e)/f.time-1;g=d.sqrt(1-k*k);k=(f.x-a)*g+a;c._pos(k,(f.y-b)*g+b);if(c.animating)c.aniTime=s(h)}},h()):c._resetPos(400))},_transitionTime:function(c){c+="ms";this.scroller.style[b+"TransitionDuration"]=c;this.hScrollbar&&(this.hScrollbarIndicator.style[b+"TransitionDuration"]=c);this.vScrollbar&&(this.vScrollbarIndicator.style[b+"TransitionDuration"]=c)},_momentum:function(c,a,b,e,f){var a=d.abs(c)/a,g=a*a/0.0012;0<c&&g>b?(b+=f/(6/(6.0E-4*(g/a))),a=a*b/g,g=b):0>c&&g>e&&(e+=f/
(6/(6.0E-4*(g/a))),a=a*e/g,g=e);return{dist:g*(0>c?-1:1),time:a/6.0E-4>>0}},_offset:function(b){for(var a=-b.offsetLeft,d=-b.offsetTop;b=b.offsetParent;)a-=b.offsetLeft,d-=b.offsetTop;b!=this.wrapper&&(a*=this.scale,d*=this.scale);return{left:a,top:d}},_snap:function(b,a){var e,f,g;g=this.pagesX.length-1;e=0;for(f=this.pagesX.length;e<f;e++)if(b>=this.pagesX[e]){g=e;break}g==this.currPageX&&0<g&&0>this.dirX&&g--;b=this.pagesX[g];f=(f=d.abs(b-this.pagesX[this.currPageX]))?500*(d.abs(this.x-b)/f):0;
this.currPageX=g;g=this.pagesY.length-1;for(e=0;e<g;e++)if(a>=this.pagesY[e]){g=e;break}g==this.currPageY&&0<g&&0>this.dirY&&g--;a=this.pagesY[g];e=(e=d.abs(a-this.pagesY[this.currPageY]))?500*(d.abs(this.y-a)/e):0;this.currPageY=g;g=d.max(f,e)>>0;return{x:b,y:a,time:g||200}},_bind:function(b,a,d){(a||this.scroller).addEventListener(b,this,!!d)},_unbind:function(b,a,d){(a||this.scroller).removeEventListener(b,this,!!d)},destroy:function(){this.scroller.style[b+"Transform"]="";this.vScrollbar=this.hScrollbar=
!1;this._scrollbar("h");this._scrollbar("v");this._unbind(q,window);this._unbind(u);this._unbind(y);this._unbind(z);this._unbind(r);this.options.hasTouch||(this._unbind("mouseout",this.wrapper),this._unbind(v));this.options.useTransition&&this._unbind("webkitTransitionEnd");this.options.checkDOMChanges&&clearInterval(this.checkDOMTime);this.options.onDestroy&&this.options.onDestroy.call(this)},setOption:function(b){for(i in b)this.options[i]=b[i];this.refresh()},refresh:function(){var c,a,d,e=0;a=
0;this.scale<this.options.zoomMin&&(this.scale=this.options.zoomMin);this.wrapperW=this.wrapper.clientWidth||1;this.wrapperH=this.wrapper.clientHeight||1;this.minScrollY=-this.options.topOffset||0;this.scrollerW=this.scroller.offsetWidth*this.scale>>0;this.scrollerH=(this.scroller.offsetHeight+this.minScrollY)*this.scale>>0;this.maxScrollX=this.wrapperW-this.scrollerW;this.maxScrollY=this.wrapperH-this.scrollerH+this.minScrollY;this.dirY=this.dirX=0;this.options.onRefresh&&this.options.onRefresh.call(this);
this.hScroll=this.options.hScroll&&0>this.maxScrollX;this.vScroll=this.options.vScroll&&(!this.options.bounceLock&&!this.hScroll||this.scrollerH>this.wrapperH);this.hScrollbar=this.hScroll&&this.options.hScrollbar;this.vScrollbar=this.vScroll&&this.options.vScrollbar&&this.scrollerH>this.wrapperH;c=this._offset(this.wrapper);this.wrapperOffsetLeft=-c.left;this.wrapperOffsetTop=-c.top;if("string"==typeof this.options.snap){this.pagesX=[];this.pagesY=[];d=this.scroller.querySelectorAll(this.options.snap);
c=0;for(a=d.length;c<a;c++)e=this._offset(d[c]),e.left+=this.wrapperOffsetLeft,e.top+=this.wrapperOffsetTop,this.pagesX[c]=e.left<this.maxScrollX?this.maxScrollX:e.left*this.scale,this.pagesY[c]=e.top<this.maxScrollY?this.maxScrollY:e.top*this.scale}else if(this.options.snap){for(this.pagesX=[];e>=this.maxScrollX;)this.pagesX[a]=e,e-=this.wrapperW,a++;this.maxScrollX%this.wrapperW&&(this.pagesX[this.pagesX.length]=this.maxScrollX-this.pagesX[this.pagesX.length-1]+this.pagesX[this.pagesX.length-1]);
a=e=0;for(this.pagesY=[];e>=this.maxScrollY;)this.pagesY[a]=e,e-=this.wrapperH,a++;this.maxScrollY%this.wrapperH&&(this.pagesY[this.pagesY.length]=this.maxScrollY-this.pagesY[this.pagesY.length-1]+this.pagesY[this.pagesY.length-1])}this._scrollbar("h");this._scrollbar("v");this.zoomed||(this.scroller.style[b+"TransitionDuration"]="0",this._resetPos(200))},scrollTo:function(b,a,d,e){var f=b;this.stop();f.length||(f=[{x:b,y:a,time:d,relative:e}]);b=0;for(a=f.length;b<a;b++)f[b].relative&&(f[b].x=this.x-
f[b].x,f[b].y=this.y-f[b].y),this.steps.push({x:f[b].x,y:f[b].y,time:f[b].time||0});this._startAni()},scrollToElement:function(b,a){var e;if(b=b.nodeType?b:this.scroller.querySelector(b))e=this._offset(b),e.left+=this.wrapperOffsetLeft,e.top+=this.wrapperOffsetTop,e.left=0<e.left?0:e.left<this.maxScrollX?this.maxScrollX:e.left,e.top=e.top>this.minScrollY?this.minScrollY:e.top<this.maxScrollY?this.maxScrollY:e.top,a=void 0===a?d.max(2*d.abs(e.left),2*d.abs(e.top)):a,this.scrollTo(e.left,e.top,a)},
scrollToPage:function(b,a,d){d=void 0===d?400:d;this.options.onScrollStart&&this.options.onScrollStart.call(this);if(this.options.snap)b="next"==b?this.currPageX+1:"prev"==b?this.currPageX-1:b,a="next"==a?this.currPageY+1:"prev"==a?this.currPageY-1:a,b=0>b?0:b>this.pagesX.length-1?this.pagesX.length-1:b,a=0>a?0:a>this.pagesY.length-1?this.pagesY.length-1:a,this.currPageX=b,this.currPageY=a,b=this.pagesX[b],a=this.pagesY[a];else if(b*=-this.wrapperW,a*=-this.wrapperH,b<this.maxScrollX&&(b=this.maxScrollX),
a<this.maxScrollY)a=this.maxScrollY;this.scrollTo(b,a,d)},disable:function(){this.stop();this._resetPos(0);this.enabled=!1;this._unbind(y);this._unbind(z);this._unbind(r)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind("webkitTransitionEnd"):n(this.aniTime);this.steps=[];this.animating=this.moved=!1},zoom:function(c,a,d,e){var f=d/this.scale;this.options.useTransform&&(this.zoomed=!0,e=void 0===e?200:e,c=c-this.wrapperOffsetLeft-this.x,a=a-this.wrapperOffsetTop-
this.y,this.x=c-c*f+this.x,this.y=a-a*f+this.y,this.scale=d,this.refresh(),this.x=0<this.x?0:this.x<this.maxScrollX?this.maxScrollX:this.x,this.y=this.y>this.minScrollY?this.minScrollY:this.y<this.maxScrollY?this.maxScrollY:this.y,this.scroller.style[b+"TransitionDuration"]=e+"ms",this.scroller.style[b+"Transform"]=t+this.x+"px,"+this.y+"px"+w+" scale("+d+")",this.zoomed=!1)},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}};"undefined"!==typeof exports?exports.iScroll=g:window.iScroll=
g})();window.languages=window.languages||{};window.languages["zh-tw"]={setting:{DST:8,format:"Y 年 m 月 d 日 (D) H:i:s",AM:"上午",PM:"下午"},shortMonths:"1 月,2 月,3 月,4 月,5 月,6 月,7 月,8 月,9 月,10 月,11 月,12 月".split(","),longMonths:"一月,二月,三月,四月,五月,六月,七月,八月,九月,十月,十一月,十二月".split(","),shortDays:"日,一,二,三,四,五,六".split(","),longDays:"星期日,星期一,星期二,星期三,星期四,星期五,星期六".split(","),orderTab:"點餐",historyTab:"紀錄",feedbackTab:"意見",aboutUsTab:"關於","Hello World":"哈囉! 世界","Nice to meet you, %1":"很高興認識你，%1","My name is %1, I'm %2 years old":"我的名字是 %1，我今年 %2 歲"};var supportedLang="zh-tw",defaultLang="zh-tw",language=window.navigator.userLanguage||window.navigator.language||defaultLang,language=language.toLowerCase();0>supportedLang.indexOf(language)&&(language=defaultLang);i18n.set(window.languages[language]);$(document).ready(function(){$("#backgroundLogo").remove();new myapp.Router;Backbone.history.start()});(function(){var d=Backbone.RelationalModel.extend({idAttribute:"_productId"}),b=Backbone.RelationalModel.extend({idAttribute:"_menuId",relations:[{type:Backbone.HasMany,key:"products",relatedModel:d,reverseRelation:{key:"menu",includeInJSON:"_menuId"}}]}),o=Backbone.RelationalModel.extend({defaults:{deliveryLimit:99999,deliveryFee:99999,lat:99999,lng:99999},idAttribute:"_storeNameId",relations:[{type:Backbone.HasOne,key:"_menuId",relatedModel:b,reverseRelation:{key:"store",includeInJSON:"_storeNameId"}}]}),
k=Backbone.RelationalModel.extend({url:"/jashami/testData/menuData",relations:[{type:Backbone.HasMany,key:"stores",relatedModel:o},{type:Backbone.HasMany,key:"menus",relatedModel:b}]});window.myapp=window.myapp||{};window.myapp.Model=window.myapp.Model||{};window.myapp.Model.Product=d;window.myapp.Model.Menu=b;window.myapp.Model.Store=o;window.myapp.Model.MenuData=k})();window.myapp=window.myapp||{};window.myapp.Images={JashamiLogo:"data:image/png;base64,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"};(function(d){var b=Backbone.View.extend({initialize:function(){this.container=document.createElement("div");this.content=document.createElement("div");this.container.appendChild(this.content);this.el=this.container;this.container.style.overflow="hidden";this.content.style.width="100%";this.content.style.height="100%";this.scroll=new d(this.container,{hScrollbar:!1,vScrollbar:!1});var b=this,k=function(){b.scroll.refresh();[].slice.call(b.content.querySelectorAll("input, select, button")).forEach(function(b){b.addEventListener("ontouchstart"in
window?"touchstart":"mousedown",function(b){b.stopPropagation()})})};$(this.container).bind("DOMNodeInsertedIntoDocument",k);$(this.container).bind("resize",k)},events:{},html:function(b){$(this.content).html(b)},setPullToRefresh:function(b){var d={pullDownOffset:30,pullUpOffset:30};for(i in b)d[i]=b[i];pullDownEl=d.pullDownEl;pullUpEl=d.pullUpEl;pullDownOffset=d.pullDownOffset;pullUpOffset=d.pullUpOffset;pullUpAction=d.pullUpAction;pullDownAction=d.pullDownAction;pullDownEl&&pullDownEl.html('<span class="pullDownIcon"></span><span class="pullDownLabel">Pull down to refresh...</span>');
pullUpEl&&pullUpEl.html('<span class="pullUpIcon"></span><span class="pullUpLabel">Pull up to refresh...</span>');this.render({useTransition:!0,topOffset:pullDownOffset,onRefresh:function(){pullDownEl&&pullDownEl.hasClass("loading")?(pullDownEl.removeClass("loading"),$(".pullDownLabel",pullDownEl).html("Pull down to refresh...")):pullUpEl&&pullUpEl.hasClass("loading")&&(pullUpEl.removeClass("loading"),$(".pullUpLabel",pullUpEl).html("Pull up to load more..."))},onScrollMove:function(){pullDownEl&&
5<this.y&&!pullDownEl.hasClass("flip")?(pullDownEl.addClass("flip"),$(".pullDownLabel",pullDownEl).html("Release to refresh..."),this.minScrollY=0):pullDownEl&&5>this.y&&pullDownEl.hasClass("flip")?(pullDownEl.removeClass("flip"),$(".pullDownLabel",pullDownEl).html("Pull down to refresh..."),this.minScrollY=-pullDownOffset):pullUpEl&&this.y<this.maxScrollY-5&&!pullUpEl.hasClass("flip")?(pullUpEl.addClass("flip"),$(".pullUpLabel",pullUpEl).html("Release to refresh..."),this.maxScrollY=this.maxScrollY):
pullUpEl&&this.y>this.maxScrollY+5&&pullUpEl.hasClass("flip")&&(pullUpEl.removeClass("flip"),$(".pullUpLabel",pullUpEl).html("Pull up to load more..."),this.maxScrollY=pullUpOffset)},onScrollEnd:function(){pullDownEl&&pullDownEl.hasClass("flip")?(pullDownEl.removeClass("flip").addClass("loading"),$(".pullDownLabel",pullDownEl).html("Loading..."),pullDownAction()):pullUpEl&&pullUpEl.hasClass("flip")&&(pullUpEl.removeClass("flip").addClass("loading"),$(".pullUpLabel",pullUpEl).html("Loading..."),pullUpAction())}})},
render:function(b){b?this.scroll.setOption(b):this.scroll.refresh();return this}});window.myapp=window.myapp||{};window.myapp.Widget=window.myapp.Widget||{};window.myapp.Widget.Scroller=b})(iScroll);(function(){var d=Backbone.View.extend({initialize:function(){this._isEnabled=!0;this._clickStart=!1;this._lastY=this._lastX=null},events:{mouseout:"onMouseOut",mousedown:"mouseDown",touchstart:"touchStart",touchmove:"touchMove",mouseup:"mouseUp",touchend:"touchEnd"},onMouseOut:function(){this._clickStart=!1;$(this.el).removeClass("Pressed")},mouseDown:function(b){b.preventDefault();b.stopPropagation();this.start(b.clientX,b.clientY)},touchStart:function(b){b.preventDefault();b.stopPropagation();
this.start(b.originalEvent.changedTouches[0].pageX,b.originalEvent.changedTouches[0].pageY)},touchMove:function(b){b.preventDefault();b.stopPropagation();var d=b.target.getBoundingClientRect(),k=d.left,d=d.top,g=b.target.clientWidth,l=b.target.clientHeight,m=b.originalEvent.changedTouches[0].pageX,b=b.originalEvent.changedTouches[0].pageY;if(m<k||m>k+g||b<d||b>d+l)this._clickStart=!1,$(this.el).removeClass("Pressed")},mouseUp:function(b){b.preventDefault();b.stopPropagation();this.end(b.clientX,b.clientY)},
touchEnd:function(b){b.preventDefault();b.stopPropagation();this.end(b.originalEvent.changedTouches[0].pageX,b.originalEvent.changedTouches[0].pageY)},start:function(b,d){this._isEnabled&&null!=b&&null!=d&&(this._lastX=b,this._lastY=d,this._clickStart=!0,this.changeColorWhenTouch&&$(this.el).addClass("Pressed"))},end:function(b,d){this._isEnabled&&null!=b&&null!=d&&(this._lastY=this._lastX=null,this._clickStart&&$(this.el).trigger("clickByTouch"),this._clickStart=!1,$(this.el).removeClass("Pressed"))}});
window.myapp=window.myapp||{};window.myapp.Widget=window.myapp.Widget||{};window.myapp.Widget.TouchWidget=d})();(function(){var d=Backbone.View.extend({render:function(){var b=this.model.get("_storeNameId"),d=this.model.get("_displayedName"),k=this.model.get("_msg"),g=this.model.get("_imgUrl");$(this.el).html(_.template('<a href="#storePage/<%= id %>"><img src="<%= img %>"></img><div class="Tag"></div><div class="InfoWidget"><div class="NameWidget"><div class="Name"><%= name %></div><div class="Msg"><%= msg %></div></div><div class="Bar"><div></div></div><div class="Status"></div></div></a>',{id:b,name:d,msg:k,
img:g}));$(this.el).addClass("StoreBriefWidget3");return this}});window.myapp=window.myapp||{};window.myapp.View=window.myapp.View||{};window.myapp.View.StoreBrief=d})();(function(d,b,o){var k=Backbone.View.extend({initialize:function(){var g=new b;g.html(_.template('<div class="StoreList"></div>'));$(this.el).html(g.render().el);$(this.el).css("background-color","rgba(255, 255, 255, 0.75)");$(this.el).css("display","-webkit-box");$(g.el).css("width","100%");var k=this,m=new d;m.fetch({success:function(){window.menuData=m;_.each(m.get("stores").models,function(b){b=new o({model:b});$(".StoreList",k.el).append(b.render().el)});$("img",this.el).bind("load",function(){g.render()});
g.render()},error:function(b,d){console.log(d.status)}})},events:{},render:function(){this.delegateEvents();return this}});window.myapp=window.myapp||{};window.myapp.OrderTabView=k})(window.myapp.Model.MenuData,window.myapp.Widget.Scroller,window.myapp.View.StoreBrief);(function(d){var b=Backbone.View.extend({initialize:function(){var b=new d;b.html(_.template('<div id="pullDown"></div><div class="OrderHistory"><div><div class="gwt-Label">點餐紀錄:</div><div class="OrderHistoryPanelTitle"><div class="gwt-Label">✭</div><div class="gwt-Label">送餐時間</div><div class="gwt-Label">編號</div><div class="gwt-Label">狀態</div></div></div><div class="Accordion OrderHistoryPanel"></div></div><div id="pullUp"></div>'));$(this.el).html(b.el);$(this.el).css("background-color","rgba(255, 255, 255, 0.75)");
$(this.el).css("display","-webkit-box");$(b.el).css("width","100%");$(".OrderHistoryPanel",this.el).css("minHeight",window.clientHeight);pullDownEl=$("#pullDown",this.el);pullDownOffset=30;pullUpEl=$("#pullUp",this.el);pullUpOffset=30;var k=this;b.setPullToRefresh({pullDownEl:pullDownEl,pullDownAction:function(){setTimeout(function(){el=$(".OrderHistoryPanel",k.el);for(i=0;3>i;i++)el.prepend("<li>Generated row</li>");b.render()},1E3)}})},render:function(){return this}});window.myapp=window.myapp||
{};window.myapp.HistoryTabView=b})(window.myapp.Widget.Scroller);(function(d,b){var o=Backbone.View.extend({initialize:function(){var k=new b;k.html(_.template("<div class='about_text' style='width:100%;'>感謝您使用Jashami(甲蝦米)<br/>您希望哪些商家擁有Jashami的服務，請推薦給我們：<input id='recommendation' type='Text' class='INPUT Text'>請留下您的寶貴意見，我們將為您提供更好的服務:<input id='opinion' type='Text' class='INPUT Text'><div id='sendFeedbackBtn' class='SubmitButton'>送出</div></div>"));$(this.el).html(k.el);$(this.el).css("background-color","rgba(255, 255, 255, 0.75)");$(this.el).css("display","-webkit-box");
$(k.el).css("width","100%");this.sendFeedbackBtn=new d({el:$("#sendFeedbackBtn",this.el)});this.sendFeedbackBtn.changeColorWhenTouch=!0},events:{"clickByTouch #sendFeedbackBtn":"sendFeedback"},render:function(){this.sendFeedbackBtn.delegateEvents();this.delegateEvents();return this},sendFeedback:function(){var b=$("#recommendation",this.el).val(),d=$("#opinion",this.el).val();alert("sendFeedback"+b+d)}});window.myapp=window.myapp||{};window.myapp.FeedbackTabView=o})(window.myapp.Widget.TouchWidget,
window.myapp.Widget.Scroller);(function(d){var b=Backbone.View.extend({initialize:function(){var b=new d;b.html(_.template('<div id="content" data-scrollable="y" style="width:100%;">qqq</div>'));$(this.el).html(b.el);$(this.el).css("background-color","rgba(255, 255, 255, 0.75)");$(this.el).css("display","-webkit-box");$(b.el).css("width","100%")},events:{},render:function(){return this}});window.myapp=window.myapp||{};window.myapp.AboutUsTabView=b})(window.myapp.Widget.Scroller);(function(d,b,o){var k=['<div class="HeaderPanel"><div></div><div>','<img src="'+b.JashamiLogo+'">','</div><div></div></div><div class="TabPanel"><div class="TabContent"></div><div class="TabHeader">','<div class="TabButton"><a href="#startPage/orderTab">'+d._("orderTab")+"</a></div>",'<div class="TabButton"><a href="#startPage/historyTab">'+d._("historyTab")+"</a></div>",'<div class="TabButton"><a href="#startPage/feedbackTab">'+d._("feedbackTab")+"</a></div>",'<div class="TabButton"><a href="#startPage/aboutUsTab">'+
d._("aboutUsTab")+"</a></div>","</div></div>"].join(""),d=Backbone.View.extend({initialize:function(){this.tabs={};$(this.el).html(_.template(k));$(this.el).addClass("Base");$(this.el).attr("style","height:100%");$(this.el).attr("style","width:100%")},render:function(){return this},toTab:function(b){this.tabs[b]||(this.tabs[b]=new o[b]);$(".TabContent",this.el).html(this.tabs[b].render().el)}});window.myapp=window.myapp||{};window.myapp.StartPageView=d})(i18n,window.myapp.Images,{orderTab:window.myapp.OrderTabView,
historyTab:window.myapp.HistoryTabView,feedbackTab:window.myapp.FeedbackTabView,aboutUsTab:window.myapp.AboutUsTabView});(function(d,b){var o=Backbone.View.extend({initialize:function(){$(this.el).addClass("Base");$(this.el).attr("style","height:100%");$(this.el).attr("style","width:100%");this.scroller=new b;$(this.scroller.el).css("background-color","rgba(255, 255, 255, 0.75)");$(this.scroller.el).css("display","-webkit-box");$(this.scroller.el).css("width","100%");$(this.scroller.el).css("-webkit-box-flex","1")},render:function(){var b=this.model.get("_displayedName");$(this.el).html(_.template('<div class="HeaderPanel"><div><div class="HeaderButton BackButton"><span class="Pointer"></span><span class="Button">返回</span></div></div><div><%= storeName %></div><div></div></div><div id="storeContent" style="-webkit-box-flex: 10;display: -webkit-box;-webkit-box-orient: vertical;-webkit-box-pack: justify;"></div>',
{storeName:b}));$("#storeContent",this.el).html(this.scroller.render().el);return this}});window.myapp=window.myapp||{};window.myapp.StorePageView=o})(window.myapp.Widget.TouchWidget,window.myapp.Widget.Scroller);(function(d,b){var o=Backbone.Router.extend({routes:{"startPage/:tab":"startPage","storePage/:store":"storePage","*actions":"defaultAction"},initialize:function(){this.views={};this.firstPage=this.useTransitionEffect=!0;this.isGoBack=!1},defaultAction:function(){this.startPage("orderTab")},startPage:function(d){this.views.startPage||(this.views.startPage=new b.StartPageView);this.views.startPage.toTab(d);this.changePage(this.views.startPage.render().el)},storePage:function(k){this.views.storePage||
(this.views.storePage=new b.StorePageView);if(window.menuData)this.views.storePage.model=window.menuData.get("stores").get(k),this.changePage(this.views.storePage.render().el);else{var g=this;window.menuData=new d;window.menuData.fetch({success:function(){g.views.storePage.model=window.menuData.get("stores").get(k);g.changePage(g.views.storePage.render().el)}})}},changePage:function(b){if(!this.useTransitionEffect||this.firstPage)$(".ActivePage").html(b),this.firstPage=!1;else{var d=$(".ActivePage").children(),
l=$(b);d.addClass("transitionSlide transitionOut");l.addClass("transitionSlide transitionIn");this.isGoBack&&(d.addClass("reverse"),l.addClass("reverse"));$(".ActivePage").append(b);this.isGoBack?d.bind("webkitTransitionEnd",function(){d.unbind();d.removeClass("transitionSlide transitionOut reverse transitionStart");l.removeClass("transitionSlide transitionIn reverse transitionStart");d.remove()}):l.bind("webkitTransitionEnd",function(){l.unbind();d.removeClass("transitionSlide transitionOut reverse transitionStart");
l.removeClass("transitionSlide transitionIn reverse transitionStart");d.remove()});setTimeout(function(){d.addClass("transitionStart");l.addClass("transitionStart")},10);this.isGoBack=!1}var m=this;$(".BackButton").bind("click",function(){m.isGoBack=!0;window.history.back()});$(".TabHeader a").bind("click",function(){m.firstPage=!0})}});window.myapp=window.myapp||{};window.myapp.Router=o})(window.myapp.Model.MenuData,{StartPageView:window.myapp.StartPageView,StorePageView:window.myapp.StorePageView});
