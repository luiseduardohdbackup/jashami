var i18n=function(){var d={},a={DST:-4,format:"D, d F Y H:i:s",AM:"AM",PM:"PM"};Date.prototype.format=function(d){var a="",l=Date.replaceChars,m="";l.reload();for(var e=0;e<d.length;e++)m=d.charAt(e),a+=l[m]?l[m].call(this):m;return a};Date.replaceChars={reload:function(){Date.replaceChars.shortMonths=d.hasOwnProperty("shortMonths")?d.shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(",");Date.replaceChars.longMonths=d.hasOwnProperty("longMonths")?d.longMonths:"January,February,March,April,May,June,July,August,September,October,November,December".split(",");
Date.replaceChars.shortDays=d.hasOwnProperty("shortDays")?d.shortDays:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(",");Date.replaceChars.longDays=d.hasOwnProperty("longDays")?d.longDays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(",")},shortMonths:[],longMonths:[],shortDays:[],longDays:[],d:function(){return(10>this.getUTCDate()?"0":"")+this.getUTCDate()},D:function(){return Date.replaceChars.shortDays[this.getUTCDay()]},j:function(){return this.getUTCDate()},l:function(){return Date.replaceChars.longDays[this.getUTCDay()]},
N:function(){return this.getDay()+1},S:function(){return 1===this.getUTCDate()%10&&11!==this.getUTCDate()?"st":2===this.getUTCDate()%10&&12!==this.getUTCDate()?"nd":3==this.getUTCDate()%10&&13!=this.getUTCDate()?"rd":"th"},w:function(){return this.getUTCDay()},z:function(){return""},W:function(){return""},F:function(){return Date.replaceChars.longMonths[this.getUTCMonth()]},m:function(){return(9>this.getUTCMonth()?"0":"")+(this.getUTCMonth()+1)},M:function(){return Date.replaceChars.shortMonths[this.getUTCMonth()]},
n:function(){return this.getUTCMonth()+1},t:function(){return""},L:function(){return""},o:function(){return""},Y:function(){return this.getUTCFullYear()},y:function(){return(""+this.getUTCFullYear()).substr(2)},a:function(){var k=d.hasOwnProperty("setting")?d.setting:a;return 12>this.getUTCHours()?k.AM:k.PM},A:function(){var k=d.hasOwnProperty("setting")?d.setting:a;return 12>this.getUTCHours()?k.AM:k.PM},B:function(){return""},g:function(){return this.getUTCHours()%12||12},G:function(){return this.getUTCHours()},
h:function(){return(10>(this.getUTCHours()%12||12)?"0":"")+(this.getUTCHours()%12||12)},H:function(){return(10>this.getUTCHours()?"0":"")+this.getUTCHours()},i:function(){return(10>this.getUTCMinutes()?"0":"")+this.getUTCMinutes()},s:function(){return(10>this.getUTCSeconds()?"0":"")+this.getUTCSeconds()},e:function(){return""},I:function(){return""},O:function(){return(0>-this.getTimezoneOffset()?"-":"+")+(10>Math.abs(this.getTimezoneOffset()/60)?"0":"")+Math.abs(this.getTimezoneOffset()/60)+"00"},
T:function(){var d=this.getUTCMonth();this.setMonth(0);var a=this.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,"$1");this.setMonth(d);return a},Z:function(){return 60*-this.getTimezoneOffset()},c:function(){return""},r:function(){return this.toString()},U:function(){return this.getUTCTime()/1E3}};var o=function(d,a,l){var m,a=parseInt(a,10);"string"===typeof l&&(l=l.split(/\D/),--l[1],m=new Date(l.join(",")));m="object"===typeof m?m:l;switch(d){case "y":m.setFullYear(m.getFullYear()+a);break;case "m":m.setMonth(m.getMonth()+
a);break;case "d":m.setDate(m.getDate()+a);break;case "w":m.setDate(m.getDate()+7*a);break;case "h":m.setHours(m.getHours()+a);break;case "n":m.setMinutes(m.getMinutes()+a);break;case "s":m.setSeconds(m.getSeconds()+a);break;case "l":m.setMilliseconds(m.getMilliseconds()+a)}return m};return{set:function(a){d=a},datetime:function(k){var g=d.hasOwnProperty("setting")?d.setting:a;return(g.format?o("h",g.DST,k?new Date(k):new Date):k?new Date(k):new Date).format(g.format)},_:function(a){try{var a=a.toString()||
"",g=arguments,l=0<g.length?RegExp("%([1-"+g.length.toString()+"])","g"):null;return(""+(d.hasOwnProperty(a)?d[a]:a)).replace(l,function(a,d){return g[d]})}catch(m){}}}}();(function(d){String.prototype.trim===d&&(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")});Array.prototype.reduce===d&&(Array.prototype.reduce=function(a){if(void 0===this||null===this)throw new TypeError;var o=Object(this),k=o.length>>>0,g=0,l;if("function"!=typeof a)throw new TypeError;if(0==k&&1==arguments.length)throw new TypeError;if(2<=arguments.length)l=arguments[1];else{do{if(g in o){l=o[g++];break}if(++g>=k)throw new TypeError;}while(1)}for(;g<k;)g in o&&
(l=a.call(d,l,o[g],g,o)),g++;return l})})();
var Zepto=function(){function d(b){return"[object Function]"=={}.toString.call(b)}function a(b){return b instanceof Object}function o(b){return b instanceof Array}function k(b){return"number"==typeof b.length}function g(b){return b.filter(function(b){return b!==r&&null!==b})}function l(b){return b.replace(/-+(.)?/g,function(b,c){return c?c.toUpperCase():""})}function m(b){return b.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}
function e(b){return b.filter(function(b,c,j){return j.indexOf(b)==c})}function f(b){return b in C?C[b]:C[b]=RegExp("(^|\\s)"+b+"(\\s|$)")}function h(c,j){j===r&&D.test(c);j in p||(j="*");var a=p[j];return a.innerHTML=""+c,b.call(a.childNodes)}function s(b,j){return b=b||c,b.__proto__=s.prototype,b.selector=j||"",b}function n(b,c){if(!b)return s();if(c!==r)return n(c).find(b);if(d(b))return n(j).ready(b);if(b instanceof s)return b;var p;return o(b)?p=g(b):0<=A.indexOf(b.nodeType)||b===window?(p=[b],
b=null):D.test(b)?(p=h(b.trim(),RegExp.$1),b=null):b.nodeType&&3==b.nodeType?p=[b]:p=t(j,b),s(p,b)}function q(b,c){return c===r?n(b):n(b).filter(c)}function u(b,c,j,p){return d(c)?c.call(b,j,p):c}function y(b,c,j){var p=b%2?c:c.parentNode;p&&p.insertBefore(j,b?1==b?p.firstChild:2==b?c:null:c.nextSibling)}function z(b,c){c(b);for(var j in b.childNodes)z(b.childNodes[j],c)}var r,v,t,w,c=[],b=c.slice,j=window.document,x={},C={},F=j.defaultView.getComputedStyle,E={"column-count":1,columns:1,"font-weight":1,
"line-height":1,opacity:1,"z-index":1,zoom:1},D=/^\s*<(\w+)[^>]*>/,A=[1,9,11],B=j.createElement("table"),G=j.createElement("tr"),p={tr:j.createElement("tbody"),tbody:B,thead:B,tfoot:B,td:G,th:G,"*":j.createElement("div")},H=/complete|loaded|interactive/,I=/^\.([\w-]+)$/,J=/^#([\w-]+)$/,K=/^[\w-]+$/;return n.extend=function(c){return b.call(arguments,1).forEach(function(b){for(v in b)c[v]=b[v]}),c},n.qsa=t=function(p,a){var e;return p===j&&J.test(a)?(e=p.getElementById(RegExp.$1))?[e]:c:b.call(I.test(a)?
p.getElementsByClassName(RegExp.$1):K.test(a)?p.getElementsByTagName(a):p.querySelectorAll(a))},n.isFunction=d,n.isObject=a,n.isArray=o,n.map=function(b,c){var j,p=[],a;if(k(b))for(a=0;a<b.length;a++)j=c(b[a],a),null!=j&&p.push(j);else for(a in b)j=c(b[a],a),null!=j&&p.push(j);return 0<p.length?[].concat.apply([],p):p},n.each=function(b,c){var j;if(k(b))for(j=0;j<b.length&&!1!==c(j,b[j]);j++);else for(j in b)if(!1===c(j,b[j]))break;return b},n.fn={forEach:c.forEach,reduce:c.reduce,push:c.push,indexOf:c.indexOf,
concat:c.concat,map:function(b){return n.map(this,function(c,j){return b.call(c,j,c)})},slice:function(){return n(b.apply(this,arguments))},ready:function(b){return H.test(j.readyState)?b(n):j.addEventListener("DOMContentLoaded",function(){b(n)},!1),this},get:function(b){return b===r?this:this[b]},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(b){return this.forEach(function(c,j){b.call(c,
j,c)}),this},filter:function(b){return n([].filter.call(this,function(c){return c.parentNode&&0<=t(c.parentNode,b).indexOf(c)}))},end:function(){return this.prevObject||n()},andSelf:function(){return this.add(this.prevObject||n())},add:function(b,c){return n(e(this.concat(n(b,c))))},is:function(b){return 0<this.length&&0<n(this[0]).filter(b).length},not:function(c){var j=[];if(d(c)&&c.call!==r)this.each(function(b){c.call(this,b)||j.push(this)});else{var p="string"==typeof c?this.filter(c):k(c)&&
d(c.item)?b.call(c):n(c);this.forEach(function(b){0>p.indexOf(b)&&j.push(b)})}return n(j)},eq:function(b){return-1===b?this.slice(b):this.slice(b,+b+1)},first:function(){var b=this[0];return b&&!a(b)?b:n(b)},last:function(){var b=this[this.length-1];return b&&!a(b)?b:n(b)},find:function(b){var c;return 1==this.length?c=t(this[0],b):c=this.map(function(){return t(this,b)}),n(c)},closest:function(b,c){var p=this[0],a=t(c||j,b);for(a.length||(p=null);p&&0>a.indexOf(p);)p=p!==c&&p!==j&&p.parentNode;return n(p)},
parents:function(b){for(var c=[],p=this;0<p.length;)p=n.map(p,function(b){if((b=b.parentNode)&&b!==j&&0>c.indexOf(b))return c.push(b),b});return q(c,b)},parent:function(b){return q(e(this.pluck("parentNode")),b)},children:function(c){return q(this.map(function(){return b.call(this.children)}),c)},siblings:function(c){return q(this.map(function(c,j){return b.call(j.parentNode.children).filter(function(b){return b!==j})}),c)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(b){return this.map(function(){return this[b]})},
show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=null);if("none"==F(this,"").getPropertyValue("display")){var b=this.style,c;c=this.nodeName;var p,a;c=(x[c]||(p=j.createElement(c),j.body.appendChild(p),a=F(p,"").getPropertyValue("display"),p.parentNode.removeChild(p),"none"==a&&(a="block"),x[c]=a),x[c]);b.display=c}})},replaceWith:function(b){return this.each(function(){n(this).before(b).remove()})},wrap:function(b){return this.each(function(){n(this).wrapAll(n(b)[0].cloneNode(!1))})},
wrapAll:function(b){return this[0]&&(n(this[0]).before(b=n(b)),b.append(this)),this},unwrap:function(){return this.parent().each(function(){n(this).replaceWith(n(this).children())}),this},hide:function(){return this.css("display","none")},toggle:function(b){return(b===r?"none"==this.css("display"):b)?this.show():this.hide()},prev:function(){return n(this.pluck("previousElementSibling"))},next:function(){return n(this.pluck("nextElementSibling"))},html:function(b){return b===r?0<this.length?this[0].innerHTML:
null:this.each(function(c){var j=this.innerHTML;n(this).empty().append(u(this,b,c,j))})},text:function(b){return b===r?0<this.length?this[0].textContent:null:this.each(function(){this.textContent=b})},attr:function(b,c){var j;return"string"==typeof b&&c===r?0==this.length?r:"value"==b&&"INPUT"==this[0].nodeName?this.val():!(j=this[0].getAttribute(b))&&b in this[0]?this[0][b]:j:this.each(function(j){if(a(b))for(v in b)this.setAttribute(v,b[v]);else this.setAttribute(b,u(this,c,j,this.getAttribute(b)))})},
removeAttr:function(b){return this.each(function(){this.removeAttribute(b)})},data:function(b,c){return this.attr("data-"+b,c)},val:function(b){return b===r?0<this.length?this[0].value:null:this.each(function(c){this.value=u(this,b,c,this.value)})},offset:function(){if(0==this.length)return null;var b=this[0].getBoundingClientRect();return{left:b.left+window.pageXOffset,top:b.top+window.pageYOffset,width:b.width,height:b.height}},css:function(b,c){if(c===r&&"string"==typeof b)return 0==this.length?
r:this[0].style[l(b)]||F(this[0],"").getPropertyValue(b);var j="";for(v in b)j+=m(v)+":"+("number"==typeof b[v]&&!E[m(v)]?b[v]+"px":b[v])+";";return"string"==typeof b&&(j=m(b)+":"+("number"==typeof c&&!E[m(b)]?c+"px":c)),this.each(function(){this.style.cssText+=";"+j})},index:function(b){return b?this.indexOf(n(b)[0]):this.parent().children().indexOf(this[0])},hasClass:function(b){return 1>this.length?!1:f(b).test(this[0].className)},addClass:function(b){return this.each(function(c){w=[];var j=this.className;
u(this,b,c,j).split(/\s+/g).forEach(function(b){n(this).hasClass(b)||w.push(b)},this);w.length&&(this.className+=(j?" ":"")+w.join(" "))})},removeClass:function(b){return this.each(function(c){if(b===r)return this.className="";w=this.className;u(this,b,c,w).split(/\s+/g).forEach(function(b){w=w.replace(f(b)," ")});this.className=w.trim()})},toggleClass:function(b,c){return this.each(function(j){j=u(this,b,j,this.className);(c===r?!n(this).hasClass(j):c)?n(this).addClass(j):n(this).removeClass(j)})}},
"filter,add,not,eq,first,last,find,closest,parents,parent,children,siblings".split(",").forEach(function(b){var c=n.fn[b];n.fn[b]=function(){var b=c.apply(this,arguments);return b.prevObject=this,b}}),["width","height"].forEach(function(b){n.fn[b]=function(c){var p,a=b.replace(/./,function(b){return b[0].toUpperCase()});return c===r?this[0]==window?window["inner"+a]:this[0]==j?j.documentElement["offset"+a]:(p=this.offset())&&p[b]:this.each(function(j){var p=n(this);p.css(b,u(this,c,j,p[b]()))})}}),
["after","prepend","before","append"].forEach(function(b,c){n.fn[b]=function(b){var j=a(b)?b:h(b);if(!("length"in j)||j.nodeType)j=[j];if(1>j.length)return this;var p=this.length,e=1<p,d=2>c;return this.each(function(b,a){for(var f=0;f<j.length;f++){var x=j[d?j.length-f-1:f];z(x,function(b){null!=b.nodeName&&"SCRIPT"===b.nodeName.toUpperCase()&&(!b.type||"text/javascript"===b.type)&&window.eval.call(window,b.innerHTML)});e&&b<p-1&&(x=x.cloneNode(!0));y(c,a,x)}})};n.fn[c%2?b+"To":"insert"+(c?"Before":
"After")]=function(c){return n(c)[b](this),this}}),s.prototype=n.fn,n}();window.Zepto=Zepto;"$"in window||(window.$=Zepto);
(function(d){function a(a,e,d,g){e=o(e);if(e.ns)var k=RegExp("(?:^| )"+e.ns.replace(" "," .* ?")+"(?: |$)");return(f[a._zid||(a._zid=h++)]||[]).filter(function(a){return a&&(!e.e||a.e==e.e)&&(!e.ns||k.test(a.ns))&&(!d||a.fn==d)&&(!g||a.sel==g)})}function o(a){a=(""+a).split(".");return{e:a[0],ns:a.slice(1).sort().join(" ")}}function k(a,e,f){d.isObject(a)?d.each(a,f):a.split(/\s/).forEach(function(a){f(a,e)})}function g(a,e,g,l,m){var n=a._zid||(a._zid=h++),c=f[n]||(f[n]=[]);k(e,g,function(b,j){var e=
m&&m(j,b),f=e||j,h=function(b){var c=f.apply(a,[b].concat(b.data));return!1===c&&b.preventDefault(),c},e=d.extend(o(b),{fn:j,proxy:h,sel:l,del:e,i:c.length});c.push(e);a.addEventListener(e.e,h,!1)})}function l(e,d,g,m){var l=e._zid||(e._zid=h++);k(d||"",g,function(d,c){a(e,d,c,m).forEach(function(b){delete f[l][b.i];e.removeEventListener(b.e,b.proxy,!1)})})}function m(a){var e=d.extend({originalEvent:a},a);return d.each(u,function(d,f){e[d]=function(){return this[f]=n,a[d].apply(a,arguments)};e[f]=
q}),e}function e(a){if(!("defaultPrevented"in a)){a.defaultPrevented=!1;var e=a.preventDefault;a.preventDefault=function(){this.defaultPrevented=!0;e.call(this)}}}var f={},h=1,s={};s.click=s.mousedown=s.mouseup=s.mousemove="MouseEvents";d.event={add:g,remove:l};d.fn.bind=function(a,e){return this.each(function(){g(this,a,e)})};d.fn.unbind=function(a,e){return this.each(function(){l(this,a,e)})};d.fn.one=function(a,e){return this.each(function(d,f){g(this,a,e,null,function(a,e){return function(){var c=
a.apply(f,arguments);return l(f,e,a),c}})})};var n=function(){return!0},q=function(){return!1},u={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};d.fn.delegate=function(a,e,f){return this.each(function(h,k){g(k,e,f,a,function(e){return function(c){var b,j=d(c.target).closest(a,k).get(0);if(j)return b=d.extend(m(c),{currentTarget:j,liveFired:k}),e.apply(j,[b].concat([].slice.call(arguments,1)))}})})};d.fn.undelegate=
function(a,e,d){return this.each(function(){l(this,e,d,a)})};d.fn.live=function(a,e){return d(document.body).delegate(this.selector,a,e),this};d.fn.die=function(a,e){return d(document.body).undelegate(this.selector,a,e),this};d.fn.on=function(a,e,f){return void 0===e||d.isFunction(e)?this.bind(a,e):this.delegate(e,a,f)};d.fn.off=function(a,e,f){return void 0===e||d.isFunction(e)?this.unbind(a,e):this.undelegate(e,a,f)};d.fn.trigger=function(a,f){return"string"==typeof a&&(a=d.Event(a)),e(a),a.data=
f,this.each(function(){this.dispatchEvent(a)})};d.fn.triggerHandler=function(e,f){var h,g;return this.each(function(k,l){h=m("string"==typeof e?d.Event(e):e);h.data=f;h.target=l;d.each(a(l,e.type||e),function(c,b){g=b.proxy(h);if(h.isImmediatePropagationStopped())return!1})}),g};"focusin,focusout,load,resize,scroll,unload,click,dblclick,mousedown,mouseup,mousemove,mouseover,mouseout,change,select,keydown,keypress,keyup,error".split(",").forEach(function(a){d.fn[a]=function(e){return this.bind(a,e)}});
["focus","blur"].forEach(function(a){d.fn[a]=function(e){if(e)this.bind(a,e);else if(this.length)try{this.get(0)[a]()}catch(d){}return this}});d.Event=function(a,e){var d=document.createEvent(s[a]||"Events"),f=!0;if(e)for(var h in e)"bubbles"==h?f=!!e[h]:d[h]=e[h];return d.initEvent(a,f,!0,null,null,null,null,null,null,null,null,null,null,null,null),d}})(Zepto);
(function(d){function a(a){var d=this.os={},g=this.browser={},l=a.match(/WebKit\/([\d.]+)/),m=a.match(/(Android)\s+([\d.]+)/),e=a.match(/(iPad).*OS\s([\d_]+)/),f=!e&&a.match(/(iPhone\sOS)\s([\d_]+)/),h=a.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),s=h&&a.match(/TouchPad/),a=a.match(/(BlackBerry).*Version\/([\d.]+)/);l&&(g.version=l[1]);g.webkit=!!l;m&&(d.android=!0,d.version=m[2]);f&&(d.ios=!0,d.version=f[2].replace(/_/g,"."),d.iphone=!0);e&&(d.ios=!0,d.version=e[2].replace(/_/g,"."),d.ipad=!0);h&&(d.webos=
!0,d.version=h[2]);s&&(d.touchpad=!0);a&&(d.blackberry=!0,d.version=a[2])}a.call(d,navigator.userAgent);d.__detect=a})(Zepto);
(function(d,a){var o="",k,g=window.document.createElement("div"),l=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;d.each({Webkit:"webkit",Moz:"",O:"o",ms:"MS"},function(d,e){if(g.style[d+"TransitionProperty"]!==a)return o="-"+d.toLowerCase()+"-",k=e,!1});d.fx={off:k===a&&g.style.transitionProperty===a,cssPrefix:o,transitionEnd:k?k+"TransitionEnd":"transitionend",animationEnd:k?k+"AnimationEnd":"animationend"};d.fn.animate=function(a,e,f,h){return d.isObject(e)&&(f=e.easing,
h=e.complete,e=e.duration),e&&(e/=1E3),this.anim(a,e,f,h)};d.fn.anim=function(g,e,f,h){var k,n={},q,u=this,y,z=d.fx.transitionEnd;e===a&&(e=0.4);d.fx.off&&(e=0);if("string"==typeof g)n[o+"animation-name"]=g,n[o+"animation-duration"]=e+"s",z=d.fx.animationEnd;else{for(q in g)l.test(q)?(k||(k=[]),k.push(q+"("+g[q]+")")):n[q]=g[q];k&&(n[o+"transform"]=k.join(" "));d.fx.off||(n[o+"transition"]="all "+e+"s "+(f||""))}return y=function(){var a={};a[o+"transition"]=a[o+"animation-name"]="none";d(this).css(a);
h&&h.call(this)},0<e&&this.one(z,y),setTimeout(function(){u.css(n);0>=e&&setTimeout(function(){u.each(function(){y.call(this)})},0)},0),this};g=null})(Zepto);
(function(d){function a(a,e,f,h){if(a.global)return a=e||n,f=d.Event(f),d(a).trigger(f,h),!f.defaultPrevented}function o(e){e.global&&0===d.active++&&a(e,null,"ajaxStart")}function k(e,d){var f=d.context;if(!1===d.beforeSend.call(f,e,d)||!1===a(d,f,"ajaxBeforeSend",[e,d]))return!1;a(d,f,"ajaxSend",[e,d])}function g(e,d,f){var h=f.context;f.success.call(h,e,"success",d);a(f,h,"ajaxSuccess",[d,f,e]);m("success",d,f)}function l(e,d,f,h){var g=h.context;h.error.call(g,f,d,e);a(h,g,"ajaxError",[f,h,e]);
m(d,f,h)}function m(e,f,h){var g=h.context;h.complete.call(g,f,e);a(h,g,"ajaxComplete",[f,h]);h.global&&!--d.active&&a(h,null,"ajaxStop")}function e(){}function f(a,e,h,g){var k=d.isArray(e);d.each(e,function(c,b){g&&(c=h?g:g+"["+(k?"":c)+"]");!g&&k?a.add(b.name,b.value):(h?d.isArray(b):s(b))?f(a,b,h,c):a.add(c,b)})}var h=0,s=d.isObject,n=window.document,q,u;d.active=0;d.ajaxJSONP=function(a){var f="jsonp"+ ++h,k=n.createElement("script"),l={abort:function(){d(k).remove();f in window&&(window[f]=
e);m(l,a,"abort")}},o;return window[f]=function(c){clearTimeout(o);d(k).remove();delete window[f];g(c,l,a)},k.src=a.url.replace(/=\?/,"="+f),d("head").append(k),0<a.timeout&&(o=setTimeout(function(){l.abort();m(l,a,"timeout")},a.timeout)),l};d.ajaxSettings={type:"GET",beforeSend:e,success:e,error:e,complete:e,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:"application/json",xml:"application/xml, text/xml",html:"text/html",
text:"text/plain"},crossDomain:!1,timeout:0};d.ajax=function(a){var f=d.extend({},a||{});for(q in d.ajaxSettings)void 0===f[q]&&(f[q]=d.ajaxSettings[q]);o(f);f.crossDomain||(f.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(f.url)&&RegExp.$2!=window.location.host);if(/=\?/.test(f.url))return d.ajaxJSONP(f);f.url||(f.url=window.location.toString());f.data&&!f.contentType&&(f.contentType="application/x-www-form-urlencoded");s(f.data)&&(f.data=d.param(f.data));f.type.match(/get/i)&&f.data&&(a=f.data,f.url.match(/\?.*=/)?
a="&"+a:"?"!=a[0]&&(a="?"+a),f.url+=a);var h=f.accepts[f.dataType],a={},n=/^([\w-]+:)\/\//.test(f.url)?RegExp.$1:window.location.protocol,m=d.ajaxSettings.xhr(),c;f.crossDomain||(a["X-Requested-With"]="XMLHttpRequest");h&&(a.Accept=h);f.headers=d.extend(a,f.headers||{});m.onreadystatechange=function(){if(m.readyState==4){clearTimeout(c);var b,j=false;if(m.status>=200&&m.status<300||m.status==0&&n=="file:"){if(h=="application/json"&&!/^\s*$/.test(m.responseText))try{b=JSON.parse(m.responseText)}catch(a){j=
a}else b=m.responseText;j?l(j,"parsererror",m,f):g(b,m,f)}else l(null,"error",m,f)}};m.open(f.type,f.url,!0);f.contentType&&(f.headers["Content-Type"]=f.contentType);for(u in f.headers)m.setRequestHeader(u,f.headers[u]);return!1===k(m,f)?(m.abort(),!1):(0<f.timeout&&(c=setTimeout(function(){m.onreadystatechange=e;m.abort();l(null,"timeout",m,f)},f.timeout)),m.send(f.data),m)};d.get=function(a,e){return d.ajax({url:a,success:e})};d.post=function(a,e,f,h){return d.isFunction(e)&&(h=h||f,f=e,e=null),
d.ajax({type:"POST",url:a,data:e,success:f,dataType:h})};d.getJSON=function(a,e){return d.ajax({url:a,success:e,dataType:"json"})};d.fn.load=function(a,e){if(!this.length)return this;var f=this,h=a.split(/\s/),g;return 1<h.length&&(a=h[0],g=h[1]),d.get(a,function(c){f.html(g?d(n.createElement("div")).html(c).find(g).html():c);e&&e.call(f)}),this};var y=encodeURIComponent;d.param=function(a,e){var d=[];return d.add=function(a,e){this.push(y(a)+"="+y(e))},f(d,a,e),d.join("&").replace("%20","+")}})(Zepto);
(function(d){d.fn.serializeArray=function(){var a=[],o;return d(Array.prototype.slice.call(this.get(0).elements)).each(function(){o=d(this);var k=o.attr("type");!this.disabled&&"submit"!=k&&"reset"!=k&&"button"!=k&&("radio"!=k&&"checkbox"!=k||this.checked)&&a.push({name:o.attr("name"),value:o.val()})}),a};d.fn.serialize=function(){var a=[];return this.serializeArray().forEach(function(d){a.push(encodeURIComponent(d.name)+"="+encodeURIComponent(d.value))}),a.join("&")};d.fn.submit=function(a){a?this.bind("submit",
a):this.length&&(a=d.Event("submit"),this.eq(0).trigger(a),a.defaultPrevented||this.get(0).submit());return this}})(Zepto);
(function(d){function a(a,e,d,h){var g=Math.abs(a-e),k=Math.abs(d-h);return g>=k?0<a-e?"Left":"Right":0<d-h?"Up":"Down"}function o(){k.last&&Date.now()-k.last>=l&&(d(k.target).trigger("longTap"),k={})}var k={},g,l=750;d(document).ready(function(){d(document.body).bind("touchstart",function(a){var e=Date.now(),d=e-(k.last||e);k.target="tagName"in a.touches[0].target?a.touches[0].target:a.touches[0].target.parentNode;g&&clearTimeout(g);k.x1=a.touches[0].pageX;k.y1=a.touches[0].pageY;0<d&&250>=d&&(k.isDoubleTap=
!0);k.last=e;setTimeout(o,l)}).bind("touchmove",function(a){k.x2=a.touches[0].pageX;k.y2=a.touches[0].pageY}).bind("touchend",function(){k.isDoubleTap?(d(k.target).trigger("doubleTap"),k={}):0<k.x2||0<k.y2?((30<Math.abs(k.x1-k.x2)||30<Math.abs(k.y1-k.y2))&&d(k.target).trigger("swipe")&&d(k.target).trigger("swipe"+a(k.x1,k.x2,k.y1,k.y2)),k.x1=k.x2=k.y1=k.y2=k.last=0):"last"in k&&(g=setTimeout(function(){g=null;d(k.target).trigger("tap");k={}},250))}).bind("touchcancel",function(){k={}})});"swipe,swipeLeft,swipeRight,swipeUp,swipeDown,doubleTap,tap,longTap".split(",").forEach(function(a){d.fn[a]=
function(e){return this.bind(a,e)}})})(Zepto);(function(){function d(c,a,j){if(c===a)return 0!==c||1/c==1/a;if(null==c||null==a)return c===a;c._chain&&(c=c._wrapped);a._chain&&(a=a._wrapped);if(c.isEqual&&b.isFunction(c.isEqual))return c.isEqual(a);if(a.isEqual&&b.isFunction(a.isEqual))return a.isEqual(c);var e=f.call(c);if(e!=f.call(a))return!1;switch(e){case "[object String]":return c==""+a;case "[object Number]":return c!=+c?a!=+a:0==c?1/c==1/a:c==+a;case "[object Date]":case "[object Boolean]":return+c==+a;case "[object RegExp]":return c.source==
a.source&&c.global==a.global&&c.multiline==a.multiline&&c.ignoreCase==a.ignoreCase}if("object"!=typeof c||"object"!=typeof a)return!1;for(var h=j.length;h--;)if(j[h]==c)return!0;j.push(c);var h=0,x=!0;if("[object Array]"==e){if(h=c.length,x=h==a.length)for(;h--&&(x=h in c==h in a&&d(c[h],a[h],j)););}else{if("constructor"in c!="constructor"in a||c.constructor!=a.constructor)return!1;for(var g in c)if(b.has(c,g)&&(h++,!(x=b.has(a,g)&&d(c[g],a[g],j))))break;if(x){for(g in a)if(b.has(a,g)&&!h--)break;
x=!h}}j.pop();return x}var a=this,o=a._,k={},g=Array.prototype,l=Object.prototype,m=g.slice,e=g.unshift,f=l.toString,h=l.hasOwnProperty,s=g.forEach,n=g.map,q=g.reduce,u=g.reduceRight,y=g.filter,z=g.every,r=g.some,v=g.indexOf,t=g.lastIndexOf,l=Array.isArray,w=Object.keys,c=Function.prototype.bind,b=function(b){return new A(b)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=b),exports._=b):a._=b;b.VERSION="1.3.1";var j=b.each=b.forEach=function(c,
a,j){if(c!=null)if(s&&c.forEach===s)c.forEach(a,j);else if(c.length===+c.length)for(var e=0,d=c.length;e<d;e++){if(e in c&&a.call(j,c[e],e,c)===k)break}else for(e in c)if(b.has(c,e)&&a.call(j,c[e],e,c)===k)break};b.map=b.collect=function(b,c,a){var e=[];if(b==null)return e;if(n&&b.map===n)return b.map(c,a);j(b,function(b,j,d){e[e.length]=c.call(a,b,j,d)});if(b.length===+b.length)e.length=b.length;return e};b.reduce=b.foldl=b.inject=function(c,a,e,d){var f=arguments.length>2;c==null&&(c=[]);if(q&&
c.reduce===q)return d&&(a=b.bind(a,d)),f?c.reduce(a,e):c.reduce(a);j(c,function(b,c,j){f?e=a.call(d,e,b,c,j):(e=b,f=true)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return e};b.reduceRight=b.foldr=function(c,a,j,e){var d=arguments.length>2;c==null&&(c=[]);if(u&&c.reduceRight===u)return e&&(a=b.bind(a,e)),d?c.reduceRight(a,j):c.reduceRight(a);var f=b.toArray(c).reverse();e&&!d&&(a=b.bind(a,e));return d?b.reduce(f,a,j,e):b.reduce(f,a)};b.find=b.detect=function(b,c,a){var j;
x(b,function(b,e,d){if(c.call(a,b,e,d))return j=b,true});return j};b.filter=b.select=function(b,c,a){var e=[];if(b==null)return e;if(y&&b.filter===y)return b.filter(c,a);j(b,function(b,j,d){c.call(a,b,j,d)&&(e[e.length]=b)});return e};b.reject=function(b,c,a){var e=[];if(b==null)return e;j(b,function(b,j,d){c.call(a,b,j,d)||(e[e.length]=b)});return e};b.every=b.all=function(b,c,a){var e=true;if(b==null)return e;if(z&&b.every===z)return b.every(c,a);j(b,function(b,j,d){if(!(e=e&&c.call(a,b,j,d)))return k});
return e};var x=b.some=b.any=function(c,a,e){a||(a=b.identity);var d=false;if(c==null)return d;if(r&&c.some===r)return c.some(a,e);j(c,function(b,c,j){if(d||(d=a.call(e,b,c,j)))return k});return!!d};b.include=b.contains=function(b,c){return b==null?false:v&&b.indexOf===v?b.indexOf(c)!=-1:x(b,function(b){return b===c})};b.invoke=function(c,a){var j=m.call(arguments,2);return b.map(c,function(c){return(b.isFunction(a)?a||c:c[a]).apply(c,j)})};b.pluck=function(c,a){return b.map(c,function(b){return b[a]})};
b.max=function(c,a,e){if(!a&&b.isArray(c))return Math.max.apply(Math,c);if(!a&&b.isEmpty(c))return-Infinity;var d={computed:-Infinity};j(c,function(b,c,j){c=a?a.call(e,b,c,j):b;c>=d.computed&&(d={value:b,computed:c})});return d.value};b.min=function(c,a,e){if(!a&&b.isArray(c))return Math.min.apply(Math,c);if(!a&&b.isEmpty(c))return Infinity;var d={computed:Infinity};j(c,function(b,c,j){c=a?a.call(e,b,c,j):b;c<d.computed&&(d={value:b,computed:c})});return d.value};b.shuffle=function(b){var c=[],a;
j(b,function(b,j){j==0?c[0]=b:(a=Math.floor(Math.random()*(j+1)),c[j]=c[a],c[a]=b)});return c};b.sortBy=function(c,a,j){return b.pluck(b.map(c,function(b,c,e){return{value:b,criteria:a.call(j,b,c,e)}}).sort(function(b,c){var a=b.criteria,j=c.criteria;return a<j?-1:a>j?1:0}),"value")};b.groupBy=function(c,a){var e={},d=b.isFunction(a)?a:function(b){return b[a]};j(c,function(b,c){var a=d(b,c);(e[a]||(e[a]=[])).push(b)});return e};b.sortedIndex=function(c,a,j){j||(j=b.identity);for(var e=0,d=c.length;e<
d;){var f=e+d>>1;j(c[f])<j(a)?e=f+1:d=f}return e};b.toArray=function(c){return!c?[]:c.toArray?c.toArray():b.isArray(c)?m.call(c):b.isArguments(c)?m.call(c):b.values(c)};b.size=function(c){return b.toArray(c).length};b.first=b.head=function(b,c,a){return c!=null&&!a?m.call(b,0,c):b[0]};b.initial=function(b,c,a){return m.call(b,0,b.length-(c==null||a?1:c))};b.last=function(b,c,a){return c!=null&&!a?m.call(b,Math.max(b.length-c,0)):b[b.length-1]};b.rest=b.tail=function(b,c,a){return m.call(b,c==null||
a?1:c)};b.compact=function(c){return b.filter(c,function(b){return!!b})};b.flatten=function(c,a){return b.reduce(c,function(c,j){if(b.isArray(j))return c.concat(a?j:b.flatten(j));c[c.length]=j;return c},[])};b.without=function(c){return b.difference(c,m.call(arguments,1))};b.uniq=b.unique=function(c,a,j){var j=j?b.map(c,j):c,e=[];b.reduce(j,function(j,d,f){if(0==f||(a===true?b.last(j)!=d:!b.include(j,d))){j[j.length]=d;e[e.length]=c[f]}return j},[]);return e};b.union=function(){return b.uniq(b.flatten(arguments,
true))};b.intersection=b.intersect=function(c){var a=m.call(arguments,1);return b.filter(b.uniq(c),function(c){return b.every(a,function(a){return b.indexOf(a,c)>=0})})};b.difference=function(c){var a=b.flatten(m.call(arguments,1));return b.filter(c,function(c){return!b.include(a,c)})};b.zip=function(){for(var c=m.call(arguments),a=b.max(b.pluck(c,"length")),j=Array(a),e=0;e<a;e++)j[e]=b.pluck(c,""+e);return j};b.indexOf=function(c,a,j){if(c==null)return-1;var e;if(j)return j=b.sortedIndex(c,a),c[j]===
a?j:-1;if(v&&c.indexOf===v)return c.indexOf(a);j=0;for(e=c.length;j<e;j++)if(j in c&&c[j]===a)return j;return-1};b.lastIndexOf=function(b,c){if(b==null)return-1;if(t&&b.lastIndexOf===t)return b.lastIndexOf(c);for(var a=b.length;a--;)if(a in b&&b[a]===c)return a;return-1};b.range=function(b,c,a){arguments.length<=1&&(c=b||0,b=0);for(var a=arguments[2]||1,j=Math.max(Math.ceil((c-b)/a),0),e=0,d=Array(j);e<j;){d[e++]=b;b=b+a}return d};var C=function(){};b.bind=function(a,j){var e,d;if(a.bind===c&&c)return c.apply(a,
m.call(arguments,1));if(!b.isFunction(a))throw new TypeError;d=m.call(arguments,2);return e=function(){if(!(this instanceof e))return a.apply(j,d.concat(m.call(arguments)));C.prototype=a.prototype;var b=new C,c=a.apply(b,d.concat(m.call(arguments)));return Object(c)===c?c:b}};b.bindAll=function(c){var a=m.call(arguments,1);a.length==0&&(a=b.functions(c));j(a,function(a){c[a]=b.bind(c[a],c)});return c};b.memoize=function(c,a){var j={};a||(a=b.identity);return function(){var e=a.apply(this,arguments);
return b.has(j,e)?j[e]:j[e]=c.apply(this,arguments)}};b.delay=function(b,c){var a=m.call(arguments,2);return setTimeout(function(){return b.apply(b,a)},c)};b.defer=function(c){return b.delay.apply(b,[c,1].concat(m.call(arguments,1)))};b.throttle=function(c,a){var j,e,d,f,h,x=b.debounce(function(){h=f=false},a);return function(){j=this;e=arguments;d||(d=setTimeout(function(){d=null;h&&c.apply(j,e);x()},a));f?h=true:c.apply(j,e);x();f=true}};b.debounce=function(b,c){var a;return function(){var j=this,
e=arguments;clearTimeout(a);a=setTimeout(function(){a=null;b.apply(j,e)},c)}};b.once=function(b){var c=false,a;return function(){if(c)return a;c=true;return a=b.apply(this,arguments)}};b.wrap=function(b,c){return function(){var a=[b].concat(m.call(arguments,0));return c.apply(this,a)}};b.compose=function(){var b=arguments;return function(){for(var c=arguments,a=b.length-1;a>=0;a--)c=[b[a].apply(this,c)];return c[0]}};b.after=function(b,c){return b<=0?c():function(){if(--b<1)return c.apply(this,arguments)}};
b.keys=w||function(c){if(c!==Object(c))throw new TypeError("Invalid object");var a=[],j;for(j in c)b.has(c,j)&&(a[a.length]=j);return a};b.values=function(c){return b.map(c,b.identity)};b.functions=b.methods=function(c){var a=[],j;for(j in c)b.isFunction(c[j])&&a.push(j);return a.sort()};b.extend=function(b){j(m.call(arguments,1),function(c){for(var a in c)b[a]=c[a]});return b};b.defaults=function(b){j(m.call(arguments,1),function(c){for(var a in c)b[a]==null&&(b[a]=c[a])});return b};b.clone=function(c){return!b.isObject(c)?
c:b.isArray(c)?c.slice():b.extend({},c)};b.tap=function(b,c){c(b);return b};b.isEqual=function(b,c){return d(b,c,[])};b.isEmpty=function(c){if(b.isArray(c)||b.isString(c))return c.length===0;for(var a in c)if(b.has(c,a))return false;return true};b.isElement=function(b){return!!(b&&b.nodeType==1)};b.isArray=l||function(b){return f.call(b)=="[object Array]"};b.isObject=function(b){return b===Object(b)};b.isArguments=function(b){return f.call(b)=="[object Arguments]"};b.isArguments(arguments)||(b.isArguments=
function(c){return!(!c||!b.has(c,"callee"))});b.isFunction=function(b){return f.call(b)=="[object Function]"};b.isString=function(b){return f.call(b)=="[object String]"};b.isNumber=function(b){return f.call(b)=="[object Number]"};b.isNaN=function(b){return b!==b};b.isBoolean=function(b){return b===true||b===false||f.call(b)=="[object Boolean]"};b.isDate=function(b){return f.call(b)=="[object Date]"};b.isRegExp=function(b){return f.call(b)=="[object RegExp]"};b.isNull=function(b){return b===null};
b.isUndefined=function(b){return b===void 0};b.has=function(b,c){return h.call(b,c)};b.noConflict=function(){a._=o;return this};b.identity=function(b){return b};b.times=function(b,c,a){for(var j=0;j<b;j++)c.call(a,j)};b.escape=function(b){return(""+b).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};b.mixin=function(c){j(b.functions(c),function(a){G(a,b[a]=c[a])})};var F=0;b.uniqueId=function(b){var c=F++;return b?
b+c:c};b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var E=/.^/,D=function(b){return b.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};b.template=function(c,a){var j=b.templateSettings,j="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+c.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(j.escape||E,function(b,c){return"',_.escape("+D(c)+"),'"}).replace(j.interpolate||E,function(b,c){return"',"+D(c)+",'"}).replace(j.evaluate||
E,function(b,c){return"');"+D(c).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",j);return a?e(a,b):function(c){return e.call(this,c,b)}};b.chain=function(c){return b(c).chain()};var A=function(b){this._wrapped=b};b.prototype=A.prototype;var B=function(c,a){return a?b(c).chain():c},G=function(c,a){A.prototype[c]=function(){var c=m.call(arguments);e.call(c,this._wrapped);return B(a.apply(b,c),
this._chain)}};b.mixin(b);j("pop,push,reverse,shift,sort,splice,unshift".split(","),function(b){var c=g[b];A.prototype[b]=function(){var a=this._wrapped;c.apply(a,arguments);var j=a.length;(b=="shift"||b=="splice")&&j===0&&delete a[0];return B(a,this._chain)}});j(["concat","join","slice"],function(b){var c=g[b];A.prototype[b]=function(){return B(c.apply(this._wrapped,arguments),this._chain)}});A.prototype.chain=function(){this._chain=true;return this};A.prototype.value=function(){return this._wrapped}}).call(this);(function(){var d=this,a=d.Backbone,o=Array.prototype.slice,k=Array.prototype.splice,g;g="undefined"!==typeof exports?exports:d.Backbone={};g.VERSION="0.9.1";var l=d._;!l&&"undefined"!==typeof require&&(l=require("underscore"));var m=d.jQuery||d.Zepto||d.ender;g.setDomLibrary=function(c){m=c};g.noConflict=function(){d.Backbone=a;return this};g.emulateHTTP=!1;g.emulateJSON=!1;g.Events={on:function(c,b,a){for(var e,c=c.split(/\s+/),d=this._callbacks||(this._callbacks={});e=c.shift();){e=d[e]||(d[e]=
{});var f=e.tail||(e.tail=e.next={});f.callback=b;f.context=a;e.tail=f.next={}}return this},off:function(c,b,a){var e,d,f;if(c){if(d=this._callbacks)for(c=c.split(/\s+/);e=c.shift();)if(f=d[e],delete d[e],b&&f)for(;(f=f.next)&&f.next;)if(!(f.callback===b&&(!a||f.context===a)))this.on(e,f.callback,f.context)}else delete this._callbacks;return this},trigger:function(c){var b,a,e,d;if(!(e=this._callbacks))return this;d=e.all;for((c=c.split(/\s+/)).push(null);b=c.shift();)d&&c.push({next:d.next,tail:d.tail,
event:b}),(a=e[b])&&c.push({next:a.next,tail:a.tail});for(d=o.call(arguments,1);a=c.pop();){b=a.tail;for(e=a.event?[a.event].concat(d):d;(a=a.next)!==b;)a.callback.apply(a.context||this,e)}return this}};g.Events.bind=g.Events.on;g.Events.unbind=g.Events.off;g.Model=function(c,b){var a;c||(c={});b&&b.parse&&(c=this.parse(c));if(a=t(this,"defaults"))c=l.extend({},a,c);b&&b.collection&&(this.collection=b.collection);this.attributes={};this._escapedAttributes={};this.cid=l.uniqueId("c");if(!this.set(c,
{silent:!0}))throw Error("Can't create an invalid model");delete this._changed;this._previousAttributes=l.clone(this.attributes);this.initialize.apply(this,arguments)};l.extend(g.Model.prototype,g.Events,{idAttribute:"id",initialize:function(){},toJSON:function(){return l.clone(this.attributes)},get:function(c){return this.attributes[c]},escape:function(c){var b;if(b=this._escapedAttributes[c])return b;b=this.attributes[c];return this._escapedAttributes[c]=l.escape(null==b?"":""+b)},has:function(c){return null!=
this.attributes[c]},set:function(c,b,a){var e,d;l.isObject(c)||null==c?(e=c,a=b):(e={},e[c]=b);a||(a={});if(!e)return this;e instanceof g.Model&&(e=e.attributes);if(a.unset)for(d in e)e[d]=void 0;if(!this._validate(e,a))return!1;this.idAttribute in e&&(this.id=e[this.idAttribute]);var b=this.attributes,f=this._escapedAttributes,h=this._previousAttributes||{},k=this._setting;this._changed||(this._changed={});this._setting=!0;for(d in e)if(c=e[d],l.isEqual(b[d],c)||delete f[d],a.unset?delete b[d]:b[d]=
c,this._changing&&!l.isEqual(this._changed[d],c)&&(this.trigger("change:"+d,this,c,a),this._moreChanges=!0),delete this._changed[d],!l.isEqual(h[d],c)||l.has(b,d)!=l.has(h,d))this._changed[d]=c;k||(!a.silent&&this.hasChanged()&&this.change(a),this._setting=!1);return this},unset:function(c,b){(b||(b={})).unset=!0;return this.set(c,null,b)},clear:function(c){(c||(c={})).unset=!0;return this.set(l.clone(this.attributes),c)},fetch:function(c){var c=c?l.clone(c):{},b=this,a=c.success;c.success=function(e,
d,f){if(!b.set(b.parse(e,f),c))return!1;a&&a(b,e)};c.error=g.wrapError(c.error,b,c);return(this.sync||g.sync).call(this,"read",this,c)},save:function(c,b,a){var e,d;l.isObject(c)||null==c?(e=c,a=b):(e={},e[c]=b);a=a?l.clone(a):{};a.wait&&(d=l.clone(this.attributes));c=l.extend({},a,{silent:!0});if(e&&!this.set(e,a.wait?c:a))return!1;var f=this,h=a.success;a.success=function(b,c,d){c=f.parse(b,d);a.wait&&(c=l.extend(e||{},c));if(!f.set(c,a))return!1;h?h(f,b):f.trigger("sync",f,b,a)};a.error=g.wrapError(a.error,
f,a);b=this.isNew()?"create":"update";b=(this.sync||g.sync).call(this,b,this,a);a.wait&&this.set(d,c);return b},destroy:function(c){var c=c?l.clone(c):{},b=this,a=c.success,e=function(){b.trigger("destroy",b,b.collection,c)};if(this.isNew())return e();c.success=function(d){c.wait&&e();a?a(b,d):b.trigger("sync",b,d,c)};c.error=g.wrapError(c.error,b,c);var d=(this.sync||g.sync).call(this,"delete",this,c);c.wait||e();return d},url:function(){var c=t(this.collection,"url")||t(this,"urlRoot")||w();return this.isNew()?
c:c+("/"==c.charAt(c.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(c){return c},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(c){if(this._changing||!this.hasChanged())return this;this._moreChanges=this._changing=!0;for(var b in this._changed)this.trigger("change:"+b,this,this._changed[b],c);for(;this._moreChanges;)this._moreChanges=!1,this.trigger("change",this,c);this._previousAttributes=l.clone(this.attributes);
delete this._changed;this._changing=!1;return this},hasChanged:function(c){return!arguments.length?!l.isEmpty(this._changed):this._changed&&l.has(this._changed,c)},changedAttributes:function(c){if(!c)return this.hasChanged()?l.clone(this._changed):!1;var b,a=!1,e=this._previousAttributes,d;for(d in c)if(!l.isEqual(e[d],b=c[d]))(a||(a={}))[d]=b;return a},previous:function(c){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[c]},previousAttributes:function(){return l.clone(this._previousAttributes)},
isValid:function(){return!this.validate(this.attributes)},_validate:function(c,b){if(b.silent||!this.validate)return!0;var c=l.extend({},this.attributes,c),a=this.validate(c,b);if(!a)return!0;b&&b.error?b.error(this,a,b):this.trigger("error",this,a,b);return!1}});g.Collection=function(c,b){b||(b={});b.comparator&&(this.comparator=b.comparator);this._reset();this.initialize.apply(this,arguments);c&&this.reset(c,{silent:!0,parse:b.parse})};l.extend(g.Collection.prototype,g.Events,{model:g.Model,initialize:function(){},
toJSON:function(){return this.map(function(c){return c.toJSON()})},add:function(c,b){var a,e,d,f,h,g={},m={};b||(b={});c=l.isArray(c)?c.slice():[c];a=0;for(e=c.length;a<e;a++){if(!(d=c[a]=this._prepareModel(c[a],b)))throw Error("Can't add an invalid model to a collection");if(g[f=d.cid]||this._byCid[f]||null!=(h=d.id)&&(m[h]||this._byId[h]))throw Error("Can't add the same model to a collection twice");g[f]=m[h]=d}for(a=0;a<e;a++)(d=c[a]).on("all",this._onModelEvent,this),this._byCid[d.cid]=d,null!=
d.id&&(this._byId[d.id]=d);this.length+=e;k.apply(this.models,[null!=b.at?b.at:this.models.length,0].concat(c));this.comparator&&this.sort({silent:!0});if(b.silent)return this;a=0;for(e=this.models.length;a<e;a++)if(g[(d=this.models[a]).cid])b.index=a,d.trigger("add",d,this,b);return this},remove:function(c,b){var a,e,d,f;b||(b={});c=l.isArray(c)?c.slice():[c];a=0;for(e=c.length;a<e;a++)if(f=this.getByCid(c[a])||this.get(c[a]))delete this._byId[f.id],delete this._byCid[f.cid],d=this.indexOf(f),this.models.splice(d,
1),this.length--,b.silent||(b.index=d,f.trigger("remove",f,this,b)),this._removeReference(f);return this},get:function(c){return null==c?null:this._byId[null!=c.id?c.id:c]},getByCid:function(c){return c&&this._byCid[c.cid||c]},at:function(c){return this.models[c]},sort:function(c){c||(c={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var b=l.bind(this.comparator,this);1==this.comparator.length?this.models=this.sortBy(b):this.models.sort(b);c.silent||this.trigger("reset",
this,c);return this},pluck:function(c){return l.map(this.models,function(b){return b.get(c)})},reset:function(c,b){c||(c=[]);b||(b={});for(var a=0,e=this.models.length;a<e;a++)this._removeReference(this.models[a]);this._reset();this.add(c,{silent:!0,parse:b.parse});b.silent||this.trigger("reset",this,b);return this},fetch:function(c){c=c?l.clone(c):{};void 0===c.parse&&(c.parse=!0);var b=this,a=c.success;c.success=function(e,d,f){b[c.add?"add":"reset"](b.parse(e,f),c);a&&a(b,e)};c.error=g.wrapError(c.error,
b,c);return(this.sync||g.sync).call(this,"read",this,c)},create:function(c,b){var a=this,b=b?l.clone(b):{},c=this._prepareModel(c,b);if(!c)return!1;b.wait||a.add(c,b);var e=b.success;b.success=function(d,f){b.wait&&a.add(d,b);e?e(d,f):d.trigger("sync",c,f,b)};c.save(null,b);return c},parse:function(c){return c},chain:function(){return l(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(c,b){c instanceof g.Model?c.collection||
(c.collection=this):(b.collection=this,c=new this.model(c,b),c._validate(c.attributes,b)||(c=!1));return c},_removeReference:function(c){this==c.collection&&delete c.collection;c.off("all",this._onModelEvent,this)},_onModelEvent:function(c,b,a,e){("add"==c||"remove"==c)&&a!=this||("destroy"==c&&this.remove(b,e),b&&c==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments))}});l.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),
function(c){g.Collection.prototype[c]=function(){return l[c].apply(l,[this.models].concat(l.toArray(arguments)))}});g.Router=function(c){c||(c={});c.routes&&(this.routes=c.routes);this._bindRoutes();this.initialize.apply(this,arguments)};var e=/:\w+/g,f=/\*\w+/g,h=/[-[\]{}()+?.,\\^$|#\s]/g;l.extend(g.Router.prototype,g.Events,{initialize:function(){},route:function(c,b,a){g.history||(g.history=new g.History);l.isRegExp(c)||(c=this._routeToRegExp(c));a||(a=this[b]);g.history.route(c,l.bind(function(e){e=
this._extractParameters(c,e);a&&a.apply(this,e);this.trigger.apply(this,["route:"+b].concat(e));g.history.trigger("route",this,b,e)},this));return this},navigate:function(c,b){g.history.navigate(c,b)},_bindRoutes:function(){if(this.routes){var c=[],b;for(b in this.routes)c.unshift([b,this.routes[b]]);b=0;for(var a=c.length;b<a;b++)this.route(c[b][0],c[b][1],this[c[b][1]])}},_routeToRegExp:function(c){c=c.replace(h,"\\$&").replace(e,"([^/]+)").replace(f,"(.*?)");return RegExp("^"+c+"$")},_extractParameters:function(c,
b){return c.exec(b).slice(1)}});g.History=function(){this.handlers=[];l.bindAll(this,"checkUrl")};var s=/^[#\/]/,n=/msie [\w.]+/,q=!1;l.extend(g.History.prototype,g.Events,{interval:50,getFragment:function(c,b){if(null==c)if(this._hasPushState||b){var c=window.location.pathname,a=window.location.search;a&&(c+=a)}else c=window.location.hash;c=decodeURIComponent(c);c.indexOf(this.options.root)||(c=c.substr(this.options.root.length));return c.replace(s,"")},start:function(c){if(q)throw Error("Backbone.history has already been started");
this.options=l.extend({},{root:"/"},this.options,c);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);var c=this.getFragment(),b=document.documentMode;if(b=n.exec(navigator.userAgent.toLowerCase())&&(!b||7>=b))this.iframe=m('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(c);this._hasPushState?m(window).bind("popstate",
this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!b?m(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));this.fragment=c;q=!0;c=window.location;b=c.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&b&&c.hash&&
(this.fragment=c.hash.replace(s,""),window.history.replaceState({},document.title,c.protocol+"//"+c.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){m(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);q=!1},route:function(c,b){this.handlers.unshift({route:c,callback:b})},checkUrl:function(){var c=this.getFragment();c==this.fragment&&this.iframe&&(c=this.getFragment(this.iframe.location.hash));
if(c==this.fragment||c==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(c);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(c){var b=this.fragment=this.getFragment(c);return l.any(this.handlers,function(c){if(c.route.test(b))return c.callback(b),!0})},navigate:function(c,b){if(!q)return!1;if(!b||!0===b)b={trigger:b};var a=(c||"").replace(s,"");this.fragment==a||this.fragment==decodeURIComponent(a)||(this._hasPushState?(0!=a.indexOf(this.options.root)&&(a=
this.options.root+a),this.fragment=a,window.history[b.replace?"replaceState":"pushState"]({},document.title,a)):this._wantsHashChange?(this.fragment=a,this._updateHash(window.location,a,b.replace),this.iframe&&a!=this.getFragment(this.iframe.location.hash)&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))):window.location.assign(this.options.root+c),b.trigger&&this.loadUrl(c))},_updateHash:function(c,b,a){a?c.replace(c.toString().replace(/(javascript:|#).*$/,
"")+"#"+b):c.hash=b}});g.View=function(c){this.cid=l.uniqueId("view");this._configure(c||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var u=/^(\S+)\s*(.*)$/,y="model,collection,el,id,attributes,className,tagName".split(",");l.extend(g.View.prototype,g.Events,{tagName:"div",$:function(c){return this.$el.find(c)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(c,b,a){c=document.createElement(c);
b&&m(c).attr(b);a&&m(c).html(a);return c},setElement:function(c,b){this.$el=m(c);this.el=this.$el[0];!1!==b&&this.delegateEvents();return this},delegateEvents:function(c){if(c||(c=t(this,"events"))){this.undelegateEvents();for(var b in c){var a=c[b];l.isFunction(a)||(a=this[c[b]]);if(!a)throw Error('Event "'+c[b]+'" does not exist');var e=b.match(u),d=e[1],e=e[2],a=l.bind(a,this),d=d+(".delegateEvents"+this.cid);""===e?this.$el.bind(d,a):this.$el.delegate(e,d,a)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+
this.cid)},_configure:function(c){this.options&&(c=l.extend({},this.options,c));for(var b=0,a=y.length;b<a;b++){var e=y[b];c[e]&&(this[e]=c[e])}this.options=c},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var c=t(this,"attributes")||{};this.id&&(c.id=this.id);this.className&&(c["class"]=this.className);this.setElement(this.make(this.tagName,c),!1)}}});g.Model.extend=g.Collection.extend=g.Router.extend=g.View.extend=function(c,b){var a=v(this,c,b);a.extend=this.extend;return a};
var z={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};g.sync=function(c,b,a){var e=z[c],d={type:e,dataType:"json"};a.url||(d.url=t(b,"url")||w());if(!a.data&&b&&("create"==c||"update"==c))d.contentType="application/json",d.data=JSON.stringify(b.toJSON());g.emulateJSON&&(d.contentType="application/x-www-form-urlencoded",d.data=d.data?{model:d.data}:{});if(g.emulateHTTP&&("PUT"===e||"DELETE"===e))g.emulateJSON&&(d.data._method=e),d.type="POST",d.beforeSend=function(b){b.setRequestHeader("X-HTTP-Method-Override",
e)};"GET"!==d.type&&!g.emulateJSON&&(d.processData=!1);return m.ajax(l.extend(d,a))};g.wrapError=function(c,b,a){return function(e,d){d=e===b?d:e;c?c(b,d,a):b.trigger("error",b,d,a)}};var r=function(){},v=function(c,b,a){var e;e=b&&b.hasOwnProperty("constructor")?b.constructor:function(){c.apply(this,arguments)};l.extend(e,c);r.prototype=c.prototype;e.prototype=new r;b&&l.extend(e.prototype,b);a&&l.extend(e,a);e.prototype.constructor=e;e.__super__=c.prototype;return e},t=function(c,b){return!c||!c[b]?
null:l.isFunction(c[b])?c[b]():c[b]},w=function(){throw Error('A "url" property or function must be specified');}}).call(this);(function(){var d,a,o;"undefined"===typeof window?(d=require("underscore"),a=require("backbone"),o=module.exports=a):(d=window._,a=window.Backbone,o=window);a.Relational={showWarnings:!0};a.Semaphore={_permitsAvailable:null,_permitsUsed:0,acquire:function(){if(this._permitsAvailable&&this._permitsUsed>=this._permitsAvailable)throw Error("Max permits acquired");this._permitsUsed++},release:function(){if(this._permitsUsed===0)throw Error("All permits released");this._permitsUsed--},isLocked:function(){return this._permitsUsed>
0},setAvailablePermits:function(a){if(this._permitsUsed>a)throw Error("Available permits cannot be less than used permits");this._permitsAvailable=a}};a.BlockingQueue=function(){this._queue=[]};d.extend(a.BlockingQueue.prototype,a.Semaphore,{_queue:null,add:function(a){this.isBlocked()?this._queue.push(a):a()},process:function(){for(;this._queue&&this._queue.length;)this._queue.shift()()},block:function(){this.acquire()},unblock:function(){this.release();this.isBlocked()||this.process()},isBlocked:function(){return this.isLocked()}});
a.Relational.eventQueue=new a.BlockingQueue;a.Store=function(){this._collections=[];this._reverseRelations=[]};d.extend(a.Store.prototype,a.Events,{_collections:null,_reverseRelations:null,addReverseRelation:function(a){if(!d.any(this._reverseRelations,function(f){return d.all(a,function(a,e){return a===f[e]})})&&a.model&&a.type){this._reverseRelations.push(a);if(!a.model.prototype.relations)a.model.prototype.relations=[];a.model.prototype.relations.push(a);this.retroFitRelation(a)}},retroFitRelation:function(a){this.getCollection(a.model).each(function(d){new a.type(d,
a)},this)},getCollection:function(a){var f=d.detect(this._collections,function(d){return a===d.model||a.constructor===d.model});f||(f=this._createCollection(a));return f},getObjectByName:function(a){a=d.reduce(a.split("."),function(a,e){return a[e]},o);return a!==o?a:null},_createCollection:function(e){var d;if(e instanceof a.RelationalModel)e=e.constructor;if(e.prototype instanceof a.RelationalModel.prototype.constructor){d=new a.Collection;d.model=e;this._collections.push(d)}return d},find:function(a,
d){var h=this.getCollection(a);return h&&h.get(d)},register:function(a){var d=a.collection,h=this.getCollection(a);h&&h.add(a);a.bind("destroy",this.unregister,this);a.collection=d},update:function(a){var d=this.getCollection(a);d._onModelEvent("change:"+a.idAttribute,a,d)},unregister:function(a){a.unbind("destroy",this.unregister);var d=this.getCollection(a);d&&d.remove(a)}});a.Relational.store=new a.Store;a.Relation=function(e,f){this.instance=e;f=typeof f==="object"&&f||{};this.reverseRelation=
d.defaults(f.reverseRelation||{},this.options.reverseRelation);this.reverseRelation.type=!d.isString(this.reverseRelation.type)?this.reverseRelation.type:a[this.reverseRelation.type]||a.Relational.store.getObjectByName(this.reverseRelation.type);this.model=f.model||this.instance.constructor;this.options=d.defaults(f,this.options,a.Relation.prototype.options);this.key=this.options.key;this.keySource=this.options.keySource||this.key;this.relatedModel=this.options.relatedModel;if(d.isString(this.relatedModel))this.relatedModel=
a.Relational.store.getObjectByName(this.relatedModel);if(!this.checkPreconditions())return false;if(e){this.keyContents=this.instance.get(this.keySource);this.key!==this.keySource&&this.instance.unset(this.keySource,{silent:true});this.instance._relations.push(this)}!this.options.isAutoRelation&&this.reverseRelation.type&&this.reverseRelation.key&&a.Relational.store.addReverseRelation(d.defaults({isAutoRelation:true,model:this.relatedModel,relatedModel:this.model,reverseRelation:this.options},this.reverseRelation));
d.bindAll(this,"_modelRemovedFromCollection","_relatedModelAdded","_relatedModelRemoved");if(e){this.initialize();a.Relational.store.getCollection(this.instance).bind("relational:remove",this._modelRemovedFromCollection);a.Relational.store.getCollection(this.relatedModel).bind("relational:add",this._relatedModelAdded).bind("relational:remove",this._relatedModelRemoved)}};a.Relation.extend=a.Model.extend;d.extend(a.Relation.prototype,a.Events,a.Semaphore,{options:{createModels:!0,includeInJSON:!0,
isAutoRelation:!1},instance:null,key:null,keyContents:null,relatedModel:null,reverseRelation:null,related:null,_relatedModelAdded:function(a,d,h){var g=this;a.queue(function(){g.tryAddRelated(a,h)})},_relatedModelRemoved:function(a,d,h){this.removeRelated(a,h)},_modelRemovedFromCollection:function(a){a===this.instance&&this.destroy()},checkPreconditions:function(){var e=this.instance,f=this.key,h=this.model,g=this.relatedModel,k=a.Relational.showWarnings&&typeof console!=="undefined";if(!h||!f||!g){k&&
console.warn("Relation=%o; no model, key or relatedModel (%o, %o, %o)",this,h,f,g);return false}if(!(h.prototype instanceof a.RelationalModel.prototype.constructor)){k&&console.warn("Relation=%o; model does not inherit from Backbone.RelationalModel (%o)",this,e);return false}if(!(g.prototype instanceof a.RelationalModel.prototype.constructor)){k&&console.warn("Relation=%o; relatedModel does not inherit from Backbone.RelationalModel (%o)",this,g);return false}if(this instanceof a.HasMany&&this.reverseRelation.type===
a.HasMany.prototype.constructor){k&&console.warn("Relation=%o; relation is a HasMany, and the reverseRelation is HasMany as well.",this);return false}if(e&&e._relations.length&&d.any(e._relations,function(a){var e=this.reverseRelation.key&&a.reverseRelation.key;return a.relatedModel===g&&a.key===f&&(!e||this.reverseRelation.key===a.reverseRelation.key)},this)){k&&console.warn("Relation=%o between instance=%o.%s and relatedModel=%o.%s already exists",this,e,f,g,this.reverseRelation.key);return false}return true},
setRelated:function(a,f){this.related=a;this.instance.acquire();this.instance.set(this.key,a,d.defaults(f||{},{silent:true}));this.instance.release()},createModel:function(a){if(this.options.createModels&&typeof a==="object")return new this.relatedModel(a)},_isReverseRelation:function(a){return a.instance instanceof this.relatedModel&&this.reverseRelation.key===a.key&&this.key===a.reverseRelation.key?true:false},getReverseRelations:function(a){var f=[],a=!d.isUndefined(a)?[a]:this.related&&(this.related.models||
[this.related]);d.each(a,function(a){d.each(a.getRelations(),function(a){this._isReverseRelation(a)&&f.push(a)},this)},this);return f},sanitizeOptions:function(a){a||(a={});if(a.silent){a=d.extend({},a,{silentChange:true});delete a.silent}return a},destroy:function(){a.Relational.store.getCollection(this.instance).unbind("relational:remove",this._modelRemovedFromCollection);a.Relational.store.getCollection(this.relatedModel).unbind("relational:add",this._relatedModelAdded).unbind("relational:remove",
this._relatedModelRemoved);d.each(this.getReverseRelations(),function(a){a.removeRelated(this.instance)},this)}});a.HasOne=a.Relation.extend({options:{reverseRelation:{type:"HasMany"}},initialize:function(){d.bindAll(this,"onChange");this.instance.bind("relational:change:"+this.key,this.onChange);this.setRelated(this.findRelated({silent:true}));var a=this;d.each(a.getReverseRelations(),function(d){d.addRelated(a.instance)})},findRelated:function(e){var f=this.keyContents,h=null;if(f instanceof this.relatedModel)h=
f;else if(f&&(d.isString(f)||d.isNumber(f)||typeof f==="object")){h=d.isString(f)||d.isNumber(f)?f:f[this.relatedModel.prototype.idAttribute];(h=a.Relational.store.find(this.relatedModel,h))&&d.isObject(f)?h.set(f,e):h||(h=this.createModel(f))}return h},onChange:function(e,f,h){if(!this.isLocked()){this.acquire();var h=this.sanitizeOptions(h),g=(e=d.isUndefined(h._related))?this.related:h._related;if(e){this.keyContents=f;f instanceof this.relatedModel?this.related=f:f?this.setRelated(this.findRelated(h)):
this.setRelated(null)}g&&this.related!==g&&d.each(this.getReverseRelations(g),function(a){a.removeRelated(this.instance,h)},this);d.each(this.getReverseRelations(),function(a){a.addRelated(this.instance,h)},this);if(!h.silentChange&&this.related!==g){var k=this;a.Relational.eventQueue.add(function(){k.instance.trigger("update:"+k.key,k.instance,k.related,h)})}this.release()}},tryAddRelated:function(a,f){if(!this.related){var f=this.sanitizeOptions(f),h=this.keyContents;if(h&&(d.isString(h)||d.isNumber(h)||
typeof h==="object")){h=d.isString(h)||d.isNumber(h)?h:h[this.relatedModel.prototype.idAttribute];a.id===h&&this.addRelated(a,f)}}},addRelated:function(a){if(a!==this.related){var d=this.related||null;this.setRelated(a);this.onChange(this.instance,a,{_related:d})}},removeRelated:function(a){if(this.related&&a===this.related){var d=this.related||null;this.setRelated(null);this.onChange(this.instance,a,{_related:d})}}});a.HasMany=a.Relation.extend({collectionType:null,options:{reverseRelation:{type:"HasOne"},
collectionType:a.Collection,collectionKey:!0},initialize:function(){d.bindAll(this,"onChange","handleAddition","handleRemoval","handleReset");this.instance.bind("relational:change:"+this.key,this.onChange);this.collectionType=this.options.collectionType;if(d(this.collectionType).isString())this.collectionType=a.Relational.store.getObjectByName(this.collectionType);if(!this.collectionType.prototype instanceof a.Collection.prototype.constructor)throw Error("collectionType must inherit from Backbone.Collection");
this.setRelated(this.prepareCollection(new this.collectionType));this.findRelated({silent:true})},prepareCollection:function(d){this.related&&this.related.unbind("relational:add",this.handleAddition).unbind("relational:remove",this.handleRemoval).unbind("relational:reset",this.handleReset);d.reset();d.model=this.relatedModel;if(this.options.collectionKey){var f=this.options.collectionKey===true?this.options.reverseRelation.key:this.options.collectionKey;d[f]&&d[f]!==this.instance?a.Relational.showWarnings&&
typeof console!=="undefined"&&console.warn("Relation=%o; collectionKey=%s already exists on collection=%o",this,f,this.options.collectionKey):d[f]=this.instance}d.bind("relational:add",this.handleAddition).bind("relational:remove",this.handleRemoval).bind("relational:reset",this.handleReset);return d},findRelated:function(e){if(this.keyContents){this.keyContents=d.isArray(this.keyContents)?this.keyContents:[this.keyContents];d.each(this.keyContents,function(f){var h=d.isString(f)||d.isNumber(f)?f:
f[this.relatedModel.prototype.idAttribute];(h=a.Relational.store.find(this.relatedModel,h))&&d.isObject(f)?h.set(f,e):h||(h=this.createModel(f));h&&!this.related.getByCid(h)&&!this.related.get(h)&&this.related.add(h)},this)}},onChange:function(e,f,h){h=this.sanitizeOptions(h);this.keyContents=f;d.each(this.getReverseRelations(),function(a){a.removeRelated(this.instance,h)},this);if(f instanceof a.Collection){this.prepareCollection(f);this.related=f}else{this.setRelated(this.prepareCollection(this.related instanceof
a.Collection?this.related:new this.collectionType));this.findRelated(h)}d.each(this.getReverseRelations(),function(a){a.addRelated(this.instance,h)},this);var g=this;a.Relational.eventQueue.add(function(){!h.silentChange&&g.instance.trigger("update:"+g.key,g.instance,g.related,h)})},tryAddRelated:function(a,f){f=this.sanitizeOptions(f);!this.related.getByCid(a)&&!this.related.get(a)&&d.any(this.keyContents,function(f){return(f=d.isString(f)||d.isNumber(f)?f:f[this.relatedModel.prototype.idAttribute])&&
f===a.id},this)&&this.related.add(a,f)},handleAddition:function(e,f,h){if(e instanceof a.Model){h=this.sanitizeOptions(h);d.each(this.getReverseRelations(e),function(a){a.addRelated(this.instance,h)},this);var g=this;a.Relational.eventQueue.add(function(){!h.silentChange&&g.instance.trigger("add:"+g.key,e,g.related,h)})}},handleRemoval:function(e,f,h){if(e instanceof a.Model){h=this.sanitizeOptions(h);d.each(this.getReverseRelations(e),function(a){a.removeRelated(this.instance,h)},this);var g=this;
a.Relational.eventQueue.add(function(){!h.silentChange&&g.instance.trigger("remove:"+g.key,e,g.related,h)})}},handleReset:function(d,f){var f=this.sanitizeOptions(f),h=this;a.Relational.eventQueue.add(function(){!f.silentChange&&h.instance.trigger("reset:"+h.key,h.related,f)})},addRelated:function(a,d){var h=this;a.queue(function(){h.related&&!h.related.getByCid(a)&&!h.related.get(a)&&h.related.add(a,d)})},removeRelated:function(a,d){(this.related.getByCid(a)||this.related.get(a))&&this.related.remove(a,
d)}});a.RelationalModel=a.Model.extend({relations:null,_relations:null,_isInitialized:!1,_deferProcessing:!1,_queue:null,constructor:function(e,f){var h=this;if(f&&f.collection){this._deferProcessing=true;var g=function(a){if(a===h){h._deferProcessing=false;h.processQueue();f.collection.unbind("relational:add",g)}};f.collection.bind("relational:add",g);d.defer(function(){g(h)})}this._queue=new a.BlockingQueue;this._queue.block();a.Relational.eventQueue.block();a.Model.prototype.constructor.apply(this,
arguments);a.Relational.eventQueue.unblock()},trigger:function(d){if(d.length>5&&"change"===d.substr(0,6)){var f=this,h=arguments;a.Relational.eventQueue.add(function(){a.Model.prototype.trigger.apply(f,h)})}else a.Model.prototype.trigger.apply(this,arguments);return this},initializeRelations:function(){this.acquire();this._relations=[];d.each(this.relations,function(e){var f=!d.isString(e.type)?e.type:a[e.type]||a.Relational.store.getObjectByName(e.type);f&&f.prototype instanceof a.Relation.prototype.constructor?
new f(this,e):a.Relational.showWarnings&&typeof console!=="undefined"&&console.warn("Relation=%o; missing or invalid type!",e)},this);this._isInitialized=true;this.release();this.processQueue()},updateRelations:function(a){this._isInitialized&&!this.isLocked()&&d.each(this._relations,function(d){var h=this.attributes[d.key];d.related!==h&&this.trigger("relational:change:"+d.key,this,h,a||{})},this)},queue:function(a){this._queue.add(a)},processQueue:function(){this._isInitialized&&!this._deferProcessing&&
this._queue.isBlocked()&&this._queue.unblock()},getRelation:function(a){return d.detect(this._relations,function(d){if(d.key===a)return true},this)},getRelations:function(){return this._relations},fetchRelated:function(e,f){f||(f={});var h,g=[],k=this.getRelation(e),l=k&&k.keyContents;if((l=l&&d.select(d.isArray(l)?l:[l],function(e){return(e=d.isString(e)||d.isNumber(e)?e:e[k.relatedModel.prototype.idAttribute])&&!a.Relational.store.find(k.relatedModel,e)},this))&&l.length){var m=d.map(l,function(a){if(typeof a===
"object")a=new k.relatedModel(a);else{var d={};d[k.relatedModel.prototype.idAttribute]=a;a=new k.relatedModel(d)}return a},this);k.related instanceof a.Collection&&d.isFunction(k.related.url)&&(h=k.related.url(m));if(h&&h!==k.related.url()){h=d.defaults({error:function(){var a=arguments;d.each(m,function(d){d.trigger("destroy",d,d.collection,f);f.error&&f.error.apply(d,a)})},url:h},f,{add:true});g=[k.related.fetch(h)]}else g=d.map(m,function(a){var e=d.defaults({error:function(){a.trigger("destroy",
a,a.collection,f);f.error&&f.error.apply(a,arguments)}},f);return a.fetch(e)},this)}return g},set:function(e,f,h){a.Relational.eventQueue.block();var g;if(d.isObject(e)||e==null){g=e;h=f}else{g={};g[e]=f}var k=a.Model.prototype.set.apply(this,arguments);if(!this._isInitialized&&!this.isLocked()){a.Relational.store.register(this);this.initializeRelations()}else g&&this.idAttribute in g&&a.Relational.store.update(this);g&&this.updateRelations(h);a.Relational.eventQueue.unblock();return k},unset:function(d,
f){a.Relational.eventQueue.block();var h=a.Model.prototype.unset.apply(this,arguments);this.updateRelations(f);a.Relational.eventQueue.unblock();return h},clear:function(d){a.Relational.eventQueue.block();var f=a.Model.prototype.clear.apply(this,arguments);this.updateRelations(d);a.Relational.eventQueue.unblock();return f},change:function(){var d=this;a.Relational.eventQueue.add(function(){a.Model.prototype.change.apply(d,arguments)})},clone:function(){var a=d.clone(this.attributes);d.isUndefined(a[this.idAttribute])||
(a[this.idAttribute]=null);d.each(this.getRelations(),function(d){delete a[d.key]});return new this.constructor(a)},toJSON:function(){if(this.isLocked())return this.id;this.acquire();var e=a.Model.prototype.toJSON.call(this);d.each(this._relations,function(f){var h=e[f.key];f.options.includeInJSON===true&&h&&d.isFunction(h.toJSON)?e[f.keySource]=h.toJSON():d.isString(f.options.includeInJSON)?h instanceof a.Collection?e[f.keySource]=h.pluck(f.options.includeInJSON):h instanceof a.Model&&(e[f.keySource]=
h.get(f.options.includeInJSON)):delete e[f.key];f.keySource!==f.key&&delete e[f.key]},this);this.release();return e}});d.extend(a.RelationalModel.prototype,a.Semaphore);var k=a.Collection.prototype.__add=a.Collection.prototype.add;a.Collection.prototype.add=function(e,f){f||(f={});d.isArray(e)||(e=[e]);d.each(e,function(d){if(!(d instanceof a.Model)){var e=a.Relational.store.find(this.model,d[this.model.prototype.idAttribute]);if(e){e.set(d,f);d=e}else d=a.Collection.prototype._prepareModel.call(this,
d,f)}if(d instanceof a.Model&&!this.get(d)&&!this.getByCid(d)){k.call(this,d,f);this.trigger("relational:add",d,this,f)}},this);return this};var g=a.Collection.prototype.__remove=a.Collection.prototype.remove;a.Collection.prototype.remove=function(e,f){f||(f={});d.isArray(e)||(e=[e]);d.each(e,function(d){d=this.getByCid(d)||this.get(d);if(d instanceof a.Model){g.call(this,d,f);this.trigger("relational:remove",d,this,f)}},this);return this};var l=a.Collection.prototype.__reset=a.Collection.prototype.reset;
a.Collection.prototype.reset=function(a,d){l.call(this,a,d);this.trigger("relational:reset",a,d);return this};var m=a.Collection.prototype.__trigger=a.Collection.prototype.trigger;a.Collection.prototype.trigger=function(d){if(d==="add"||d==="remove"||d==="reset"){var f=this,g=arguments;a.Relational.eventQueue.add(function(){m.apply(f,g)})}else m.apply(this,arguments);return this};a.RelationalModel.extend=function(e,f){var g=a.Model.extend.apply(this,arguments);d.each(e&&e.relations||[],function(e){if(e.reverseRelation){e.model=
g;var f=true;if(d.isString(e.relatedModel))f=(f=a.Relational.store.getObjectByName(e.relatedModel))&&f.prototype instanceof a.RelationalModel.prototype.constructor;var k=!d.isString(e.type)?e.type:a[e.type]||a.Relational.store.getObjectByName(e.type);f&&k&&k.prototype instanceof a.Relation.prototype.constructor&&new k(null,e)}});return g}})();(function(){var d=Math,a=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":/trident/i.test(navigator.userAgent)?"ms":"opera"in window?"O":"",o=/android/gi.test(navigator.appVersion),k=/iphone|ipad/gi.test(navigator.appVersion),g=/playbook/gi.test(navigator.appVersion),l=/hp-tablet/gi.test(navigator.appVersion),m="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,e="ontouchstart"in window&&!l,f=a+"Transform"in document.documentElement.style,h=k||g,s=function(){return window.requestAnimationFrame||
window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(c){return setTimeout(c,1)}}(),n=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout,q="onorientationchange"in window?"orientationchange":"resize",u=e?"touchstart":"mousedown",
y=e?"touchmove":"mousemove",z=e?"touchend":"mouseup",r=e?"touchcancel":"mouseup",v="Moz"==a?"DOMMouseScroll":"mousewheel",t="translate"+(m?"3d(":"("),w=m?",0)":")",g=function(c,b){var d=this,g;d.wrapper="object"==typeof c?c:document.getElementById(c);d.wrapper.style.overflow="hidden";d.scroller=d.wrapper.children[0];d.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,hScrollbar:!0,vScrollbar:!0,
fixedScrollbar:o,hideScrollbar:k,fadeScrollbar:k&&m,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(b){b.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(g in b)d.options[g]=b[g];d.x=d.options.x;d.y=d.options.y;d.options.useTransform=f?d.options.useTransform:
!1;d.options.hScrollbar=d.options.hScroll&&d.options.hScrollbar;d.options.vScrollbar=d.options.vScroll&&d.options.vScrollbar;d.options.zoom=d.options.useTransform&&d.options.zoom;d.options.useTransition=h&&d.options.useTransition;d.options.zoom&&o&&(t="translate(",w=")");d.scroller.style[a+"TransitionProperty"]=d.options.useTransform?"-"+a.toLowerCase()+"-transform":"top left";d.scroller.style[a+"TransitionDuration"]="0";d.scroller.style[a+"TransformOrigin"]="0 0";d.options.useTransition&&(d.scroller.style[a+
"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)");d.options.useTransform?d.scroller.style[a+"Transform"]=t+d.x+"px,"+d.y+"px"+w:d.scroller.style.cssText+=";position:absolute;top:"+d.y+"px;left:"+d.x+"px";d.options.useTransition&&(d.options.fixedScrollbar=!0);d.refresh();d._bind(q,window);d._bind(u);e||(d._bind("mouseout",d.wrapper),"none"!=d.options.wheelAction&&d._bind(v));d.options.checkDOMChanges&&(d.checkDOMTime=setInterval(function(){d._checkDOMChanges()},500))};g.prototype={enabled:!0,
x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(c){switch(c.type){case u:if(!e&&0!==c.button)break;this._start(c);break;case y:this._move(c);break;case z:case r:this._end(c);break;case q:this._resize();break;case v:this._wheel(c);break;case "mouseout":this._mouseout(c);break;case "webkitTransitionEnd":this._transitionEnd(c)}},_checkDOMChanges:function(){!this.moved&&!this.zoomed&&!(this.animating||this.scrollerW==this.scroller.offsetWidth*
this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)&&this.refresh()},_scrollbar:function(c){var b=document,e;this[c+"Scrollbar"]?(this[c+"ScrollbarWrapper"]||(e=b.createElement("div"),this.options.scrollbarClass?e.className=this.options.scrollbarClass+c.toUpperCase():e.style.cssText="position:absolute;z-index:100;"+("h"==c?"height:7px;bottom:1px;left:2px;right:"+(this.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(this.hScrollbar?"7":"2")+"px;top:2px;right:1px"),e.style.cssText+=";pointer-events:none;-"+
a+"-transition-property:opacity;-"+a+"-transition-duration:"+(this.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(this.options.hideScrollbar?"0":"1"),this.wrapper.appendChild(e),this[c+"ScrollbarWrapper"]=e,e=b.createElement("div"),this.options.scrollbarClass||(e.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-"+a+"-background-clip:padding-box;-"+a+"-box-sizing:border-box;"+("h"==c?"height:100%":"width:100%")+";-"+a+
"-border-radius:3px;border-radius:3px"),e.style.cssText+=";pointer-events:none;-"+a+"-transition-property:-"+a+"-transform;-"+a+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-"+a+"-transition-duration:0;-"+a+"-transform:"+t+"0,0"+w,this.options.useTransition&&(e.style.cssText+=";-"+a+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),this[c+"ScrollbarWrapper"].appendChild(e),this[c+"ScrollbarIndicator"]=e),"h"==c?(this.hScrollbarSize=this.hScrollbarWrapper.clientWidth,this.hScrollbarIndicatorSize=
d.max(this.hScrollbarSize*this.hScrollbarSize/this.scrollerW>>0,8),this.hScrollbarIndicator.style.width=this.hScrollbarIndicatorSize+"px",this.hScrollbarMaxScroll=this.hScrollbarSize-this.hScrollbarIndicatorSize,this.hScrollbarProp=this.hScrollbarMaxScroll/this.maxScrollX):(this.vScrollbarSize=this.vScrollbarWrapper.clientHeight,this.vScrollbarIndicatorSize=d.max(this.vScrollbarSize*this.vScrollbarSize/this.scrollerH>>0,8),this.vScrollbarIndicator.style.height=this.vScrollbarIndicatorSize+"px",this.vScrollbarMaxScroll=
this.vScrollbarSize-this.vScrollbarIndicatorSize,this.vScrollbarProp=this.vScrollbarMaxScroll/this.maxScrollY),this._scrollbarPos(c,!0)):this[c+"ScrollbarWrapper"]&&(f&&(this[c+"ScrollbarIndicator"].style[a+"Transform"]=""),this[c+"ScrollbarWrapper"].parentNode.removeChild(this[c+"ScrollbarWrapper"]),this[c+"ScrollbarWrapper"]=null,this[c+"ScrollbarIndicator"]=null)},_resize:function(){var c=this;setTimeout(function(){c.refresh()},o?200:0)},_pos:function(c,b){c=this.hScroll?c:0;b=this.vScroll?b:0;
this.options.useTransform?this.scroller.style[a+"Transform"]=t+c+"px,"+b+"px"+w+" scale("+this.scale+")":(c>>=0,b>>=0,this.scroller.style.left=c+"px",this.scroller.style.top=b+"px");this.x=c;this.y=b;this._scrollbarPos("h");this._scrollbarPos("v")},_scrollbarPos:function(c,b){var d="h"==c?this.x:this.y;this[c+"Scrollbar"]&&(d*=this[c+"ScrollbarProp"],0>d?(this.options.fixedScrollbar||(d=this[c+"ScrollbarIndicatorSize"]+(3*d>>0),8>d&&(d=8),this[c+"ScrollbarIndicator"].style["h"==c?"width":"height"]=
d+"px"),d=0):d>this[c+"ScrollbarMaxScroll"]&&(this.options.fixedScrollbar?d=this[c+"ScrollbarMaxScroll"]:(d=this[c+"ScrollbarIndicatorSize"]-(3*(d-this[c+"ScrollbarMaxScroll"])>>0),8>d&&(d=8),this[c+"ScrollbarIndicator"].style["h"==c?"width":"height"]=d+"px",d=this[c+"ScrollbarMaxScroll"]+(this[c+"ScrollbarIndicatorSize"]-d))),this[c+"ScrollbarWrapper"].style[a+"TransitionDelay"]="0",this[c+"ScrollbarWrapper"].style.opacity=b&&this.options.hideScrollbar?"0":"1",this[c+"ScrollbarIndicator"].style[a+
"Transform"]=t+("h"==c?d+"px,0":"0,"+d+"px")+w)},_start:function(c){var b=e?c.touches[0]:c,f,g;if(this.enabled){this.options.onBeforeScrollStart&&this.options.onBeforeScrollStart.call(this,c);(this.options.useTransition||this.options.zoom)&&this._transitionTime(0);this.zoomed=this.animating=this.moved=!1;this.dirY=this.dirX=this.absDistY=this.absDistX=this.distY=this.distX=0;this.options.zoom&&e&&1<c.touches.length&&(g=d.abs(c.touches[0].pageX-c.touches[1].pageX),f=d.abs(c.touches[0].pageY-c.touches[1].pageY),
this.touchesDistStart=d.sqrt(g*g+f*f),this.originX=d.abs(c.touches[0].pageX+c.touches[1].pageX-2*this.wrapperOffsetLeft)/2-this.x,this.originY=d.abs(c.touches[0].pageY+c.touches[1].pageY-2*this.wrapperOffsetTop)/2-this.y,this.options.onZoomStart&&this.options.onZoomStart.call(this,c));if(this.options.momentum&&(this.options.useTransform?(f=getComputedStyle(this.scroller,null)[a+"Transform"].replace(/[^0-9-.,]/g,"").split(","),g=1*f[4],f=1*f[5]):(g=1*getComputedStyle(this.scroller,null).left.replace(/[^0-9-]/g,
""),f=1*getComputedStyle(this.scroller,null).top.replace(/[^0-9-]/g,"")),g!=this.x||f!=this.y))this.options.useTransition?this._unbind("webkitTransitionEnd"):n(this.aniTime),this.steps=[],this._pos(g,f);this.absStartX=this.x;this.absStartY=this.y;this.startX=this.x;this.startY=this.y;this.pointX=b.pageX;this.pointY=b.pageY;this.startTime=c.timeStamp||Date.now();this.options.onScrollStart&&this.options.onScrollStart.call(this,c);this._bind(y);this._bind(z);this._bind(r)}},_move:function(c){var b=e?
c.touches[0]:c,f=b.pageX-this.pointX,g=b.pageY-this.pointY,h=this.x+f,k=this.y+g,l=c.timeStamp||Date.now();this.options.onBeforeScrollMove&&this.options.onBeforeScrollMove.call(this,c);if(this.options.zoom&&e&&1<c.touches.length)h=d.abs(c.touches[0].pageX-c.touches[1].pageX),k=d.abs(c.touches[0].pageY-c.touches[1].pageY),this.touchesDist=d.sqrt(h*h+k*k),this.zoomed=!0,b=1/this.touchesDistStart*this.touchesDist*this.scale,b<this.options.zoomMin?b=0.5*this.options.zoomMin*Math.pow(2,b/this.options.zoomMin):
b>this.options.zoomMax&&(b=2*this.options.zoomMax*Math.pow(0.5,this.options.zoomMax/b)),this.lastScale=b/this.scale,h=this.originX-this.originX*this.lastScale+this.x,k=this.originY-this.originY*this.lastScale+this.y,this.scroller.style[a+"Transform"]=t+h+"px,"+k+"px"+w+" scale("+b+")",this.options.onZoom&&this.options.onZoom.call(this,c);else{this.pointX=b.pageX;this.pointY=b.pageY;if(0<h||h<this.maxScrollX)h=this.options.bounce?this.x+f/2:0<=h||0<=this.maxScrollX?0:this.maxScrollX;if(k>this.minScrollY||
k<this.maxScrollY)k=this.options.bounce?this.y+g/2:k>=this.minScrollY||0<=this.maxScrollY?this.minScrollY:this.maxScrollY;this.distX+=f;this.distY+=g;this.absDistX=d.abs(this.distX);this.absDistY=d.abs(this.distY);6>this.absDistX&&6>this.absDistY||(this.options.lockDirection&&(this.absDistX>this.absDistY+5?(k=this.y,g=0):this.absDistY>this.absDistX+5&&(h=this.x,f=0)),this.moved=!0,this._pos(h,k),this.dirX=0<f?-1:0>f?1:0,this.dirY=0<g?-1:0>g?1:0,300<l-this.startTime&&(this.startTime=l,this.startX=
this.x,this.startY=this.y),this.options.onScrollMove&&this.options.onScrollMove.call(this,c))}},_end:function(c){if(!(e&&0!=c.touches.length)){var b=this,f=e?c.changedTouches[0]:c,g,h,k={dist:0,time:0},l={dist:0,time:0},m=(c.timeStamp||Date.now())-b.startTime,o=b.x,n=b.y;b._unbind(y);b._unbind(z);b._unbind(r);b.options.onBeforeScrollEnd&&b.options.onBeforeScrollEnd.call(b,c);if(b.zoomed)o=b.scale*b.lastScale,o=Math.max(b.options.zoomMin,o),o=Math.min(b.options.zoomMax,o),b.lastScale=o/b.scale,b.scale=
o,b.x=b.originX-b.originX*b.lastScale+b.x,b.y=b.originY-b.originY*b.lastScale+b.y,b.scroller.style[a+"TransitionDuration"]="200ms",b.scroller.style[a+"Transform"]=t+b.x+"px,"+b.y+"px"+w+" scale("+b.scale+")",b.zoomed=!1,b.refresh(),b.options.onZoomEnd&&b.options.onZoomEnd.call(b,c);else{if(b.moved){if(300>m&&b.options.momentum){k=o?b._momentum(o-b.startX,m,-b.x,b.scrollerW-b.wrapperW+b.x,b.options.bounce?b.wrapperW:0):k;l=n?b._momentum(n-b.startY,m,-b.y,0>b.maxScrollY?b.scrollerH-b.wrapperH+b.y-b.minScrollY:
0,b.options.bounce?b.wrapperH:0):l;o=b.x+k.dist;n=b.y+l.dist;if(0<b.x&&0<o||b.x<b.maxScrollX&&o<b.maxScrollX)k={dist:0,time:0};if(b.y>b.minScrollY&&n>b.minScrollY||b.y<b.maxScrollY&&n<b.maxScrollY)l={dist:0,time:0}}k.dist||l.dist?(k=d.max(d.max(k.time,l.time),10),b.options.snap&&(l=o-b.absStartX,m=n-b.absStartY,d.abs(l)<b.options.snapThreshold&&d.abs(m)<b.options.snapThreshold?b.scrollTo(b.absStartX,b.absStartY,200):(l=b._snap(o,n),o=l.x,n=l.y,k=d.max(l.time,k))),b.scrollTo(o>>0,n>>0,k)):b.options.snap?
(l=o-b.absStartX,m=n-b.absStartY,d.abs(l)<b.options.snapThreshold&&d.abs(m)<b.options.snapThreshold?b.scrollTo(b.absStartX,b.absStartY,200):(l=b._snap(b.x,b.y),(l.x!=b.x||l.y!=b.y)&&b.scrollTo(l.x,l.y,l.time))):b._resetPos(200)}else e&&(b.doubleTapTimer&&b.options.zoom?(clearTimeout(b.doubleTapTimer),b.doubleTapTimer=null,b.options.onZoomStart&&b.options.onZoomStart.call(b,c),b.zoom(b.pointX,b.pointY,1==b.scale?b.options.doubleTapZoom:1),b.options.onZoomEnd&&setTimeout(function(){b.options.onZoomEnd.call(b,
c)},200)):b.doubleTapTimer=setTimeout(function(){b.doubleTapTimer=null;for(g=f.target;1!=g.nodeType;)g=g.parentNode;"SELECT"!=g.tagName&&"INPUT"!=g.tagName&&"TEXTAREA"!=g.tagName&&(h=document.createEvent("MouseEvents"),h.initMouseEvent("click",!0,!0,c.view,1,f.screenX,f.screenY,f.clientX,f.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,0,null),h._fake=!0,g.dispatchEvent(h))},b.options.zoom?250:0)),b._resetPos(200);b.options.onTouchEnd&&b.options.onTouchEnd.call(b,c)}}},_resetPos:function(c){var b=
0<=this.x?0:this.x<this.maxScrollX?this.maxScrollX:this.x,d=this.y>=this.minScrollY||0<this.maxScrollY?this.minScrollY:this.y<this.maxScrollY?this.maxScrollY:this.y;if(b==this.x&&d==this.y){if(this.moved&&(this.moved=!1,this.options.onScrollEnd&&this.options.onScrollEnd.call(this)),this.hScrollbar&&this.options.hideScrollbar&&("webkit"==a&&(this.hScrollbarWrapper.style[a+"TransitionDelay"]="300ms"),this.hScrollbarWrapper.style.opacity="0"),this.vScrollbar&&this.options.hideScrollbar)"webkit"==a&&
(this.vScrollbarWrapper.style[a+"TransitionDelay"]="300ms"),this.vScrollbarWrapper.style.opacity="0"}else this.scrollTo(b,d,c||0)},_wheel:function(c){var b=this,a,d;if("wheelDeltaX"in c)a=c.wheelDeltaX/12,d=c.wheelDeltaY/12;else if("wheelDelta"in c)a=d=c.wheelDelta/12;else if("detail"in c)a=d=3*-c.detail;else return;if("zoom"==b.options.wheelAction){if(d=b.scale*Math.pow(2,1/3*(d?d/Math.abs(d):0)),d<b.options.zoomMin&&(d=b.options.zoomMin),d>b.options.zoomMax&&(d=b.options.zoomMax),d!=b.scale)!b.wheelZoomCount&&
b.options.onZoomStart&&b.options.onZoomStart.call(b,c),b.wheelZoomCount++,b.zoom(c.pageX,c.pageY,d,400),setTimeout(function(){b.wheelZoomCount--;!b.wheelZoomCount&&b.options.onZoomEnd&&b.options.onZoomEnd.call(b,c)},400)}else a=b.x+a,d=b.y+d,0<a?a=0:a<b.maxScrollX&&(a=b.maxScrollX),d>b.minScrollY?d=b.minScrollY:d<b.maxScrollY&&(d=b.maxScrollY),b.scrollTo(a,d,0)},_mouseout:function(c){var b=c.relatedTarget;if(b)for(;b=b.parentNode;)if(b==this.wrapper)return;this._end(c)},_transitionEnd:function(c){c.target==
this.scroller&&(this._unbind("webkitTransitionEnd"),this._startAni())},_startAni:function(){var c=this,b=c.x,a=c.y,e=Date.now(),f,g,h;c.animating||(c.steps.length?(f=c.steps.shift(),f.x==b&&f.y==a&&(f.time=0),c.animating=!0,c.moved=!0,c.options.useTransition)?(c._transitionTime(f.time),c._pos(f.x,f.y),c.animating=!1,f.time?c._bind("webkitTransitionEnd"):c._resetPos(0)):(h=function(){var k=Date.now();if(k>=e+f.time){c._pos(f.x,f.y);c.animating=false;c.options.onAnimationEnd&&c.options.onAnimationEnd.call(c);
c._startAni()}else{k=(k-e)/f.time-1;g=d.sqrt(1-k*k);k=(f.x-b)*g+b;c._pos(k,(f.y-a)*g+a);if(c.animating)c.aniTime=s(h)}},h()):c._resetPos(400))},_transitionTime:function(c){c+="ms";this.scroller.style[a+"TransitionDuration"]=c;this.hScrollbar&&(this.hScrollbarIndicator.style[a+"TransitionDuration"]=c);this.vScrollbar&&(this.vScrollbarIndicator.style[a+"TransitionDuration"]=c)},_momentum:function(a,b,e,f,g){var b=d.abs(a)/b,h=b*b/0.0012;0<a&&h>e?(e+=g/(6/(6.0E-4*(h/b))),b=b*e/h,h=e):0>a&&h>f&&(f+=g/
(6/(6.0E-4*(h/b))),b=b*f/h,h=f);return{dist:h*(0>a?-1:1),time:b/6.0E-4>>0}},_offset:function(a){for(var b=-a.offsetLeft,d=-a.offsetTop;a=a.offsetParent;)b-=a.offsetLeft,d-=a.offsetTop;a!=this.wrapper&&(b*=this.scale,d*=this.scale);return{left:b,top:d}},_snap:function(a,b){var e,f,g;g=this.pagesX.length-1;e=0;for(f=this.pagesX.length;e<f;e++)if(a>=this.pagesX[e]){g=e;break}g==this.currPageX&&0<g&&0>this.dirX&&g--;a=this.pagesX[g];f=(f=d.abs(a-this.pagesX[this.currPageX]))?500*(d.abs(this.x-a)/f):0;
this.currPageX=g;g=this.pagesY.length-1;for(e=0;e<g;e++)if(b>=this.pagesY[e]){g=e;break}g==this.currPageY&&0<g&&0>this.dirY&&g--;b=this.pagesY[g];e=(e=d.abs(b-this.pagesY[this.currPageY]))?500*(d.abs(this.y-b)/e):0;this.currPageY=g;g=d.max(f,e)>>0;return{x:a,y:b,time:g||200}},_bind:function(a,b,d){(b||this.scroller).addEventListener(a,this,!!d)},_unbind:function(a,b,d){(b||this.scroller).removeEventListener(a,this,!!d)},destroy:function(){this.scroller.style[a+"Transform"]="";this.vScrollbar=this.hScrollbar=
!1;this._scrollbar("h");this._scrollbar("v");this._unbind(q,window);this._unbind(u);this._unbind(y);this._unbind(z);this._unbind(r);this.options.hasTouch||(this._unbind("mouseout",this.wrapper),this._unbind(v));this.options.useTransition&&this._unbind("webkitTransitionEnd");this.options.checkDOMChanges&&clearInterval(this.checkDOMTime);this.options.onDestroy&&this.options.onDestroy.call(this)},setOption:function(a){for(i in a)this.options[i]=a[i];this.refresh()},refresh:function(){var c,b,d,e=0;b=
0;this.scale<this.options.zoomMin&&(this.scale=this.options.zoomMin);this.wrapperW=this.wrapper.clientWidth||1;this.wrapperH=this.wrapper.clientHeight||1;this.minScrollY=-this.options.topOffset||0;this.scrollerW=this.scroller.offsetWidth*this.scale>>0;this.scrollerH=(this.scroller.offsetHeight+this.minScrollY)*this.scale>>0;this.maxScrollX=this.wrapperW-this.scrollerW;this.maxScrollY=this.wrapperH-this.scrollerH+this.minScrollY;this.dirY=this.dirX=0;this.options.onRefresh&&this.options.onRefresh.call(this);
this.hScroll=this.options.hScroll&&0>this.maxScrollX;this.vScroll=this.options.vScroll&&(!this.options.bounceLock&&!this.hScroll||this.scrollerH>this.wrapperH);this.hScrollbar=this.hScroll&&this.options.hScrollbar;this.vScrollbar=this.vScroll&&this.options.vScrollbar&&this.scrollerH>this.wrapperH;c=this._offset(this.wrapper);this.wrapperOffsetLeft=-c.left;this.wrapperOffsetTop=-c.top;if("string"==typeof this.options.snap){this.pagesX=[];this.pagesY=[];d=this.scroller.querySelectorAll(this.options.snap);
c=0;for(b=d.length;c<b;c++)e=this._offset(d[c]),e.left+=this.wrapperOffsetLeft,e.top+=this.wrapperOffsetTop,this.pagesX[c]=e.left<this.maxScrollX?this.maxScrollX:e.left*this.scale,this.pagesY[c]=e.top<this.maxScrollY?this.maxScrollY:e.top*this.scale}else if(this.options.snap){for(this.pagesX=[];e>=this.maxScrollX;)this.pagesX[b]=e,e-=this.wrapperW,b++;this.maxScrollX%this.wrapperW&&(this.pagesX[this.pagesX.length]=this.maxScrollX-this.pagesX[this.pagesX.length-1]+this.pagesX[this.pagesX.length-1]);
b=e=0;for(this.pagesY=[];e>=this.maxScrollY;)this.pagesY[b]=e,e-=this.wrapperH,b++;this.maxScrollY%this.wrapperH&&(this.pagesY[this.pagesY.length]=this.maxScrollY-this.pagesY[this.pagesY.length-1]+this.pagesY[this.pagesY.length-1])}this._scrollbar("h");this._scrollbar("v");this.zoomed||(this.scroller.style[a+"TransitionDuration"]="0",this._resetPos(200))},scrollTo:function(a,b,d,e){var f=a;this.stop();f.length||(f=[{x:a,y:b,time:d,relative:e}]);a=0;for(b=f.length;a<b;a++)f[a].relative&&(f[a].x=this.x-
f[a].x,f[a].y=this.y-f[a].y),this.steps.push({x:f[a].x,y:f[a].y,time:f[a].time||0});this._startAni()},scrollToElement:function(a,b){var e;if(a=a.nodeType?a:this.scroller.querySelector(a))e=this._offset(a),e.left+=this.wrapperOffsetLeft,e.top+=this.wrapperOffsetTop,e.left=0<e.left?0:e.left<this.maxScrollX?this.maxScrollX:e.left,e.top=e.top>this.minScrollY?this.minScrollY:e.top<this.maxScrollY?this.maxScrollY:e.top,b=void 0===b?d.max(2*d.abs(e.left),2*d.abs(e.top)):b,this.scrollTo(e.left,e.top,b)},
scrollToPage:function(a,b,d){d=void 0===d?400:d;this.options.onScrollStart&&this.options.onScrollStart.call(this);if(this.options.snap)a="next"==a?this.currPageX+1:"prev"==a?this.currPageX-1:a,b="next"==b?this.currPageY+1:"prev"==b?this.currPageY-1:b,a=0>a?0:a>this.pagesX.length-1?this.pagesX.length-1:a,b=0>b?0:b>this.pagesY.length-1?this.pagesY.length-1:b,this.currPageX=a,this.currPageY=b,a=this.pagesX[a],b=this.pagesY[b];else if(a*=-this.wrapperW,b*=-this.wrapperH,a<this.maxScrollX&&(a=this.maxScrollX),
b<this.maxScrollY)b=this.maxScrollY;this.scrollTo(a,b,d)},disable:function(){this.stop();this._resetPos(0);this.enabled=!1;this._unbind(y);this._unbind(z);this._unbind(r)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind("webkitTransitionEnd"):n(this.aniTime);this.steps=[];this.animating=this.moved=!1},zoom:function(c,b,d,e){var f=d/this.scale;this.options.useTransform&&(this.zoomed=!0,e=void 0===e?200:e,c=c-this.wrapperOffsetLeft-this.x,b=b-this.wrapperOffsetTop-
this.y,this.x=c-c*f+this.x,this.y=b-b*f+this.y,this.scale=d,this.refresh(),this.x=0<this.x?0:this.x<this.maxScrollX?this.maxScrollX:this.x,this.y=this.y>this.minScrollY?this.minScrollY:this.y<this.maxScrollY?this.maxScrollY:this.y,this.scroller.style[a+"TransitionDuration"]=e+"ms",this.scroller.style[a+"Transform"]=t+this.x+"px,"+this.y+"px"+w+" scale("+d+")",this.zoomed=!1)},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}};"undefined"!==typeof exports?exports.iScroll=g:window.iScroll=
g})();window.languages=window.languages||{};window.languages["zh-tw"]={setting:{DST:8,format:"Y 年 m 月 d 日 (D) H:i:s",AM:"上午",PM:"下午"},shortMonths:"1 月,2 月,3 月,4 月,5 月,6 月,7 月,8 月,9 月,10 月,11 月,12 月".split(","),longMonths:"一月,二月,三月,四月,五月,六月,七月,八月,九月,十月,十一月,十二月".split(","),shortDays:"日,一,二,三,四,五,六".split(","),longDays:"星期日,星期一,星期二,星期三,星期四,星期五,星期六".split(","),orderTab:"點餐",historyTab:"紀錄",feedbackTab:"意見",aboutUsTab:"關於","Hello World":"哈囉! 世界","Nice to meet you, %1":"很高興認識你，%1","My name is %1, I'm %2 years old":"我的名字是 %1，我今年 %2 歲"};var supportedLang="zh-tw",defaultLang="zh-tw",language=window.navigator.userLanguage||window.navigator.language||defaultLang,language=language.toLowerCase();0>supportedLang.indexOf(language)&&(language=defaultLang);i18n.set(window.languages[language]);$(document).ready(function(){$("#backgroundLogo").remove();new myapp.Router;Backbone.history.start()});(function(){var d=Backbone.RelationalModel.extend({idAttribute:"_productId"}),a=Backbone.RelationalModel.extend({idAttribute:"_menuId",relations:[{type:Backbone.HasMany,key:"products",relatedModel:d,reverseRelation:{key:"menu",includeInJSON:"_menuId"}}]}),o=Backbone.RelationalModel.extend({defaults:{deliveryLimit:99999,deliveryFee:99999,lat:99999,lng:99999},idAttribute:"_storeNameId",relations:[{type:Backbone.HasOne,key:"_menuId",relatedModel:a,reverseRelation:{key:"store",includeInJSON:"_storeNameId"}}]}),
k=Backbone.RelationalModel.extend({url:"/jashami/testData/menuData",relations:[{type:Backbone.HasMany,key:"stores",relatedModel:o},{type:Backbone.HasMany,key:"menus",relatedModel:a}]});window.myapp=window.myapp||{};window.myapp.Model=window.myapp.Model||{};window.myapp.Model.Product=d;window.myapp.Model.Menu=a;window.myapp.Model.Store=o;window.myapp.Model.MenuData=k})();window.myapp=window.myapp||{};
window.myapp.Images={JashamiLogo:"data:image/png;base64,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",ShoppingCarIcon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAA6RwvCAAAEfUlEQVR42u1Xa0ybVRgeWebITJwzmrm4sOhmsqnjDzHYBEmlugKVJaAkg8CuLXRLGAT7C5M120S2GmsiRmRqolspCmSAW0eWbayZvQgMLaUX29qPFiUQCAPC/e7zLqfJScMPoHXxB1/ypOd7zvnOec9776ZNG8/G8z94ZmZm3l9eXj4JHOMgB8RAzBMRQqPRvLqwsPAQBwaBfzg8An4Ctj4RQerr67NxWM/s7OwnRUVFHxYWFj6GUqk8olAo3lzxI6lUuislJWVvUlLSK9EA7WU0Gq9AEJdcLj+wKslJRUATYAE6gE4O7cADNtcZBlL7r4CJjXm+DfgT0GdkZGxbiyBGwDE8PKw3mUzXQnC73dfBO4eGhkw8T7BYLDWLi4t2+EGH2WzWhXir1XoN3E18JxgMBvWqbUneC1yiA3U63W5+TiwWvwjeptfrNSt9OzU19RD4KpyfmJg4SoI0NzfL1uRYfr8/ixyrtbW1VCQSHUxMTIwnlJWVSUj92Pjn4uLix1xovqGhIX1packOQb5OTk4+GOIlEkk8uKvQVmd5efnONQmSnZ39Gg40A14gAPQy0NjOEOR4ggD8znwhnPfMzc39gK3XlisKCgq24eNaOtDn833R3t5+ntDb23sR3D3gN6/X+xnjL9DvyMjId+RXWP9jiIePnO/v778K3m+32wvXFfddXV1qMk9qamo8z9tsNi1FQVpa2gs8D7/5gBIU1ot43ul0ltE+6enpiesSpKmpSUqmwY0u45ZSaECGTSUUSXRz8KfBHyIeeG98fPxLtv4jevd4PGmIrsPgbgMtOTk5z69LEPjJc8iC5CduUi3disHFfMHLcQQn8Afg4zga/+VwODSRZOUYRMf32Kh7dHT0Y5jqFGFsbOxzEg5RoIXdTwCKYDCoAHeLfCcQCKhoXXd390ms+ZYctba2Njei+gBPp8ooYCNxiENueYtuSrkhLP/UAIaEhIQtXP7QkKYaGxv3RiRISUmJiG4PLeigXjlQgPE50hJuewWZVkEcNHKWZeM7iKwzxLlcrjPIqGbkkEZstTkiQWQy2Q5s/gsr1yG7+5nf+MJ8xMNyiMC9++bn51VRKd9arXYfasch1Ix3VwtEzNsQ4hsSqrS09J2oCILeYatKpXqaktxqoFarY6urq7dDCEpklqysrD0RC4HYFzHbU0QYGKiStrAMe5ehZYV5L0Ud0sDmiAXJzMx8g/UeXuYbAhtbWXtXD9Sxdw+bF9jYiGp7OCpmodtgQ6oh7r6+vqLBwcHjrFm6AXO9jOr6DFS/C03xPVTeNkEQjvb09JRg7Jienq6OWp+JQ3Yz0+hDHMKSao0Tndbr9I7yv5+y7eTk5DmuL7kOQdowjI2KILm5uRS+N6gHyc/PP4DeYufAwAB1aR15eXn7aE1VVdVL0IANh9fExcXtqKys3I/8QaZqwfSWqGkFqlay3sPK+tW/wX3KJakY1KQKtsbIfCpQV1d3Kqp/A9AexsIHill03IfKy8E9y6+pqKggzV1ggrQCSvjXUxt/KTee/+L5FwmS/gs/m0cyAAAAAElFTkSuQmCC"};(function(d){var a=Backbone.View.extend({initialize:function(){this.container=document.createElement("div");this.content=document.createElement("div");this.container.appendChild(this.content);this.el=this.container;this.container.style.overflow="hidden";this.content.style.width="100%";this.content.style.height="100%";this.scroll=new d(this.container,{hScrollbar:!1,vScrollbar:!1});var a=this,k=function(){a.scroll.refresh();[].slice.call(a.content.querySelectorAll("input, select, button")).forEach(function(a){a.addEventListener("ontouchstart"in
window?"touchstart":"mousedown",function(a){a.stopPropagation()})})};$(this.container).bind("DOMNodeInsertedIntoDocument",k);$(this.container).bind("resize",k)},events:{},html:function(a){$(this.content).html(a)},getContent:function(){return $(this.content)},setPullToRefresh:function(a){var d={pullDownOffset:30,pullUpOffset:30};for(i in a)d[i]=a[i];pullDownEl=d.pullDownEl;pullUpEl=d.pullUpEl;pullDownOffset=d.pullDownOffset;pullUpOffset=d.pullUpOffset;pullUpAction=d.pullUpAction;pullDownAction=d.pullDownAction;
pullDownEl&&pullDownEl.html('<span class="pullDownIcon"></span><span class="pullDownLabel">Pull down to refresh...</span>');pullUpEl&&pullUpEl.html('<span class="pullUpIcon"></span><span class="pullUpLabel">Pull up to refresh...</span>');this.render({useTransition:!0,topOffset:pullDownOffset,onRefresh:function(){pullDownEl&&pullDownEl.hasClass("loading")?(pullDownEl.removeClass("loading"),$(".pullDownLabel",pullDownEl).html("Pull down to refresh...")):pullUpEl&&pullUpEl.hasClass("loading")&&(pullUpEl.removeClass("loading"),
$(".pullUpLabel",pullUpEl).html("Pull up to load more..."))},onScrollMove:function(){pullDownEl&&5<this.y&&!pullDownEl.hasClass("flip")?(pullDownEl.addClass("flip"),$(".pullDownLabel",pullDownEl).html("Release to refresh..."),this.minScrollY=0):pullDownEl&&5>this.y&&pullDownEl.hasClass("flip")?(pullDownEl.removeClass("flip"),$(".pullDownLabel",pullDownEl).html("Pull down to refresh..."),this.minScrollY=-pullDownOffset):pullUpEl&&this.y<this.maxScrollY-5&&!pullUpEl.hasClass("flip")?(pullUpEl.addClass("flip"),
$(".pullUpLabel",pullUpEl).html("Release to refresh..."),this.maxScrollY=this.maxScrollY):pullUpEl&&this.y>this.maxScrollY+5&&pullUpEl.hasClass("flip")&&(pullUpEl.removeClass("flip"),$(".pullUpLabel",pullUpEl).html("Pull up to load more..."),this.maxScrollY=pullUpOffset)},onScrollEnd:function(){pullDownEl&&pullDownEl.hasClass("flip")?(pullDownEl.removeClass("flip").addClass("loading"),$(".pullDownLabel",pullDownEl).html("Loading..."),pullDownAction()):pullUpEl&&pullUpEl.hasClass("flip")&&(pullUpEl.removeClass("flip").addClass("loading"),
$(".pullUpLabel",pullUpEl).html("Loading..."),pullUpAction())}})},render:function(a){a?this.scroll.setOption(a):this.scroll.refresh();return this}});window.myapp=window.myapp||{};window.myapp.Widget=window.myapp.Widget||{};window.myapp.Widget.Scroller=a})(iScroll);(function(){var d=Backbone.View.extend({initialize:function(){this._isEnabled=!0;this._clickStart=!1;this._lastY=this._lastX=null},events:{mouseout:"onMouseOut",mousedown:"mouseDown",touchstart:"touchStart",touchmove:"touchMove",mouseup:"mouseUp",touchend:"touchEnd"},onMouseOut:function(){this._clickStart=!1;$(this.el).removeClass("Pressed")},mouseDown:function(a){a.preventDefault();a.stopPropagation();this.start(a.clientX,a.clientY)},touchStart:function(a){a.preventDefault();a.stopPropagation();
this.start(a.changedTouches[0].pageX,a.changedTouches[0].pageY);for(a=a.target;!a.tagName;)a=a.parentElement;var d=a.getBoundingClientRect();this.topLeftX=d.left;this.topLeftY=d.top;this.bottomRightX=d.left+a.clientWidth;this.bottomRightY=d.top+a.clientHeight},touchMove:function(a){a.preventDefault();a.stopPropagation();var d=a.changedTouches[0].pageX,a=a.changedTouches[0].pageY;if(d<this.topLeftX||d>this.bottomRightX||a<this.topLeftY||a>this.bottomRightY)this._clickStart=!1,$(this.el).removeClass("Pressed")},
mouseUp:function(a){a.preventDefault();a.stopPropagation();this.end(a.clientX,a.clientY)},touchEnd:function(a){a.preventDefault();a.stopPropagation();this.end(a.changedTouches[0].pageX,a.changedTouches[0].pageY)},start:function(a,d){this._isEnabled&&null!=a&&null!=d&&(this._lastX=a,this._lastY=d,this._clickStart=!0,this.changeColorWhenTouch&&$(this.el).addClass("Pressed"))},end:function(a,d){this._isEnabled&&null!=a&&null!=d&&(this._lastY=this._lastX=null,this._clickStart&&$(this.el).trigger("clickByTouch"),
this._clickStart=!1,$(this.el).removeClass("Pressed"))}});window.myapp=window.myapp||{};window.myapp.Widget=window.myapp.Widget||{};window.myapp.Widget.TouchWidget=d})();(function(){var d=Backbone.View.extend({render:function(){var a=this.model.get("_storeNameId"),d=this.model.get("_displayedName"),k=this.model.get("_msg"),g=this.model.get("_imgUrl");$(this.el).html(_.template('<a href="#storePage/<%= id %>"><img src="<%= img %>"></img><div class="Tag"></div><div class="InfoWidget"><div class="NameWidget"><div class="Name"><%= name %></div><div class="Msg"><%= msg %></div></div><div class="Bar"><div></div></div><div class="Status"></div></div></a>',{id:a,name:d,msg:k,
img:g}));$(this.el).addClass("StoreBriefWidget3");return this}});window.myapp=window.myapp||{};window.myapp.View=window.myapp.View||{};window.myapp.View.StoreBrief=d})();(function(d,a,o){var k=Backbone.View.extend({initialize:function(){var g=new a;g.html(_.template('<div class="StoreList"></div>'));$(this.el).html(g.render().el);$(this.el).css("background-color","rgba(255, 255, 255, 0.75)");$(this.el).css("display","-webkit-box");$(g.el).css("width","100%");var k=this,m=new d;m.fetch({success:function(){window.menuData=m;_.each(m.get("stores").models,function(a){a=new o({model:a});$(".StoreList",k.el).append(a.render().el)});$("img",this.el).bind("load",function(){g.render()});
g.render()},error:function(a,d){console.log(d.status)}})},events:{},render:function(){this.delegateEvents();return this}});window.myapp=window.myapp||{};window.myapp.OrderTabView=k})(window.myapp.Model.MenuData,window.myapp.Widget.Scroller,window.myapp.View.StoreBrief);(function(d){var a=Backbone.View.extend({initialize:function(){var a=new d;a.html(_.template('<div id="pullDown"></div><div class="OrderHistory"><div><div class="gwt-Label">點餐紀錄:</div><div class="OrderHistoryPanelTitle"><div class="gwt-Label">✭</div><div class="gwt-Label">送餐時間</div><div class="gwt-Label">編號</div><div class="gwt-Label">狀態</div></div></div><div class="Accordion OrderHistoryPanel"></div></div><div id="pullUp"></div>'));$(this.el).html(a.el);$(this.el).css("background-color","rgba(255, 255, 255, 0.75)");
$(this.el).css("display","-webkit-box");$(a.el).css("width","100%");$(".OrderHistoryPanel",this.el).css("minHeight",window.clientHeight);pullDownEl=$("#pullDown",this.el);pullDownOffset=30;pullUpEl=$("#pullUp",this.el);pullUpOffset=30;var k=this;a.setPullToRefresh({pullDownEl:pullDownEl,pullDownAction:function(){setTimeout(function(){el=$(".OrderHistoryPanel",k.el);for(i=0;3>i;i++)el.prepend("<li>Generated row</li>");a.render()},1E3)}})},render:function(){return this}});window.myapp=window.myapp||
{};window.myapp.HistoryTabView=a})(window.myapp.Widget.Scroller);(function(d,a){var o=Backbone.View.extend({initialize:function(){var k=new a;k.html(_.template("<div class='about_text' style='width:100%;'>感謝您使用Jashami(甲蝦米)<br/>您希望哪些商家擁有Jashami的服務，請推薦給我們：<input id='recommendation' type='Text' class='INPUT Text'>請留下您的寶貴意見，我們將為您提供更好的服務:<input id='opinion' type='Text' class='INPUT Text'><div id='sendFeedbackBtn' class='SubmitButton'>送出</div></div>"));$(this.el).html(k.el);$(this.el).css("background-color","rgba(255, 255, 255, 0.75)");$(this.el).css("display","-webkit-box");
$(k.el).css("width","100%");this.sendFeedbackBtn=new d({el:$("#sendFeedbackBtn",this.el)});this.sendFeedbackBtn.changeColorWhenTouch=!0},events:{"clickByTouch #sendFeedbackBtn":"sendFeedback"},render:function(){this.sendFeedbackBtn.delegateEvents();this.delegateEvents();return this},sendFeedback:function(){var a=$("#recommendation",this.el).val(),d=$("#opinion",this.el).val();alert("sendFeedback"+a+d)}});window.myapp=window.myapp||{};window.myapp.FeedbackTabView=o})(window.myapp.Widget.TouchWidget,
window.myapp.Widget.Scroller);(function(d){var a=Backbone.View.extend({initialize:function(){var a=new d;a.html(_.template('<div id="content" data-scrollable="y" style="width:100%;">qqq</div>'));$(this.el).html(a.el);$(this.el).css("background-color","rgba(255, 255, 255, 0.75)");$(this.el).css("display","-webkit-box");$(a.el).css("width","100%")},events:{},render:function(){return this}});window.myapp=window.myapp||{};window.myapp.AboutUsTabView=a})(window.myapp.Widget.Scroller);(function(d,a,o){var k=['<div class="HeaderPanel"><div></div><div>','<img src="'+a.JashamiLogo+'">','</div><div></div></div><div class="TabPanel"><div class="TabContent"></div><div class="TabHeader">','<div class="TabButton"><a href="#startPage/orderTab">'+d._("orderTab")+"</a></div>",'<div class="TabButton"><a href="#startPage/historyTab">'+d._("historyTab")+"</a></div>",'<div class="TabButton"><a href="#startPage/feedbackTab">'+d._("feedbackTab")+"</a></div>",'<div class="TabButton"><a href="#startPage/aboutUsTab">'+
d._("aboutUsTab")+"</a></div>","</div></div>"].join(""),d=Backbone.View.extend({initialize:function(){this.tabs={};$(this.el).html(_.template(k));$(this.el).addClass("Base");$(this.el).attr("id","startPageView");$(this.el).attr("style","height:100%; width:100%;")},render:function(){return this},toTab:function(a){this.tabs[a]||(this.tabs[a]=new o[a]);$(".TabContent",this.el).html(this.tabs[a].render().el)}});window.myapp=window.myapp||{};window.myapp.StartPageView=d})(i18n,window.myapp.Images,{orderTab:window.myapp.OrderTabView,
historyTab:window.myapp.HistoryTabView,feedbackTab:window.myapp.FeedbackTabView,aboutUsTab:window.myapp.AboutUsTabView});(function(d,a,o){var k=['<div class="HeaderPanel"><div><div class="HeaderButton BackButton"><span class="Pointer"></span><span class="Button">返回</span></div></div><div id="storeName"></div><div></div></div><div id="storeContent" style="-webkit-box-flex: 10;display: -webkit-box;-webkit-box-orient: vertical;-webkit-box-pack: justify;"></div><div class="ShoppingCar"><div style="position: relative; " class="Car"><div style="position: absolute; overflow-x: hidden; overflow-y: hidden; top: 0%; right: 0%; bottom: 0%; width: 25%; "><div class="Button" style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; ">',
'<div><img src="'+d.ShoppingCarIcon+'"></div><div class="ButtonText">查看</div>','</div></div><div style="position: absolute; overflow-x: hidden; overflow-y: hidden; left: 0%; top: 0%; right: 25%; height: 50%; "><div class="ProgressBarPanel" style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; "><div class="ProgressMsgOk">可外送</div><div style="" class="ProgressMsgNotOk">未達額度</div><div class="ProgressBar"><div class="Progress"></div></div><div class="gwt-Label">0/800</div></div></div><div style="position: absolute; overflow-x: hidden; overflow-y: hidden; left: 0%; top: 50%; bottom: 0%; width: 30%; "><div class="gwt-Label" style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; ">總共$</div></div><div style="position: absolute; overflow-x: hidden; overflow-y: hidden; left: 30%; top: 50%; right: 25%; bottom: 0%; "><div class="gwt-Label" style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; ">0元</div></div></div></div>'].join(""),
d=Backbone.View.extend({initialize:function(){$(this.el).addClass("Base");$(this.el).attr("style","height:100%");$(this.el).attr("style","width:100%");this.scroller=new o;$(this.scroller.el).css("background-color","rgba(255, 255, 255, 0.75)");$(this.scroller.el).css("display","-webkit-box");$(this.scroller.el).css("width","100%");$(this.scroller.el).css("-webkit-box-flex","1");$(this.el).html(_.template(k));$("#storeContent",this.el).html(this.scroller.render().el);this.backBtn=new a({el:$(".BackButton",
this.el)});this.backBtn.changeColorWhenTouch=!0},setModel:function(a){this.model=a;var d=this,a=this.model.get("_displayedName");$("#storeName",this.el).html(a);this.scroller.getContent().empty();a=this.model.get("_menuId").get("products").models;_.each(a,function(a){var e=document.createElement("div");e.style["float"]="left";var f=a.get("_imgUrl"),g=a.get("_displayedName"),a=a.get("_price");f?(e.style.width="142px",e.style.height="218px",$(e).html(_.template('<div class="ProductBoxWidget2"><img class="ProductBoxWidget2-img" src="<%= img %>"/><div class="ProductBoxWidget2-info"><div class="ProductBoxWidget2-name"><%= name %></div><div class="ProductBoxWidget2-price"><%= price %></div></div></div>',
{img:f,name:g,price:a}))):(e.style.width="142px",e.style.height="106px",$(e).html(_.template('<div class="ProductBoxWidget2"><div class="ProductBoxWidget2-infoNoImg"><div class="ProductBoxWidget2-name"><%= name %></div><div class="ProductBoxWidget2-price"><%= price %></div></div></div>',{name:g,price:a})));d.scroller.getContent().append(e)})},render:function(){this.backBtn.delegateEvents();this.scroller.render();return this}});window.myapp=window.myapp||{};window.myapp.StorePageView=d})(window.myapp.Images,
window.myapp.Widget.TouchWidget,window.myapp.Widget.Scroller);(function(d,a){var o=Backbone.Router.extend({routes:{"startPage/:tab":"startPage","storePage/:store":"storePage","*actions":"defaultAction"},initialize:function(){var a=this;this.views={};this.firstPage=this.useTransitionEffect=!0;this.isGoBack=!1;$(".BackButton").live("clickByTouch",function(){a.isGoBack=!0;window.history.back()})},defaultAction:function(){this.startPage("orderTab")},startPage:function(d){this.views.startPage||(this.views.startPage=new a.StartPageView);$("#startPageView").length&&
(this.firstPage=!0);this.views.startPage.toTab(d);this.changePage(this.views.startPage.render().el)},storePage:function(k){this.views.storePage||(this.views.storePage=new a.StorePageView);if(window.menuData)this.views.storePage.setModel(window.menuData.get("stores").get(k)),this.changePage(this.views.storePage.render().el);else{var g=this;window.menuData=new d;window.menuData.fetch({success:function(){g.views.storePage.setModel(window.menuData.get("stores").get(k));g.changePage(g.views.storePage.render().el)}})}},
changePage:function(a){if(!this.useTransitionEffect||this.firstPage)$(".ActivePage").html(a),this.firstPage=!1;else{var d=$(".ActivePage").children(),l=$(a);d.addClass("transitionSlide transitionOut");l.addClass("transitionSlide transitionIn");this.isGoBack&&(d.addClass("reverse"),l.addClass("reverse"));$(".ActivePage").append(a);this.isGoBack?d.bind("webkitTransitionEnd",function(){d.unbind();d.removeClass("transitionSlide transitionOut reverse transitionStart");l.removeClass("transitionSlide transitionIn reverse transitionStart");
d.remove()}):l.bind("webkitTransitionEnd",function(){l.unbind();d.removeClass("transitionSlide transitionOut reverse transitionStart");l.removeClass("transitionSlide transitionIn reverse transitionStart");d.remove()});setTimeout(function(){d.addClass("transitionStart");l.addClass("transitionStart")},10);this.isGoBack=!1}}});window.myapp=window.myapp||{};window.myapp.Router=o})(window.myapp.Model.MenuData,{StartPageView:window.myapp.StartPageView,StorePageView:window.myapp.StorePageView});
