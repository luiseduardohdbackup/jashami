(function(){if("undefined"!=typeof window.localStorage){LS=window.localStorage;var e={set:function(a,b){!a||1>a.length?console.log("local storage error: (set) key is null"):LS.setItem(a,b)},get:function(a){return LS.getItem(a)},remove:function(a){LS.removeItem(a)},clear:function(){LS.clear()},getLength:function(){return LS.length},key:function(a){return 0<=a&&a<this.getLength()?LS.key(a):null},clearWithPrefix:function(a){for(var b=[],c=0,g=this.getLength();c<g;c++){var f=this.key(c);0==f.indexOf(a)&&
b.push(f)}c=0;for(g=b.length;c<g;c++)this.remove(b[c])}};e.get("appID")||e.set("appID","@APPID@"+(new Date).getTime()+"."+Math.random());e.getMenuLastUpdateTime=function(a){return this.get("MenuLastUpdateTime"+(a?"_EditMode":""))};e.setMenuLastUpdateTime=function(a,b){this.set("MenuLastUpdateTime"+(b?"_EditMode":""),a.getTime())};e.getAppId=function(){return this.get("appID")};e.setPhoneUUID=function(a){this.set("phoneUUID",a)};e.getPhoneUUID=function(){return this.get("phoneUUID")};e.getUUID=function(){var a=
this.get("phoneUUID");return a?a:this.getAppId()};window.myapp=window.myapp||{};window.myapp.LocalModel=e}})();window.languages=window.languages||{};window.languages["zh-tw"]={setting:{DST:8,format:"Y 年 m 月 d 日 (D) H:i:s",AM:"上午",PM:"下午"},shortMonths:"1 月,2 月,3 月,4 月,5 月,6 月,7 月,8 月,9 月,10 月,11 月,12 月".split(","),longMonths:"一月,二月,三月,四月,五月,六月,七月,八月,九月,十月,十一月,十二月".split(","),shortDays:"日,一,二,三,四,五,六".split(","),longDays:"星期日,星期一,星期二,星期三,星期四,星期五,星期六".split(","),orderTab:"點餐",historyTab:"紀錄",feedbackTab:"意見",aboutUsTab:"關於","Hello World":"哈囉! 世界","Nice to meet you, %1":"很高興認識你，%1","My name is %1, I'm %2 years old":"我的名字是 %1，我今年 %2 歲"};var supportedLang="zh-tw",defaultLang="zh-tw",language=window.navigator.userLanguage||window.navigator.language||defaultLang,language=language.toLowerCase();0>supportedLang.indexOf(language)&&(language=defaultLang);i18n.set(window.languages[language]);
myapp.PG.Event.onDeviceReady(function(){console.log("phonegap load");window.phonegapEnabled=!0;myapp.LocalModel&&myapp.LocalModel.setPhoneUUID(myapp.PG.Device.getUUID());myapp.PG.Device.overrideBackButton();myapp.PG.Event.onBackKeyDown(function(){});$(window).trigger("useNative",!0)});$(document).ready(function(){$("#backgroundLogo").remove();window.app_router=new myapp.Router;Backbone.history.start()});(function(){window.myapp=window.myapp||{};window.myapp.Settings={OnMoveEventThreshold:10,LocalMenuDataFileName:"menuData.txt",StoreBriefHmargin:10,getStoreBriefWidth:function(e){var e=e-this.StoreBriefHmargin,a=Math.floor(e/400)+1;return(e-this.StoreBriefHmargin*(a-1))/a}};window.myapp.Api=window.myapp.Api||{};window.myapp.Api.BasicUrl="http://api2.majashami.appspot.com/api/";window.myapp.Api.MenuServiceUrl=window.myapp.Api.BasicUrl+"MenuService";window.myapp.Api.OrderServiceUrl=window.myapp.Api.BasicUrl+
"OrderService"})();(function(){var e={getAbsoluteLeft:function(a){for(var b=0,c=a;c.offsetParent;)b-=e.getTranslateX(c),b-=c.scrollLeft,c=c.parentNode;for(;a;)b+=a.offsetLeft,a=a.offsetParent;return b},getAbsoluteTop:function(a){for(var b=0,c=a;c.offsetParent;)b-=e.getTranslateY(c),b-=c.scrollTop,c=c.parentNode;for(;a;)b+=a.offsetTop,a=a.offsetParent;return b},getTranslateX:function(a){var b=0;if((a=a.style.webkitTransform)&&""!==a)(a=/translate(3d)?\((\-?.*)px, (\-?.*)px, (\-?.*)px\)( scale\((\d)\))?/.exec(a))&&(b=
-parseInt(a[2]));return b},getTranslateY:function(a){var b=0;if((a=a.style.webkitTransform)&&""!==a)(a=/translate(3d)?\((\-?.*)px, (\-?.*)px, (\-?.*)px\)( scale\((\d)\))?/.exec(a))&&(b=-parseInt(a[3]));return b},StringEndsWith:function(a,b){return-1!==a.indexOf(b,a.length-b.length)},getDistanceFromLatLng:function(a,b,c,g){var a=(f-c)*Math.PI/180,g=(lng2-g)*Math.PI/180,c=c*Math.PI/180,f=f*Math.PI/180,c=Math.sin(a/2)*Math.sin(a/2)+Math.sin(g/2)*Math.sin(g/2)*Math.cos(c)*Math.cos(f);return 6371*2*Math.atan2(Math.sqrt(c),
Math.sqrt(1-c))},DeviceType:{Other:1,Android:2,iPhone:3,iPod:4,iPad:5}};e.DeviceType.getDeviceType=function(){var a=window.navigator.userAgent.toLocaleLowerCase();return 0<=a.indexOf("android")?this.Android:0<=a.indexOf("ipod")?this.iPod:0<=a.indexOf("ipad")?this.iPad:0<=a.indexOf("iphone")?this.iPhone:this.Others};window.myapp=window.myapp||{};window.myapp.Utils=e})();(function(){var e="台北市,基隆市,新北市,宜蘭縣,新竹市,新竹縣,桃園縣,苗栗縣,台中市,彰化縣,南投縣,嘉義市,嘉義縣,雲林縣,台南市,高雄市,屏東縣,台東縣,花蓮縣".split(","),a=[];a["請選擇縣市"]=[];a["台北市"]="中正區,100 大同區,103 中山區,104 松山區,105 大安區,106 萬華區,108 信義區,110 士林區,111 北投區,112 內湖區,114 南港區,115 文山區,116".split(" ");a["基隆市"]="仁愛區,200 信義區,201 中正區,202 中山區,203 安樂區,204 暖暖區,205 七堵區,206".split(" ");a["新北市"]="萬里區,207 金山區,208 板橋區,220 汐止區,221 深坑區,222 石碇區,223 瑞芳區,224 平溪區,226 雙溪區,227 貢寮區,228 新店區,231 坪林區,232 烏來區,233 永和區,234 中和區,235 土城區,236 三峽區,237 樹林區,238 鶯歌區,239 三重區,241 新莊區,242 泰山區,243 林口區,244 蘆洲區,247 五股區,248 八里區,249 淡水區,251 三芝區,252 石門區,253".split(" ");
a["宜蘭縣"]="宜蘭市,260 頭城鎮,261 礁溪鄉,262 壯圍鄉,263 員山鄉,264 羅東鎮,265 三星鄉,266 大同鄉,267 五結鄉,268 冬山鄉,269 蘇澳鎮,270 南澳鄉,272".split(" ");a["新竹市"]=["北區,300","東區,300","香山區,300"];a["新竹縣"]="竹北市,302 湖口鄉,303 新豐鄉,304 新埔鎮,305 關西鎮,306 芎林鄉,307 寶山鄉,308 竹東鎮,310 五峰鄉,311 橫山鄉,312 尖石鄉,313 北埔鄉,314 峨眉鄉,315".split(" ");a["桃園縣"]="中壢市,320 平鎮市,324 龍潭鄉,325 楊梅鎮,326 新屋鄉,327 觀音鄉,328 桃園市,330 龜山鄉,333 八德市,334 大溪鎮,335 復興鄉,336 大園鄉,337 蘆竹鄉,338".split(" ");a["苗栗縣"]="竹南鎮,350 頭份鎮,351 三灣鄉,352 南庄鄉,353 獅潭鄉,354 後龍鎮,356 通霄鎮,357 苑裡鎮,358 苗栗市,360 造橋鄉,361 頭屋鄉,362 公館鄉,363 大湖鄉,364 泰安鄉,365 銅鑼鄉,366 三義鄉,367 西湖鄉,368 卓蘭鎮,369".split(" ");
a["台中市"]="中區,400 東區,401 南區,402 西區,403 北區,404 北屯區,406 西屯區,407 南屯區,408 太平區,411 大里區,412 霧峰區,413 烏日區,414 豐原區,420 后里區,421 石岡區,422 東勢區,423 和平區,424 新社區,426 潭子區,427 大雅區,428 神岡區,429 大肚區,432 沙鹿區,433 龍井區,434 梧棲區,435 清水區,436 大甲區,437 外埔區,438 大安區,439".split(" ");a["彰化縣"]="彰化市,500 芬園鄉,502 花壇鄉,503 秀水鄉,504 鹿港鎮,505 福興鄉,506 線西鄉,507 和美鎮,508 伸港鄉,509 員林鎮,510 社頭鄉,511 永靖鄉,512 埔心鄉,513 溪湖鎮,514 大村鄉,515 埔鹽鄉,516 田中鎮,520 北斗鎮,521 田尾鄉,522 埤頭鄉,523 溪州鄉,524 竹塘鄉,525 二林鎮,526 大城鄉,527 芳苑鄉,528 二水鄉,530".split(" ");a["南投縣"]="南投市,540 中寮鄉,541 草屯鎮,542 國姓鄉,544 埔里鎮,545 仁愛鄉,546 名間鄉,551 集集鎮,552 水里鄉,553 魚池鄉,555 信義鄉,556 竹山鎮,557 鹿谷鄉,558".split(" ");
a["嘉義市"]=["西區,600","東區,600"];a["嘉義縣"]="番路鄉,602 梅山鄉,603 竹崎鄉,604 阿里山鄉,605 中埔鄉,606 大埔鄉,607 水上鄉,608 鹿草鄉,611 太保市,612 朴子市,613 東石鄉,614 六腳鄉,615 新港鄉,616 民雄鄉,621 大林鎮,622 溪口鄉,623 義竹鄉,624 布袋鎮,625".split(" ");a["雲林縣"]="斗南鎮,630 大埤鄉,631 虎尾鎮,632 土庫鎮,633 褒忠鄉,634 東勢鄉,635 台西鄉,636 崙背鄉,637 麥寮鄉,638 斗六市,640 林內鄉,643 古坑鄉,646 莿桐鄉,647 西螺鎮,648 二崙鄉,649 北港鎮,651 水林鄉,652 口湖鄉,653 四湖鄉,654 元長鄉,655".split(" ");a["台南市"]="中西區,700 東區,701 南區,702 北區,704 安平區,708 安南區,709 永康區,710 歸仁區,711 新化區,712 左鎮區,713 玉井區,714 楠西區,715 南化區,716 仁德區,717 關廟區,718 龍崎區,719 官田區,720 麻豆區,721 佳里區,722 西港區,723 七股區,724 將軍區,725 學甲區,726 北門區,727 新營區,730 後壁區,731 白河區,732 東山區,733 六甲區,734 下營區,735 柳營區,736 鹽水區,737 善化區,741 大內區,742 山上區,743 新市區,744 安定區,745".split(" ");
a["高雄市"]="新興區,800 前金區,801 苓雅區,802 鹽埕區,803 鼓山區,804 旗津區,805 前鎮區,806 三民區,807 楠梓區,811 小港區,812 左營區,813 仁武區,814 大社區,815 岡山區,820 路竹區,821 阿蓮區,822 田寮區,823 燕巢區,824 橋頭區,825 梓官區,826 彌陀區,827 永安區,828 湖內區,829 鳳山區,830 大寮區,831 林園區,832 鳥松區,833 大樹區,840 旗山區,842 美濃區,843 六龜區,844 內門區,845 杉林區,846 甲仙區,847 桃源區,848 那瑪夏區,849 茂林區,851 茄萣區,852".split(" ");a["屏東縣"]="屏東市,900 三地門鄉,901 霧台鄉,902 瑪家鄉,903 九如鄉,904 里港鄉,905 高樹鄉,906 鹽埔鄉,907 長治鄉,908 麟洛鄉,909 竹田鄉,911 內埔鄉,912 萬丹鄉,913 潮州鎮,920 泰武鄉,921 來義鄉,922 萬巒鄉,923 崁頂鄉,924 新埤鄉,925 南州鄉,926 林邊鄉,927 東港鎮,928 佳冬鄉,931 新園鄉,932 枋寮鄉,940 枋山鄉,941 春日鄉,942 獅子鄉,943 車城鄉,944 牡丹鄉,945 恆春鎮,946 滿州鄉,947".split(" ");
a["台東縣"]="台東市,950 延平鄉,953 卑南鄉,954 鹿野鄉,955 關山鎮,956 海端鄉,957 池上鄉,958 東河鄉,959 成功鎮,961 長濱鄉,962 太麻里鄉,963 金峰鄉,964 大武鄉,965 達仁鄉,966".split(" ");a["花蓮縣"]="花蓮市,970 新城鄉,971 秀林鄉,972 吉安鄉,973 壽豐鄉,974 鳳林鎮,975 光復鄉,976 豐濱鄉,977 瑞穗鄉,978 萬榮鄉,979 玉里鎮,981 卓溪鄉,982 富里鄉,983".split(" ");var b={address2zipcode:function(b){var g=b.substring(0,3),b=b.substring(3),g=a[g];if(!g)return null;for(var f=0,d=g.length;f<d;f++)if(0<=g[f].indexOf(b))return g[f].split(",")[1];return null},zipcode2address:function(b){for(var g=0,f=e.length;g<
f;g++)for(var d=e[g],k=0,h=a[d].length;k<h;k++)if(0<=a[d][k].indexOf(b))return d+a[d][k].split(",")[0];return null}};window.addressAndZipcode=window.addressAndZipcode||b;window.addressAndZipcode.Countries=e;window.addressAndZipcode.Areas=a})();(function(e){var a=Backbone.Model.extend({Single:"singleOption",Multiple:"multipleOption",parse:function(d){this.clear();this.set("title",d.substring(0,d.indexOf("?")));this.set("values",d.substring(d.indexOf("?")+1).split("&"));this.set("type",a.Single)}}),b=Backbone.Collection.extend({parse:function(d){this.models=[];var b=this,d=d.split("|");_.each(d,function(d){var f=new a;f.parse(d);b.add(f)})}}),c=Backbone.RelationalModel.extend({idAttribute:"productNameId"}),g=Backbone.RelationalModel.extend({idAttribute:"menuId",
relations:[{type:Backbone.HasMany,key:"products",relatedModel:c,reverseRelation:{key:"menu",includeInJSON:"menuId"}}]}),f=Backbone.RelationalModel.extend({defaults:{deliveryLimit:99999,deliveryFee:99999,lat:99999,lng:99999},idAttribute:"storeNameId",relations:[{type:Backbone.HasOne,key:"menuId",relatedModel:g,reverseRelation:{key:"store",includeInJSON:"storeNameId"}}]}),d=Backbone.RelationalModel.extend({idAttribute:"zipCode",relations:[{type:Backbone.HasMany,key:"stores",relatedModel:f}]}),d=Backbone.RelationalModel.extend({_getMenuFromServer:function(a,
d,b){var f=this,g=e.MenuServiceUrl+"?action=getMenuByZipcode&zipCode="+a+"&isEditMode="+this.isEditMode;window.loadingPanel&&window.loadingPanel.connectionOut();$.ajax({type:"GET",url:g,dataType:"json",success:function(b){window.loadingPanel&&window.loadingPanel.connectionIn();f.get("zipCodeIndexs").add(b.zipCodeIndexs);f.get("stores").add(b.stores);f.get("menus").add(b.menus);d&&(b=f.get("zipCodeIndexs").get(a),d(b))},error:function(a,d){window.loadingPanel&&window.loadingPanel.connectionIn();console.log("_getMenuFromServer: Ajax error!");
b&&b(a,d)}})},getMenuByZipCode:function(a,d,b){var f=this.get("zipCodeIndexs").get(a);f?d&&d(f):this._getMenuFromServer(a,d,b)},setEditMode:function(a){this.isEditMode=a},relations:[{type:Backbone.HasMany,key:"stores",relatedModel:f},{type:Backbone.HasMany,key:"menus",relatedModel:g},{type:Backbone.HasMany,key:"zipCodeIndexs",relatedModel:d}]});window.myapp=window.myapp||{};window.myapp.Model=window.myapp.Model||{};window.myapp.Model.ProductOptionList=b;window.myapp.Model.Product=c;window.myapp.Model.Menu=
g;window.myapp.Model.Store=f;window.myapp.Model.MenuData=d})(window.myapp.Api);(function(e){var a=Backbone.Model.extend({idAttribute:"orderID"}),b=Backbone.Collection.extend({model:a,url:"http://api.majashami.appspot.com/api/OrderService?action=getOrderHistory&phoneId=864071458d0d76c9ffcd8542dbdf6be5f57e674f",setAPI:function(a,b){this.url=e.OrderServiceUrl+"?action="+a+"&";if(b&&0<Object.keys(b).length)for(key in b)this.url+=key+"="+b[key]+"&";this.url=this.url.substring(0,this.url.length-1)}});window.myapp=window.myapp||{};window.myapp.Model=window.myapp.Model||{};window.myapp.Model.Order=
a;window.myapp.Model.OrderHistory=b})(window.myapp.Api);(function(){var e=Backbone.Model.extend({}),a=Backbone.Collection.extend({model:e}),b=Backbone.Model.extend({defaults:{deliveryLimit:0,amount:0,sum:0,buyList:new a},idAttribute:"storeNameId",initialize:function(){this.set("buyList",new a);this.updateDisplay()},updateDisplay:function(){for(var a=this.get("buyList"),b=0,d=0,c=0,h=a.length;c<h;c++)var e=a.at(c),b=b+e.get("singlePrice")*e.get("amount"),d=d+e.get("amount");this.set("amount",d);this.set("sum",b);window.shoppingCartPanel&&window.shoppingCartPanel.resetDisplayedData&&
window.shoppingCartPanel.resetDisplayedData(this);window.orderInfoPage&&window.orderInfoPage.resetDisplayedData&&window.orderInfoPage.resetDisplayedData()},addBuyItem:function(a,b){this.get("buyList").push(a);(!b||!b.slient)&&this.updateDisplay()},removeBuyItem:function(a,b){this.get("buyList").remove(a);(!b||!b.slient)&&this.updateDisplay()},updateBuyItem:function(a,b){this.get("buyList").remove(a);this.get("buyList").push(a);(!b||!b.slient)&&this.updateDisplay()},clearBuyList:function(a){this.set("amount",
0);this.set("sum",0);this.get("buyList").reset();(!a||!a.slient)&&this.updateDisplay()}}),c=Backbone.Collection.extend({model:b});window.myapp=window.myapp||{};window.myapp.Model=window.myapp.Model||{};window.myapp.Model.BuyItem=e;window.myapp.Model.ShoppingCart=b;window.myapp.Model.ShoppingCartCollection=c})();window.myapp=window.myapp||{};
window.myapp.Images={JashamiIcon:"data:image/png;base64,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",SearchIcon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsSAAALEgHS3X78AAABiElEQVRYhe2X0XHCMAyGP/X6zgjJBmEENmg3CJ2kIzBC2ABGaCfgOgHtBNAJxEPSKziOLZtA6R3/ne5CIjufJMcWoqrckh7+GsDVHSimO1BMj6kDRKQGZkDpPHoDlqr6dRaRqpoMeAK2gEasASbWeXvvMcI0BpBj2wFVDpDENkYRaYC5c/sTWAP77vcUeHZ89sBMVT9MpfqRoUxu5PWAbwGsHP/NqCXjdM2YykC/vN4AkoGAOndiJ5DtWEBN9qT9YArr2NDGWB5dr5MWZt+/9Dn5ZN2p93GXX6nqd4r/sW7u6LACTVMmFZEqg6VVYGG+krkwcT79sb6ywgFaGWEqZ1wzCpAv0tjkHcwuN7MWoInnBVvafWbigAwdwONlKBB1qpmhrIu0AjbXgDKnsgOrGW7Sdl3ZinPKF+2HfBKRAuc4UNV3x6eh30dB2+a+DE6ekqFUC2RqMTTmokdHl4ml51EZGnRx4zRTGwJ/ArLWUI5EZEGbmbkGuoGrAVn1b9uPq+kOFNPNAR0ABtsGMJi+0FcAAAAASUVORK5CYII=",
FileIcon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsSAAALEgHS3X78AAAAiElEQVRYhe3WUQqAIBREUSfaV0t1qdNPQUQxT0UzmAvvT+wQaIFkmqnla8A9g1QGqUIgAIzMsTY3iUjKSSkxMpe1ObLv47M6gapRPUFVqN6gYtQIUBFqLT8G7wHYSKJpj8jH9TzSLUWh/7wYR2aQyiCVQSqDVAapDFIZpAr9oI1sujdkkMog1Q6UA6fKYLmsrwAAAABJRU5ErkJggg==",CommentsIcon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsSAAALEgHS3X78AAAAwElEQVRYhe2WwQ3CMAxFvxH3bsYOTAYzsEDZ7HMKhyiOSRqTIPykXCo5fsqv0wpJrMRptkBOCFmEkAnJ4gKwAdgBcPDaAWxq34qQh8xbSusr2j0kIq4XFEkpPT9/WH/p7PtoLVjupf67yHLMCCOyxLcia56qnIgsMWPKuuKLyBJaZLUTevqoGHv/zP+QIllqcGvZw+xxUGiozFGh4TIku8f+TvLaWVulR8hNBmgXcpUBKhfjLJb7dISQRQhZLCf0AkEfDIfb4gvwAAAAAElFTkSuQmCC",
ShoppingCarIcon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAA6RwvCAAAEfUlEQVR42u1Xa0ybVRgeWebITJwzmrm4sOhmsqnjDzHYBEmlugKVJaAkg8CuLXRLGAT7C5M120S2GmsiRmRqolspCmSAW0eWbayZvQgMLaUX29qPFiUQCAPC/e7zLqfJScMPoHXxB1/ypOd7zvnOec9776ZNG8/G8z94ZmZm3l9eXj4JHOMgB8RAzBMRQqPRvLqwsPAQBwaBfzg8An4Ctj4RQerr67NxWM/s7OwnRUVFHxYWFj6GUqk8olAo3lzxI6lUuislJWVvUlLSK9EA7WU0Gq9AEJdcLj+wKslJRUATYAE6gE4O7cADNtcZBlL7r4CJjXm+DfgT0GdkZGxbiyBGwDE8PKw3mUzXQnC73dfBO4eGhkw8T7BYLDWLi4t2+EGH2WzWhXir1XoN3E18JxgMBvWqbUneC1yiA3U63W5+TiwWvwjeptfrNSt9OzU19RD4KpyfmJg4SoI0NzfL1uRYfr8/ixyrtbW1VCQSHUxMTIwnlJWVSUj92Pjn4uLix1xovqGhIX1packOQb5OTk4+GOIlEkk8uKvQVmd5efnONQmSnZ39Gg40A14gAPQy0NjOEOR4ggD8znwhnPfMzc39gK3XlisKCgq24eNaOtDn833R3t5+ntDb23sR3D3gN6/X+xnjL9DvyMjId+RXWP9jiIePnO/v778K3m+32wvXFfddXV1qMk9qamo8z9tsNi1FQVpa2gs8D7/5gBIU1ot43ul0ltE+6enpiesSpKmpSUqmwY0u45ZSaECGTSUUSXRz8KfBHyIeeG98fPxLtv4jevd4PGmIrsPgbgMtOTk5z69LEPjJc8iC5CduUi3disHFfMHLcQQn8Afg4zga/+VwODSRZOUYRMf32Kh7dHT0Y5jqFGFsbOxzEg5RoIXdTwCKYDCoAHeLfCcQCKhoXXd390ms+ZYctba2Njei+gBPp8ooYCNxiENueYtuSrkhLP/UAIaEhIQtXP7QkKYaGxv3RiRISUmJiG4PLeigXjlQgPE50hJuewWZVkEcNHKWZeM7iKwzxLlcrjPIqGbkkEZstTkiQWQy2Q5s/gsr1yG7+5nf+MJ8xMNyiMC9++bn51VRKd9arXYfasch1Ix3VwtEzNsQ4hsSqrS09J2oCILeYatKpXqaktxqoFarY6urq7dDCEpklqysrD0RC4HYFzHbU0QYGKiStrAMe5ehZYV5L0Ud0sDmiAXJzMx8g/UeXuYbAhtbWXtXD9Sxdw+bF9jYiGp7OCpmodtgQ6oh7r6+vqLBwcHjrFm6AXO9jOr6DFS/C03xPVTeNkEQjvb09JRg7Jienq6OWp+JQ3Yz0+hDHMKSao0Tndbr9I7yv5+y7eTk5DmuL7kOQdowjI2KILm5uRS+N6gHyc/PP4DeYufAwAB1aR15eXn7aE1VVdVL0IANh9fExcXtqKys3I/8QaZqwfSWqGkFqlay3sPK+tW/wX3KJakY1KQKtsbIfCpQV1d3Kqp/A9AexsIHill03IfKy8E9y6+pqKggzV1ggrQCSvjXUxt/KTee/+L5FwmS/gs/m0cyAAAAAElFTkSuQmCC",
ArrowDownIcon1:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAKCAYAAABi8KSDAAABMElEQVR42mPw5eZYZs3GulCNlXWBKiszFsy6QIeVdaE7F9t8hnQx/o5wXo53ruysX+3ZgJgdE/tys32N4+PYw1Dv4MDRYWa0p1pT+X+WGP//NGG+/+kifP/TQFiY93+hjNj/Gg2l/8syUsMYQGC6r6fTZC/Xn00G2v9LJIX/FwE1FYkL/q9UlPnfbWvxv8fRdv/++noWsOL6+nqmSb4eK7vtrf5XKsv+zwcqLpYS+d9kqP1/kpfr9157a0cGZDDF1117kqfL1xZjPbDCShW5/z0O1v8n+7kvZMAGJvt5Tuhzsvtfq6X6v9VE7/9kb5fPU7yc1bAqnurvJjvFx+PRJHeX/5O93P5P8nXvYMAHZoYFFq7Izvi/MCnuwSRPT1G8iqeGhvJsrK06tTInMwNdDgB0FHcbmF0FFQAAAABJRU5ErkJggg==",
ArrowDownIcon2:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAADS0lEQVR42sWYX0gTcRzAD3wNAnGXc7fbdpvN9k+DMqg9BNmTQQzspZeC6EHQHqLHXnpK+ud09jBaZflnS8pEs8kklUan5yaSJEkPURBkkGhRgWV8+31vTXLN2/1um/7gwx3c/b7fD/f73f1+32MYyiY6udKkWziZqLYGEx6bNO2xJhMe6xqSOrdJeA3vwXuZYjXJZfVNu4UYASiJYd+CiYgOS+2UyyJOugTIB4yBsTSL9J1gSuJOs58ABcaPsalkRgVh57jDFCVAkSCxdTtUy8T28PMEKDLzmEt5mBimJFpljBJgi4hizk2Fhuycf9DOwVaCObPK9O/mvf2VHGwLJPd/QuFKQzxiM8B2gLk3yHRb9b5uoQIyeVTrgVHfsYLx5IgXsuWRIQ7rQp2WcrHToodMHh7aB7++f4NCtckL5yBbnhTloiwTFPR8yLwLNuNVR1tBZD7PJEApD4IuTNDMNgZNLGzGXYcVfnxazFtouOE4KOWRIS5Mh5HtucmzoMTE+ea8ZN4ODUCuHAi6MAFeN9vO6yAXi8mEJhmcg50HakBNDnRhWjl2qZXTQS4e1B+F32tr1ELS1RZQEz8Fu8Tc4MpWCaCG+Z77VDJf3r+DNvJKq42PLsx1Q9kqAdQQqq2m+gzEmhtBbey/yEJLNJ2mrlxWJfMxOU0rg8hDNkvxSOUhwKFQajjXwvV1NEOVhkxqgy6iftKleHrmlKLQ654uoI2J+Dny2rcb2UY1r2QmH8afZZVZXV6GWzV20BITXeSlQ81HK5PI4YMAWT4DM9daQEs8RF465PXMxIo5P+tZeBPu2iDzlcytkI0DLbHQYX21v21ifXfI4kZL714H/FxZXhcaP3satMRB0GHDnuieoI8TgJaZSxdlmcWJMdDSXya99fi39Qp6b9haAbRE7EZYmXsJ0TovaOmPYO7sVYeNC/SRLSUtg/vdoKVfCi6gWAY9rjTEBsjGeyvAXIplULpQHK7iF4ZJ3VRc+IWchWK6jTi5UlJZxopYtcZGaH/V4KMkNXhgjNTihQRj5hwmpRZ3CN7nTrNEgDyRMFbB/hO9cFoaRJdZJAAlIvYt2p+0pEPgJbelSfIIIcktJMlxlhxBJnWeTF2zNOG9tPH/APf5IS28jA2hAAAAAElFTkSuQmCC"};(function(){var e=Backbone.View.extend({initialize:function(){this._isEnabled=!0;this._clickStart=!1;this._lastY=this._lastX=null},events:{mouseout:"onMouseOut",mousedown:"mouseDown",touchstart:"touchStart",touchmove:"touchMove",mouseup:"mouseUp",touchend:"touchEnd"},onMouseOut:function(){this._clickStart=!1;$(this.el).removeClass("active")},mouseDown:function(a){this.start(a.clientX,a.clientY)},touchStart:function(a){this.start(a.changedTouches[0].pageX,a.changedTouches[0].pageY)},touchMove:function(){},
mouseUp:function(a){this.end(a.clientX,a.clientY)},touchEnd:function(a){this.end(a.changedTouches[0].pageX,a.changedTouches[0].pageY)},start:function(a,b){this._isEnabled&&null!=a&&null!=b&&(this._lastX=a,this._lastY=b,this._clickStart=!0,$(this.el).addClass("active"))},end:function(a,b){this._isEnabled&&null!=a&&null!=b&&(this._lastY=this._lastX=null,this._clickStart=!1,$(this.el).removeClass("active"))}});window.myapp=window.myapp||{};window.myapp.Widget=window.myapp.Widget||{};window.myapp.Widget.TouchWidget=
e})();(function(e){var a=Backbone.View.extend({initialize:function(){this.container=document.createElement("div");this.content=document.createElement("div");this.container.appendChild(this.content);this.el=this.container;$(this.el).addClass("scroller");$(this.el).css("-webkit-box-flex","1");this.container.style.overflow="hidden";this.content.style.width="100%";this.scroll=new e(this.container,{hScrollbar:!1,vScrollbar:!1})},html:function(a){$(this.content).html(a)},getContent:function(){return $(this.content)},
setPullToRefresh:function(a){var c={pullDownOffset:30,pullUpOffset:30};for(i in a)c[i]=a[i];pullDownEl=c.pullDownEl;pullUpEl=c.pullUpEl;pullDownOffset=c.pullDownOffset;pullUpOffset=c.pullUpOffset;pullUpAction=c.pullUpAction;pullDownAction=c.pullDownAction;pullDownEl&&pullDownEl.html('<span class="pullDownIcon"></span><span class="pullDownLabel">Pull down to refresh...</span>');pullUpEl&&pullUpEl.html('<span class="pullUpIcon"></span><span class="pullUpLabel">Pull up to refresh...</span>');this.render({useTransition:!0,
topOffset:pullDownOffset,onRefresh:function(){pullDownEl&&pullDownEl.hasClass("loading")?(pullDownEl.removeClass("loading"),$(".pullDownLabel",pullDownEl).html("Pull down to refresh...")):pullUpEl&&pullUpEl.hasClass("loading")&&(pullUpEl.removeClass("loading"),$(".pullUpLabel",pullUpEl).html("Pull up to load more..."))},onScrollMove:function(){pullDownEl&&5<this.y&&!pullDownEl.hasClass("flip")?(pullDownEl.addClass("flip"),$(".pullDownLabel",pullDownEl).html("Release to refresh..."),this.minScrollY=
0):pullDownEl&&5>this.y&&pullDownEl.hasClass("flip")?(pullDownEl.removeClass("flip"),$(".pullDownLabel",pullDownEl).html("Pull down to refresh..."),this.minScrollY=-pullDownOffset):pullUpEl&&this.y<this.maxScrollY-5&&!pullUpEl.hasClass("flip")?(pullUpEl.addClass("flip"),$(".pullUpLabel",pullUpEl).html("Release to refresh..."),this.maxScrollY=this.maxScrollY):pullUpEl&&this.y>this.maxScrollY+5&&pullUpEl.hasClass("flip")&&(pullUpEl.removeClass("flip"),$(".pullUpLabel",pullUpEl).html("Pull up to load more..."),
this.maxScrollY=pullUpOffset)},onScrollEnd:function(){pullDownEl&&pullDownEl.hasClass("flip")?(pullDownEl.removeClass("flip").addClass("loading"),$(".pullDownLabel",pullDownEl).html("Loading..."),pullDownAction()):pullUpEl&&pullUpEl.hasClass("flip")&&(pullUpEl.removeClass("flip").addClass("loading"),$(".pullUpLabel",pullUpEl).html("Loading..."),pullUpAction())}})},scrollTo:function(a,c,g){g||(g=300);this.scroll.scrollTo(-a,-c,g)},scrollToElement:function(a,c){c||(c=300);this.scroll.scrollToElement(a,
c)},render:function(a){a?this.scroll.setOption(a):this.scroll.refresh("re-bind event");[].slice.call(this.content.querySelectorAll("input, select, button")).forEach(function(a){a.addEventListener("ontouchstart"in window?"touchstart":"mousedown",function(a){a.stopPropagation()})});return this}});window.myapp=window.myapp||{};window.myapp.Widget=window.myapp.Widget||{};window.myapp.Widget.Scroller=a})(iScroll);(function(e,a,b){var c=Backbone.View.extend({initialize:function(){$(this.el).html(_.template('<div class="AddressSelectionBox"><select class="country-selector"><option>請選擇縣市</option><% for(var i=0,length=countries.length; i<length; i++) { %><option value="<%= countries[i] %>"><%= countries[i] %></option><% } %></select><select class="area-selector"></select></div>',{countries:a}))},events:{"change .country-selector":"changeCountry","change .area-selector":"changeArea"},changeCountry:function(a){a=
a.currentTarget.value;$(".area-selector",this.el).html(_.template('<option>請選擇鄉鎮區</option><% for(var i=0,length=areas[index].length; i<length; i++) { %><% var area = areas[index][i].split(",")[0]; %><% var zip = areas[index][i].split(",")[1]; %><option value="<%= zip %>"><%= area %></option><% } %>',{index:a,areas:b}))},changeArea:function(a){this.$el.trigger("locationChange",a.currentTarget.value)},setSelection:function(a,f){for(var d=$(".area-selector",this.el).val(),c=a.substring(0,3),h=a.substring(3),
e=0,j=b[c].length;e<j;e++)if(0<=b[c][e].indexOf(h)){h=b[c][e].split(",")[1];break}$(".country-selector",this.el).val(c);$(".area-selector",this.el).html(_.template('<option>請選擇鄉鎮區</option><% for(var i=0,length=areas[index].length; i<length; i++) { %><% var area = areas[index][i].split(",")[0]; %><% var zip = areas[index][i].split(",")[1]; %><option value="<%= zip %>"><%= area %></option><% } %>',{index:c,areas:b}));$(".area-selector",this.el).val(h);(!f||!f.silent)&&d!=h&&this.$el.trigger("locationChange",
h)},setSelection_zipcode:function(a,b){var d=e.zipcode2address(a);null!=d&&this.setSelection(d,b)},render:function(){return this}});window.myapp=window.myapp||{};window.myapp.Widget=window.myapp.Widget||{};window.myapp.Widget.AddressSelector=c})(window.addressAndZipcode,window.addressAndZipcode.Countries,window.addressAndZipcode.Areas);(function(){var e=Backbone.View.extend({initialize:function(){$(this.el).html(_.template('<div class="DateTimeSelectionBox"><select class="date-selector"></select><select class="time-selector"></select></div>'))},events:{"change .date-selector":"dateChanged","change .time-selector":"timeChanged"},dateChanged:function(){var a=parseInt($(".date-selector",this.el).val()),a=this._sortedTimeList[new Date(a)];$(".time-selector",this.el).html(_.template('<% if(data.length>1){ %> <option>請選擇時間</option> <% } %><% for(var i=0,length=data.length; i<length; i++) { %><% var date = new Date(data[i]); %><option value="<%= date.getTime() %>"><%= i18n.formatDate(date ,"H:i") %></option><% } %>',
{data:a}))},timeChanged:function(){this.$el.trigger("dateTimeSelectionChange",this.getSelection())},setDataList:function(a){this._sortedTimeList={};$(".date-selector",this.el).empty();$(".time-selector",this.el).empty();if(a&&1==a.length)$(".date-selector",this.el).html(_.template('<% for(var i=0,length=data.length; i<length; i++) { %><% var date = new Date(data[i]), today=new Date(), text=i18n.formatDate(date, "m 月 d 日 (D)"); %><% if(today.getYear()==date.getYear()&&today.getMonth==date.getMonth&&today.getDate()==date.getDate()){text="今天";} %><option value="<%= date.getTime() %>"><%= text %></option><% } %>',
{data:a})),$(".time-selector",this.el).html(_.template('<% if(data.length>1){ %> <option>請選擇時間</option> <% } %><% for(var i=0,length=data.length; i<length; i++) { %><% var date = new Date(data[i]); %><option value="<%= date.getTime() %>"><%= i18n.formatDate(date ,"H:i") %></option><% } %>',{data:a}));else if(a&&1<a.length){var b=[a[0]],c=[a[0]];this._sortedTimeList[new Date(a[0])]=c;for(var g=0,f=a.length-1;g<f;g++){var d=a[g+1],k=new Date(a[g]),h=new Date(d);k.getYear()==h.getYear()&&k.getMonth==
h.getMonth&&k.getDate()==h.getDate()?c.push(d):(c=[],c.push(d),this._sortedTimeList[h]=c,b.push(d))}$(".date-selector",this.el).html(_.template('<% for(var i=0,length=data.length; i<length; i++) { %><% var date = new Date(data[i]), today=new Date(), text=i18n.formatDate(date, "m 月 d 日 (D)"); %><% if(today.getYear()==date.getYear()&&today.getMonth==date.getMonth&&today.getDate()==date.getDate()){text="今天";} %><option value="<%= date.getTime() %>"><%= text %></option><% } %>',{data:b}));$(".time-selector",
this.el).html(_.template('<% if(data.length>1){ %> <option>請選擇時間</option> <% } %><% for(var i=0,length=data.length; i<length; i++) { %><% var date = new Date(data[i]); %><option value="<%= date.getTime() %>"><%= i18n.formatDate(date ,"H:i") %></option><% } %>',{data:this._sortedTimeList[new Date(b[0])]}))}},getSelection:function(){var a=parseInt($(".time-selector",this.el).val());return isNaN(a)?void 0:new Date(a)},render:function(){return this}});window.myapp=window.myapp||{};window.myapp.Widget=
window.myapp.Widget||{};window.myapp.Widget.DateTimeSelector=e})();(function(e,a,b,c){b=Backbone.View.extend({initialize:function(){this._wordsInLine=8;this._saperateText="";this._isDependent=!1;var b=this;this.$el.addClass("SelectInput");this.$el.html(_.template('<div class="selectedValue"></div><div id="addr-sel-icon">▼</div>'));this.$el.on("click",function(){var f=[],d;for(d in b._selectedKey)f.add=d+"="+b._selectedKey[d];d=function(a){for(var a=a.split("&"),d=0,f=a.length;d<f;d++){var c=a[d].split("=");b._selectedKey[c[0]]=2>c.length?"":c[1]}b.updateDisplay();
b.$el.trigger("selectionChange",b.getSelectedValues())};if(a.getDeviceType()==a.iPad){var k=b.el,h=e.getAbsoluteLeft(k),l=e.getAbsoluteTop(k);c.showPicker(b._isDependent,b._pickerOptionString,f,d,[h,l,k.clientWidth,k.clientHeight])}else c.showPicker(b._isDependent,b._pickerOptionString,f,d)})},setModel:function(a,b,d){this._isDependent=b;this._saperateText=d||"";this._options=a;this._selectedKey={};this._pickerOptionString=[];this._childTitle=this._parentTitle="";for(var c in this._options){var a=
this._options[c],b=c+"?",h;for(h in a)b+=h+"&";b=b.substring(0,b.length-1);this._pickerOptionString.push(b);this._isDependent?0<c.indexOf(":")?(a=c.split(":"),this._selectedKey[a[1]]="",this._childTitle=a[1]):(this._selectedKey[c]=Object.keys(a)[0],this._parentTitle=c):this._selectedKey[c]=a.key[0]}this._isDependent&&(c=this._options[this._parentTitle+":"+this._childTitle+":"+this._selectedKey[this._parentTitle]],this._selectedKey[this._childTitle]=c?Object.keys(c)[0]:"");this.updateDisplay()},clear:function(){this._options=
{};this._selectedKey={};this._pickerOptionString=[];this._childTitle=this._parentTitle=""},updateDisplay:function(){var a="",b;for(b in this._selectedKey){var d=this._selectedKey[b];d&&!(1>d.length)&&(a+=d+this._saperateText)}a=a.substring(0,a.length-this._saperateText.length);a.length>this._wordsInLine&&(a=a.replace(RegExp(this._saperateText,"gm"),this._saperateText+"<br/>"));this.setDisplayText(a)},setDisplayText:function(a){$(".selectedValue",this.el).html(a)},setSelectedValues:function(a,b){for(var d in a){var c=
a[d],h;this._isDependent&&d==this._childTitle?(h=this._parentTitle,h+=":"+this._childTitle+":"+this._selectedKey[h],h=this._options[h]):h=this._options[d];for(var e in h)if(h[e]==c){this._selectedKey[d]=e;break}}this.updateDisplay();(!b||!b.silent)&&this.$el.trigger("selectionChange",this.getSelectedValues())},getSelectedValues:function(){var a={},b;for(b in this._selectedKey)if(this._isDependent&&b==this._childTitle){var d=this._parentTitle,d=d+(":"+this._childTitle+":"+this._selectedKey[d]);a[b]=
this._options[d][this._selectedKey[b]]}else a[b]=this._options[b][this._selectedKey[b]];return a},setWordsInLine:function(a){this._wordsInLine=a;this.updateDisplay()},render:function(){return this}});window.myapp=window.myapp||{};window.myapp.Widget=window.myapp.Widget||{};window.myapp.Widget.NativeSelector=b})(window.myapp.Utils,window.myapp.Utils.DeviceType,window.myapp.Images,window.myapp.PG.Picker);(function(e,a,b,c){var g=Backbone.View.extend({initialize:function(){this.$el.addClass("AddressSelectionBox");this.$el.html(_.template('<div class="SelectInput"></div>'));var a=new e({el:$(".SelectInput",this.el)});this.selector=a;var d={city:{}},k;for(k in b){var h=b[k];d.city[h]=h;d["city:town:"+h]={};for(var g in c[h]){var j=c[h][g].split(",")[0];d["city:town:"+h][j]=j}}a.setModel(d,!0,"");a.setDisplayText("請選擇縣市")},events:{"selectionChange *":"changeArea"},changeArea:function(b){var b=b.data,
d="",c;for(c in b)d+=b[c];this.$el.trigger("locationChange",a.address2zipcode(d))},setSelection:function(a,b){var c={};c.city=a.substring(0,3);c.town=a.substring(3);this.selector.setSelectedValues(c,b)},setSelection_zipcode:function(b,d){var c=a.zipcode2address(b);null!=c&&this.setSelection(c,d)},render:function(){return this}});window.myapp=window.myapp||{};window.myapp.Widget=window.myapp.Widget||{};window.myapp.Widget.NativeAddressSelector=g})(window.myapp.Widget.NativeSelector,window.addressAndZipcode,
window.addressAndZipcode.Countries,window.addressAndZipcode.Areas);(function(e){var a=Backbone.View.extend({initialize:function(){this.$el.addClass("DateTimeSelectionBox");this.$el.html(_.template('<div class="SelectInput"></div>'));this.selector=new e({el:$(".SelectInput",this.el)})},events:{"selectionChange *":"timeChanged"},timeChanged:function(){this.$el.trigger("dateTimeSelectionChange",this.getSelection())},setDataList:function(a){if(!a||1>a.length)this.selector.clear();else{var c={},e={},f={};c[this._getDateText(new Date(a[0]))]=a[0];e[this._getTimeText(new Date(a[0]))]=
a[0];f.date=c;f["date:time:"+this._getDateText(new Date(a[0]))]=e;for(var d=0,k=a.length-1;d<k;d++){var h=a[d+1],l=new Date(a[d]),j=new Date(h);l.getYear()==j.getYear()&&l.getMonth==j.getMonth&&l.getDate()==j.getDate()?e[i18n.formatDate(j,"H:i")]=h:(e={},e[this._getTimeText(j)]=h,f["date:time:"+this._getDateText(j)]=e,c[this._getDateText(j)]=h)}this.selector.setModel(f,!0,"")}},getSelection:function(){var a=this.selector.getSelectedValues().time;return isNaN(a)?void 0:new Date(a)},render:function(){return this},
_getDateText:function(a){var c=new Date;return c.getYear()==a.getYear()&&c.getMonth==a.getMonth&&c.getDate()==a.getDate()?"今天":i18n.formatDate(a,"m 月 d 日 (D)")},_getTimeText:function(a){return i18n.formatDate(a,"H:i")}});window.myapp=window.myapp||{};window.myapp.Widget=window.myapp.Widget||{};window.myapp.Widget.NativeTimeSelector=a})(window.myapp.Widget.NativeSelector);(function(){var e=Backbone.View.extend({initialize:function(){this.conn=0;$(this.el).attr("id","loadingPanel");$(this.el).attr("style","position:absolute; z-index: 99990;width: 100%; height: 100%;");$(this.el).hide();$(this.el).html(_.template('<div class="Mask" style="z-index: 99998; position: absolute; width: 100%; height: 100%; background: -webkit-gradient(radial, center center, 150, center center, 520, from(rgba(0, 0, 0, 0.6)), to(rgba(0, 0, 0, 0.95)));"></div><table class="DialogPanel BusyPanel" style="position: relative; margin-top: auto; margin-right: auto; margin-bottom: auto; margin-left: auto; top: 50%;"><colgroup><col></colgroup><tbody><tr><td><div class="gwt-Label" style="text-align: center; ">請稍等...</div></td></tr><tr><td><div class="BusyPanelAnimation"><div></div><div></div><div></div><div></div><div></div></div></td></tr></tbody></table>'))},
connectionOut:function(){this.conn++;this._update()},connectionIn:function(){this.conn--;0>this.conn&&(this.conn=0);this._update()},_update:function(){0<this.conn?this.$el.show():this.$el.hide()},render:function(){return this}});window.myapp=window.myapp||{};window.myapp.Widget=window.myapp.Widget||{};window.myapp.Widget.LoadingPanel=e})();(function(){var e=Backbone.View.extend({initialize:function(){$(this.el).addClass("Accordion")},clear:function(){$(this.el).empty()},add:function(a,b){var c=document.createElement("div"),e=document.createElement("div"),f=document.createElement("div");$(e).addClass("AccordionHeader");$(f).addClass("AccordionContent");$(c).addClass("Collapse");$(f).css("height","0px");$(e).html(a);$(f).html(b);$(c).append(e);$(c).append(f);this.$el.append(c)},toggleAccordionStack:function(a){a=a.currentTarget.parentNode;
$(a).toggleClass("Collapse");$(a).toggleClass("Expand");var b=$(a).children(".AccordionContent");$(a).hasClass("Expand")?b.css("height","auto"):b.css("height","0px");this.$el.trigger("toggle")},events:{"click .AccordionHeader":"toggleAccordionStack"},render:function(){this.delegateEvents();return this}});window.myapp=window.myapp||{};window.myapp.Widget=window.myapp.Widget||{};window.myapp.Widget.Accordion=e})();(function(){var e=Backbone.View.extend({render:function(){var a=this.model.get("storeNameId"),b=this.model.get("displayedName"),c=this.model.get("msg"),e=this.model.get("imgUrl");$(this.el).html(_.template('<a href="#storePage/<%= id %>"><div class=storeBriefWrap><img class="storeImg" src="<%= img %>"></img><div class="Tag"></div><div class="InfoWidget"><div class="NameWidget"><div class="Name"><%= name %></div><div class="Msg"><%= msg %></div></div><div class="Bar"><div></div></div><div class="Status"></div></div></div></a>',
{id:a,name:b,msg:c,img:e}));$(this.el).addClass("StoreBriefWidget3 item");return this}});window.myapp=window.myapp||{};window.myapp.View=window.myapp.View||{};window.myapp.View.StoreBrief=e})();(function(){var e=Backbone.View.extend({initialize:function(){this.$el.addClass("ProductOption")},events:{"change .master":"selectionChange_m","change .salve":"selectionChange_s"},selectionChange_m:function(a){var b=a.currentTarget.value,c=this.model;c.subOption&&(a=$(".salve",this.el).val(),b=c.subOption.values[b]||{},$("select.salve",this.el).html(_.template('<% for(var key in options){ %><% var text = options[key]>0?key+" + "+options[key]+"元":key; %><option value="<%= key %>"><%= text %></option><% } %>',
{options:b})),b[a]&&$(".salve",this.el).val(a));this.$el.trigger("selectionChange")},selectionChange_s:function(){this.$el.trigger("selectionChange")},getSelected:function(){var a=this.model,b={};b[a.title]=$(".master",this.el).val();a.subOption&&(b[a.subOption.title]=$(".salve",this.el).val());return b},getSelectedPrice:function(){var a=this.model,b=0,c=$(".master",this.el).val(),b=b+a.values[c];a.subOption&&(b+=a.subOption.values[c][$(".salve",this.el).val()]);return b},isValid:function(){return!0},
render:function(){var a=this.model;this.$el.html(_.template('<div class="OptionPanel WebOptionPanel"><div class="OptionTitle"><%= title %>：</div><select class="<%= type %>" key="<%= title %>"><% for(var key in options){ %><% var text = options[key]>0?key+" + "+options[key]+"元":key; %><option value="<%= key %>"><%= text %></option><% } %></select></div>',{title:a.title,type:"master",options:a.values}));var b=Object.keys(a.values)[0];$("select.master",this.el).val(b);a.subOption&&(a=a.subOption,this.$el.append(_.template('<div class="OptionPanel WebOptionPanel"><div class="OptionTitle"><%= title %>：</div><select class="<%= type %>" key="<%= title %>"><% for(var key in options){ %><% var text = options[key]>0?key+" + "+options[key]+"元":key; %><option value="<%= key %>"><%= text %></option><% } %></select></div>',
{title:a.title,type:"salve",options:a.values[b]||{}})));return this}});window.myapp=window.myapp||{};window.myapp.View=window.myapp.View||{};window.myapp.View.ProductOptionView=e})();(function(e,a,b,c,g){var f=Backbone.View.extend({initialize:function(){this.tabs={};this.$el.html(_.template('<div class="HeaderPanel"><div id="cancelBtn"><div class="HeaderButton"><div class="ButtonText">取消</div></div></div><div id="title"></div><div id="buyBtn"><div class="HeaderButton"><div class="ButtonText">購買</div></div></div></div><div class="ProductDialog" id="productContent" style="background-color:rgba(255, 255, 255, 0.75) ; -webkit-box-flex: 10;display: -webkit-box; -webkit-box-orient: horizontal;"></div>'));
this.$el.addClass("Base");this.$el.attr("id","productPageView");this.$el.attr("style","height:100%; width:100%;");this.$el.css("z-index","999");this.$el.css("position","absolute");this.$el.hide();this.scroller=new e;$("#productContent",this.el).append(this.scroller.render().el)},events:{"click #cancelBtn":"_cancel","click #buyBtn":"_buy","click #plusBtn":"_addAmount","click #minusBtn":"_minusAmount","selectionChange .ProductOption":"_updateSelection"},resetDisplayedData:function(a){var b=a.get("amount"),
c=a.get("singlePrice"),a=a.get("selectedOptions");$(".Price",this.el).html(_.template("<%=price%> X <%=amount%> = <%=price*amount%>元",{price:c,amount:b}));for(var f in a)$('select[key="'+f+'"]',this.el).val(a[f]);this.selectedOption=a},setModel:function(b,c){b&&(this.model=b);c&&(this.storeNameId=c);var f=this.model,e=f.get("displayedName"),j=f.get("price"),g=f.get("imgUrl"),n=f.get("intro");this.amount=1;this.scroller.html(_.template('<img class="Img" src="<%= img %>" style="<% if(!img || img.length<3) print("display:none;"); %>" /><div><%= name %></div><div><%= info %></div><div style="display: -webkit-box;"><div class="AmountPanel" style="-webkit-box-flex:1; "><div class="AmountOption Horizontal"><div class="Btns"><div class="Button" id="plusBtn"><div class="ButtonText">＋</div></div><div class="Button" id="minusBtn"><div class="ButtonText">－</div></div></div></div></div><div class="Price" style="-webkit-box-flex: 999;"></div></div><div class="OptionBox"></div>',
{name:e,img:g,info:n}));$(".Price",this.el).html(_.template("<%=price%> X <%=amount%> = <%=price*amount%>元",{price:j,amount:this.amount}));$(".OptionBox",this.el).empty();this.optionWidget=[];this.selectedOption={};this.selectedPrice=j;if(f=f.get("options")){for(e=0;e<f.length;e++)j=f[e],g=Object.keys(j.values),0<g.length&&2>g.length?$(".OptionBox",this.el).append(_.template('<div class="OptionPanel WebOptionPanel"><div class="OptionTitle"><%= title %>：</div><div><%= content  %></div></div>',{title:j.title,
content:g[0]})):(j=new a({model:j}),$(".OptionBox",this.el).append(j.render().el),this.optionWidget.push(j),this.selectedOption=$.extend(this.selectedOption,j.getSelected()),this.selectedPrice+=j.getSelectedPrice());this._updateMoney()}this.scroller.render()},_cancel:function(){this.cancelAction&&(this.cancelAction(),this.cancelAction=null);var a=this;this.hide("top",function(){if(a.callback){a.callback();a.callback=null}else window.history.go(-1)})},_buy:function(){if(this.buyAction)this.buyAction(),
this.buyAction=null;else{var a=this;this.hide("bottom",function(){window.shoppingCartCollection||(window.shoppingCartCollection=new g);var f=window.shoppingCartCollection,e=f.get(a.storeNameId);e||(e=this.model.get("deliveryLimit"),e=new c({storeNameId:storeNameId,deliveryLimit:e}),f.add(e));e.addBuyItem(new b({productNameId:a.model.get("productNameId"),selectedOptions:$.extend({},a.selectedOption),singlePrice:a.selectedPrice,amount:a.amount}));window.history.go(-1)})}},_updateSelection:function(){this.selectedPrice=
this.model.get("price");this.selectedOption={};for(var a=0,b=this.optionWidget.length;a<b;a++){var c=this.optionWidget[a];this.selectedOption=$.extend(this.selectedOption,c.getSelected());this.selectedPrice+=c.getSelectedPrice()}this._updateMoney()},_updateMoney:function(){$(".Price",this.el).html(_.template("<%=price%> X <%=amount%> = <%=price*amount%>元",{price:this.selectedPrice,amount:this.amount}))},_addAmount:function(){this.amount++;this.model.get("price");$(".Price",this.el).html(_.template("<%=price%> X <%=amount%> = <%=price*amount%>元",
{price:this.selectedPrice,amount:this.amount}))},_minusAmount:function(){this.amount--;1>this.amount&&(this.amount=1);this.model.get("price");$(".Price",this.el).html(_.template("<%=price%> X <%=amount%> = <%=price*amount%>元",{price:this.selectedPrice,amount:this.amount}))},render:function(){this.delegateEvents();return this},show:function(a,b,c){this.buyAction=b;this.cancelAction=c;"none"==this.$el.css("display")&&("top"==a?this.$el.css("-webkit-transform","translate3d(0, -100%, 0)"):this.$el.css("-webkit-transform",
"translate3d(0, 100%, 0)"),this.$el.show(),this.$el.animate({"-webkit-transform":"translate3d(0, 0, 0)"},300,"ease-in-out",function(){}))},hide:function(a,b){if("none"!=this.$el.css("display")){var c=this;"top"==a?(this.$el.css("-webkit-transform","translate3d(0, 0, 0)"),this.$el.animate({"-webkit-transform":"translate3d(0, -100%, 0)"},300,"ease-in-out",function(){c.$el.hide();b&&b()})):(this.$el.css("-webkit-transform","translate3d(0, 0, 0)"),this.$el.animate({"-webkit-transform":"translate3d(0, 100%, 0)"},
300,"ease-in-out",function(){c.$el.hide();b&&b()}))}}});window.myapp=window.myapp||{};window.myapp.View=window.myapp.View||{};window.myapp.View.ProductPanel=f})(window.myapp.Widget.Scroller,window.myapp.View.ProductOptionView,window.myapp.Model.BuyItem,window.myapp.Model.ShoppingCart,window.myapp.Model.ShoppingCartCollection);(function(){var e=Backbone.View.extend({initialize:function(){$(this.el).html(_.template('<div style="position: absolute; overflow-x: hidden; overflow-y: hidden; left: 0%; top: 0%; right: 25%; height: 50%; "><div class="ProgressBarPanel" style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; "><% if(shoppingCartSum >= deliveryLimit){ %><div class="ProgressMsgOk">可外送</div><% }else{ %><div style="" class="ProgressMsgNotOk">未達額度</div><% } %><div class="ProgressBar"><div style="width: <%= progress %>%;" class="Progress"></div></div><div class="gwt-Label"><%= shoppingCartSum %>/<%= deliveryLimit %></div></div></div><div style="position: absolute; overflow-x: hidden; overflow-y: hidden; left: 0%; top: 50%; bottom: 0%; width: 30%; "><div class="gwt-Label" style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; ">總共$</div></div><div style="position: absolute; overflow-x: hidden; overflow-y: hidden; left: 30%; top: 50%; right: 25%; bottom: 0%; "><div style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; "><%= shoppingCartSum %>元</div></div>',
{shoppingCartSum:0,deliveryLimit:0,progress:0}))},render:function(){return this},resetDisplayedData:function(a){var b=a.get("sum"),a=a.get("deliveryLimit"),c=100*(b/a);100<=c&&(c=100);$(this.el).html(_.template('<div style="position: absolute; overflow-x: hidden; overflow-y: hidden; left: 0%; top: 0%; right: 25%; height: 50%; "><div class="ProgressBarPanel" style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; "><% if(shoppingCartSum >= deliveryLimit){ %><div class="ProgressMsgOk">可外送</div><% }else{ %><div style="" class="ProgressMsgNotOk">未達額度</div><% } %><div class="ProgressBar"><div style="width: <%= progress %>%;" class="Progress"></div></div><div class="gwt-Label"><%= shoppingCartSum %>/<%= deliveryLimit %></div></div></div><div style="position: absolute; overflow-x: hidden; overflow-y: hidden; left: 0%; top: 50%; bottom: 0%; width: 30%; "><div class="gwt-Label" style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; ">總共$</div></div><div style="position: absolute; overflow-x: hidden; overflow-y: hidden; left: 30%; top: 50%; right: 25%; bottom: 0%; "><div style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; "><%= shoppingCartSum %>元</div></div>',
{shoppingCartSum:b,deliveryLimit:a,progress:c}))}});window.myapp=window.myapp||{};window.myapp.View=window.myapp.View||{};window.myapp.View.ShoppingCartPanel=e})();(function(e,a,b,c,g,f,d,k){var h=Backbone.View.extend({initialize:function(){this.loadStore("110");var a=this,b=new g;$(this.el).append('<div class="district-panel"><div class="district-panel-inner"><div id="district-sticker1"></div><div id="district-sticker2"></div><div class="AddressSelector"></div><div class="CircleButton"><div class="locating-txt">自動定位</div><div id="locating-icon">⊙</div></div></div></div><div id="stores-panel">');this.scroller=b;$(this.el).html(_.template('<div id="district-sticker1"></div><div id="district-sticker2"></div><div class="district-panel"><div class="AddressSelector"></div><div class="CircleButton"><div class="locating-txt">自動定位</div><div id="locating-icon">⊙</div></div></div><div id="stores-panel"></div>'));
$("#stores-panel",this.el).css("-webkit-box-flex","1");$("#stores-panel",this.el).append(b.render().el);$(b.el).css("height","100%");$(this.el).addClass("orderTab");this.itemWidth=e.getStoreBriefWidth($(window).width());b=document.createElement("div");$(b).addClass("StoreList clearfix masonry centered");$(this.scroller.content).append(b);this.masonry=new Masonry(b,{columnWidth:this.itemWidth,gutterWidth:e.StoreBriefHmargin,isFitWidth:!0,isResizable:!0});this.useNative(window.phonegapEnabled);$(window).bind("useNative",
function(b){a.useNative(b.data)})},events:{"click .CircleButton":"autoLocate","locationChange .AddressSelector":"locationChange"},autoLocate:function(){var b=this;window.loadingPanel&&window.loadingPanel.connectionOut();a.getCurrentPosition(function(c){a.getAddressFromGeo(c.latitude,c.longitude,function(a){b.addressSelector.setSelection_zipcode(a.results[0].formatted_address.substring(0,3));window.loadingPanel&&window.loadingPanel.connectionIn()},function(a){console.log(a);window.loadingPanel&&window.loadingPanel.connectionIn()})},
function(a){console.log(a);window.loadingPanel&&window.loadingPanel.connectionIn()})},locationChange:function(a){this.loadStore(a.data)},loadStore:function(a){window.menuData||(window.menuData=new c);var d=this,e=window.menuData;e.getMenuByZipCode(a,function(a){a=a.get("stores");a.comparator=function(a,c){if(!e._lat||!e._lng){if(a.get("chainStore")!=c.get("chainStore"))return a.get("index").localeCompare(c.get("index"));var d=a.get("deliveryLimit"),f=c.get("deliveryLimit");return d==f?0:d<f?-1:1}if(!a.get("chainStore")==
c.get("chainStore"))return a.get("index").localeCompare(c.get("index"));var h=b.getDistanceFromLatLng(e._lat,e._lng,a.get("lat"),a.get("lng")),g=b.getDistanceFromLatLng(e._lat,e._lng,c.get("lat"),c.get("lng"));if(h<2.5&&g<2.5||Math.abs(h-g)<1){d=a.get("deliveryLimit");f=c.get("deliveryLimit");return d==f?h==g?0:h<g?-1:1:d==f?0:d<f?-1:1}return h==g?0:h<g?-1:1};a.sort();$(".StoreList",d.el).empty();d._itemCount=a.models.length;d._loadedImg=0;_.each(a.models,function(a){a=(new f({model:a})).render();
a.$el.css("width",d.itemWidth+"px");$(".StoreList",d.el).append(a.el)});$("img",this.el).bind("load",function(){d._loadedImg++;if(d._loadedImg==d._itemCount){d.masonry.reload();d.scroller.render()}});d.masonry.reload();d.scroller.render()},function(a,b){console.log(b)})},render:function(){this.scroller.render();this.delegateEvents();return this},useNative:function(a){a?(a=new k,$(".CircleButton",this.el).css("display","")):(a=new d,$(".CircleButton",this.el).css("display","none"));this.addressSelector=
a;$(".AddressSelector",this.el).html(this.addressSelector.render().el)}});window.myapp=window.myapp||{};window.myapp.OrderTabView=h})(window.myapp.Settings,window.myapp.PG.Geolocation,window.myapp.Utils,window.myapp.Model.MenuData,window.myapp.Widget.Scroller,window.myapp.View.StoreBrief,window.myapp.Widget.AddressSelector,window.myapp.Widget.NativeAddressSelector);(function(e,a,b){var c=Backbone.View.extend({initialize:function(){var c=new e;this.scroller=c;c.html(_.template('<div id="pullDown"></div><div class="OrderHistory"><div><div class="gwt-Label">點餐紀錄:</div><div class="OrderHistoryPanelTitle"><div class="gwt-Label">✭</div><div class="gwt-Label">送餐時間</div><div class="gwt-Label">編號</div><div class="gwt-Label">狀態</div></div></div><div class="OrderHistoryPanel"></div></div><div id="pullUp"></div>'));$(this.el).html(c.el);$(this.el).css("display","-webkit-box");
$(this.el).css("-webkit-box-flex","10");$(c.el).css("width","100%");$(".OrderHistoryPanel",this.el).css("minHeight",window.clientHeight);var f=new a({el:$(".OrderHistoryPanel",this.el)});pullDownEl=$("#pullDown",this.el);pullDownOffset=30;pullUpEl=$("#pullUp",this.el);pullUpOffset=30;c.setPullToRefresh({pullDownEl:pullDownEl,pullDownAction:function(){var a=new b;a.setAPI("getOrderHistory",{phoneId:myapp.LocalModel.getUUID()});a.fetch({success:function(){window.orderHistory=a;f.clear();_.each(a.models,
function(a){var b=_.template('<div class="AccordionArrow"></div><div><%= want.format("m/d H:i") %></div><div><%= send.format("md")+"-"+ID.substring(ID.length-3) %></div><div><%= status %></div>',{send:new Date(a.get("submitDate")),want:new Date(a.get("wantDate")),ID:a.get("orderID"),status:a.get("status")}),a=_.template('<div class="TakeOutLabel"><%if(storePhone){ print(store+"("+storePhone+")"+":"); }else{ print(store+":"); }%></div><ul class="BuyList"><%for(var i=0, length=buyList.length; i<length; i++){var bi=buyList[i];var pname=bi.productNameId, amount=bi.amount, singlePrice=bi.singlePrice, orderName=bi.orderName, option="", orderNameString="";name=name.split("_")[1];var opt=bi.selectedOptions, keySet=Object.keys(opt);if(orderName && orderName.length>0 && orderName!="null"){orderNameString="<span style=\'background:-webkit-gradient(linear,center top, center bottom, from(#5D311A), color-stop(2%, #F38D48), color-stop(98%,#CE6522), to(white));\'>"+orderName+"</span>";}if(keySet.length>0){option="[";for(var j=0, length2=keySet.length; j<length2; j++){var key=keySet[j];option+=key+":"+bi.selectedOptions[key]+",";}option=option.substring(0,option.length-1); option+="]";}if(singlePrice>0){print("<li>"+orderNameString+pname+option+" X "+amount+" = "+singlePrice*amount+"元</li>");}else{print("<li>"+orderNameString+pname+option+" X "+amount+"</li>");}}%></ul><div class="TotalMoney"><%= "總共"+total+"元" %></div>',
{store:a.get("branchName"),storePhone:a.get("branchPhone"),buyList:a.get("buyList"),total:a.get("totalMoney")});f.add(b,a)});c.render()},error:function(){console.log("get order history failed")}})}})},events:{"toggle .Accordion":"toggleCallback"},toggleCallback:function(){this.scroller.render()},render:function(){this.delegateEvents();this.scroller.render();return this}});window.myapp=window.myapp||{};window.myapp.HistoryTabView=c})(window.myapp.Widget.Scroller,window.myapp.Widget.Accordion,window.myapp.Model.OrderHistory);(function(e){var a=Backbone.View.extend({initialize:function(){var a=new e;this.scroller=a;a.html(_.template("<div class='about_text' style='width:100%;'>感謝您使用Jashami(甲蝦米)<br/>您希望哪些商家擁有Jashami的服務，請推薦給我們：<input id='recommendation' type='Text' class='INPUT Text'>請留下您的寶貴意見，我們將為您提供更好的服務:<input id='opinion' type='Text' class='INPUT Text'><a id='sendFeedbackBtn' class='SubmitButton'>送出</a></div>"));$(this.el).html(a.el);$(this.el).css("display","-webkit-box");$(this.el).css("-webkit-box-flex","10");$(a.el).css("width",
"100%")},events:{"click #sendFeedbackBtn":"sendFeedback"},render:function(){this.scroller.render();this.delegateEvents();return this},sendFeedback:function(){var a=$("#recommendation",this.el).val(),c=$("#opinion",this.el).val();alert("sendFeedback"+a+c)}});window.myapp=window.myapp||{};window.myapp.FeedbackTabView=a})(window.myapp.Widget.Scroller);(function(e){var a=Backbone.View.extend({initialize:function(){var a=new e;a.html(_.template('<div id="content" data-scrollable="y" style="width:100%;">qqq</div>'));$(this.el).html(a.el);$(this.el).css("background-color","rgba(255, 255, 255, 0.75)");$(this.el).css("display","-webkit-box");$(this.el).css("-webkit-box-flex","10");$(a.el).css("width","100%")},events:{},render:function(){return this}});window.myapp=window.myapp||{};window.myapp.AboutUsTabView=a})(window.myapp.Widget.Scroller);(function(e,a,b,c){var g=['<div class="PageLeftPanel"></div><div class="PageMainPanel"><div class="header-shadow"></div><div class="header-outer"><div class="header"><div class="center"><div class="BackButton"><a><div class="Pointer"></div><div class="Button"><div class="ButtonMsg"></div></div></a></div><div class="function-panel">','<a class="link" href="#startPage/orderTab"><div class="link-wrap"><div id="order-link" class="icon" style=" -webkit-mask-box-image:url('+a.SearchIcon+');"></div><div class="function-txt">訂餐</div></div></a>',
'<a class="link" href="#startPage/historyTab"><div class="link-wrap"><div id="history-link" class="icon" style=" -webkit-mask-box-image:url('+a.FileIcon+');"></div><div class="function-txt">紀錄</div></div></a>','<a class="link" href="#startPage/feedbackTab"><div class="link-wrap"><div id="feedback-link" class="icon" style=" -webkit-mask-box-image:url('+a.CommentsIcon+');"></div><div class="function-txt">意見</div></div></a>','<a class="link" href="#startPage/aboutUsTab"><div class="link-wrap"><div id="about-link" class="icon" style=" -webkit-mask-box-image:url('+
a.JashamiIcon+');"></div><div class="function-txt">關於</div></div></a>','</div><div class="NextButton"><div class="Pointer"></div><div class="Button"><div class="ButtonMsg"></div></div></div></div></div></div><div class="content-wrap"><div class="header-fake"></div><div class="PageContent"></div></div></div>'].join(""),e=Backbone.View.extend({initialize:function(){this.isShowFunction=!1;this.tabs={};this.$el.html(_.template(g));this.$el.addClass("Base");this.$el.attr("id","startPageView");this.$el.attr("style",
"height:100%; width:100%;");this.$el.css("-webkit-box-orient","horizontal");new b({el:$(".BackButton",this.el)})},events:{"click .PageContent":"hideFunctionPanel","click .BackButton":"toggleFunctionPanel","click .PageLeftPanel .TabButton":"toTab2"},render:function(){return this},toggleFunctionPanel:function(){this.isShowFunction?(this.$el.children(".PageLeftPanel").css("-webkit-transform","translate3d(-100%, 0px, 0px)"),this.$el.children(".PageMainPanel").css("-webkit-transform","translate3d(0px, 0px, 0px)"),
this.onToggle=this.isShowFunction=!1):(this.$el.children(".PageLeftPanel").css("-webkit-transform","translate3d(0px, 0px, 0px)"),this.$el.children(".PageMainPanel").css("-webkit-transform","translate3d(200px, 0px, 0px)"),this.isShowFunction=!0)},hideFunctionPanel:function(){this.isShowFunction&&(this.$el.children(".PageLeftPanel").css("-webkit-transform","translate3d(-100%, 0px, 0px)"),this.$el.children(".PageMainPanel").css("-webkit-transform","translate3d(0px, 0px, 0px)"),this.isShowFunction=!1)},
toTab:function(a){a&&(this.currentTab=a,this.tabs[a]||(this.tabs[a]=new c[a],$(".PageContent",this.el).append(this.tabs[a].render().el)),$(".PageContent",this.el).children().hide(),$(this.tabs[a].el).css("display","-webkit-box"),this.tabs[a].render())},toTab2:function(a){a=$(a.currentTarget).attr("href");Backbone.history.navigate("#startPage/"+a,{trigger:!1,replace:!0});this.toggleFunctionPanel();this.toTab(a);this.$el.attr("url",window.location.href)}});window.myapp=window.myapp||{};window.myapp.StartPageView=
e})(i18n,window.myapp.Images,window.myapp.Widget.TouchWidget,{orderTab:window.myapp.OrderTabView,historyTab:window.myapp.HistoryTabView,feedbackTab:window.myapp.FeedbackTabView,aboutUsTab:window.myapp.AboutUsTabView});(function(e,a,b,c,g,f){var d=['<div class="header"><div><div class="HeaderButton BackButton"><span class="Pointer"></span><span class="Button">返回</span></div></div><div id="title"></div><div></div></div><div id="storeContent" style="-webkit-box-flex: 10;display: -webkit-box; -webkit-box-orient: horizontal;"></div><div class="ShoppingCar"><div style="position: relative; " class="Car"><div style="position: absolute; overflow-x: hidden; overflow-y: hidden; top: 0%; right: 0%; bottom: 0%; width: 25%; "><a class="Button" style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; ">',
'<div><img src="'+e.ShoppingCarIcon+'"></div><div class="ButtonText">查看</div>','</a></div><div class="ShoppingCartPanel"></div></div></div>'].join(""),e=Backbone.View.extend({initialize:function(){var e=this;$(this.el).addClass("Base");$(this.el).attr("id","storePageView");$(this.el).attr("style","height:100%; width:100%;");this.scroller=new a;this._segmentPanelWidth=640<$(window).width()?60:30;this.segmentPanel=new a;window.productPanel||(window.productPanel=new b,$("body").append(window.productPanel.$el));
$(this.el).html(_.template(d));$("#storeContent",this.el).append(this.scroller.render().el);$("#storeContent",this.el).append(this.segmentPanel.render().el);$(this.segmentPanel.getContent()).addClass("ScrollBar Segment");window.shoppingCartPanel||(window.shoppingCartPanel=new c,$(".ShoppingCartPanel",this.el).html(window.shoppingCartPanel.render().el));this._col=3;this._gridWidth=100;this._gridHeight=75;this._gridHMargin=2;this._minCol=this._gridVMargin=3;this._minGridWidth=640>=$(window).width()?
100:150;this._maxGridWidth=640>=$(window).width()?150:200;$(window).bind("resize",function(){e._minGridWidth=$(window).width()<=640?100:150;e._maxGridWidth=$(window).width()<=640?150:200;e._segmentPanelWidth=$(window).width()>640?60:30;var a=$(window).width()-e._segmentPanelWidth;e.calAndSetGridSize(e._segmentPanelWidth,a)})},refreshGridSize:function(){this._minGridWidth=640>=$(window).width()?100:150;this._maxGridWidth=640>=$(window).width()?150:200;this._segmentPanelWidth=640<$(window).width()?
60:30;this.calAndSetGridSize(this._segmentPanelWidth,$(window).width()-this._segmentPanelWidth)},calAndSetGridSize:function(a,b){$(this.scroller.el).css("width",b+"px");for(var c=2*this._gridHMargin,d=b/this._col-c;d>this._maxGridWidth;)this._col++,d=b/this._col-c;for(;this._col>this._minCol&&d<this._minGridWidth;)this._col--,d=b/this._col-c;this._gridHeight=this._gridHeight*d/this._gridWidth;this._gridWidth=d;c=$(".Grid",this.el);for(i=0;i<c.length;i++)d=$(c.get(i)),d.css("width",this._gridWidth),
$("img",d).length?d.css("height",2*this._gridHeight+this._gridVMargin):d.css("height",this._gridHeight);$(".SegmentWidget",this.el).width(a)},resetScroller:function(){this.scroller.scrollTo(0,0);this.segmentPanel.scrollTo(0,0)},resetDisplayedData:function(){this.scroller.getContent().empty();this.segmentPanel.getContent().empty()},setModel:function(a){a&&(this.model=a);var b=this,a=this.model.get("displayedName");$("#title",this.el).html(a);var c=this.model.get("menuId").get("products").models,d,
e,n=0,p=function(a){var c=document.createElement("div");c.className="Grid";c.style["float"]="left";c.style.marginTop=b._gridVMargin+"px";c.style.marginBottom=b._gridVMargin+"px";c.style.marginLeft=b._gridHMargin+"px";c.style.marginRight=b._gridHMargin+"px";var f=a.get("imgUrl"),g=a.get("displayedName"),k=a.get("price"),l=a.get("productNameId");c.pid=l;if(f){c.style.width=b._gridWidth+"px";c.style.height=b._gridHeight*2+b._gridVMargin+"px";$(c).html(_.template('<div class="ProductBoxWidget2"><img class="ProductBoxWidget2-img" src="<%= img %>"/><div class="ProductBoxWidget2-info"><div class="ProductBoxWidget2-name"><%= name %></div><div class="ProductBoxWidget2-price"><%= price %>元</div></div></div>',
{img:f,name:g,price:k}))}else{c.style.width=b._gridWidth+"px";c.style.height=b._gridHeight+"px";$(c).html(_.template('<div class="ProductBoxWidget2"><div class="ProductBoxWidget2-infoNoImg"><div class="ProductBoxWidget2-name"><%= name %></div><div class="ProductBoxWidget2-price"><%= price %>元</div></div></div>',{name:g,price:k}))}a=a.get("category");a=a.substring(a.indexOf(".")+1);if(a==d)$(e).append(c);else{n++;d=a;g=document.createElement("div");g.className="FlexGridContainerTitle";f=d.indexOf("@");
f>=0&&(a=d.substring(0,f));g.innerHTML=a;e=document.createElement("div");e.className="FlexGridContainer color1";e.id="cateName"+n;e.style.paddingTop="15px";e.style.marginBottom="-15px";$(e).append(g);$(e).append(c);b.scroller.getContent().append(e);c=document.createElement("div");c.className="SegmentWidget color1";f=d.indexOf("@")+1;f>0&&(a=d.substring(f));c.innerHTML="<div>"+a+"</div>";b.segmentPanel.getContent().append(c);$(c).width(b._segmentPanelWidth);$(c).attr("loc","cateName"+n)}};setTimeout(function(){_.each(c,
p);$(e).css("margin-bottom","0px");b.scroller.render();b.segmentPanel.render();$(".SegmentWidget",b.el).bind("click",function(a){a=$(a.currentTarget).attr("loc");b.scroller.scrollToElement($("#"+a).get(0))})},30);a=this.model.get("storeNameId");$(".ShoppingCar a.Button",this.el).attr("href","#oderInfoPage/"+a);window.shoppingCartCollection||(window.shoppingCartCollection=new f);var o=window.shoppingCartCollection,m=o.get(a);m||(m=this.model.get("deliveryLimit"),m=new g({storeNameId:a,deliveryLimit:m}),
o.add(m));m.updateDisplay()},events:{"click .BackButton":"goBack","click .Grid":"showProduct"},goBack:function(){window.inTransition||(window.isGoBack=!0,window.history.back())},showProduct:function(a){pid=$(a.currentTarget).attr("pid");window.productPanel.show("top");this.model.get("menuId").get("menuId");window.productPanel.setModel(this.model.get("menuId").get("products").get(pid),this.model.get("storeNameId"));a="";a=0<=window.location.hash.indexOf(pid)?window.location.hash:window.location.hash+
"/"+pid;Backbone.history.navigate(a,{trigger:!1,replace:!1})},render:function(){this.scroller.render();this.delegateEvents();return this}});window.myapp=window.myapp||{};window.myapp.StorePageView=e})(window.myapp.Images,window.myapp.Widget.Scroller,window.myapp.View.ProductPanel,window.myapp.View.ShoppingCartPanel,window.myapp.Model.ShoppingCart,window.myapp.Model.ShoppingCartCollection);(function(e,a){var b=Backbone.View.extend({initialize:function(){$(this.el).addClass("Base");$(this.el).attr("id","OrderInfoPageView");$(this.el).attr("style","height:100%; width:100%;");this.scroller=new a;$(this.el).html(_.template('<div class="HeaderPanel"><div><div class="HeaderButton BackButton"><span class="Pointer"></span><span class="Button">返回</span></div></div><div id="title"></div><div></div></div><div class="OrderInfoListTitle"><div><div class="AccordionArrow"></div><div>已點餐點</div></div><div><div class="AccordionArrow"></div><div>數量</div></div><div><div class="AccordionArrow"></div><div>價錢</div></div></div><div class="OrderListPanel" style="color:#000; background-color:rgba(255, 255, 255, 0.75); -webkit-box-flex: 10;display: -webkit-box; -webkit-box-orient: horizontal;"></div><div id="orderList" style="-webkit-box-flex: 10;display: -webkit-box; -webkit-box-orient: horizontal;"></div><div class="TotalMoneyPanel"><div><div>總共</div><div class="totalCount"></div><div class="totalMoney"></div><div></div></div></div><div class="OrderInfo Btns"><div class="Button" id="clearAllBtn"><div class="ButtonText">清除全部</div></div><a class="Button" id="checkOutBtn"><div class="ButtonText">結帳</div></a></div>'))},
setModel:function(a){a&&(this.model=a);a=this.model.get("displayedName");$("#title",this.el).html(a);$("#checkOutBtn",this.el).attr("href","#userInfoPage/"+this.model.id);this.resetDisplayedData()},events:{"click .BackButton":"goBack","click #clearAllBtn":"clearAll","click .updateItem":"updateItem","click .removeItem":"removeItem"},goBack:function(){window.inTransition||(window.isGoBack=!0,window.history.back())},clearAll:function(){var a=this.model.get("storeNameId");window.shoppingCartCollection.get(a).clearBuyList()},
updateItem:function(a){var a=a.currentTarget.getAttribute("index"),b=this.model.get("storeNameId"),e=window.shoppingCartCollection.get(b).get("buyList").at(a),a=e.get("productNameId"),d=window.menuData.get("stores").get(b).get("menuId").get("products").get(a);window.productPanel.show("top",function(){var a=this;this.hide("bottom",function(){window.shoppingCartCollection||(window.shoppingCartCollection=new ShoppingCartCollection);var c=window.shoppingCartCollection,d=c.get(a.storeNameId);d||(d=this.model.get("deliveryLimit"),
d=new ShoppingCartData({storeNameId:b,deliveryLimit:d}),c.add(d));e.set("selectedOptions",$.extend({},a.selectedOption));e.set("singlePrice",a.selectedPrice);e.set("amount",a.amount);d.updateBuyItem(e);window.history.go(-1)})});window.productPanel.setModel(d,b);window.productPanel.resetDisplayedData(e);d="";d=0<=window.location.hash.indexOf(a)?window.location.hash:window.location.hash+"/"+a;Backbone.history.navigate(d,{trigger:!1,replace:!1})},removeItem:function(a){var a=a.currentTarget.getAttribute("index"),
b=this.model.get("storeNameId"),b=window.shoppingCartCollection.get(b),a=b.get("buyList").at(a);b.removeBuyItem(a)},resetDisplayedData:function(){var a=this.model.get("storeNameId"),a=window.shoppingCartCollection.get(a);this.scroller.html(_.template('<div class="OrderInfoList"><% for(var i=0, length=shoppingCart.get("buyList").length; i<length; i++){ %><% var buyList = shoppingCart.get("buyList") %><div><img class="removeItem" index="<%= i %>" src="data:image/png;base64,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"></img><div class="BuyItemCell"><div class="ProductInfoPanel"><div class="ProductName"><%= buyList.at(i).get("productNameId") %></div><div class="OptionPanel"><% var selectedOptions = buyList.at(i).get("selectedOptions"); %><% for(var key in selectedOptions){ %><div><%=  key %>：<%=  selectedOptions[key] %></div><% } %></div></div><div class="BuyAmount"><%= buyList.at(i).get("amount") %></div><div class="BuyPrice"><%= buyList.at(i).get("singlePrice") * buyList.at(i).get("amount") %>元</div></div><img class="updateItem" index="<%= i %>" src="data:image/png;base64,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"></img></div><% } %></div>',
{shoppingCart:a}));$(".OrderListPanel",this.el).html(this.scroller.render().el);$(this.scroller.el).css("width","100%");$(".totalCount",this.el).html(a.get("amount"));$(".totalMoney",this.el).html(a.get("sum"))},render:function(){this.scroller.render();this.delegateEvents();return this}});window.myapp=window.myapp||{};window.myapp.OrderInfoPageView=b})(window.myapp.Images,window.myapp.Widget.Scroller,window.myapp.View.ProductPanel);(function(e,a,b,c){var g=Backbone.View.extend({initialize:function(){$(this.el).addClass("Base");$(this.el).attr("id","UserInfoPageView");$(this.el).attr("style","height:100%; width:100%;");this.scroller=new a;$(this.scroller.el).css("width","100%");$(this.scroller.el).css("-webkit-box-flex","1");$(this.el).html(_.template('<div class="HeaderPanel"><div><div class="HeaderButton BackButton"><span class="Pointer"></span><span class="Button">返回</span></div></div><div id="title"></div><div><div class="HeaderButton NextButton"><span class="Pointer"></span><span class="Button">送出</span></div></div></div><div id="userinfoList" style="-webkit-box-flex: 10;display: -webkit-box; -webkit-box-orient: horizontal;"></div>'));
$("#userinfoList",this.el).append(this.scroller.render().el);this.scroller.html(_.template('<table class="UserInfo"><colgroup><col></colgroup><tbody><tr><td><div>送達時間</div></td><td><div class="DateTimeSelectionBox"></div></td></tr><tr><td><div>稱呼</div></td><td><input type="Text" placeholder="必填" class="INPUT Text"></td></tr><tr><td><div>手機</div></td><td><input type="Tel" placeholder="必填" class="INPUT Tel"></td></tr><tr><td><div>地址</div></td><td><table cellspacing="0" cellpadding="0" style="width: 100%; "><tbody><tr><td align="left" style="vertical-align: middle; " width="200px"><div style="font-size: 12pt; ">台北市信義區</div></td><td align="left" style="vertical-align: middle; "><input type="Text" placeholder="必填" class="INPUT Text" style=""></td></tr></tbody></table></td></tr><tr><td><div>公司行號</div></td><td><input type="Text" placeholder="選填，公司請註明，以便外送人員找尋" class="INPUT Text"></td></tr><tr><td><div>統一編號</div></td><td><input type="Tel" placeholder="選填" class="INPUT Tel"></td></tr><tr><td><div>附註</div></td><td><input type="Text" placeholder="選填，任何您想補充說明的" class="INPUT Text"></td></tr></tbody></table>'));
this.useNative(window.phonegapEnabled);$(window).bind("useNative",function(a){that.useNative(a.data)})},events:{"click .BackButton":"goBack","click .NextButton":"sendOrder"},goBack:function(){window.inTransition||(window.isGoBack=!0,window.history.back())},sendOrder:function(){$.ajax({type:"GET",url:"./testData/sendOrder",dataType:"json",success:function(a){console.log(a);$.ajax({type:"POST",url:e+"?action=sendOrder",dataType:"json",data:JSON.stringify(a),success:function(a){console.log(a)}})},error:function(a,
b){console.log(a);console.log(b)}})},setAvailableTime:function(a){this.timeSelector.setDataList(a)},render:function(){this.scroller.render();this.delegateEvents();return this},useNative:function(a){this.timeSelector=a?new c:new b;$(".DateTimeSelectionBox",this.el).html(this.timeSelector.render().el)}});window.myapp=window.myapp||{};window.myapp.UserInfoPageView=g})(window.myapp.Api.OrderServiceUrl,window.myapp.Widget.Scroller,window.myapp.Widget.DateTimeSelector,window.myapp.Widget.NativeTimeSelector);(function(e,a,b,c){var g=Backbone.Router.extend({routes:{"startPage/:tab":"startPage","storePage/:store":"storePage","storePage/:store/:product":"productPage","oderInfoPage/:store":"orderInfoPage","userInfoPage/:store":"userInfoPage","*actions":"defaultAction"},initialize:function(){window.loadingPanel=new b;$("body").append(window.loadingPanel.el);var a=this;this.views={};window.useTransitionEffect=!0;window.lastUrl=window.location.href;this.views.startPage=new c.StartPageView;this.loadToDOM(this.views.startPage.el);
this.views.storePage=new c.StorePageView;this.loadToDOM(this.views.storePage.el);$(window).bind("hashchange",function(b){var c;b.newURL?(c=b.newURL,b=b.oldURL):(c=window.location.href,b=window.lastUrl,window.lastUrl=c);if(0<=c.indexOf("#startPage")||0>c.indexOf("#"))a.transitionEffectType="hSlide",0<=b.indexOf("#storePage")&&(a.transitionDir="left");else if(0<=c.indexOf("#storePage")){if(a.transitionEffectType="hSlide",0<=b.indexOf("#startPage")||0>b.indexOf("#"))a.transitionDir="right"}else 0<=c.indexOf("#oderInfoPage")?
(a.transitionEffectType="hSlide",0<=b.indexOf("#storePage")&&(a.transitionDir="right")):0<=c.indexOf("#userInfoPage")&&(a.transitionEffectType="hSlide",0<=b.indexOf("#oderInfoPage")&&(a.transitionDir="right"))})},defaultAction:function(){this.startPage("orderTab")},startPage:function(a){this.views.startPage||(this.views.startPage=new c.StartPageView,this.loadToDOM(this.views.startPage.el));window.productPanel&&window.productPanel.$el.hide();this.changePage(this.views.startPage.render().el,this.transitionEffectType,
this.transitionDir);this.transitionDir=this.transitionEffectType=null;this.views.startPage.toTab(a)},storePage:function(b){this.views.storePage||(this.views.storePage=new c.StorePageView,this.loadToDOM(this.views.storePage.el));window.productPanel&&window.productPanel.$el.hide();var d=this;d.views.storePage.$el.attr("url")==window.location.href?(d.changePage(d.views.storePage.el,d.transitionEffectType,d.transitionDir),d.transitionEffectType=null,d.transitionDir=null,d.views.storePage.render()):(d.changePage(d.views.storePage.el,
d.transitionEffectType,d.transitionDir),d.transitionEffectType=null,d.transitionDir=null,window.menuData?(d.views.storePage.resetDisplayedData(),d.views.storePage.refreshGridSize(),d.views.storePage.resetScroller(),d.views.storePage.setModel(window.menuData.get("stores").get(b)),d.views.orderInfoPage||(d.views.orderInfoPage=new c.OrderInfoPageView,d.loadToDOM(d.views.orderInfoPage.el))):(window.menuData=new a,window.menuData.fetch({success:function(){d.views.storePage.resetDisplayedData();d.views.storePage.refreshGridSize();
d.views.storePage.resetScroller();d.views.storePage.setModel(window.menuData.get("stores").get(b));if(!d.views.orderInfoPage){d.views.orderInfoPage=new c.OrderInfoPageView;d.loadToDOM(d.views.orderInfoPage.el)}}})))},productPage:function(){window.productPanel||(window.productPanel=new ProductPanel,$("body").append(window.productPanel.$el));window.productPanel.$el.show();this.changePage(this.views.storePage.el)},orderInfoPage:function(b){this.views.orderInfoPage||(this.views.orderInfoPage=new c.OrderInfoPageView,
this.loadToDOM(this.views.orderInfoPage.el));this.views.orderInfoPage&&!window.orderInfoPage&&(window.orderInfoPage=this.views.orderInfoPage);this.changePage(this.views.orderInfoPage.render().el,this.transitionEffectType,this.transitionDir);this.transitionDir=this.transitionEffectType=null;var d=this;window.menuData?(d.views.orderInfoPage.setModel(window.menuData.get("stores").get(b)),d.views.userInfoPage||(d.views.userInfoPage=new c.UserInfoPageView,d.loadToDOM(d.views.userInfoPage.el))):(window.menuData=
new a,window.menuData.fetch({success:function(){d.views.orderInfoPage.setModel(window.menuData.get("stores").get(b));if(!d.views.userInfoPage){d.views.userInfoPage=new c.UserInfoPageView;d.loadToDOM(d.views.userInfoPage.el)}}}))},userInfoPage:function(a){var b=this;this.views.userInfoPage||(this.views.userInfoPage=new c.UserInfoPageView,this.loadToDOM(this.views.userInfoPage.el));this.views.userInfoPage.setAvailableTime([]);window.loadingPanel&&window.loadingPanel.connectionOut();$.ajax({type:"GET",
url:e+"?action=getAvailableDeliveryTime&storeID="+a,dataType:"json",success:function(a){window.loadingPanel&&window.loadingPanel.connectionIn();b.views.userInfoPage.setAvailableTime(a.time)},error:function(){window.loadingPanel&&window.loadingPanel.connectionIn()}});this.changePage(this.views.userInfoPage.render().el,this.transitionEffectType,this.transitionDir);this.transitionDir=this.transitionEffectType=null;this.views.userInfoPage.render()},loadToDOM:function(a){var b=$(a).attr("id");0<$("#"+
b).length?console.log("page "+b+" has already loaded"):($(a).hide(),$("#mainRoot").append(a))},changePage:function(a,b,c){$(":focus").blur();var e=$(this.currentActivePage),g=$(a);g.attr("url",window.location.href);if(!(e==g||e.attr("url")==g.attr("url")))if(window.inTransition=!0,!window.useTransitionEffect||!b||0>"hSlide".indexOf(b))e.hide(),g.show(),this.currentActivePage=g,window.inTransition=!1;else if("hSlide"==b){var j=this;e.css("position","absolute");g.css("position","absolute");g.show();
"right"==c?(g.css("-webkit-transform","translate3d(100%, 0, 0)"),e.css("-webkit-transform","translate3d(0, 0, 0)"),e.animate({"-webkit-transform":"translate3d(-100%, 0, 0)"},300,"ease-in-out",function(){e.hide()}),g.animate({"-webkit-transform":"translate3d(0, 0, 0)"},300,"ease-in-out",function(){j.currentActivePage=g;window.inTransition=!1})):(g.css("-webkit-transform","translate3d(-100%, 0, 0)"),e.css("-webkit-transform","translate3d(0, 0, 0)"),e.animate({"-webkit-transform":"translate3d(100%, 0, 0)"},
300,"ease-in-out",function(){e.hide()}),g.animate({"-webkit-transform":"translate3d(0, 0, 0)"},300,"ease-in-out",function(){j.currentActivePage=g;window.inTransition=!1}),window.isGoBack=!1)}}});window.myapp=window.myapp||{};window.myapp.Router=g})(window.myapp.Api.OrderServiceUrl,window.myapp.Model.MenuData,window.myapp.Widget.LoadingPanel,{StartPageView:window.myapp.StartPageView,StorePageView:window.myapp.StorePageView,OrderInfoPageView:window.myapp.OrderInfoPageView,UserInfoPageView:window.myapp.UserInfoPageView});
